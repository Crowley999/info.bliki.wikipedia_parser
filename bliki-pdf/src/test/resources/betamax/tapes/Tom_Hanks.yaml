!tape
name: Tom_Hanks
interactions:
- recorded: 2014-11-04T23:11:02.897Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Tom+Hanks&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:02 GMT
      Server: Apache
      Set-Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4; Path=/; Domain=.wikipedia.org
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq59 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226971582, 3268170295, 4115537263
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"43568\" ns=\"0\" title=\"Tom Hanks\"><revisions><rev user=\"Bbb23\" timestamp=\"2014-10-31T22:26:22Z\" comment=\"place of birth is unnecessary in lead (already in infobox\
      \ and body and his nationality is in lead)\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{refimprove|date=September 2014}}\n{{About|the American actor|the seismologist|Thomas C. Hanks}}\n{{pp-move-indef}}\n{{pp-semi-blp|small=yes}}\n\
      {{Use mdy dates|date=October 2013}}\n{{Infobox person\n| image       = TomHanksJan2009 (cropped).jpg\n| imagesize   = 220px\n| caption     = Hanks at [[We Are One: The Obama Inaugural Celebration at the Lincoln Memorial]] in 2009\n| alt         = Hanks\
      \ standing at a podium\n| birth_name  = Thomas Jeffrey Hanks\n| birth_date  = {{Birth date and age|1956|7|9}}&lt;ref&gt;{{cite news|title=Monitor|newspaper=[[Entertainment Weekly]]|publisher=[[Time Inc.]]|date=July 13, 2012|issue=1215|page=20}}&lt;/ref&gt;\n\
      | birth_place = [[Concord, California]], U.S.\n| residence   = Los Angeles\n| education   = [[California State University, Sacramento]]\n| years_active = 1978–present\n| occupation  = Actor, filmmaker\n| spouse      ={{ubl|{{marriage|Samantha Lewes|1978|1987}}|{{marriage|[[Rita\
      \ Wilson]]|1988|}}}}\n| children    = 4; including [[Colin Hanks]]\n| net_worth   = $390 million (as of 2014)&lt;ref&gt;{{cite news|url=http://gma.yahoo.com/richest-actors-world-not-expect-015943179--abc-news-celebrities.html|title=The Richest Actors in\
      \ the World Are Not Who You Expect|publisher=ABC ''Good Morning America''|first=Susanna|last=Kim|date=22 May 2014|accessdate=5 August 2014}}&lt;/ref&gt;\n}}\n'''Thomas Jeffrey''' &quot;'''Tom'''&quot; '''Hanks''' (born July 9, 1956) is an American [[actor]]\
      \ and [[Filmmaking|filmmaker]]. He is known for his roles in ''[[Big (film)|Big]]'' (1988), ''[[Philadelphia (film)|Philadelphia]]'' (1993), ''[[Forrest Gump]]'' (1994), ''[[Apollo 13 (film)|Apollo 13]]'' (1995), ''[[Saving Private Ryan]]'', ''[[You've\
      \ Got Mail]]'' (both 1998), ''[[Cast Away]]'' (2000), ''[[The Da Vinci Code (film)|The Da Vinci Code]]'' (2006), ''[[Captain Phillips (film)|Captain Phillips]]'', and ''[[Saving Mr. Banks]]'' (both 2013), as well as for his voice work in the animated films\
      \ ''[[The Polar Express (film)|The Polar Express]]'' (2004) and the ''[[Toy Story (franchise)|Toy Story]]'' series.\n\nHanks has earned and been nominated for numerous awards during his career, including winning a [[Golden Globe Award]] and an [[Academy\
      \ Awards|Academy Award]] for Best Actor for his role in ''Philadelphia'', as well as a Golden Globe, an Academy Award, a [[Screen Actors Guild Award]], and a [[People's Choice Award]] for Best Actor for his role in ''Forrest Gump''. In 2004, he received\
      \ the Stanley Kubrick Britannia Award for Excellence in Film from the [[British Academy of Film and Television Arts]] (BAFTA).&lt;ref&gt;{{cite web|url=http://news.bbc.co.uk/1/hi/entertainment/3983091.stm|title=Hanks' big splash in Hollywood|publisher=[[BBC\
      \ News]]|date=November 5, 2004|accessdate=August 7, 2014}}&lt;/ref&gt;\n\nHanks is also known for his collaboration with film director [[Steven Spielberg]] on ''Saving Private Ryan'', ''[[Catch Me If You Can]]'' (2002), and ''[[The Terminal]]'' (2004),\
      \ as well as the 2001 mini-series ''[[Band of Brothers (TV miniseries)|Band of Brothers]]'', which launched Hanks as a successful director, producer, and writer. In 2010, Spielberg and Hanks were [[executive producer]]s on the HBO mini-series [[The Pacific\
      \ (TV miniseries)|''The Pacific'']] (a&amp;nbsp;companion piece&amp;nbsp;to ''Band of Brothers'').\n\nAs of 2014, Hanks' films have [[gross (economics)|grossed]] over $4.2 billion at the US and Canada box offices, and over $8.4 billion worldwide,&lt;ref&gt;{{cite\
      \ web|url=http://www.boxofficemojo.com/people/chart/?id=tomhanks.htm|title=Tom Hanks Movie Box Office Results|publisher=[[Box Office Mojo]]|accessdate=August 6, 2014}}&lt;/ref&gt; making him one of the highest-grossing actors in film history.&lt;ref&gt;{{cite\
      \ web | url=http://www.dailyfinance.com/2013/02/21/the-10-most-valuable-actors-of-all-time/#!slide=977847 | title=The 10 most valuable actors of all time | work=Dailyfinance.com | date=February 21, 2013 | accessdate=December 21, 2013}}&lt;/ref&gt;\n\n\
      ==Early life and education==\nHanks was born in [[Concord, California]]. His father, Amos Mefford Hanks (born in [[Glenn County, California]], on March 9, 1924&amp;nbsp;– died in [[Alameda, California]], on January 31, 1992), was an itinerant cook.&lt;ref\
      \ name=tca&gt;Stated on ''[[Inside the Actors Studio]]'', 1999&lt;/ref&gt; His mother, Janet Marylyn (née Frager; born in [[Alameda County, California]], on January 18, 1932), was a hospital worker. She is of [[Portuguese-American|Portuguese]] ancestry\
      \ (her family's surname was originally Fraga), while two of Hanks' paternal great-grandparents emigrated from the United Kingdom.&lt;ref&gt;{{youtube|id=QDXsSnjehrM|title=Friday Night with Jonathan Ross, January 2008}}&lt;/ref&gt;&lt;ref&gt;{{cite web|url=http://www.thisislondon.co.uk/showbiz/article-23373847-the-all-american-icons-with-british-roots.do\
      \ |title=The all-American icons with British roots – Showbiz – Evening Standard |work=Thisislondon.co.uk |date=November 8, 2006 |accessdate=March 12, 2012}}&lt;/ref&gt;&lt;ref&gt;{{cite web|url=http://www.portuguesetimes.com/Ed_2070/util/beat.htm |first=Eurico\
      \ |last=Mendes |title=James Franco, neto de pescador madeirense apresenta os Oscars |publisher=Portuguese Times |date= |accessdate=April 21, 2014}} {{pt icon}}&lt;/ref&gt; Hanks' parents divorced in 1960. The family's three oldest children, Sandra (now\
      \ Sandra Hanks Benoiton, a writer),&lt;ref&gt;{{cite web|title=Female Nomad and Friends Interview: Sandra Hanks Benoiton|url=http://mexicoinsmallbytes.com/mexicoblog/?cat=10|accessdate=July 10, 2012}}&lt;/ref&gt; Larry (Lawrence M. Hanks, PhD, an [[entomology]]\
      \ professor at the [[University of Illinois at Urbana-Champaign]])&lt;ref&gt;[http://www.life.uiuc.edu/hanks/hanks.html Lawrence M. Hanks, Associate Professor]&amp;nbsp;– [[University of Illinois at Urbana-Champaign]].&lt;/ref&gt; and Tom, went with their\
      \ father, while the youngest, [[Jim Hanks|Jim]], now an actor and filmmaker, remained with their mother in [[Red Bluff, California]].&lt;ref name=&quot;Tom Hanks biography&quot;&gt;[http://www.biography.com/people/tom-hanks-9327661 Tom Hanks biography]&lt;/ref&gt;\n\
      \nHanks' family history was of [[Catholicism]] and [[Mormonism]], and he was a &quot;Bible-toting [[evangelical]] teenager&quot; for several years.&lt;ref name=mattingly&gt;{{cite web |url=http://www.scrippsnews.com/node/41996 |title=Mattingly: Tom Hanks\
      \ talks about religion |author=Terry Mattingly |work=Scripps Howard News Service |date=March 25, 2009 |accessdate=December 14, 2012}}&lt;/ref&gt; In school, Hanks was unpopular with students and teachers alike, later telling ''[[Rolling Stone]]'' magazine:\
      \ &quot;I was a geek, a spaz. I was horribly, painfully, terribly shy. At the same time, I was the guy who'd yell out funny captions during filmstrips. But I didn't get into trouble. I was always a real good kid and pretty responsible.&quot; In 1965, Amos\
      \ Hanks married Frances Wong, a San Francisco native of [[Chinese American|Chinese descent]]. Frances had three children, two of whom lived with Tom during his high school years. Hanks acted in school plays, including ''[[South Pacific (musical)|South\
      \ Pacific]]'', while attending [[Skyline High School (Oakland, California)|Skyline High School]] in [[Oakland, California]].&lt;ref&gt;{{cite news|url=http://www.people.com/people/article/0,,619462,00.html|title=Hanks Thanks School|publisher=People|date=April\
      \ 15, 1998|last=Silverman|first=Stephen}}&lt;/ref&gt;\n\nHanks studied theater at [[Chabot College]] in [[Hayward, California]] and, after two years, transferred to [[California State University, Sacramento]].&lt;ref name=THanksCSUS-CalState&gt;{{cite\
      \ web|url=http://www.calstate.edu/pa/clips2004/february/19feb/id.shtml|title=Show your ID: What do you call that university by the river? The new president steps into the name game|date=February 19, 2004|first=J.|last=Freedom du Lac|publisher=California\
      \ State University|accessdate=July 20, 2013}}\n* &lt;sup&gt;a&lt;/sup&gt; &quot;Famous alumni*: Actor Tom Hanks... *Includes former students who attended – but didn't graduate from – the university&quot; — ¶ 67.&lt;/ref&gt; Hanks told ''[[New York (magazine)|New\
      \ York]]'' magazine in 1986: &quot;Acting classes looked like the best place for a guy who liked to make a lot of noise and be rather flamboyant&amp;nbsp;...I spent a lot of time going to plays. I wouldn't take dates with me. I'd just drive to a theater,\
      \ buy myself a ticket, sit in the seat and read the program, and then get into the play completely. I spent a lot of time like that, seeing [[Bertolt Brecht|Brecht]], [[Tennessee Williams]], [[Henrik Ibsen|Ibsen]], and all that.&quot;&lt;ref name=Blum1986&gt;{{cite\
      \ journal |last=Blum |first=David |date=July 28, 1986 |title=Tom Hanks's Real Splash: A Funny Guy Grows Up in 'Nothing in Common' |journal=New York |publisher=New York Media |volume=19 |issue=29 |page=39 |issn=0028-7369 |url=http://books.google.com/books?id=9OYCAAAAMBAJ&amp;pg=PA39}}&lt;/ref&gt;\n\
      \nDuring his years studying theater, Hanks met [[Vincent Dowling]], head of the [[Great Lakes Theater Festival]] in [[Cleveland]], Ohio.&lt;ref name=tca/&gt; At Dowling's suggestion, Hanks became an intern at the festival. His internship stretched into\
      \ a three-year experience that covered most aspects of theater production, including lighting, set design, and stage management, prompting Hanks to drop out of college. During the same time, Hanks won the Cleveland Critics Circle Award for Best Actor for\
      \ his 1978 performance as [[Proteus (The Two Gentlemen of Verona)|Proteus]] in Shakespeare's ''[[The Two Gentlemen of Verona]]'', one of the few times he played a villain.&lt;ref&gt;{{cite news |url=http://www.clevelandmagazine.com/ME2/dirmod.asp?sid=E73ABD6180B44874871A91F6BA5C249C&amp;nm=&amp;type=Publishing&amp;mod=Publications%3A%3AArticle&amp;mid=1578600D80804596A222593669321019&amp;tier=4&amp;id=516286375F5F4B71A3896EF13FF6915D\
      \ |title=Life According to Tom Hanks |last=Mytnick |first=Colleen |work=[[Cleveland Magazine]] |date=October 2009 |accessdate=November 6, 2010}}&lt;/ref&gt;\n\n==Career==\n\n===Early acting career (1979–85)===\nIn 1979, Hanks moved to New York City, where\
      \ he made his film debut in the low-budget [[slasher film]] ''[[He Knows You're Alone]]'' (1980)&lt;ref name=HKY&gt;{{cite news|url=http://www.nytimes.com/movies/movie/21754/He-Knows-You-re-Alone/overview|title=He Knows You're Alone (1980)|work=[[The New\
      \ York Times]]|accessdate=July 10, 2014}}&lt;/ref&gt;&lt;ref name=tca/&gt; and landed a starring role in the television movie ''[[Mazes and Monsters]]''.&lt;ref&gt;{{cite news | last = Kushner | first = David | title = Dungeon Master: The Life and Legacy\
      \ of Gary Gygax | work = Wired.com | url = http://archive.wired.com/gaming/virtualworlds/news/2008/03/ff_gygax?currentPage=all | accessdate = 2008-10-16 | date=March 10, 2008}}&lt;/ref&gt; Early that year, he was cast in the lead, Callimaco, in the [[Riverside\
      \ Shakespeare Company]]'s production of [[Niccolò Machiavelli]]'s ''[[The Mandrake]]'', directed by Daniel Southern. As a high profile [[Off Off Broadway]] [[Variety show|showcase]], the production helped Tom land an agent, Joe Ohla, with the J. Michael\
      \ Bloom Agency.{{cn|date=September 2014}}\n\nThe following year, Hanks landed one of the lead roles, that of character Kip Wilson, on the [[American Broadcasting Company|ABC]] television pilot of ''[[Bosom Buddies]]''.  He and [[Peter Scolari]] played\
      \ a pair of young advertising men forced to dress as women so they could live in an inexpensive all-female hotel.&lt;ref name=tca/&gt; Hanks had previously partnered with Scolari on the 1970s game show ''[[Make Me Laugh]]''. After landing the role, Hanks\
      \ moved to Los Angeles. ''Bosom Buddies'' ran for two seasons, and, although the ratings were never strong, television critics gave the program high marks. &quot;The first day I saw him on the set,&quot; co-producer Ian Praiser told ''Rolling Stone'',\
      \ &quot;I thought, 'Too bad he won't be in television for long.' I knew he'd be a movie star in two years.&quot;  However, although Praiser knew it, he was not able to convince Hanks. &quot;The television show had come out of nowhere,&quot; Hanks' best\
      \ friend Tom Lizzio told ''Rolling Stone''. &quot;Then out of nowhere it got canceled. He figured he'd be back to pulling ropes and hanging lights in a theater.&quot;{{cn|date=September 2014}}\n\n''Bosom Buddies'' and a guest appearance on a 1982 episode\
      \ of ''[[Happy Days]]'' (&quot;A Case of Revenge,&quot; in which he played a disgruntled former classmate of [[Fonzie]]) prompted director [[Ron Howard]] to contact Hanks. Howard was working on the film ''[[Splash (film)|Splash]]'' (1984), a romantic comedy\
      \ fantasy about a [[mermaid]] who falls in love with a human.&lt;ref name=splash&gt;{{cite book|title=Sensing the Past: Hollywood Stars and Historical Visions|last=Cullen|first=Jim|publisher=[[Oxford University Press]]|page=152|date=February 28, 2013}}&lt;/ref&gt;&lt;ref&gt;{{cite\
      \ book|title=Tom and Colin Hanks|last=Isle|first=Mick|publisher=[[Rosen Publishing]]|pages=11, 39|date=October 1, 2004}}&lt;/ref&gt; At first, Howard considered Hanks for the role of the main character's wisecracking brother, a role that eventually went\
      \ to [[John Candy]]. Instead, Hanks landed the lead role and subsequent career boost from ''Splash'', which went on to become a surprise box office hit, grossing more than US$69&amp;nbsp;million.&lt;ref&gt;{{cite web|url=http://www.cbsnews.com/pictures/tom-hanks-from-big-to-brothers/|title=From\
      \ 'Big' To 'Brothers'|publisher=[[CBS News]]|accessdate=August 6, 2014}}&lt;/ref&gt; He also had a sizable hit with the sex comedy ''[[Bachelor Party (1984 film)|Bachelor Party]]'', also in 1984.&lt;ref name=&quot;Tom Hanks biography&quot;/&gt; In 1983–\
      84, Hanks made three guest appearances on ''[[Family Ties]]'' as Elyse Keaton's alcoholic brother, Ned Donnelly.&lt;ref&gt;{{Cite book |title=Television listings |url=http://books.google.com/?id=Uek4AAAAIAAJ&amp;q=Tom+Hanks+Family+Ties&amp;dq=Tom+Hanks+Family+Ties\
      \ |work=[[TV Guide (magazine)|TV Guide]] |date=November 27, 2003 |accessdate=January 20, 2009}}&lt;/ref&gt;&lt;ref&gt;{{cite book |last=Riggs |first=Thomas |title=Contemporary Theatre, Film, and Television |publisher=[[Gale Research]] |year=2002 |page=117\
      \ |isbn=0-7876-5116-8}}&lt;/ref&gt;\n\n===Period of successes and failures (1986–91)===\n[[File:TomHanks1989.png|thumb|upright|left|Hanks at the [[61st Academy Awards|Academy Awards]] after party in March 1989]]\nWith ''[[Nothing in Common]]'' (1986)&amp;nbsp;–\
      \ about a young man alienated from his parents who must reestablish a relationship with his father (played by [[Jackie Gleason]])&amp;nbsp;– Hanks began to establish the credentials as not only a comic actor but someone who could carry a serious role as\
      \ well. &quot;It changed my desires about working in movies,&quot; Hanks told ''Rolling Stone''. &quot;Part of it was the nature of the material, what we were trying to say. But besides that, it focused on people's relationships. The story was about a\
      \ guy and his father, unlike, say, ''[[The Money Pit]]'', where the story is really about a guy and his house.&quot;&lt;ref&gt;{{cite book|title=Encyclopedia of American Cinema|url=http://books.google.com/books?id=zlSRS80XIfQC&amp;pg=PT1033&amp;lpg=PT1033&amp;dq=money+pit+Part+of+it+was+the+nature+of+the+material,+what+we+were+trying+to+say.+But+besides+that,+it+focused+on+people's+relationships.+The+story+was+about+a+guy+and+his+father,+unlike,+say,+The+Money+Pit,+where+the+story+is+really+about+a+guy+and+his+house&amp;source=bl&amp;ots=iIBD7s1Rcf&amp;sig=L_9M7MEagWxsKMDunuyXcGfqehM&amp;hl=en&amp;sa=X&amp;ei=wY_7T-WRMoHr6wGZ6vGBBw&amp;ved=0CE0Q6AEwAA#v=onepage&amp;q=money%20pit%20Part%20of%20it%20was%20the%20nature%20of%20the%20material%2C%20what%20we%20were%20trying%20to%20say.%20But%20besides%20that%2C%20it%20focused%20on%20people's%20relationships.%20The%20story%20was%20about%20a%20guy%20and%20his%20father%2C%20unlike%2C%20say%2C%20The%20Money%20Pit%2C%20where%20the%20story%20is%20really%20about%20a%20guy%20and%20his%20house&amp;f=false}}&lt;/ref&gt;\n\
      \nAfter a few more flops and a moderate success with ''[[Dragnet (1987 film)|Dragnet]]'', Hanks' career began to take off after the success of the fantasy comedy ''[[Big (film)|Big]]'' (1988), both at the box office and within the industry,&lt;ref name=break&gt;{{cite\
      \ web|url=http://news.bbc.co.uk/1/hi/entertainment/3983091.stm|title=Hanks' big splash in Hollywood |publisher=[[BBC News]]|date=November 5, 2004|accessdate=July 31, 2014}}&lt;/ref&gt;&lt;ref name=tca/&gt; establishing Hanks as a major Hollywood talent.&lt;ref&gt;{{cite\
      \ web|url=http://www.biography.com/people/tom-hanks-9327661#big-break|title=Tom Hanks Biography|publisher=[[Fyi (TV network)|The Biography Channel]]|accessdate=August 6, 2014}}&lt;/ref&gt; For his performance in the film, Hanks earned his first nominations\
      \ for the Academy Award for Best Actor.&lt;ref name=Bignom&gt;{{cite web|url=http://www.oscars.org/awards/academyawards/legacy/ceremony/61st-winners.html|title=The 61st Academy Awards (1989) Nominees and Winners|publisher=[[Academy of Motion Picture Arts\
      \ and Sciences]]|accessdate=July 10, 2014}}&lt;/ref&gt;  ''Big'' was followed later that year by ''[[Punchline (film)|Punchline]]'', in which he and [[Sally Field]] co-starred as struggling comedians. Hanks' character, Steven Gold, a failing medical student\
      \ trying to break into stand-up comedy, was somewhat edgy and complex. His portrayal of Gold offered a glimpse of the far more dramatic roles Hanks would master in films to come.{{cn|date=September 2014}}\n\nHanks then suffered a run of box-office under-performers:\
      \ ''[[The 'Burbs]]'' (1989), ''[[Joe Versus the Volcano]]'' (1990), and ''[[The Bonfire of the Vanities (film)|The Bonfire of the Vanities]]'' (1990).&lt;ref name=tca/&gt;  In the latter, he portrayed a greedy [[Wall Street]] figure who gets enmeshed in\
      \ a hit-and-run accident. Only the 1989 movie ''[[Turner &amp; Hooch]]'' brought success for Hanks during this period. In a 1993 issue of ''[[Disney Adventures]]'', Hanks said, &quot;I saw ''Turner &amp; Hooch'' the other day in the SAC store and couldn't\
      \ help but be reminiscent. I cried like a baby.&quot; He did admit to making a couple of &quot;bum tickers,&quot; however, and blamed his &quot;...deductive reasoning and decision making skills.&quot;{{cn|date=September 2014}}\n\n===Progression into dramatic\
      \ roles (1992–95)===\n[[File:TomHanksForrestGump94.jpg|thumb|upright|alt=A man is at the center of the image smiling into the camera. He is sitting on a blue crate and has his hands resting on his legs.|Hanks on the film set of ''[[Forrest Gump]]'' (1994)]]\n\
      Hanks climbed back to the top again with his portrayal of a washed-up baseball legend turned manager in ''[[A League of Their Own]]'' (1992).&lt;ref name=tca/&gt; Hanks has admitted that his acting in earlier roles was not great, but that he has improved.\
      \ In an interview with ''[[Vanity Fair (magazine)|Vanity Fair]]'', Hanks noted his ''&quot;modern era of moviemaking ... because enough self-discovery has gone on ... My work has become less pretentiously fake and over the top&quot;''. This &quot;modern\
      \ era&quot; began in 1993 for Hanks, first with ''[[Sleepless in Seattle]]'' and then with ''[[Philadelphia (film)|Philadelphia]]''. The former was a blockbuster success about a widower who finds true love over the radio airwaves.&lt;ref&gt;{{cite news|url=http://www.huffingtonpost.com/2013/06/25/sleepless-in-seattle-anniversary_n_3496495.html|title='Sleepless\
      \ In Seattle' Anniversary: Tom Hanks &amp; Meg Ryan Classic Turns 20|work=[[The Huffington Post]]|date=June 25, 2013|accessdate=July 10, 2014}}&lt;/ref&gt; [[Richard Schickel]] of ''TIME'' called his performance &quot;charming,&quot; and most critics agreed\
      \ that Hanks' portrayal ensured him a place among the premier romantic-comedy stars of his generation.&lt;ref&gt;{{cite news|last=SCHICKEL|first=RICHARD|title=Modern Romance|url=http://www.time.com/time/magazine/article/0,9171,978809,00.html|work=Time\
      \ magazine|date=July 5, 1993|accessdate=July 9, 2012}}&lt;/ref&gt;\n\nIn ''Philadelphia'', he played a [[homosexuality|gay]] lawyer with AIDS who sues his firm for discrimination.&lt;ref name=tca/&gt; Hanks lost 35 pounds and thinned his hair in order\
      \ to appear sickly for the role. In a review for ''[[People (American magazine)|People]]'', Leah Rozen stated, &quot;Above all, credit for ''Philadelphia''{{'}}s success belongs to Hanks, who makes sure that he plays a character, not a saint. He is flat-out\
      \ terrific, giving a deeply felt, carefully nuanced performance that deserves an Oscar.&quot; Hanks won the 1993 [[Academy Award]] for Best Actor for his role in ''Philadelphia''.&lt;ref name=tca/&gt;&lt;ref name=Philwin&gt;{{cite web|url=http://www.oscars.org/awards/academyawards/oscarlegacy/1990-1999/66nominees.html|title=Nominees\
      \ &amp; Winners for the 66th Academy Awards|publisher=[[Academy of Motion Picture Arts and Sciences]]|accessdate=July 10, 2014}}&lt;/ref&gt; During his acceptance speech, he revealed that his high school drama teacher Rawley Farnsworth and former classmate\
      \ John Gilkerson, two people with whom he was close, were gay.&lt;ref&gt;[http://film.guardian.co.uk/oscars2000/story/0,,147619,00.html Winner Speeches].&lt;/ref&gt;\n\nHanks followed ''Philadelphia'' with the 1994 hit ''[[Forrest Gump]]'' which grossed\
      \ a worldwide total of over $600 million at the box office.&lt;ref name=Forbox&gt;{{cite web|url=http://www.boxofficemojo.com/movies/?id=forrestgump.htm|title=Forrest Gump|publisher=[[Box Office Mojo]]|accessdate=July 10, 2014}}&lt;/ref&gt; Hanks remarked:\
      \ &quot;When I read the script for ''Gump'', I saw it as one of those kind of grand, hopeful movies that the audience can go to and feel ... some hope for their lot and their position in life ... I got that from the movies a hundred million times when\
      \ I was a kid. I still do.&quot; Hanks won his second Best Actor Academy Award for his role in ''Forrest Gump'', becoming only the second actor to have accomplished the feat of winning consecutive Best Actor Oscars.&lt;ref name=&quot;67AcAwardsWins&quot;&gt;{{cite\
      \ news|last=Grimes|first=William|title='Forrest Gump' Triumphs With 6 Academy Awards|url=http://www.nytimes.com/1995/03/28/movies/forrest-gump-triumphs-with-6-academy-awards.html|work=The New York Times|date=March 28, 1995|accessdate=October 20, 2010|archiveurl=http://www.webcitation.org/5tdd3ad9J|archivedate=July\
      \ 9, 2012}}&lt;/ref&gt; ([[Spencer Tracy]] was the first, winning in 1937–38. Hanks and Tracy were the same age at the time they received their Academy Awards: 37 for the first and 38 for the second.)&lt;ref&gt;{{cite web|last=Teachout|first=Terry|title=The\
      \ Eclipse of Spencer Tracy|url=http://www.commentarymagazine.com/article/the-eclipse-of-spencer-tracy/|work=commentarymagazine.com}}&lt;/ref&gt;&lt;ref&gt;{{cite web|url=http://www.oscars.org/awards/academyawards/legacy/ceremony/67th.html|title=The 67th\
      \ Academy Awards|publisher=[[Academy of Motion Picture Arts and Sciences]]|accessdate=July 31, 2014}}&lt;/ref&gt;\n\nHanks' next role—astronaut and commander [[Jim Lovell]], in the 1995 film ''[[Apollo 13 (film)|Apollo 13]]''—reunited him with Ron Howard.&lt;ref\
      \ name=tca/&gt; Critics generally applauded the film and the performances of the entire cast, which included actors [[Kevin Bacon]], [[Bill Paxton]], [[Gary Sinise]], [[Ed Harris]], and [[Kathleen Quinlan]]. The movie also earned nine Academy Award nominations,\
      \ winning two. Later that year, Hanks starred in the [[Walt Disney Pictures|Disney]]•[[Pixar]] film ''[[Toy Story]]'', as the voice of [[Sheriff Woody]].{{cn|date=September 2014}}\n\n===Continued success (1996–99)===\n[[File:Tom Hanks - footprint.JPG|thumb|right|Hanks'\
      \ cement prints in front of the [[TCL Chinese Theatre|Grauman's Chinese Theatre]] in Hollywood]]\nHanks made his directing debut with his 1996 film ''[[That Thing You Do!]]'' about a 1960s pop group, also playing the role of a music producer.&lt;ref&gt;{{cite\
      \ news|url=http://www.nytimes.com/movies/movie/136774/That-Thing-You-Do-/details|title=That Thing You Do! (1996)|work=[[The New York Times]]|accessdate=July 31, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite news|url=http://www.nytimes.com/movie/review?res=9804E7DA153FF937A35753C1A960958260|title=\
      \ Movie Reviews - That Thing You Do!|work=[[The New York Times]]|accessdate=August 4, 2014}}&lt;/ref&gt; Hanks and producer [[Gary Goetzman]] went on to create [[Playtone]], a record and film production company named after the record company in the film.&lt;ref&gt;{{cite\
      \ news|url=http://online.wsj.com/article/PR-CO-20131015-906556.html|title=Audible and Playtone Launch Creative Partnership |work=[[The Wall Street Journal]]|date=October 15, 2013|accessdate=July 31, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite web|title=That Thing\
      \ You Do! (1996)|url=http://www.rottentomatoes.com/m/that_thing_you_do/|work=rottentomatoes}}&lt;/ref&gt;\n\nHanks executive produced, co-wrote, and co-directed the [[HBO]] docudrama ''[[From the Earth to the Moon (TV miniseries)|From the Earth to the\
      \ Moon]]''. The 12-part series chronicled the space program from its inception, through the familiar flights of [[Neil Armstrong]] and [[Jim Lovell]], to the personal feelings surrounding the reality of moon landings. The [[Emmy Award]]-winning project\
      \ was, at US$68&amp;nbsp;million, one of the most expensive ventures undertaken for television.&lt;ref&gt;{{cite web|url=http://www.emmys.com/shows/earth-moon|title=From The Earth To The Moon|publisher=[[Academy of Television Arts &amp; Sciences]]|accessdate=August\
      \ 4, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite web|title=From the Earth to the Moon|url=http://www.tv.com/shows/from-the-earth-to-the-moon/|work=tv.com|accessdate= July 9, 2012}}&lt;/ref&gt;\n\nHanks' next project was no less expensive. For ''[[Saving Private\
      \ Ryan]]'', he teamed up with [[Steven Spielberg]] to make a film about a search through war-torn France after [[D-Day]] to bring back a soldier.&lt;ref&gt;{{citeweb|url = http://www.empireonline.com/features/saving-private-ryan-classic-feature|title=\
      \ Making of Saving Private Ryan|date=October 1998|work=Empire Magazine|accessdate=10 June 2014}}&lt;/ref&gt;\t It earned the praise and respect of the film community, critics, and the general public.&lt;ref&gt;{{cite web|title=Saving Private Ryan (1998)|url=http://www.rottentomatoes.com/m/saving_private_ryan/|work=rottentomatoes|accessdate=July\
      \ 10, 2012}}&lt;/ref&gt; It was labeled one of the finest war films ever made and earned Spielberg his second Academy Award for direction, and Hanks another Best Actor nomination.&lt;ref name=SPRnom&gt;{{cite web|url=http://www.oscars.org/awards/academyawards/oscarlegacy/1990-1999/71nominees.html|title=Nominees\
      \ &amp; Winners for the 71st Academy Awards|publisher=Academy of Motion Picture Arts and Sciences|accessdate=July 10, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite web|accessdate=September 5, 2008|url=http://us.imdb.com/Sections/Awards/Academy_Awards_USA/1999|title=Academy\
      \ Awards, USA: 1999 |publisher=IMDB }}&lt;/ref&gt; Later in 1998, Hanks re-teamed with his ''Sleepless in Seattle'' co-star [[Meg Ryan]] for ''[[You've Got Mail]]'', a remake of 1940's ''[[The Shop Around the Corner]]''.&lt;ref name=&quot;Tom Hanks biography&quot;/&gt;\
      \ In 1999, Hanks starred in an adaptation of the [[Stephen King]] novel ''[[The Green Mile (film)|The Green Mile]]''.&lt;ref&gt;{{rotten-tomatoes | id=green_mile | title=The Green Mile }}&lt;/ref&gt; He also returned as the voice of Woody in ''[[Toy Story\
      \ 2]]'', the sequel to ''Toy Story''. The following year, he won a [[Golden Globe]] for Best Actor and an Academy Award nomination for his portrayal of a marooned [[FedEx]] systems analyst in [[Robert Zemeckis]]'s ''[[Cast Away]]''.&lt;ref&gt;{{cite web|url=http://www.goldenglobes.com/tom-hanks|title=Tom\
      \ Hanks|publisher=[[Golden Globe Awards]]|accessdate=August 6, 2014}}&lt;/ref&gt;&lt;ref name=&quot;Oscars2001&quot;&gt;{{cite web|url=http://www.oscars.org/awards/academyawards/legacy/ceremony/73rd-winners.html |title=The 73rd Academy Awards (2001) Nominees\
      \ and Winners |accessdate=July 10, 2012|work=oscars.org}}&lt;/ref&gt;\n\n===International recognition (2000–09)===\nIn 2001, Hanks helped direct and produce the Emmy-Award winning HBO miniseries ''[[Band of Brothers (TV miniseries)|Band of Brothers]]''.&lt;ref&gt;{{cite\
      \ web|url=http://www.emmys.com/shows/band-brothers|title=Band of Brothers|publisher=[[Academy of Television Arts &amp; Sciences]]|accessdate=August 4, 2014}}&lt;/ref&gt; He also appeared in the September 11 television special ''[[America: A Tribute to\
      \ Heroes]]'' and the documentary ''Rescued From the Closet''.&lt;ref&gt;{{cite web|title=America: A Tribute to Heroes|url=http://www.cbs.com/specials/heroes/|work=cbs.com|accessdate=July 10, 2012}}&lt;/ref&gt; He then teamed up with ''[[American Beauty\
      \ (1999 film)|American Beauty]]'' director [[Sam Mendes]] for the adaptation of [[Max Allan Collins]]'s and [[Richard Piers Rayner]]'s graphic novel ''[[Road to Perdition]]'', in which he played an [[anti-hero]] role as a [[hitman]] on the run with his\
      \ son. That same year, Hanks collaborated once again with director Spielberg, starring opposite [[Leonardo DiCaprio]] in the hit crime comedy ''[[Catch Me If You Can]]'', based on the true story of [[Frank Abagnale, Jr.]] The same year, Hanks and his wife\
      \ [[Rita Wilson]] produced the hit movie ''[[My Big Fat Greek Wedding]]''.&lt;ref&gt;{{cite news|url=http://www.theguardian.com/film/2014/may/28/my-big-fat-greek-wedding-sequel-nia-vardalos|title=Nia Vardalos confirms 'bigger, fatter' Greek Wedding sequel\
      \ to hit big screen|work=[[The Guardian]]|date=May 28, 2014|accessdate=August 4, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite news|url=http://www.huffingtonpost.com/2014/05/28/my-big-fat-greek-wedding-sequel_n_5403134.html|title='My Big Fat Greek Wedding' Sequel\
      \ In The Works From Nia Vardalos|work=[[The Huffington Post]]|date=May 28, 2014|accessdate=August 4, 2014}}&lt;/ref&gt; In August 2007, he along with co-producers Rita Wilson and [[Gary Goetzman]], and writer and star [[Nia Vardalos]], initiated a legal\
      \ action against the production company Gold Circle Films for their share of profits from the movie.&lt;ref&gt;[http://www.newsdaily.com/index.php?feed=Entertainment&amp;article=UPI-1-20070808-11481500-bc-us-hanks.xml &quot;Hanks files big fat 'Greek'\
      \ lawsuit&quot;]{{dead link|date=March 2011}}&amp;nbsp;– [[United Press International]]&amp;nbsp;– (c/o NewsDaily.com)&amp;nbsp;– August 8, 2007.&lt;/ref&gt;&lt;ref&gt;{{cite web|url=http://www.newsdaily.com/index.php?feed=Entertainment&amp;article=UPI-1-20070808-11481500-bc-us-hanks.xml|archiveurl=http://web.archive.org/web/20080208234100/http://www.newsdaily.com/index.php?feed=Entertainment&amp;article=UPI-1-20070808-11481500-bc-us-hanks.xml|archivedate=2008-02-08|work=\
      \ Archive of UPS article at Archive.org|title=Tom Hanks|accessdate=October 21, 2011}}&lt;/ref&gt;&lt;ref&gt;[http://www.irishexaminer.com/breaking/entertainment/mhcwcweyqlgb/ &quot;Hanks sues over unpaid 'My big fat Greek wedding' profits&quot;], ''[[Irish\
      \ Examiner]]'', August 8, 2007.&lt;/ref&gt; At the age of 45, Hanks became the youngest ever recipient of the [[American Film Institute]]'s Life Achievement Award on June 12, 2002.&lt;ref&gt;{{cite news|url=http://articles.latimes.com/2002/jun/14/entertainment/et-king14|title=AFI\
      \ Salutes a Humble Tom Hanks With Life Achievement Award|work=[[Los Angeles Times]]|date=June 14, 2002|accessdate=July 31, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite web|last=Levy|first=Rochelle L.|title=THE ACHIEVEMENT OF TOM HANKS|url=http://www.afi.com/laa/laa02.aspx|work=afi.com|accessdate=July\
      \ 10, 2012}}&lt;/ref&gt;\n\nIn 2004, he appeared in three films: The [[Coen brothers]]' ''[[The Ladykillers (2004 film)|The Ladykillers]]'', another Spielberg film, ''[[The Terminal]]'', and ''[[The Polar Express (film)|The Polar Express]]'', a family\
      \ film from Robert Zemeckis. In a ''[[USA Weekend]]'' interview, Hanks discussed how he chooses projects: &quot;[Since] ''A League of Their Own'', it can't be just another movie for me. It has to get me going somehow ... There has to be some all-encompassing\
      \ desire or feeling about wanting to do that particular movie. I'd like to assume that I'm willing to go down any avenue in order to do it right&quot;.  In August 2005, Hanks was voted in as vice president of the [[Academy of Motion Picture Arts and Sciences]].&lt;ref\
      \ name=&quot;BBC-2005-08-25&quot;&gt;[http://news.bbc.co.uk/1/hi/entertainment/film/4184066.stm &quot;Actor Hanks voted in by Academy&quot;], [[BBC]], August 25, 2005.&lt;/ref&gt;\n\nHanks next starred in the highly anticipated film ''[[The Da Vinci Code\
      \ (film)|The Da Vinci Code]]'', based on the best-selling novel by [[Dan Brown]]. The film was released May 19, 2006, in the US and grossed over US$750&amp;nbsp;million worldwide.&lt;ref name=DVCbox&gt;{{cite web|url=http://www.boxofficemojo.com/movies/?id=davincicode.htm|title=The\
      \ Da Vinci Code|publisher=[[Box Office Mojo]]|accessdate=July 10, 2014}}&lt;/ref&gt; He followed the film with [[Ken Burns]]'s 2007 documentary ''[[The War (documentary)|The War]]''. For the documentary, Hanks did voice work, reading excerpts from [[World\
      \ War II]]-era columns by [[Al McIntosh]]. In 2006, Hanks topped a 1,500-strong list of &quot;most trusted celebrities&quot; compiled by ''[[Forbes]]'' magazine.&lt;ref name=&quot;BBC-2006-09-27&quot;&gt;[http://news.bbc.co.uk/1/hi/entertainment/5384320.stm\
      \ &quot;Hanks tops 'most trusted' index&quot;], BBC, September 27, 2006.&lt;/ref&gt;\n[[File:Tom Hanks 2008a.jpg|thumb|left|upright|Hanks at Post-Emmys Party, September 2008]]\n\nHanks next appeared in a cameo role as himself in ''[[The Simpsons Movie]]'',\
      \ in which he appeared in an advertisement claiming that the U.S. government has lost its credibility and is hence buying some of his. He also made an appearance in the credits, expressing a desire to be left alone when he is out in public. Later in 2006,\
      \ Hanks produced the British film ''[[Starter for 10 (film)|Starter for Ten]]'', a comedy based on working class students attempting to win the ''University Challenge''.&lt;ref name=&quot;BBC-2006-11-09&quot;&gt;[http://www.bbc.co.uk/dna/filmnetwork/A17127155\
      \ &quot;A real Movie challenge&quot;.] BBC. November 9, 2006.&lt;/ref&gt;\n\nIn 2007, Hanks starred in [[Mike Nichols]]'s film ''[[Charlie Wilson's War]]'' (written by screenwriter [[Aaron Sorkin]]) in which he played [[Democratic Party (United States)|Democratic]]\
      \ Texas Congressman [[Charles Wilson (Texas politician)|Charles Wilson]].&lt;ref&gt;{{cite web|last=Roddy|first=Melissa|title=Tom Hanks Tells Hollywood Whopper in 'Charlie Wilson's War'|url=http://www.alternet.org/story/71286/|work=Alternet|date=December\
      \ 21, 2007|accessdate=July 10, 2012}}&lt;/ref&gt; The film opened on December 21, 2007, and Hanks received a [[Golden Globe]] nomination.&lt;ref name=65gg&gt;{{cite web|url=http://www.goldenglobes.org/news/id/81 |title=Hollywood Foreign Press Association\
      \ 2008 Golden Globe Awards for the Year Ended December 31, 2007 |accessdate= July 10, 2012 |date= December 13, 2007 |publisher=goldenglobes.org |archiveurl = http://web.archive.org/web/20071215072618/http://www.goldenglobes.org/news/id/81 &lt;!-- Bot retrieved\
      \ archive --&gt; |archivedate = July 10, 2012}}&lt;/ref&gt; In the comedy-drama film ''[[The Great Buck Howard]]'' (2008), Hanks played the on-screen father of a young man (played by Hanks' real-life son, [[Colin Hanks|Colin]]) who chooses to follow in\
      \ the footsteps of a fading magician ([[John Malkovich]]). His character was less than thrilled about his son's career decision.&lt;ref&gt;{{cite web|title=The Great Buck Howard|url=http://www.magpictures.com/profile.aspx?id=2b7aa78c-5fb3-4c62-b7f6-1a733c3f632d|work=magpictures.com}}&lt;/ref&gt;\
      \ In the same year, he executive produced hit [[musical comedy]], ''[[Mamma Mia (film)|Mamma Mia]]'' and Emmy Award-winning mini-series, ''[[John Adams (miniseries)|John Adams]]''.&lt;ref&gt;{{cite news|url=http://www.telegraph.co.uk/finance/newsbysector/mediatechnologyandtelecoms/3794360/Mamma-Mia-becomes-biggest-ever-hit-at-British-box-office.html|title=Mamma\
      \ Mia! becomes biggest-ever hit at British box office|work=[[The Daily Telegraph]]|date=December 16, 2008|accessdate=July 31, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite web|url=http://www.emmys.com/shows/john-adams|title=John Adams|publisher=[[Academy of Television\
      \ Arts &amp; Sciences]]|accessdate=August 4, 2014}}&lt;/ref&gt;\n\nHanks' next endeavor, released on May 15, 2009, was a film adaptation of ''[[Angels &amp; Demons (film)|Angels &amp; Demons]]'', based on the [[Angels &amp; Demons|novel of the same name]]\
      \ by Dan Brown. Its April 11, 2007, announcement revealed that Hanks would reprise his role as Robert Langdon, and that he would reportedly receive the highest salary ever for an actor.&lt;ref&gt;Tyler, Joshua. [http://www.cinemablend.com/new/Exclusive-Tom-Hanks-Confirmed-For-Da-Vinci-Code-Sequel-4885.html\
      \ &quot;Tom Hanks Confirmed For Da Vinci Code Sequel&quot;], Cinema Blend, April 10, 2007.&lt;/ref&gt;&lt;ref&gt;Fleming, Michael. [http://www.variety.com/VR1117974685.html &quot;Howard moves fast with 'Code' sequel&quot;], ''[[Variety (magazine)|Variety]]'',\
      \ October 24, 2007.&lt;/ref&gt; The following day he made his 10th appearance on [[NBC]]'s ''[[Saturday Night Live]]'', impersonating himself for the ''[[Celebrity Jeopardy! (Saturday Night Live)|Celebrity Jeopardy]]'' sketch. Hanks produced the [[Spike\
      \ Jonze]] film ''[[Where The Wild Things Are (film)|Where The Wild Things Are]]'', based on the children's book by [[Maurice Sendak]] in 2009.&lt;ref&gt;[http://www.boxofficemojo.com/movies/?id=wherethewildthingsare.htm &quot;Where the Wild Things Are&quot;.]\
      \ Box Office Mojo. Accessed October 19, 2009.&lt;/ref&gt;\n\n===Recent projects (2010–present)===\nIn 2010, Hanks reprised his voice role of Woody in ''[[Toy Story 3]]'', after he, [[Tim Allen]], and [[John Ratzenberger]] were invited to a movie theater\
      \ to see a complete story reel of the movie.&lt;ref&gt;[http://www.firstshowing.net/2009/04/23/tom-hanks-on-toy-story-3-and-what-they-showed-him-first/ Tom Hanks on Toy Story 3] from [http://www.firstshowing.net/ firstshowing.net].&lt;/ref&gt; The film\
      \ went on to become the first animated film to gross a worldwide total of over $1 billion as well as the [[List of highest-grossing animated films|highest grossing animated film of all time]].&lt;ref&gt;{{cite web|url=http://www.boxofficemojo.com/news/?id=2904&amp;p=.htm|title='Toy\
      \ Story 3' Reaches $1 Billion|publisher=[[Box Office Mojo]]|date=August 29, 2010|accessdate=August 6, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite news|url=http://www.telegraph.co.uk/culture/film/film-news/7945746/Toy-Story-3-highest-grossing-animated-film.html|title=Toy\
      \ Story 3 highest-grossing animated film |work=[[The Daily Telegraph]]|date=August 14, 2010|accessdate=August 6, 2014}}&lt;/ref&gt; This record held until the 2013 Disney film, ''[[Frozen (2013 film)|Frozen]]'', surpassed it.&lt;ref name=Fro&gt;{{cite\
      \ web|url=http://www.bbc.co.uk/news/entertainment-arts-26815584|title=Frozen becomes the biggest animation in box office history|publisher=[[BBC News]]|date=March 31, 2014}}&lt;/ref&gt; He also executively produced the Emmy Award-winning mini-series, ''[[The\
      \ Pacific (TV miniseries)|The Pacific]]''.&lt;ref&gt;{{cite web|url=http://www.emmys.com/shows/pacific|title=The Pacific|publisher=[[Academy of Television Arts &amp; Sciences]]|accessdate=August 4, 2014}}&lt;/ref&gt;\n\nIn 2011, he directed and starred\
      \ opposite [[Julia Roberts]] in the title role in the romantic comedy ''[[Larry Crowne]]''.&lt;ref&gt;{{cite news|url=http://articles.chicagotribune.com/2011-06-26/entertainment/ct-ent-0627-luis-tom-hanks-20110626_1_golden-globes-host-box-office-charlie-wilson-s-war|title=The\
      \ first rule is no punching Tom Hanks|work=[[Chicago Tribune]]|date=June 26, 2011|accessdate=August 4, 2014}}&lt;/ref&gt; The movie received poor reviews, with only 35% of the 175 [[Rotten Tomatoes]] reviews giving it high ratings.&lt;ref&gt;{{cite web|url=http://www.rottentomatoes.com/m/larry_crowne/|title=Larry\
      \ Crowne (2011)|accessdate=July 23, 2011|publisher=[[Rotten Tomatoes]]}}&lt;/ref&gt; Also in 2011, he starred in the drama film ''[[Extremely Loud and Incredibly Close (film)|Extremely Loud and Incredibly Close]]''.&lt;ref&gt;{{cite news|last=Dargis|first=Manhola|title=Extremely\
      \ Loud &amp; Incredibly Close (2011)|url=http://movies.nytimes.com/2011/12/23/movies/extremely-loud-incredibly-close-with-tom-hanks-review.html|work=new york times|date=December 22, 2011|accessdate=July 10, 2012}}&lt;/ref&gt; In 2012, he voiced the character\
      \ Cleveland Carr for a [[web series]] he created entitled ''[[Electric City (web series)|Electric City]]''.&lt;ref&gt;{{cite web |url=http://entertainment.time.com/2012/07/17/for-web-only-viewing-tom-hanks-created-series-debuts-today/ |title=Online Blockbuster?:\
      \ Tom Hanks' Electric City Debuts on Yahoo Today |accessdate=July 17, 2012}}&lt;/ref&gt; He also starred in [[the Wachowskis]]-directed film adaptation of [[Cloud Atlas (novel)|the novel of the same name]], ''[[Cloud Atlas (film)|Cloud Atlas]]'' and executive\
      \ produced Emmy Award-winning mini-series, ''[[Game Change (film)|Game Change]]''.&lt;ref&gt;{{cite web|url=http://www.emmys.com/shows/game-change|title=Game Change|publisher=[[Academy of Television Arts &amp; Sciences]]|accessdate=August 4, 2014}}&lt;/ref&gt;\n\
      \nIn 2013, Hanks starred with [[Barkhad Abdi]] in the film ''[[Captain Phillips (film)|Captain Phillips]]'', based on the [[Maersk Alabama hijacking]] as [[Captain Richard Phillips]] which earned him a nomination for the [[BAFTA Award for Best Actor in\
      \ a Leading Role]].&lt;ref name=BAFTAnom&gt;{{cite web|url=http://www.bbc.co.uk/news/entertainment-arts-25648930|title=Bafta Film Awards 2014: Full list of nominees|publisher=[[BBC News]]|date=January 8, 2014|accessdate=January 8, 2014}}&lt;/ref&gt;&lt;ref&gt;{{cite\
      \ news|url=http://www.hollywoodreporter.com/news/tom-hanks-play-capt-richard-167846|title=Tom Hanks to Play Capt. Richard Phillips in Somali Pirate Hostage Story|publisher=Hollywood Reporter|date= March 15, 2011 |accessdate=April 13, 2012|first=Borys|last=Kit}}&lt;/ref&gt;\
      \ He also played [[Walt Disney]] in the film ''[[Saving Mr. Banks]]'', costarring [[Emma Thompson]] and [[Colin Farrell]], and directed by [[John Lee Hancock]]. Hanks is the first actor to portray Disney in a film.&lt;ref&gt;{{cite news|url=http://www.guardian.co.uk/film/2012/apr/11/tom-hanks-walt-disney-mary-poppins|title=Tom\
      \ Hanks to play Walt Disney in Saving Mr Banks|accessdate=April 13, 2012|publisher=The Guardian|first=Ben|last=Child|date=April 11, 2012}}&lt;/ref&gt; In 2013, Hanks also made his Broadway debut, starring in [[Nora Ephron]]'s ''[[Lucky Guy (play)|Lucky\
      \ Guy]]'', for which he was nominated for the [[Tony Award for Best Actor in a Play]].{{cn|date=September 2014}}\n\nIn 2014, Hanks' short story [http://www.newyorker.com/magazine/2014/10/27/alan-bean-plus-four &quot;Alan Bean Plus Four&quot;] was published\
      \ in the October 27 issue of ''[[The New Yorker]]''. Revolving around four friends who make a voyage to the moon, the short story is titled after the [[Apollo 12]] astronaut [[Alan Bean]]. ''[[Slate (magazine)|Slate]]'' magazine's Katy Waldman found Hanks'\
      \ first published short story &quot;mediocre&quot;, writing that &quot;Hanks’ shopworn ideas about technology might have yet sung if they hadn’t been wrapped in too-clever lit mag-ese&quot;.&lt;ref&gt;{{cite web|last1=Waldman|first1=Katy|title=Tom Hanks\
      \ Has a Short Story in The New Yorker. It’s Not Very Good.|url=http://www.slate.com/blogs/browbeat/2014/10/20/tom_hanks_new_yorker_story_alan_bean_plus_four_is_not_very_good.html|website=Slate|publisher=The Slate Group|accessdate=21 October 2014}}&lt;/ref&gt;\
      \ In an interview with ''The New Yorker'', Hanks said he has always been fascinated by space. He told the magazine that he built plastic models of rockets when he was a child and watched live broadcasts of space missions back in the 1960s.&lt;ref&gt;{{cite\
      \ web|title=Tom Hanks publishes short story in The New Yorker and gets panned|url=http://www.straitstimes.com/lifestyle/movies/story/tom-hanks-publishes-short-story-the-new-yorker-and-gets-panned-20141021|website=The Straits Times|publisher=Singapore Press\
      \ Holdings|accessdate=21 October 2014}}&lt;/ref&gt;\n\n==Personal life==\n[[File:Tom Hanks and wife Rita Wilson 836.jpg|thumb|upright|left|Hanks and his wife, [[Rita Wilson]], at the 1989 Oscars]]\nHanks was married to American actress Samantha Lewes&lt;ref&gt;{{cite\
      \ news |url=http://www.guardian.co.uk/film/2001/jan/12/culture.awardsandprizes |title=Desert island risks |work=The Guardian |location=UK |first= Danny |last= Leigh |date=January 12, 2001 |accessdate=October 9, 2010}}&lt;/ref&gt; from 1978 until they divorced\
      \ in 1987. The couple had two children, son [[Colin Hanks]] (born 1977), also an actor, and daughter Elizabeth Ann Hanks (born 1982).&lt;ref&gt;{{cite web|url=http://www.usmagazine.com/fe_dev.php/celebrities/tom-hanks|title=tom hanks|work=US magazine}}&lt;/ref&gt;&lt;ref&gt;[http://www.eonline.com/celebrities/profile/index.jsp?uuid=4ddc31be-a18f-4c2e-b0bf-54a91910c86d\
      \ Tom Hanks], [[E!|E! Entertainment Television]].{{Dead link|date=April 2013}}&lt;/ref&gt;\n\nIn 1988, Hanks married actress Rita Wilson. The two first met on the set of Hanks' television show ''[[Bosom Buddies]]'', then later developed a romantic interest\
      \ while working on the film ''[[Volunteers (film)|Volunteers]]''. They have two sons: Chester, or &quot;Chet&quot; Marlon (born 1990), who has a small part as a student in ''[[Indiana Jones and the Kingdom of the Crystal Skull]]'' and released a rap single\
      \ in 2011,&lt;ref&gt;{{cite news |url=http://dailynorthwestern.com/2011/01/12/archive-manual/frat-star-to-rap-star-chet-hanks/ |title=Frat star to rap star: Chet Hanks |newspaper= The Northwestern Daily |first= Jennifer |last= Suh |date=January 13, 2011\
      \ |accessdate=June 25, 2011}}&lt;/ref&gt; and Truman Theodore (born 1995).{{cn|date=September 2014}}\n\nOn October 7, 2013, on ''[[The Late Show with David Letterman]]'', Hanks announced that he has [[Diabetes mellitus type 2|Type 2 diabetes]].&lt;ref&gt;{{cite\
      \ web| title= Tom Hanks reveals diabetes diagnosis: Did fluctuating weight play a role? |date= October 8, 2013 |publisher= CBS News| url= http://www.cbsnews.com/8301-505270_162-57606462/tom-hanks-reveals-diabetes-diagnosis-did-fluctuating-weight-play-a-role/|accessdate=October\
      \ 9, 2013| quote= Academy Award winning actor, Tom Hanks announced on Monday that he is living with Type 2 diabetes on CBS' ''The Late Show with David Letterman''.}}&lt;/ref&gt;\n\nHanks is a convert to the [[Greek Orthodox Church]].&lt;ref&gt;{{cite news|last=Fairchild\
      \ |first=Mary|url=http://christianity.about.com/od/easternorthodoxy/p/orthodoxprofile.htm|title=Eastern Orthodox Church Denomination |work=About.com |accessdate=February 26, 2014}}&lt;/ref&gt; Hanks said, &quot;I must say that when I go to church—and I\
      \ do go to church—I ponder the mystery. I meditate on the 'why?' of 'why people are as they are' and 'why bad things happen to good people,' and 'why good things happen to bad people'... The mystery is what I think it is, almost, the grand unifying theory\
      \ of mankind.&quot;&lt;ref name=mattingly /&gt; Hanks is an avid collector of manual [[typewriter]]s, writing an article about them in ''[[The New York Times]]'' in August 2013.&lt;ref&gt;{{cite news|last=Hanks|first=Tom|url=http://www.nytimes.com/2013/08/04/opinion/sunday/i-am-tom-i-like-to-type-hear-that.html?_r=0|title=I\
      \ Am TOM. I Like to TYPE. Hear That?|accessdate=March 27, 2014}}&lt;/ref&gt;\n\n==Politics==\nHanks has made donations to many Democratic politicians and has been open about his support for [[same-sex marriage]], environmental causes, and [[alternative\
      \ fuel]]s. Hanks made public his presidential candidate choice in the 2008 election, uploading a video to his [[MySpace]] account in which he announced his endorsement of [[Barack Obama]].&lt;ref&gt;[http://vids.myspace.com/index.cfm?fuseaction=vids.individual&amp;videoid=33546997\
      \ Beware: Celebrity Endorsement par Tom Hanks] from Vidéos MySpaceTV&lt;/ref&gt;\n\nA proponent of [[environmentalism]], Hanks is an investor in [[electric vehicles]] and owns both a [[Toyota RAV4 EV]] and the first production [[AC Propulsion eBox]]. Hanks\
      \ was a lessee of an [[EV1]] before it was recalled, as chronicled in the documentary ''[[Who Killed the Electric Car?]]''&lt;ref&gt;[http://www.allabouthybridcars.com/hollywood-hybrids.htm &quot;Hollywood Loves Hybrid Cars&quot;], ''[[Washington Post]]''&lt;/ref&gt;\
      \ He was on the waiting list for an [[Aptera 2 Series]].&lt;ref&gt;[http://www.paloaltoonline.com/news/show_story.php?id=12043 &quot;Bird-like electric car to make Palo Alto debut&quot;]. Retrieved February 1, 2010&lt;/ref&gt;\n\nHanks was extremely outspoken\
      \ about his opposition to the 2008 [[California Proposition 8 (2008)|Proposition 8]], an amendment to the [[Constitution of California|California constitution]] that defined marriage as a union only between a man and a woman. Hanks and others who were\
      \ in opposition to the proposition raised over US$44&amp;nbsp;million, in contrast to the supporters' $39&amp;nbsp;million,&lt;ref&gt;[http://www.latimes.com/news/local/la-moneymap,0,2198220.htmlstory &quot;Tracking the Money: The Final Numbers&quot;],\
      \ ''[[Los Angeles Times]]''&lt;/ref&gt; but Proposition 8 passed with 52% of the vote.&lt;ref&gt;[http://www.latimes.com/news/local/politics/cal/la-2008election-california-results,0,1293859.htmlstory?view=8&amp;tab=0&amp;fnum=0 California propositions:\
      \ Proposition 8, county-by-county map, margin of victory], ''[[Los Angeles Times]]''&lt;/ref&gt; It was only overruled in June 2013, when the [[United States Court of Appeals for the Ninth Circuit|Ninth Circuit]] lifted its stay of the district court's\
      \ ruling, enabling Governor [[Jerry Brown]] to order same-sex marriage officiations to resume.&lt;ref&gt;{{cite news|last=Dolan |first=Maura |url=http://www.latimes.com/local/lanow/la-me-ln-prop-8-gay-marriage-20130628,0,1889039.story |title=Prop 8: Gay\
      \ marriages can resume in California, court rules |publisher=Latimes.com |date=2013-06-28 |accessdate=2013-12-03}}&lt;/ref&gt;\n\nWhile premiering a TV series in January 2009, Hanks called supporters of Proposition 8 &quot;un-American&quot; and criticized\
      \ the [[Latter Day Saints|LDS]] (Mormon) church members, who were major proponents of the bill, for their views on marriage and their role in supporting the bill.&lt;ref&gt;[http://www.lonsberry.com/writings.cfm?story=2585&amp;go=4 &quot;Tom Hanks Get\
      \ Payback for Prop 8&quot;] from Lonsberry.com.&lt;/ref&gt;&lt;ref&gt;[http://www.foxnews.com/story/0,2933,480167,00.html &quot;Tom Hanks Says Mormon Supporters of Proposition 8 'Un-American'&quot;], [[Fox News]].&lt;/ref&gt; About a week later, Hanks\
      \ apologized for the remark, saying that nothing is more American than voting one's conscience.&lt;ref&gt;[http://www.foxnews.com/story/0,2933,482266,00.html &quot;Tom Hanks Apologizes for Calling Mormon Supporters of Proposition 8 'Un-American'&quot;],\
      \ Fox News&lt;/ref&gt; Hanks narrated a video created by [[Obama for America]], entitled ''[[The Road We've Traveled]]''.&lt;ref name=&quot;Road&quot;&gt;{{cite news | url=http://www.latimes.com/news/politics/la-pn-grassroots-reactions-to-obamas-the-road-weve-traveled-video-20120316,0,6154612.story?track=rss&amp;utm_source=dlvr.it&amp;utm_medium=twitter&amp;dlvrit=56325\
      \ | title=Grassroots reactions to Obama's &quot;The Road We've Traveled&quot; Video | date=March 16, 2012 | agency=Los Angeles Times | accessdate=March 17, 2012 | author=Memoli, Michael | work=Los Angeles Times}}&lt;/ref&gt;\n\n==Other activities==\n[[File:Steven\
      \ Spielberg &amp; Tom Hanks at National World War II Memorial for premiere of The Pacific 2010-03-11.jpg|thumb|Hanks with [[Steven Spielberg]] at the [[National World War II Memorial]] in March 2010]]\n\nA supporter of [[NASA]]'s manned space program,\
      \ Hanks has said that he originally wanted to be an [[astronaut]], but &quot;didn't have the math.&quot; Hanks is a member of the [[National Space Society]], serving on the [[Board of Governors]] of the nonprofit educational [[space advocacy]] organization\
      \ founded by Dr. [[Wernher Von Braun]].&lt;ref&gt;{{cite web|title=National Space Society Board of Governors|url=http://www.nss.org/about/bog.html|accessdate=July 10, 2012}}&lt;/ref&gt; He also produced the [[Home Box Office|HBO]] miniseries ''[[From the\
      \ Earth to the Moon (TV miniseries)|From the Earth to the Moon]]'' about the [[Apollo program]] to send astronauts to the moon.  In addition, Hanks co-wrote and co-produced ''[[Magnificent Desolation: Walking on the Moon 3D]]'', an [[IMAX]] film about\
      \ the moon landings.&lt;ref&gt;{{cite web|title=The Narrator:Tom Hanks|url=http://www.imax.com/magnificentdesolation/|work=imax.com}}&lt;/ref&gt; Hanks provided the [[voice over]] for the premiere of the show ''Passport to the Universe'' at the [[Rose\
      \ Center for Earth and Space]] in the [[Hayden Planetarium]] at the [[American Museum of Natural History]] in New York.&lt;ref&gt;{{cite web|title=Rose Center for Earth and Space at the American Museum of Natural History|url=http://www.ny.com/museums/rosecenter2.html|work=ny.com|publisher=museums}}&lt;/ref&gt;\n\
      \nIn 2006, the [[Space Foundation]] awarded Hanks the Douglas S. Morrow Public Outreach Award,&lt;ref&gt;{{cite web | url=http://www.spacefoundation.org/about/awards/douglas-s-morrow-public-outreach-award | title=Douglas S. Morrow Public Outreach Awards:\
      \ Recipients | work=spacefoundation.org | accessdate=April 21, 2014}}&lt;/ref&gt; given annually to an individual or organization that has made significant contributions to public awareness of space programs.{{cn|date=September 2014}}\n\nIn June 2006,\
      \ Hanks was inducted as an honorary member of the [[United States Army Rangers]] Hall of Fame for his accurate portrayal of a [[Captain (U.S. Army)|Captain]] in the movie ''Saving Private Ryan''; Hanks, who was unable to attend the induction ceremony,\
      \ was the first actor to receive such an honor.&lt;ref&gt;{{cite web | url=http://usatoday30.usatoday.com/life/people/2006-06-29-hanks-ranger_x.htm | title=Tom Hanks into Army's Ranger Hall of Fame | work=usatoday.com | date=June 29, 2006 | accessdate=April\
      \ 21, 2014}}&lt;/ref&gt; In addition to his role in ''Saving Private Ryan'', Hanks was cited for serving as the national spokesperson for the World War II Memorial Campaign, for being the honorary chairperson of the D-Day Museum Capital Campaign, and for\
      \ his role in writing and helping to produce the Emmy Award-winning miniseries, ''Band of Brothers''.&lt;ref&gt;{{cite news |last=Alexander |first=Bryan |title=Steven Spielberg, Tom Hanks Pay Tribute to 'Band of Brothers' Inspiration |url=http://www.hollywoodreporter.com/news/steven-spielberg-dick-winters-vanguard-69934|work=hollywoodreporter\
      \ |date=January 10, 2011 |accessdate= July 10, 2012}}&lt;/ref&gt; On March 10, 2008, Hanks was on hand at the [[Rock &amp; Roll Hall of Fame]] to induct [[the Dave Clark Five]].&lt;ref&gt;{{cite web| url=http://www.captainerniesshowboat.com/marshalj |title=The\
      \ Dave Clark Five |publisher=Captainerniesshowboat.com |accessdate=March 15, 2011}}&lt;/ref&gt;\n\n==Legacy and impact==\nHanks is perceived to be amiable and congenial to his fans. In 2013, when he was starring in Nora Ephron's Lucky Guy on Broadway,\
      \ he had crowds of 300 fans waiting for a glimpse of him after every performance. This is the highest number of expectant fans post-show of any Broadway performance.&lt;ref&gt;Vineyard, Jennifer, &quot;Who Needs a Tony ...&quot;, New York, June 24-July\
      \ 1, 2013, pp.124-25&lt;/ref&gt;\n\nHanks is ranked as the highest all-time box office star with over $3.639&amp;nbsp;billion total box office gross, an average of $107&amp;nbsp;million per film.&lt;ref&gt;[http://www.boxofficemojo.com/people/?view=Actor&amp;sort=sumgross&amp;p=.htm\
      \ &quot;People Index.&quot;] Box Office Mojo.&lt;/ref&gt; He has been involved with 17 films that grossed over $100&amp;nbsp;million at the worldwide box office, the highest grossing of which was 2010's ''[[Toy Story 3]]''.&lt;ref name=&quot;box&quot;&gt;{{cite\
      \ web|url=http://www.boxofficemojo.com/people/chart/?id=tomhanks.htm |title=Tom Hanks profile at Box Office Mojo |publisher=Boxofficemojo.com |accessdate=March 15, 2011}}&lt;/ref&gt; As of 2014, Hanks' films have [[gross (economics)|grossed]] over $4.2\
      \ billion at the United States and Canada box office and over $8.4 billion worldwide, making him the highest all-time box office star. Asteroid [[12818 Tomhanks]] is named after him.&lt;ref&gt;{{cite web|url=http://ssd.jpl.nasa.gov/sbdb.cgi?sstr=12818+Tomhanks\
      \ |title=12818 Tomhanks (1996 GU8) |accessdate=August 3, 2011 |publisher=[[NASA]].gov}}&lt;/ref&gt;\n\n== See also ==\n*[[Tom Hanks on screen and stage]]\n*[[List of awards and nominations received by Tom Hanks]]\n{{Portal bar|Biography|Film}}\n\n==References==\n\
      {{Reflist|30em}}\n\n==Further reading==\n* Gardner, David, (1999), ''Tom Hanks: The Unauthorized Biography'', London: England, ISBN 978-1857823271\n* Gardner, David, (2007), ''Tom Hanks: Enigma,'' ISBN 978-1844544288\n* Pfeiffer, Lee, (1996), ''The Films\
      \ of Tom Hanks'', Secaucus: New Jersey, ISBN 978-0806517179\n* Salamon, Julie, (1991), ''The Devil's Candy: The Bonfire of the Vanities Goes to Hollywood,'' Boston, ISBN 978-0385308243\n* Trakin, Roy, (1995), ''Tom Hanks: Journey to Stardom'', ISBN 978-0312955960\n\
      * Wallner, Rosemary, (1994), ''Tom Hanks: Academy Award-Winning Actor'', Edina: Minnesota\n\n==External links==\n{{Commons category|Tom Hanks}}\n* {{IMDb name|158}}\n* {{Twitter|tomhanks}}\n* [https://www.facebook.com/TomHanks Tom Hanks' Facebook Page]\n\
      * {{youtube user|tomhankschannel|Tom Hanks}}\n\n{{Tom Hanks}}\n{{Navboxes\n| title = Awards for Tom Hanks\n| list =\n{{AcademyAwardBestActor 1981-2000}}\n{{AFI Life Achievement Award}}\n{{BAFTA Los Angeles Britannia Awards}}\n{{Silver Bear for Best Actor}}\n\
      {{EmmyAward MiniseriesDirector 2001-2025}}\n{{Empire Award for Best Actor}}\n{{Kennedy Center Honorees 2010s}}\n{{Lincoln Center Gala Tribute}}\n{{GoldenGlobeBestActorMotionPictureDrama 1981-2000}}\n{{GoldenGlobeBestActorMotionPictureMusicalComedy 1981–\
      2000}}\n{{MTV Movie Award for Best Performance}}\n{{National Board of Review Award for Best Actor}}\n{{New York Film Critics Circle Award for Best Actor}}\n{{Saturn Award for Best Actor}}\n{{ScreenActorsGuildAward CastMotionPicture 1995–2000}}\n{{ScreenActorsGuildAward\
      \ MaleLeadMotionPicture 1994-2000}}\n}}\n\n{{Authority control|VIAF=19874894}}\n\n{{Persondata\n| NAME              = Hanks, Thomas Jeffrey\n| ALTERNATIVE NAMES = Hanks, Tom\n| SHORT DESCRIPTION = Actor, filmmaker\n| DATE OF BIRTH     = July 9, 1956\n\
      | PLACE OF BIRTH    = [[Concord, California]]\n| DATE OF DEATH     =\n| PLACE OF DEATH    =\n}}\n{{DEFAULTSORT:Hanks, Tom}}\n[[Category:1956 births]]\n[[Category:20th-century American male actors]]\n[[Category:21st-century American male actors]]\n[[Category:American\
      \ film producers]]\n[[Category:American male film actors]]\n[[Category:American male television actors]]\n[[Category:American male voice actors]]\n[[Category:American people of English descent]]\n[[Category:American people of Portuguese descent]]\n[[Category:American\
      \ screenwriters]]\n[[Category:Best Actor Academy Award winners]]\n[[Category:Best Actor Empire Award winners]]\n[[Category:Best Drama Actor Golden Globe (film) winners]]\n[[Category:Best Musical or Comedy Actor Golden Globe (film) winners]]\n[[Category:California\
      \ Democrats]]\n[[Category:California State University, Sacramento alumni]]\n[[Category:Chabot College alumni]]\n[[Category:Eastern Orthodox Christians from the United States]]\n[[Category:Greek Orthodox Christians]]\n[[Category:Converts to Eastern Orthodoxy\
      \ from Catholicism]]\n[[Category:Film directors from California]]\n[[Category:Living people]]\n[[Category:Outstanding Performance by a Cast in a Motion Picture Screen Actors Guild Award winners]]\n[[Category:Outstanding Performance by a Male Actor in a\
      \ Leading Role Screen Actors Guild Award winners]]\n[[Category:People from Concord, California]]\n[[Category:Primetime Emmy Award winners]]\n[[Category:Space advocates]]\n[[Category:Silver Bear for Best Actor winners]]\n[[Category:Writers from Los Angeles,\
      \ California]]\n[[Category:American people of German descent]]\n[[Category:Former Roman Catholics]]</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:03.530Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Arefimprove&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:03 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226972700, 1470602486, 4115537952
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:refimprove" to="Template:Refimprove" /></normalized><pages><page pageid="10160967" ns="10" title="Template:Refimprove"><revisions><rev user="Jackmcbarn" timestamp="2013-11-30T17:17:10Z" comment="image&#039;s license requires linking" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||$N=Refimprove |date=__DATE__ |$B=
      {{ambox
      | name  = {{{name|Refimprove}}}
      | subst = {{{subst|&lt;includeonly&gt;{{subst:&lt;/includeonly&gt;&lt;includeonly&gt;substcheck}}&lt;/includeonly&gt;}}}
      | small = {{{small|}}}
      | type  = content
      | class = ambox-Refimprove
      | image = [[File:Question book-new.svg|50x40px|alt=]]
      | issue = This {{#if:{{{1|}}}|{{{1}}}|article}} '''needs additional citations for [[Wikipedia:Verifiability|verification]]'''.
      | fix   = Please help [{{fullurl:{{FULLPAGENAME}}|action=edit}} improve this article] by [[Help:Introduction to referencing/1|adding citations to reliable sources]]. Unsourced material may be challenged and removed.
      | talk  = {{{talk|}}}
      | date  = {{{date|}}}
      | cat   = Articles needing additional references
      | all   = All articles needing additional references
      }}&lt;!--{{refimprove}} end--&gt;
      }}&lt;noinclude&gt;
      {{documentation}}&lt;!-- Please add categories and interwikis to the /doc subpage, thanks --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:03.895Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asubstcheck&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:03 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq41 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348936091, 654984848, 4115538686
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:substcheck" to="Template:Substcheck" /></normalized><pages><page pageid="22465489" ns="10" title="Template:Substcheck"><revisions><rev user="Thumperward" timestamp="2010-09-07T17:05:47Z" comment="add docs" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">SUBST&lt;noinclude&gt;{{documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:04.444Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aambox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:04 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103480020, 3589272344, 4115539030
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:ambox" to="Template:Ambox" /></normalized><pages><page pageid="13179742" ns="10" title="Template:Ambox"><revisions><rev user="Mr. Stradivarius" timestamp="2013-10-23T12:52:13Z" comment="Undid revision 578101879 by [[Special:Contributions/Mr. Stradivarius|Mr. Stradivarius]] ([[User talk:Mr. Stradivarius|talk]]) problems with module have been fixed - trying again" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Message box|ambox}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:05.506Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AMessage_box&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:05 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq31 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530261886, 882849607, 4115539759
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Message_box\" to=\"Module:Message box\" /></normalized><pages><page pageid=\"40574910\" ns=\"828\" title=\"Module:Message box\"><revisions><rev user=\"Mr. Stradivarius\"\
      \ timestamp=\"2014-04-08T04:39:12Z\" comment=\"Allow passing attributes per protected edit request by [[User:Jackmcbarn]]. Also remove undocumented &quot;hidden&quot; parameter and format the module so it mostly fits within 80 chars.\" contentformat=\"\
      text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This is a meta-module for producing message box templates, including\n-- {{mbox}}, {{ambox}}, {{imbox}}, {{tmbox}}, {{ombox}}, {{cmbox}} and {{fmbox}}.\n\n-- Require necessary modules.\n\
      local getArgs = require('Module:Arguments').getArgs\nlocal htmlBuilder = require('Module:HtmlBuilder')\nlocal categoryHandler = require('Module:Category handler').main\nlocal yesno = require('Module:Yesno')\n\n-- Load the configuration page.\nlocal cfgTables\
      \ = mw.loadData('Module:Message box/configuration')\n\n-- Get a language object for formatDate and ucfirst.\nlocal lang = mw.language.getContentLanguage()\n\n-- Set aliases for often-used functions to reduce table lookups.\nlocal format = mw.ustring.format\n\
      local tinsert = table.insert\nlocal tconcat = table.concat\nlocal trim = mw.text.trim\n\n--------------------------------------------------------------------------------\n-- Helper functions\n--------------------------------------------------------------------------------\n\
      \nlocal function getTitleObject(page, ...)\n\tif type(page) == 'string' then\n\t\t-- Get the title object, passing the function through pcall \n\t\t-- in case we are over the expensive function count limit.\n\t\tlocal success, title = pcall(mw.title.new,\
      \ page, ...)\n\t\tif success then\n\t\t\treturn title\n\t\tend\n\tend\nend\n\nlocal function union(t1, t2)\n\t-- Returns the union of two arrays.\n\tlocal vals = {}\n\tfor i, v in ipairs(t1) do\n\t\tvals[v] = true\n\tend\n\tfor i, v in ipairs(t2) do\n\t\
      \tvals[v] = true\n\tend\n\tlocal ret = {}\n\tfor k in pairs(vals) do\n\t\ttinsert(ret, k)\n\tend\n\ttable.sort(ret)\n\treturn ret\nend\n\nlocal function getArgNums(args, prefix)\n\tlocal nums = {}\n\tfor k, v in pairs(args) do\n\t\tlocal num = mw.ustring.match(tostring(k),\
      \ '^' .. prefix .. '([1-9]%d*)$')\n\t\tif num then\n\t\t\ttinsert(nums, tonumber(num))\n\t\tend\n\tend\n\ttable.sort(nums)\n\treturn nums\nend\n\n--------------------------------------------------------------------------------\n-- Box class definition\n\
      --------------------------------------------------------------------------------\n\nlocal box = {}\nbox.__index = box\n\nfunction box.new()\n\tlocal obj = {}\n\tsetmetatable(obj, box)\n\treturn obj\nend\n\nfunction box.getNamespaceId(ns)\n\tif not ns then\
      \ return end\n\tif type(ns) == 'string' then\n\t\tns = lang:ucfirst(mw.ustring.lower(ns))\n\t\tif ns == 'Main' then\n\t\t\tns = 0\n\t\tend\n\tend\n\tlocal nsTable = mw.site.namespaces[ns]\n\tif nsTable then\n\t\treturn nsTable.id\n\tend\nend\n\nfunction\
      \ box.getMboxType(nsid)\n\t-- Gets the mbox type from a namespace number.\n\tif nsid == 0 then\n\t\treturn 'ambox' -- main namespace\n\telseif nsid == 6 then\n\t\treturn 'imbox' -- file namespace\n\telseif nsid == 14 then\n\t\treturn 'cmbox' -- category\
      \ namespace\n\telse\n\t\tlocal nsTable = mw.site.namespaces[nsid]\n\t\tif nsTable and nsTable.isTalk then\n\t\t\treturn 'tmbox' -- any talk namespace\n\t\telse\n\t\t\treturn 'ombox' -- other namespaces or invalid input\n\t\tend\n\tend\nend\n\nfunction\
      \ box:addCat(ns, cat, sort)\n\tif type(cat) ~= 'string' then return end\n\tlocal nsVals = {'main', 'template', 'all'}\n\tlocal tname\n\tfor i, val in ipairs(nsVals) do\n\t\tif ns == val then\n\t\t\ttname = ns .. 'Cats'\n\t\tend\n\tend\n\tif not tname then\n\
      \t\tfor i, val in ipairs(nsVals) do\n\t\t\tnsVals[i] = format('&quot;%s&quot;', val)\n\t\tend\n\t\terror(\n\t\t\t'invalid ns parameter passed to box:addCat; valid values are '\n\t\t\t.. mw.text.listToText(nsVals, nil, ' or ')\n\t\t)\n\tend\n\tself[tname]\
      \ = self[tname] or {}\n\tif type(sort) == 'string' then\n\t\ttinsert(self[tname], format('[[Category:%s|%s]]', cat, sort))\n\telse\n\t\ttinsert(self[tname], format('[[Category:%s]]', cat))\n\tend\nend\n\nfunction box:addClass(class)\n\tif type(class) ~=\
      \ 'string' then return end\n\tself.classes = self.classes or {}\n\ttinsert(self.classes, class)\nend\n\nfunction box:addAttr(attr, val)\n\tif type(attr) ~= 'string' or type(val) ~= 'string' then return end\n\tself.attrs = self.attrs or {}\n\ttinsert(self.attrs,\
      \ attr)\nend\n\nfunction box:setTitle(args)\n\t-- Get the title object and the namespace.\n\tself.pageTitle = getTitleObject(args.page ~= '' and args.page)\n\tself.title = self.pageTitle or mw.title.getCurrentTitle()\n\tself.demospace = args.demospace\
      \ ~= '' and args.demospace or nil\n\tself.nsid = box.getNamespaceId(self.demospace) or self.title.namespace\nend\n\nfunction box:getConfig(boxType)\n\t-- Get the box config data from the data page.\n\tif boxType == 'mbox' then\n\t\tboxType = box.getMboxType(self.nsid)\n\
      \tend\n\tlocal cfg = cfgTables[boxType]\n\tif not cfg then\n\t\tlocal boxTypes = {}\n\t\tfor k, v in pairs(dataTables) do\n\t\t\ttinsert(boxTypes, format('&quot;%s&quot;', k))\n\t\tend\n\t\ttinsert(boxTypes, '&quot;mbox&quot;')\n\t\terror(format(\n\t\t\
      \t'invalid message box type &quot;%s&quot;; valid types are %s',\n\t\t\ttostring(boxType),\n\t\t\tmw.text.listToText(boxTypes)\n\t\t), 2)\n\tend\n\treturn cfg\nend\n\nfunction box:removeBlankArgs(cfg, args)\n\t-- Only allow blank arguments for the parameter\
      \ names listed in\n\t-- cfg.allowBlankParams.\n\tlocal newArgs = {}\n\tfor k, v in pairs(args) do\n\t\tif v ~= '' then\n\t\t\tnewArgs[k] = v\n\t\tend\n\tend\n\tfor i, param in ipairs(cfg.allowBlankParams or {}) do\n\t\tnewArgs[param] = args[param]\n\t\
      end\n\treturn newArgs\nend\n\nfunction box:setBoxParameters(cfg, args)\n\t-- Get type data.\n\tself.type = args.type\n\tlocal typeData = cfg.types[self.type]\n\tself.invalidTypeError = cfg.showInvalidTypeError\n\t\tand self.type\n\t\tand not typeData\n\
      \t\tand true\n\t\tor false\n\ttypeData = typeData or cfg.types[cfg.default]\n\tself.typeClass = typeData.class\n\tself.typeImage = typeData.image\n\n\t-- Find if the box has been wrongly substituted.\n\tif cfg.substCheck and args.subst == 'SUBST' then\n\
      \t\tself.isSubstituted = true\n\tend\n\n\t-- Find whether we are using a small message box.\n\tif cfg.allowSmall and (\n\t\tcfg.smallParam and args.small == cfg.smallParam\n\t\tor not cfg.smallParam and yesno(args.small)\n\t)\n\tthen\n\t\tself.isSmall\
      \ = true\n\telse\n\t\tself.isSmall = false\n\tend\n\n\t-- Add attributes, classes and styles.\n\tif cfg.allowId then\n\t\tself.id = args.id\n\tend\n\tself:addClass(\n\t\tcfg.usePlainlinksParam and yesno(args.plainlinks or true) and 'plainlinks'\n\t)\n\t\
      for _, class in ipairs(cfg.classes or {}) do\n\t\tself:addClass(class)\n\tend\n\tif self.isSmall then\n\t\tself:addClass(cfg.smallClass or 'mbox-small')\n\tend\n\tself:addClass(self.typeClass)\n\tself:addClass(args.class)\n\tself.style = args.style\n\t\
      self.attrs = args.attrs\n\n\t-- Set text style.\n\tself.textstyle = args.textstyle\n\n\t-- Find if we are on the template page or not. This functionality is only\n\t-- used if useCollapsibleTextFields is set, or if both cfg.templateCategory\n\t-- and cfg.templateCategoryRequireName\
      \ are set.\n\tself.useCollapsibleTextFields = cfg.useCollapsibleTextFields\n\tif self.useCollapsibleTextFields\n\t\tor cfg.templateCategory\n\t\tand cfg.templateCategoryRequireName\n\tthen\n\t\tself.name = args.name\n\t\tif self.name then\n\t\t\tlocal\
      \ templateName = mw.ustring.match(\n\t\t\t\tself.name,\n\t\t\t\t'^[tT][eE][mM][pP][lL][aA][tT][eE][%s_]*:[%s_]*(.*)$'\n\t\t\t) or self.name\n\t\t\ttemplateName = 'Template:' .. templateName\n\t\t\tself.templateTitle = getTitleObject(templateName)\n\t\t\
      end\n\t\tself.isTemplatePage = self.templateTitle\n\t\t\tand mw.title.equals(self.title, self.templateTitle)\n\t\t\tor false\n\tend\n\n\t-- Process data for collapsible text fields. At the moment these are only\n\t-- used in {{ambox}}.\n\tif self.useCollapsibleTextFields\
      \ then\n\t\t-- Get the self.issue value.\n\t\tif self.isSmall and args.smalltext then\n\t\t\tself.issue = args.smalltext\n\t\telse\n\t\t\tlocal sect\n\t\t\tif args.sect == '' then\n\t\t\t\tsect = 'This ' .. (cfg.sectionDefault or 'page')\n\t\t\telseif\
      \ type(args.sect) == 'string' then\n\t\t\t\tsect = 'This ' .. args.sect\n\t\t\tend\n\t\t\tlocal issue = args.issue\n\t\t\tissue = type(issue) == 'string' and issue ~= '' and issue or nil\n\t\t\tlocal text = args.text\n\t\t\ttext = type(text) == 'string'\
      \ and text or nil\n\t\t\tlocal issues = {}\n\t\t\ttinsert(issues, sect)\n\t\t\ttinsert(issues, issue)\n\t\t\ttinsert(issues, text)\n\t\t\tself.issue = tconcat(issues, ' ')\n\t\tend\n\n\t\t-- Get the self.talk value.\n\t\tlocal talk = args.talk\n\t\t--\
      \ Show talk links on the template page or template subpages if the talk\n\t\t-- parameter is blank.\n\t\tif talk == ''\n\t\t\tand self.templateTitle \n\t\t\tand (\n\t\t\t\tmw.title.equals(self.templateTitle, self.title)\n\t\t\t\tor self.title:isSubpageOf(self.templateTitle)\n\
      \t\t\t)\n\t\tthen\n\t\t\ttalk = '#'\n\t\telseif talk == '' then\n\t\t\ttalk = nil\n\t\tend\n\t\tif talk then\n\t\t\t-- If the talk value is a talk page, make a link to that page. Else\n\t\t\t-- assume that it's a section heading, and make a link to the\
      \ talk\n\t\t\t-- page of the current page with that section heading.\n\t\t\tlocal talkTitle = getTitleObject(talk)\n\t\t\tlocal talkArgIsTalkPage = true\n\t\t\tif not talkTitle or not talkTitle.isTalkPage then\n\t\t\t\ttalkArgIsTalkPage = false\n\t\t\t\
      \ttalkTitle = getTitleObject(\n\t\t\t\t\tself.title.text,\n\t\t\t\t\tmw.site.namespaces[self.title.namespace].talk.id\n\t\t\t\t)\n\t\t\tend\n\t\t\tif talkTitle and talkTitle.exists then\n\t\t\t\tlocal talkText = 'Relevant discussion may be found on'\n\t\
      \t\t\tif talkArgIsTalkPage then\n\t\t\t\t\ttalkText = format(\n\t\t\t\t\t\t'%s [[%s|%s]].',\n\t\t\t\t\t\ttalkText,\n\t\t\t\t\t\ttalk,\n\t\t\t\t\t\ttalkTitle.prefixedText\n\t\t\t\t\t)\n\t\t\t\telse\n\t\t\t\t\ttalkText = format(\n\t\t\t\t\t\t'%s the [[%s#%s|talk\
      \ page]].',\n\t\t\t\t\t\ttalkText,\n\t\t\t\t\t\ttalkTitle.prefixedText,\n\t\t\t\t\t\ttalk\n\t\t\t\t\t)\n\t\t\t\tend\n\t\t\t\tself.talk = talkText\n\t\t\tend\n\t\tend\n\n\t\t-- Get other values.\n\t\tself.fix = args.fix ~= '' and args.fix or nil\n\t\tlocal\
      \ date\n\t\tif args.date and args.date ~= '' then\n\t\t\tdate = args.date\n\t\telseif args.date == '' and self.isTemplatePage then\n\t\t\tdate = lang:formatDate('F Y')\n\t\tend\n\t\tif date then\n\t\t\tself.date = format(&quot; &lt;small&gt;''(%s)''&lt;/small&gt;&quot;,\
      \ date)\n\t\tend\n\t\tself.info = args.info\n\tend\n\n\t-- Set the non-collapsible text field. At the moment this is used by all box\n\t-- types other than ambox, and also by ambox when small=yes.\n\tif self.isSmall then\n\t\tself.text = args.smalltext\
      \ or args.text\n\telse\n\t\tself.text = args.text\n\tend\n\n\t-- Set the below row.\n\tself.below = cfg.below and args.below\n\n\t-- General image settings.\n\tself.imageCellDiv = not self.isSmall and cfg.imageCellDiv and true or false\n\tself.imageEmptyCell\
      \ = cfg.imageEmptyCell\n\tif cfg.imageEmptyCellStyle then\n\t\tself.imageEmptyCellStyle = 'border:none;padding:0px;width:1px'\n\tend\n\n\t-- Left image settings.\n\tlocal imageLeft = self.isSmall and args.smallimage or args.image\n\tif cfg.imageCheckBlank\
      \ and imageLeft ~= 'blank' and imageLeft ~= 'none'\n\t\tor not cfg.imageCheckBlank and imageLeft ~= 'none'\n\tthen\n\t\tself.imageLeft = imageLeft\n\t\tif not imageLeft then\n\t\t\tlocal imageSize = self.isSmall\n\t\t\t\tand (cfg.imageSmallSize or '30x30px')\n\
      \t\t\t\tor '40x40px'\n\t\t\tself.imageLeft = format('[[File:%s|%s|link=|alt=]]', self.typeImage\n\t\t\t\tor 'Imbox notice.png', imageSize)\n\t\tend\n\tend\n\n\t-- Right image settings.\n\tlocal imageRight = self.isSmall and args.smallimageright or args.imageright\n\
      \tif not (cfg.imageRightNone and imageRight == 'none') then\n\t\tself.imageRight = imageRight\n\tend\n\n\t-- Add mainspace categories. At the moment these are only used in {{ambox}}.\n\tif cfg.allowMainspaceCategories then\n\t\tif args.cat then\n\t\t\t\
      args.cat1 = args.cat\n\t\tend\n\t\tself.catNums = getArgNums(args, 'cat')\n\t\tif args.category then\n\t\t\targs.category1 = args.category\n\t\tend\n\t\tself.categoryNums = getArgNums(args, 'category')\n\t\tif args.all then\n\t\t\targs.all1 = args.all\n\
      \t\tend\n\t\tself.allNums = getArgNums(args, 'all')\n\t\tself.categoryParamNums = union(self.catNums, self.categoryNums)\n\t\tself.categoryParamNums = union(self.categoryParamNums, self.allNums)\n\t\t-- The following is roughly equivalent to the old {{Ambox/category}}.\n\
      \t\tlocal date = args.date\n\t\tdate = type(date) == 'string' and date\n\t\tlocal preposition = 'from'\n\t\tfor _, num in ipairs(self.categoryParamNums) do\n\t\t\tlocal mainCat = args['cat' .. tostring(num)]\n\t\t\t\tor args['category' .. tostring(num)]\n\
      \t\t\tlocal allCat = args['all' .. tostring(num)]\n\t\t\tmainCat = type(mainCat) == 'string' and mainCat\n\t\t\tallCat = type(allCat) == 'string' and allCat\n\t\t\tif mainCat and date and date ~= '' then\n\t\t\t\tlocal catTitle = format('%s %s %s', mainCat,\
      \ preposition, date)\n\t\t\t\tself:addCat('main', catTitle)\n\t\t\t\tcatTitle = getTitleObject('Category:' .. catTitle)\n\t\t\t\tif not catTitle or not catTitle.exists then\n\t\t\t\t\tself:addCat(\n\t\t\t\t\t\t'main',\n\t\t\t\t\t\t'Articles with invalid\
      \ date parameter in template'\n\t\t\t\t\t)\n\t\t\t\tend\n\t\t\telseif mainCat and (not date or date == '') then\n\t\t\t\tself:addCat('main', mainCat)\n\t\t\tend\n\t\t\tif allCat then\n\t\t\t\tself:addCat('main', allCat)\n\t\t\tend\n\t\tend\n\tend\n\n\t\
      -- Add template-namespace categories.\n\tif cfg.templateCategory then\n\t\tif cfg.templateCategoryRequireName then\n\t\t\tif self.isTemplatePage then\n\t\t\t\tself:addCat('template', cfg.templateCategory)\n\t\t\tend\n\t\telseif not self.title.isSubpage\
      \ then\n\t\t\tself:addCat('template', cfg.templateCategory)\n\t\tend\n\tend\n\n\t-- Add template error category.\n\tif cfg.templateErrorCategory then\n\t\tlocal templateErrorCategory = cfg.templateErrorCategory\n\t\tlocal templateCat, templateSort\n\t\t\
      if not self.name and not self.title.isSubpage then\n\t\t\ttemplateCat = templateErrorCategory\n\t\telseif self.isTemplatePage then\n\t\t\tlocal paramsToCheck = cfg.templateErrorParamsToCheck or {}\n\t\t\tlocal count = 0\n\t\t\tfor i, param in ipairs(paramsToCheck)\
      \ do\n\t\t\t\tif not args[param] then\n\t\t\t\t\tcount = count + 1\n\t\t\t\tend\n\t\t\tend\n\t\t\tif count &gt; 0 then\n\t\t\t\ttemplateCat = templateErrorCategory\n\t\t\t\ttemplateSort = tostring(count)\n\t\t\tend\n\t\t\tif self.categoryNums and #self.categoryNums\
      \ &gt; 0 then\n\t\t\t\ttemplateCat = templateErrorCategory\n\t\t\t\ttemplateSort = 'C'\n\t\t\tend\n\t\tend\n\t\tself:addCat('template', templateCat, templateSort)\n\tend\n\n\t-- Categories for all namespaces.\n\tif self.invalidTypeError then\n\t\tlocal\
      \ allSort = (self.nsid == 0 and 'Main:' or '') .. self.title.prefixedText\n\t\tself:addCat('all', 'Wikipedia message box parameter needs fixing', allSort)\n\tend\n\tif self.isSubstituted then\n\t\tself:addCat('all', 'Pages with incorrectly substituted\
      \ templates')\n\tend\n\n\t-- Convert category tables to strings and pass them through\n\t-- [[Module:Category handler]].\n\tself.categories = categoryHandler{\n\t\tmain = tconcat(self.mainCats or {}),\n\t\ttemplate = tconcat(self.templateCats or {}),\n\
      \t\tall = tconcat(self.allCats or {}),\n\t\tnocat = args.nocat,\n\t\tdemospace = self.demospace,\n\t\tpage = self.pageTitle and self.pageTitle.prefixedText or nil\n\t}\nend\n\nfunction box:export()\n\tlocal root = htmlBuilder.create()\n\n\t-- Add the subst\
      \ check error.\n\tif self.isSubstituted and self.name then\n\t\troot\n\t\t\t.tag('b')\n\t\t\t\t.addClass('error')\n\t\t\t\t.wikitext(format(\n\t\t\t\t\t'Template &lt;code&gt;%s[[Template:%s|%s]]%s&lt;/code&gt; has been incorrectly substituted.',\n\t\t\t\
      \t\tmw.text.nowiki('{{'), self.name, self.name, mw.text.nowiki('}}')\n\t\t\t\t))\n\tend\n\n\t-- Create the box table.\n\tlocal boxTable = root.tag('table')\n\tboxTable\n\t\t.attr('id', self.id)\n\tfor i, class in ipairs(self.classes or {}) do\n\t\tboxTable\n\
      \t\t\t.addClass(class)\n\tend\n\tboxTable\n\t\t.cssText(self.style)\n\t\t.attr('role', 'presentation')\n\tfor attr, val in pairs(self.attrs or {}) do\n\t\tboxTable\n\t\t\t.attr(attr, val)\n\tend\n\n\t-- Add the left-hand image.\n\tlocal row = boxTable.tag('tr')\n\
      \tif self.imageLeft then\n\t\tlocal imageLeftCell = row.tag('td').addClass('mbox-image')\n\t\tif self.imageCellDiv then\n\t\t\t-- If we are using a div, redefine imageLeftCell so that the image\n\t\t\t-- is inside it. Divs use style=&quot;width: 52px;&quot;,\
      \ which limits the\n\t\t\t-- image width to 52px. If any images in a div are wider than that,\n\t\t\t-- they may overlap with the text or cause other display problems.\n\t\t\timageLeftCell = imageLeftCell.tag('div').css('width', '52px') \n\t\tend\n\t\t\
      imageLeftCell\n\t\t\t.wikitext(self.imageLeft)\n\telseif self.imageEmptyCell then\n\t\t-- Some message boxes define an empty cell if no image is specified, and\n\t\t-- some don't. The old template code in templates where empty cells are\n\t\t-- specified\
      \ gives the following hint: &quot;No image. Cell with some width\n\t\t-- or padding necessary for text cell to have 100% width.&quot;\n\t\trow.tag('td')\n\t\t\t.addClass('mbox-empty-cell') \n\t\t\t.cssText(self.imageEmptyCellStyle)\n\tend\n\n\t-- Add the\
      \ text.\n\tlocal textCell = row.tag('td').addClass('mbox-text')\n\tif self.useCollapsibleTextFields then\n\t\t-- The message box uses advanced text parameters that allow things to be\n\t\t-- collapsible. At the moment, only ambox uses this.\n\t\ttextCell\n\
      \t\t\t.cssText(self.textstyle)\n\t\tlocal textCellSpan = textCell.tag('span')\n\t\ttextCellSpan\n\t\t\t.addClass('mbox-text-span')\n\t\t\t.wikitext(self.issue)\n\t\tif not self.isSmall then\n\t\t\ttextCellSpan\n\t\t\t\t.tag('span')\n\t\t\t\t\t.addClass('hide-when-compact')\n\
      \t\t\t\t\t.wikitext(self.talk and ' ' .. self.talk)\n\t\t\t\t\t.wikitext(self.fix and ' ' .. self.fix)\n\t\tend\n\t\ttextCellSpan\n\t\t\t.wikitext(self.date and ' ' .. self.date)\n\t\tif not self.isSmall then\n\t\t\ttextCellSpan\n\t\t\t\t.tag('span')\n\
      \t\t\t\t.addClass('hide-when-compact')\n\t\t\t\t.wikitext(self.info and ' ' .. self.info)\n\t\tend\n\telse\n\t\t-- Default text formatting - anything goes.\n\t\ttextCell\n\t\t\t.cssText(self.textstyle)\n\t\t\t.wikitext(self.text)\n\tend\n\n\t-- Add the\
      \ right-hand image.\n\tif self.imageRight then\n\t\tlocal imageRightCell = row.tag('td').addClass('mbox-imageright')\n\t\tif self.imageCellDiv then\n\t\t\t-- If we are using a div, redefine imageRightCell so that the image\n\t\t\t-- is inside it.\n\t\t\
      \timageRightCell = imageRightCell.tag('div').css('width', '52px')\n\t\tend\n\t\timageRightCell\n\t\t\t.wikitext(self.imageRight)\n\tend\n\n\t-- Add the below row.\n\tif self.below then\n\t\tboxTable.tag('tr')\n\t\t\t.tag('td')\n\t\t\t\t.attr('colspan',\
      \ self.imageRight and '3' or '2')\n\t\t\t\t.addClass('mbox-text')\n\t\t\t\t.cssText(self.textstyle)\n\t\t\t\t.wikitext(self.below)\n\tend\n\n\t-- Add error message for invalid type parameters.\n\tif self.invalidTypeError then\n\t\troot\n\t\t\t.tag('div')\n\
      \t\t\t\t.css('text-align', 'center')\n\t\t\t\t.wikitext(format(\n\t\t\t\t\t'This message box is using an invalid &quot;type=%s&quot; parameter and needs fixing.',\n\t\t\t\t\tself.type or ''\n\t\t\t\t))\n\tend\n\n\t-- Add categories.\n\troot\n\t\t.wikitext(self.categories)\n\
      \n\treturn tostring(root)\nend\n\nlocal function main(boxType, args)\n\tlocal outputBox = box.new()\n\toutputBox:setTitle(args)\n\tlocal cfg = outputBox:getConfig(boxType)\n\targs = outputBox:removeBlankArgs(cfg, args)\n\toutputBox:setBoxParameters(cfg,\
      \ args)\n\treturn outputBox:export()\nend\n\nlocal function makeWrapper(boxType)\n\treturn function (frame)\n\t\tlocal args = getArgs(frame, {trim = false, removeBlanks = false})\n\t\treturn main(boxType, args)\n\tend\nend\n\nlocal p = {\n\tmain = main,\n\
      \tmbox = makeWrapper('mbox')\n}\n\nfor boxType in pairs(cfgTables) do\n\tp[boxType] = makeWrapper(boxType)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:05.979Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AArguments&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:05 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq39 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226976892, 3682445654, 4115540576
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"41298065\" ns=\"828\" title=\"Module:Arguments\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-05T03:52:56Z\" comment=\"allow using both the frame and parent\
      \ frame arguments with the wrappers option if specifically requested, per protected edit request by [[User:Jackmcbarn]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module provides easy processing of arguments\
      \ passed to Scribunto from\n-- #invoke. It is intended for use by other Lua modules, and should not be\n-- called from #invoke directly.\n\nlocal libraryUtil = require('libraryUtil')\nlocal checkType = libraryUtil.checkType\n\nlocal arguments = {}\n\n\
      -- Generate four different tidyVal functions, so that we don't have to check the\n-- options every time we call it.\n\nlocal function tidyValDefault(key, val)\n\tif type(val) == 'string' then\n\t\tval = val:match('^%s*(.-)%s*$')\n\t\tif val == '' then\n\
      \t\t\treturn nil\n\t\telse\n\t\t\treturn val\n\t\tend\n\telse\n\t\treturn val\n\tend\nend\n\nlocal function tidyValTrimOnly(key, val)\n\tif type(val) == 'string' then\n\t\treturn val:match('^%s*(.-)%s*$')\n\telse\n\t\treturn val\n\tend\nend\n\nlocal function\
      \ tidyValRemoveBlanksOnly(key, val)\n\tif type(val) == 'string' then\n\t\tif val:find('%S') then\n\t\t\treturn val\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn val\n\tend\nend\n\nlocal function tidyValNoChange(key, val)\n\treturn val\nend\n\
      \nfunction arguments.getArgs(frame, options)\n\tcheckType('getArgs', 1, frame, 'table', true)\n\tcheckType('getArgs', 2, options, 'table', true)\n\tframe = frame or {}\n\toptions = options or {}\n\n\t--[[\n\t-- Get the argument tables. If we were passed\
      \ a valid frame object, get the\n\t-- frame arguments (fargs) and the parent frame arguments (pargs), depending\n\t-- on the options set and on the parent frame's availability. If we weren't\n\t-- passed a valid frame object, we are being called from another\
      \ Lua module\n\t-- or from the debug console, so assume that we were passed a table of args\n\t-- directly, and assign it to a new variable (luaArgs).\n\t--]]\n\tlocal fargs, pargs, luaArgs\n\tif type(frame.args) == 'table' and type(frame.getParent) ==\
      \ 'function' then\n\t\tif options.wrappers then\n\t\t\t--[[\n\t\t\t-- The wrappers option makes Module:Arguments look up arguments in\n\t\t\t-- either the frame argument table or the parent argument table, but\n\t\t\t-- not both. This means that users\
      \ can use either the #invoke syntax\n\t\t\t-- or a wrapper template without the loss of performance associated\n\t\t\t-- with looking arguments up in both the frame and the parent frame.\n\t\t\t-- Module:Arguments will look up arguments in the parent frame\n\
      \t\t\t-- if it finds the parent frame's title in options.wrapper;\n\t\t\t-- otherwise it will look up arguments in the frame object passed\n\t\t\t-- to getArgs.\n\t\t\t--]]\n\t\t\tlocal parent = frame:getParent()\n\t\t\tif not parent then\n\t\t\t\tfargs\
      \ = frame.args\n\t\t\telse\n\t\t\t\tlocal title = parent:getTitle():gsub('/sandbox$', '')\n\t\t\t\tlocal found = false\n\t\t\t\tif type(options.wrappers) == 'table' then\n\t\t\t\t\tfor _,v in pairs(options.wrappers) do\n\t\t\t\t\t\tif v == title then\n\
      \t\t\t\t\t\t\tfound = true\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\telseif options.wrappers == title then\n\t\t\t\t\tfound = true\n\t\t\t\tend\n\t\t\t\t\n\t\t\t\t-- We test for false specifically here so that nil (the default) acts\
      \ like true.\n\t\t\t\tif found or options.frameOnly == false then\n\t\t\t\t\tpargs = parent.args\n\t\t\t\tend\n\t\t\t\tif not found or options.parentOnly == false then\n\t\t\t\t\tfargs = frame.args\n\t\t\t\tend\n\t\t\tend\n\t\telse\n\t\t\t-- options.wrapper\
      \ isn't set, so check the other options.\n\t\t\tif not options.parentOnly then\n\t\t\t\tfargs = frame.args\n\t\t\tend\n\t\t\tif not options.frameOnly then\n\t\t\t\tlocal parent = frame:getParent()\n\t\t\t\tpargs = parent and parent.args or nil\n\t\t\t\
      end\n\t\tend\n\t\tif options.parentFirst then\n\t\t\tfargs, pargs = pargs, fargs\n\t\tend\n\telse\n\t\tluaArgs = frame\n\tend\n\t\n\t-- Set the order of precedence of the argument tables. If the variables are\n\t-- nil, nothing will be added to the table,\
      \ which is how we avoid clashes\n\t-- between the frame/parent args and the Lua args.\t\n\tlocal argTables = {fargs}\n\targTables[#argTables + 1] = pargs\n\targTables[#argTables + 1] = luaArgs\n\n\t--[[\n\t-- Generate the tidyVal function. If it has been\
      \ specified by the user, we\n\t-- use that; if not, we choose one of four functions depending on the\n\t-- options chosen. This is so that we don't have to call the options table\n\t-- every time the function is called.\n\t--]]\n\tlocal tidyVal = options.valueFunc\n\
      \tif tidyVal then\n\t\tif type(tidyVal) ~= 'function' then\n\t\t\terror(\n\t\t\t\t&quot;bad value assigned to option 'valueFunc'&quot;\n\t\t\t\t\t.. '(function expected, got '\n\t\t\t\t\t.. type(tidyVal)\n\t\t\t\t\t.. ')',\n\t\t\t\t2\n\t\t\t)\n\t\tend\n\
      \telseif options.trim ~= false then\n\t\tif options.removeBlanks ~= false then\n\t\t\ttidyVal = tidyValDefault\n\t\telse\n\t\t\ttidyVal = tidyValTrimOnly\n\t\tend\n\telse\n\t\tif options.removeBlanks ~= false then\n\t\t\ttidyVal = tidyValRemoveBlanksOnly\n\
      \t\telse\n\t\t\ttidyVal = tidyValNoChange\n\t\tend\n\tend\n\n\t--[[\n\t-- Set up the args, metaArgs and nilArgs tables. args will be the one\n\t-- accessed from functions, and metaArgs will hold the actual arguments. Nil\n\t-- arguments are memoized in\
      \ nilArgs, and the metatable connects all of them\n\t-- together.\n\t--]]\n\tlocal args, metaArgs, nilArgs, metatable = {}, {}, {}, {}\n\tsetmetatable(args, metatable)\n\n\tlocal function mergeArgs(iterator, tables)\n\t\t--[[\n\t\t-- Accepts multiple tables\
      \ as input and merges their keys and values\n\t\t-- into one table using the specified iterator. If a value is already\n\t\t-- present it is not overwritten; tables listed earlier have precedence.\n\t\t-- We are also memoizing nil values, but those values\
      \ can be\n\t\t-- overwritten.\n\t\t--]]\n\t\tfor _, t in ipairs(tables) do\n\t\t\tfor key, val in iterator(t) do\n\t\t\t\tif metaArgs[key] == nil then\n\t\t\t\t\tlocal tidiedVal = tidyVal(key, val)\n\t\t\t\t\tif tidiedVal == nil then\n\t\t\t\t\t\tnilArgs[key]\
      \ = true\n\t\t\t\t\telse\n\t\t\t\t\t\tmetaArgs[key] = tidiedVal\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\n\t--[[\n\t-- Define metatable behaviour. Arguments are memoized in the metaArgs table,\n\t-- and are only fetched from the argument\
      \ tables once. Fetching arguments\n\t-- from the argument tables is the most resource-intensive step in this\n\t-- module, so we try and avoid it where possible. For this reason, nil\n\t-- arguments are also memoized, in the nilArgs table. Also, we keep\
      \ a record\n\t-- in the metatable of when pairs and ipairs have been called, so we do not\n\t-- run pairs and ipairs on the argument tables more than once. We also do\n\t-- not run ipairs on fargs and pargs if pairs has already been run, as all\n\t-- the\
      \ arguments will already have been copied over.\n\t--]]\n\n\tmetatable.__index = function (t, key)\n\t\t--[[\n\t\t-- Fetches an argument when the args table is indexed. First we check\n\t\t-- to see if the value is memoized, and if not we try and fetch\
      \ it from\n\t\t-- the argument tables. When we check memoization, we need to check\n\t\t-- metaArgs before nilArgs, as both can be non-nil at the same time.\n\t\t-- If the argument is not present in metaArgs, we also check whether\n\t\t-- pairs has been\
      \ run yet. If pairs has already been run, we return nil.\n\t\t-- This is because all the arguments will have already been copied into\n\t\t-- metaArgs by the mergeArgs function, meaning that any other arguments\n\t\t-- must be nil.\n\t\t--]]\n\t\tlocal\
      \ val = metaArgs[key]\n\t\tif val ~= nil then\n\t\t\treturn val\n\t\telseif metatable.donePairs or nilArgs[key] then\n\t\t\treturn nil\n\t\tend\n\t\tfor _, argTable in ipairs(argTables) do\n\t\t\tlocal argTableVal = tidyVal(key, argTable[key])\n\t\t\t\
      if argTableVal == nil then\n\t\t\t\tnilArgs[key] = true\n\t\t\telse\n\t\t\t\tmetaArgs[key] = argTableVal\n\t\t\t\treturn argTableVal\n\t\t\tend\n\t\tend\n\t\treturn nil\n\tend\n\n\tmetatable.__newindex = function (t, key, val)\n\t\t-- This function is\
      \ called when a module tries to add a new value to the\n\t\t-- args table, or tries to change an existing value.\n\t\tif options.readOnly then\n\t\t\terror(\n\t\t\t\t'could not write to argument table key &quot;'\n\t\t\t\t\t.. tostring(key)\n\t\t\t\t\t\
      .. '&quot;; the table is read-only',\n\t\t\t\t2\n\t\t\t)\n\t\telseif options.noOverwrite and args[key] ~= nil then\n\t\t\terror(\n\t\t\t\t'could not write to argument table key &quot;'\n\t\t\t\t\t.. tostring(key)\n\t\t\t\t\t.. '&quot;; overwriting existing\
      \ arguments is not permitted',\n\t\t\t\t2\n\t\t\t)\n\t\telseif val == nil then\n\t\t\t--[[\n\t\t\t-- If the argument is to be overwritten with nil, we need to erase\n\t\t\t-- the value in metaArgs, so that __index, __pairs and __ipairs do\n\t\t\t-- not\
      \ use a previous existing value, if present; and we also need\n\t\t\t-- to memoize the nil in nilArgs, so that the value isn't looked\n\t\t\t-- up in the argument tables if it is accessed again.\n\t\t\t--]]\n\t\t\tmetaArgs[key] = nil\n\t\t\tnilArgs[key]\
      \ = true\n\t\telse\n\t\t\tmetaArgs[key] = val\n\t\tend\n\tend\n\n\tmetatable.__pairs = function ()\n\t\t-- Called when pairs is run on the args table.\n\t\tif not metatable.donePairs then\n\t\t\tmergeArgs(pairs, argTables)\n\t\t\tmetatable.donePairs =\
      \ true\n\t\t\tmetatable.doneIpairs = true\n\t\tend\n\t\treturn pairs(metaArgs)\n\tend\n\n\tmetatable.__ipairs = function ()\n\t\t-- Called when ipairs is run on the args table.\n\t\tif not metatable.doneIpairs then\n\t\t\tmergeArgs(ipairs, argTables)\n\
      \t\t\tmetatable.doneIpairs = true\n\t\tend\n\t\treturn ipairs(metaArgs)\n\tend\n\n\treturn args\nend\n\nreturn arguments</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:06.595Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AHtmlBuilder&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:06 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103483143, 3589274070, 4115541181
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38663961\" ns=\"828\" title=\"Module:HtmlBuilder\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2013-09-18T15:22:39Z\" comment=\"don&#039;t add attributes with no\
      \ values, plus a couple of minor tweaks\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- Module for building complex HTML (e.g. infoboxes, navboxes) using a fluent interface.\n\nlocal HtmlBuilder = {}\n\nlocal metatable\
      \ = {}\n\nmetatable.__index = function(t, key)\n    local ret = rawget(t, key)\n    if ret then\n        return ret\n    end\n    \n    ret = metatable[key]\n    if type(ret) == 'function' then\n        return function(...) \n            return ret(t,\
      \ ...) \n        end \n    else\n        return ret\n    end\nend\n\nmetatable.__tostring = function(t)\n    local ret = {}\n    t._build(ret)\n    return table.concat(ret)\nend\n\nmetatable._build = function(t, ret)\n    if t.tagName then \n        table.insert(ret,\
      \ '&lt;' .. t.tagName)\n        for i, attr in ipairs(t.attributes) do\n            table.insert(ret, ' ' .. attr.name .. '=&quot;' .. attr.val .. '&quot;') \n        end\n        if #t.styles &gt; 0 then\n            table.insert(ret, ' style=&quot;')\n\
      \            for i, prop in ipairs(t.styles) do\n                if type(prop) == 'string' then -- added with cssText()\n                    table.insert(ret, prop .. ';')\n                else -- added with css()\n                    table.insert(ret,\
      \ prop.name .. ':' .. prop.val .. ';')\n                end\n            end\n            table.insert(ret, '&quot;')\n        end\n        if t.selfClosing then\n            table.insert(ret, ' /')\n        end\n        table.insert(ret, '&gt;') \n  \
      \  end\n    for i, node in ipairs(t.nodes) do\n        if node then\n            if type(node) == 'table' then\n                node._build(ret)\n            else\n                table.insert(ret, tostring(node))\n            end\n        end\n    end\n\
      \    if t.tagName and not t.unclosed and not t.selfClosing then\n        table.insert(ret, '&lt;/' .. t.tagName .. '&gt;')\n    end\nend\n\nmetatable.node = function(t, builder)\n    if builder then\n        table.insert(t.nodes, builder)\n    end\n  \
      \  return t\nend\n\nmetatable.wikitext = function(t, ...) \n    local vals = {...}\n    for i = 1, #vals do\n        if vals[i] then\n            table.insert(t.nodes, vals[i])\n        end\n    end\n    return t\nend\n\nmetatable.newline = function(t)\n\
      \    table.insert(t.nodes, '\\n')\n    return t\nend\n\nmetatable.tag = function(t, tagName, args)\n    args = args or {}\n    args.parent = t\n    local builder = HtmlBuilder.create(tagName, args)\n    table.insert(t.nodes, builder)\n    return builder\n\
      end\n\nlocal function getAttr(t, name)\n    for i, attr in ipairs(t.attributes) do\n        if attr.name == name then\n            return attr\n        end\n    end\nend\n\nmetatable.attr = function(t, name, val)\n    if type(val) == 'string' or type(val)\
      \ == 'number' then\n        -- if caller sets the style attribute explicitly, then replace all styles previously added with css() and cssText()\n        if name == 'style' then\n            t.styles = {val}\n            return t\n        end\n        \n\
      \        local attr = getAttr(t, name)\n        if attr then\n            attr.val = val\n        else\n            table.insert(t.attributes, {name = name, val = val})\n        end\n    end\n    \n    return t\nend\n\nmetatable.addClass = function(t,\
      \ class)\n    if class then\n        local attr = getAttr(t, 'class')\n        if attr then\n            attr.val = attr.val .. ' ' .. class\n        else\n            t.attr('class', class)\n        end\n    end\n    \n    return t\nend\n\nmetatable.css\
      \ = function(t, name, val)\n    if type(val) == 'string' or type(val) == 'number' then\n        for i, prop in ipairs(t.styles) do\n            if prop.name == name then\n                prop.val = val\n                return t\n            end\n     \
      \   end\n        \n        table.insert(t.styles, {name = name, val = val})\n    end\n    \n    return t\nend\n\nmetatable.cssText = function(t, css)\n    if css then\n        table.insert(t.styles, css)\n    end\n    return t\nend\n\nmetatable.done =\
      \ function(t)\n    return t.parent or t\nend\n\nmetatable.allDone = function(t)\n    while t.parent do\n        t = t.parent\n    end\n    return t\nend\n\nfunction HtmlBuilder.create(tagName, args)\n    args = args or {}\n    local builder = {}\n    setmetatable(builder,\
      \ metatable)\n    builder.nodes = {}\n    builder.attributes = {}\n    builder.styles = {}\n    builder.tagName = tagName\n    builder.parent = args.parent\n    builder.unclosed = args.unclosed or false\n    builder.selfClosing = args.selfClosing or false\n\
      \    return builder\nend\n\nreturn HtmlBuilder</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:07.216Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:06 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq44 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530264414, 3460489375, 4115541462
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"39772274\" ns=\"828\" title=\"Module:Category handler\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-22T05:08:26Z\" comment=\"allow invocations specifying\
      \ the page parameter to use the mw.loadData optimisations, and don&#039;t call mw.title.new every time\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n\
      --                                                                            --\n--                              CATEGORY HANDLER                              --\n--                                                                            --\n--   \
      \   This module implements the {{category handler}} template in Lua,      --\n--      with a few improvements: all namespaces and all namespace aliases     --\n--      are supported, and namespace names are detected automatically for     --\n--      the\
      \ local wiki. This module requires [[Module:Namespace detect]]      --\n--      and [[Module:Yesno]] to be available on the local wiki. It can be     --\n--      configured for different wikis by altering the values in              --\n--      [[Module:Category\
      \ handler/config]], and pages can be blacklisted      --\n--      from categorisation by using [[Module:Category handler/blacklist]].   --\n--                                                                            --\n--------------------------------------------------------------------------------\n\
      \n-- Load required modules\nlocal yesno = require('Module:Yesno')\n\n-- Lazily load things we don't always need\nlocal mShared, mappings\n\nlocal p = {}\n\n--------------------------------------------------------------------------------\n-- Helper functions\n\
      --------------------------------------------------------------------------------\n\nlocal function trimWhitespace(s, removeBlanks)\n\tif type(s) ~= 'string' then\n\t\treturn s\n\tend\n\ts = s:match('^%s*(.-)%s*$')\n\tif removeBlanks then\n\t\tif s ~= ''\
      \ then\n\t\t\treturn s\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn s\n\tend\nend\n\n--------------------------------------------------------------------------------\n-- CategoryHandler class\n--------------------------------------------------------------------------------\n\
      \nlocal CategoryHandler = {}\nCategoryHandler.__index = CategoryHandler\n\nfunction CategoryHandler.new(data, args)\n\tlocal obj = setmetatable({ _data = data, _args = args }, CategoryHandler)\n\t\n\t-- Set the title object\n\tdo\n\t\tlocal pagename =\
      \ obj:parameter('demopage')\n\t\tlocal success, titleObj\n\t\tif pagename then\n\t\t\tsuccess, titleObj = pcall(mw.title.new, pagename)\n\t\tend\n\t\tif success and titleObj then\n\t\t\tobj.title = titleObj\n\t\t\tif titleObj == mw.title.getCurrentTitle()\
      \ then\n\t\t\t\tobj._usesCurrentTitle = true\n\t\t\tend\n\t\telse\n\t\t\tobj.title = mw.title.getCurrentTitle()\n\t\t\tobj._usesCurrentTitle = true\n\t\tend\n\tend\n\n\t-- Set suppression parameter values\n\tfor _, key in ipairs{'nocat', 'categories'}\
      \ do\n\t\tlocal value = obj:parameter(key)\n\t\tvalue = trimWhitespace(value, true)\n\t\tobj['_' .. key] = yesno(value)\n\tend\n\tdo\n\t\tlocal subpage = obj:parameter('subpage')\n\t\tlocal category2 = obj:parameter('category2')\n\t\tif type(subpage) ==\
      \ 'string' then\n\t\t\tsubpage = mw.ustring.lower(subpage)\n\t\tend\n\t\tif type(category2) == 'string' then\n\t\t\tsubpage = mw.ustring.lower(category2)\n\t\tend\n\t\tobj._subpage = trimWhitespace(subpage, true)\n\t\tobj._category2 = trimWhitespace(category2)\
      \ -- don't remove blank values\n\tend\n\treturn obj\nend\n\nfunction CategoryHandler:parameter(key)\n\tlocal parameterNames = self._data.parameters[key]\n\tlocal pntype = type(parameterNames)\n\tif pntype == 'string' or pntype == 'number' then\n\t\treturn\
      \ self._args[parameterNames]\n\telseif pntype == 'table' then\n\t\tfor _, name in ipairs(parameterNames) do\n\t\t\tlocal value = self._args[name]\n\t\t\tif value ~= nil then\n\t\t\t\treturn value\n\t\t\tend\n\t\tend\n\t\treturn nil\n\telse\n\t\terror(string.format(\n\
      \t\t\t'invalid config key &quot;%s&quot;',\n\t\t\ttostring(key)\n\t\t), 2)\n\tend\nend\n\nfunction CategoryHandler:isSuppressedByArguments()\n\treturn\n\t\t-- See if a category suppression argument has been set.\n\t\tself._nocat == true\n\t\tor self._categories\
      \ == false\n\t\tor (\n\t\t\tself._category2\n\t\t\tand self._category2 ~= self._data.category2Yes\n\t\t\tand self._category2 ~= self._data.category2Negative\n\t\t)\n\n\t\t-- Check whether we are on a subpage, and see if categories are\n\t\t-- suppressed\
      \ based on our subpage status.\n\t\tor self._subpage == self._data.subpageNo and self.title.isSubpage\n\t\tor self._subpage == self._data.subpageOnly and not self.title.isSubpage\nend\n\nfunction CategoryHandler:shouldSkipBlacklistCheck()\n\t-- Check whether\
      \ the category suppression arguments indicate we\n\t-- should skip the blacklist check.\n\treturn self._nocat == false\n\t\tor self._categories == true\n\t\tor self._category2 == self._data.category2Yes\nend\n\nfunction CategoryHandler:matchesBlacklist()\n\
      \tif self._usesCurrentTitle then\n\t\treturn self._data.currentTitleMatchesBlacklist\n\telse\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\treturn mShared.matchesBlacklist(\n\t\t\tself.title.prefixedText,\n\t\t\tmw.loadData('Module:Category\
      \ handler/blacklist')\n\t\t)\n\tend\nend\n\nfunction CategoryHandler:isSuppressed()\n\t-- Find if categories are suppressed by either the arguments or by\n\t-- matching the blacklist.\n\treturn self:isSuppressedByArguments()\n\t\tor not self:shouldSkipBlacklistCheck()\
      \ and self:matchesBlacklist()\nend\n\nfunction CategoryHandler:getNamespaceParameters()\n\tif self._usesCurrentTitle then\n\t\treturn self._data.currentTitleNamespaceParameters\n\telse\n\t\tif not mappings then\n\t\t\tmShared = mShared or require('Module:Category\
      \ handler/shared')\n\t\t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\t\tend\n\t\treturn mShared.getNamespaceParameters(\n\t\t\tself.title,\n\t\t\tmappings\n\t\t)\n\tend\nend\n\nfunction CategoryHandler:namespaceParametersExist()\n\
      \t-- Find whether any namespace parameters have been specified.\n\t-- We use the order &quot;all&quot; --&gt; namespace params --&gt; &quot;other&quot; as this is what\n\t-- the old template did.\n\tif self:parameter('all') then\n\t\treturn true\n\tend\n\
      \tif not mappings then\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\tend\n\tfor ns, params in pairs(mappings) do\n\t\tfor i, param in ipairs(params)\
      \ do\n\t\t\tif self._args[param] then\n\t\t\t\treturn true\n\t\t\tend\n\t\tend\n\tend\n\tif self:parameter('other') then\n\t\treturn true\n\tend\n\treturn false\nend\n\nfunction CategoryHandler:getCategories()\n\tlocal params = self:getNamespaceParameters()\n\
      \tlocal nsCategory\n\tfor i, param in ipairs(params) do\n\t\tlocal value = self._args[param]\n\t\tif value ~= nil then\n\t\t\tnsCategory = value\n\t\t\tbreak\n\t\tend\n\tend\n\tif nsCategory ~= nil or self:namespaceParametersExist() then\n\t\t-- Namespace\
      \ parameters exist - advanced usage.\n\t\tif nsCategory == nil then\n\t\t\tnsCategory = self:parameter('other')\n\t\tend\n\t\tlocal ret = {self:parameter('all')}\n\t\tlocal numParam = tonumber(nsCategory)\n\t\tif numParam and numParam &gt;= 1 and math.floor(numParam)\
      \ == numParam then\n\t\t\t-- nsCategory is an integer\n\t\t\tret[#ret + 1] = self._args[numParam]\n\t\telse\n\t\t\tret[#ret + 1] = nsCategory\n\t\tend\n\t\tif #ret &lt; 1 then\n\t\t\treturn nil\n\t\telse\n\t\t\treturn table.concat(ret)\n\t\tend\n\telseif\
      \ self._data.defaultNamespaces[self.title.namespace] then\n\t\t-- Namespace parameters don't exist, simple usage.\n\t\treturn self._args[1]\n\tend\n\treturn nil\nend\n\n--------------------------------------------------------------------------------\n\
      -- Exports\n--------------------------------------------------------------------------------\n\nlocal p = {}\n\nfunction p._exportClasses()\n\t-- Used for testing purposes.\n\treturn {\n\t\tCategoryHandler = CategoryHandler\n\t}\nend\n\nfunction p._main(args,\
      \ data)\n\tdata = data or mw.loadData('Module:Category handler/data')\n\tlocal handler = CategoryHandler.new(data, args)\n\tif handler:isSuppressed() then\n\t\treturn nil\n\tend\n\treturn handler:getCategories()\nend\n\nfunction p.main(frame, data)\n\t\
      data = data or mw.loadData('Module:Category handler/data')\n\tlocal args = require('Module:Arguments').getArgs(frame, {\n\t\twrappers = data.wrappers,\n\t\tvalueFunc = function (k, v)\n\t\t\tv = trimWhitespace(v)\n\t\t\tif type(k) == 'number' then\n\t\t\
      \t\tif v ~= '' then\n\t\t\t\t\treturn v\n\t\t\t\telse\n\t\t\t\t\treturn nil\n\t\t\t\tend\n\t\t\telse\n\t\t\t\treturn v\n\t\t\tend\n\t\tend\n\t})\n\treturn p._main(args, data)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:07.488Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AYesno&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:07 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025855114, 269519034, 4115541965
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38665046\" ns=\"828\" title=\"Module:Yesno\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-04-18T10:35:42Z\" comment=\"use the Lua string.lower function instead\
      \ of mw.ustring.lower; this makes the function around 25x faster\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- Function allowing for consistent treatment of boolean-like wikitext input.\n-- It works similarly to the\
      \ template {{yesno}}.\n\nreturn function (val, default)\n\t-- If your wiki uses non-ascii characters for any of &quot;yes&quot;, &quot;no&quot;, etc., you\n\t-- should replace &quot;val:lower()&quot; with &quot;mw.ustring.lower(val)&quot; in the\n\t--\
      \ following line.\n\tval = type(val) == 'string' and val:lower() or val\n\tif val == nil then\n\t\treturn nil\n\telseif val == true \n\t\tor val == 'yes'\n\t\tor val == 'y'\n\t\tor val == 'true'\n\t\tor tonumber(val) == 1\n\tthen\n\t\treturn true\n\telseif\
      \ val == false\n\t\tor val == 'no'\n\t\tor val == 'n'\n\t\tor val == 'false'\n\t\tor tonumber(val) == 0\n\tthen\n\t\treturn false\n\telse\n\t\treturn default\n\tend\nend</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:09.444Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AMessage+box%2Fconfiguration&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:07 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348942179, 3156553782, 4115542290
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"40627038\" ns=\"828\" title=\"Module:Message box/configuration\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-01-27T01:07:32Z\" comment=\"allow the hidden arg\
      \ to be blank, and allow tmbox to have an id attribute, per protected edit request by [[User:Technical 13]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">local ambox = {\n\ttypes = {\n\t\tspeedy = {\n\t\t\tclass = 'ambox-speedy',\n\
      \t\t\timage = 'Ambox speedy deletion.png'\n\t\t},\n\t\tdelete = {\n\t\t\tclass = 'ambox-delete',\n\t\t\timage = 'Ambox deletion.png'\n\t\t},\n\t\tcontent = {\n\t\t\tclass = 'ambox-content',\n\t\t\timage = 'Ambox content.png'\n\t\t},\n\t\tstyle = {\n\t\t\
      \tclass = 'ambox-style',\n\t\t\timage = 'Edit-clear.svg'\n\t\t},\n\t\tmove = {\n\t\t\tclass = 'ambox-move',\n\t\t\timage = 'Ambox move.png'\n\t\t},\n\t\tprotection = {\n\t\t\tclass = 'ambox-protection',\n\t\t\timage = 'Ambox protection.png'\n\t\t},\n\t\
      \tnotice = {\n\t\t\tclass = 'ambox-notice',\n\t\t\timage = 'Ambox notice.png'\n\t\t}\n\t},\n\tdefault                     = 'notice',\n\tallowBlankParams            = {'talk', 'sect', 'date', 'issue', 'fix', 'subst', 'hidden'},\n\tallowSmall          \
      \        = true,\n\tsmallParam                  = 'left',\n\tsmallClass                  = 'mbox-small-left',\n\tsubstCheck                  = true,\n\tclasses                     = {'metadata', 'plainlinks', 'ambox'},\n\timageEmptyCell              =\
      \ true,\n\timageCheckBlank             = true,\n\timageSmallSize              = '20x20px',\n\timageCellDiv                = true,\n\tuseCollapsibleTextFields    = true,\n\timageRightNone              = true,\n\tsectionDefault              = 'article',\n\
      \tallowMainspaceCategories    = true,\n\ttemplateCategory            = 'Article message templates',\n        templateCategoryRequireName = true,\n\ttemplateErrorCategory       = 'Article message templates with missing parameters',\n\ttemplateErrorParamsToCheck\
      \  = {'issue', 'fix', 'subst'}\n}\n\nlocal cmbox = {\n\ttypes = {\n\t\tspeedy = {\n\t\t\tclass = 'cmbox-speedy',\n\t\t\timage = 'Cmbox deletion.png'\n\t\t},\n\t\tdelete = {\n\t\t\tclass = 'cmbox-delete',\n\t\t\timage = 'Cmbox deletion.png'\n\t\t},\n\t\t\
      content = {\n\t\t\tclass = 'cmbox-content',\n\t\t\timage = 'Cmbox content.png'\n\t\t},\n\t\tstyle = {\n\t\t\tclass = 'cmbox-style',\n\t\t\timage = 'Edit-clear.svg'\n\t\t},\n\t\tmove = {\n\t\t\tclass = 'cmbox-move',\n\t\t\timage = 'Cmbox move.png'\n\t\t\
      },\n\t\tprotection = {\n\t\t\tclass = 'cmbox-protection',\n\t\t\timage = 'Cmbox protection.png'\n\t\t},\n\t\tnotice = {\n\t\t\tclass = 'cmbox-notice',\n\t\t\timage = 'Cmbox notice.png'\n\t\t}\n\t},\n\tdefault              = 'notice',\n\tshowInvalidTypeError\
      \ = true,\n\tclasses              = {'plainlinks', 'cmbox'},\n\timageEmptyCell       = true\n}\n\nlocal fmbox = {\n\ttypes = {\n\t\twarning = {\n\t\t\tclass = 'fmbox-warning',\n\t\t\timage = 'Cmbox deletion.png'\n\t\t},\n\t\teditnotice = {\n\t\t\tclass\
      \ = 'fmbox-editnotice',\n\t\t\timage = 'Imbox notice.png'\n\t\t},\n\t\tsystem = {\n\t\t\tclass = 'fmbox-system',\n\t\t\timage = 'Imbox notice.png'\n\t\t}\n\t},\n\tdefault              = 'system',\n\tshowInvalidTypeError = true,\n\tallowId             \
      \   = true,\n\tclasses              = {'plainlinks', 'fmbox'},\n\timageEmptyCell       = false,\n\timageRightNone       = false\n}\n\nlocal imbox = {\n\ttypes = {\n\t\tspeedy = {\n\t\t\tclass = 'imbox-speedy',\n\t\t\timage = 'Imbox speedy deletion.png'\n\
      \t\t},\n\t\tdelete = {\n\t\t\tclass = 'imbox-delete',\n\t\t\timage = 'Imbox deletion.png'\n\t\t},\n\t\tcontent = {\n\t\t\tclass = 'imbox-content',\n\t\t\timage = 'Imbox content.png'\n\t\t},\n\t\tstyle = {\n\t\t\tclass = 'imbox-style',\n\t\t\timage = 'Edit-clear.svg'\n\
      \t\t},\n\t\tmove = {\n\t\t\tclass = 'imbox-move',\n\t\t\timage = 'Imbox move.png'\n\t\t},\n\t\tprotection = {\n\t\t\tclass = 'imbox-protection',\n\t\t\timage = 'Imbox protection.png'\n\t\t},\n\t\tlicense = {\n\t\t\tclass = 'imbox-license',\n\t\t\timage\
      \ = 'Imbox license.png'\n\t\t},\n\t\tfeatured = {\n\t\t\tclass = 'imbox-featured',\n\t\t\timage = 'Imbox featured.png'\n\t\t},\n\t\tnotice = {\n\t\t\tclass = 'imbox-notice',\n\t\t\timage = 'Imbox notice.png'\n\t\t}\n\t},\n\tdefault              = 'notice',\n\
      \tshowInvalidTypeError = true,\n\tclasses              = {'imbox'},\n\tusePlainlinksParam   = true,\n\timageEmptyCell       = true,\n\tbelow                = true,\n\ttemplateCategory     = 'File message boxes'\n}\n\nlocal ombox = {\n\ttypes = {\n\t\t\
      speedy = {\n\t\t\tclass = 'ombox-speedy',\n\t\t\timage = 'Imbox speedy deletion.png'\n\t\t},\n\t\tdelete = {\n\t\t\tclass = 'ombox-delete',\n\t\t\timage = 'Imbox deletion.png'\n\t\t},\n\t\tcontent = {\n\t\t\tclass = 'ombox-content',\n\t\t\timage = 'Imbox\
      \ content.png'\n\t\t},\n\t\tstyle = {\n\t\t\tclass = 'ombox-style',\n\t\t\timage = 'Edit-clear.svg'\n\t\t},\n\t\tmove = {\n\t\t\tclass = 'ombox-move',\n\t\t\timage = 'Imbox move.png'\n\t\t},\n\t\tprotection = {\n\t\t\tclass = 'ombox-protection',\n\t\t\t\
      image = 'Imbox protection.png'\n\t\t},\n\t\tnotice = {\n\t\t\tclass = 'ombox-notice',\n\t\t\timage = 'Imbox notice.png'\n\t\t}\n\t},\n\tdefault              = 'notice',\n\tshowInvalidTypeError = true,\n\tclasses              = {'plainlinks', 'ombox'},\n\
      \tallowSmall           = true,\n\timageEmptyCell       = true,\n\timageRightNone       = true\n}\n\nlocal tmbox = {\n\ttypes = {\n\t\tspeedy = {\n\t\t\tclass = 'tmbox-speedy',\n\t\t\timage = 'Imbox speedy deletion.png'\n\t\t},\n\t\tdelete = {\n\t\t\tclass\
      \ = 'tmbox-delete',\n\t\t\timage = 'Imbox deletion.png'\n\t\t},\n\t\tcontent = {\n\t\t\tclass = 'tmbox-content',\n\t\t\timage = 'Imbox content.png'\n\t\t},\n\t\tstyle = {\n\t\t\tclass = 'tmbox-style',\n\t\t\timage = 'Edit-clear.svg '\n\t\t},\n\t\tmove\
      \ = {\n\t\t\tclass = 'tmbox-move',\n\t\t\timage = 'Imbox move.png'\n\t\t},\n\t\tprotection = {\n\t\t\tclass = 'tmbox-protection',\n\t\t\timage = 'Imbox protection.png'\n\t\t},\n\t\tnotice = {\n\t\t\tclass = 'tmbox-notice',\n\t\t\timage = 'Imbox notice.png'\n\
      \t\t}\n\t},\n\tdefault              = 'notice',\n\tshowInvalidTypeError = true,\n\tclasses              = {'plainlinks', 'tmbox'},\n\tallowId              = true,\n\tallowSmall           = true,\n\timageRightNone       = true,\n\timageEmptyCell       =\
      \ true,\n\timageEmptyCellStyle  = true,\n\ttemplateCategory     = 'Talk message boxes'\n}\n\nreturn {\n\tambox = ambox,\n\tcmbox = cmbox,\n\tfmbox = fmbox,\n\timbox = imbox,\n\tombox = ombox,\n\ttmbox = tmbox\n}</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:09.809Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fdata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:09 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404069402, 319058483, 4115544902
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"43233647\" ns=\"828\" title=\"Module:Category handler/data\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:05:55Z\" comment=\"Protected Module:Category\
      \ handler/data: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"\
      preserve\">-- This module assembles data to be passed to [[Module:Category handler]] using\n-- mw.loadData. This includes the configuration data and whether the current\n-- page matches the title blacklist.\n\nlocal data = require('Module:Category handler/config')\n\
      local mShared = require('Module:Category handler/shared')\nlocal blacklist = require('Module:Category handler/blacklist')\nlocal title = mw.title.getCurrentTitle()\n\ndata.currentTitleMatchesBlacklist = mShared.matchesBlacklist(\n\ttitle.prefixedText,\n\
      \tblacklist\n)\n\ndata.currentTitleNamespaceParameters = mShared.getNamespaceParameters(\n\ttitle,\n\tmShared.getParamMappings()\n)\n\nreturn data</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:11.202Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fconfig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:10 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530270035, 3439949146, 4115545445
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42291997\" ns=\"828\" title=\"Module:Category handler/config\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:05:36Z\" comment=\"Protected Module:Category\
      \ handler/config: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"\
      preserve\">--------------------------------------------------------------------------------\n--            [[Module:Category handler]] configuration data                  --\n--       Language-specific parameter names and values can be set here.      \
      \  --\n--       For blacklist config, see [[Module:Category handler/blacklist]].     --\n--------------------------------------------------------------------------------\n\nlocal cfg = {} -- Don't edit this line.\n\n--------------------------------------------------------------------------------\n\
      --                       Start configuration data                             --\n--------------------------------------------------------------------------------\n\n--------------------------------------------------------------------------------\n-- \
      \                             Parameter names                               --\n-- These configuration items specify custom parameter names.                  --\n-- To add one extra name, you can use this format:                            --\n--     \
      \                                                                       --\n-- foo = 'parameter name',                                                    --\n--                                                                            --\n-- To add multiple\
      \ names, you can use this format:                            --\n--                                                                            --\n-- foo = {'parameter name 1', 'parameter name 2', 'parameter name 3'},        --\n--------------------------------------------------------------------------------\n\
      \ncfg.parameters = {\n\t\n\t-- The nocat and categories parameter suppress\n\t-- categorisation. They are used with Module:Yesno, and work as follows:\n\t--\n\t-- cfg.nocat:\n\t-- Result of yesno()                        Effect\n\t-- true             \
      \                        Categorisation is suppressed\n\t-- false                                    Categorisation is allowed, and\n\t--                                          the blacklist check is skipped\n\t-- nil                                \
      \      Categorisation is allowed\n\t--\n\t-- cfg.categories:\n\t-- Result of yesno()                        Effect\n\t-- true                                     Categorisation is allowed, and\n\t--                                          the blacklist\
      \ check is skipped\n\t-- false                                    Categorisation is suppressed\n\t-- nil                                      Categorisation is allowed\n\tnocat = 'nocat',\n\tcategories = 'categories',\n\t\n\t-- The parameter name for the\
      \ legacy &quot;category2&quot; parameter. This skips the\n\t-- blacklist if set to the cfg.category2Yes value, and suppresses\n\t-- categorisation if present but equal to anything other than\n\t-- cfg.category2Yes or cfg.category2Negative.\n\tcategory2\
      \ = 'category2',\n\t\n\t-- cfg.subpage is the parameter name to specify how to behave on subpages.\n\tsubpage = 'subpage',\n\t\n\t-- The parameter for data to return in all namespaces.\n\tall = 'all',\n\t\n\t-- The parameter name for data to return if\
      \ no data is specified for the\n\t-- namespace that is detected.\n\tother = 'other',\n\t\n\t-- The parameter name used to specify a page other than the current page;\n\t-- used for testing and demonstration.\n\tdemopage = 'page',\n}\n\n--------------------------------------------------------------------------------\n\
      --                              Parameter values                              --\n-- These are set values that can be used with certain parameters. Only one    --\n-- value can be specified, like this:                                         --\n--   \
      \                                                                         --\n-- cfg.foo = 'value name'                                                     --                                               --\n--------------------------------------------------------------------------------\n\
      \n-- The following settings are used with the cfg.category2 parameter. Setting\n-- cfg.category2 to cfg.category2Yes skips the blacklist, and if cfg.category2\n-- is present but equal to anything other than cfg.category2Yes or\n-- cfg.category2Negative\
      \ then it supresses cateogrisation.\ncfg.category2Yes = 'yes'\ncfg.category2Negative = '¬'\n\n-- The following settings are used with the cfg.subpage parameter.\n-- cfg.subpageNo is the value to specify to not categorise on subpages;\n-- cfg.subpageOnly\
      \ is the value to specify to only categorise on subpages.\ncfg.subpageNo = 'no'\ncfg.subpageOnly = 'only'\n\n--------------------------------------------------------------------------------\n--                           Default namespaces             \
      \                  --\n-- This is a table of namespaces to categorise by default. The keys are the   --\n-- namespace numbers.                                                         --\n--------------------------------------------------------------------------------\n\
      \ncfg.defaultNamespaces = {\n\t[  0] = true, -- main\n\t[  6] = true, -- file\n\t[ 12] = true, -- help\n\t[ 14] = true, -- category\n\t[100] = true, -- portal\n\t[108] = true, -- book\n}\n\n--------------------------------------------------------------------------------\n\
      --                                Wrappers                                    --\n-- This is a wrapper template or a list of wrapper templates to be passed to  --\n-- [[Module:Arguments]].                                                      --\n--------------------------------------------------------------------------------\n\
      \ncfg.wrappers = 'Template:Category handler'\n\n--------------------------------------------------------------------------------\n--                           End configuration data                           --\n--------------------------------------------------------------------------------\n\
      \nreturn cfg -- Don't edit this line.</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:11.904Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fshared&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:11 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq61 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226986591, 3811643543, 4115546475
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"43232937\" ns=\"828\" title=\"Module:Category handler/shared\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:06:15Z\" comment=\"Protected Module:Category\
      \ handler/shared: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"\
      preserve\">-- This module contains shared functions used by [[Module:Category handler]]\n-- and its submodules.\n\nlocal p = {}\n\nfunction p.matchesBlacklist(page, blacklist)\n\tfor i, pattern in ipairs(blacklist) do\n\t\tlocal match = mw.ustring.match(page,\
      \ pattern)\n\t\tif match then\n\t\t\treturn true\n\t\tend\n\tend\n\treturn false\nend\n\nfunction p.getParamMappings(useLoadData)\n\tlocal dataPage = 'Module:Namespace detect/data'\n\tif useLoadData then\n\t\treturn mw.loadData(dataPage).mappings\n\telse\n\
      \t\treturn require(dataPage).mappings\n\tend\nend\n\nfunction p.getNamespaceParameters(titleObj, mappings)\n\t-- We don't use title.nsText for the namespace name because it adds\n\t-- underscores.\n\tlocal mappingsKey\n\tif titleObj.isTalkPage then\n\t\
      \tmappingsKey = 'talk'\n\telse\n\t\tmappingsKey = mw.site.namespaces[titleObj.namespace].name\n\tend\n\tmappingsKey = mw.ustring.lower(mappingsKey)\n\treturn mappings[mappingsKey] or {}\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:12.248Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fblacklist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:12 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404073090, 319060043, 4115546927
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"43232926\" ns=\"828\" title=\"Module:Category handler/blacklist\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:07:09Z\" comment=\"Protected Module:Category\
      \ handler/blacklist: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"\
      preserve\">-- This module contains the blacklist used by [[Module:Category handler]].\n-- Pages that match Lua patterns in this list will not be categorised unless\n-- categorisation is explicitly requested.\n\nreturn {\n    '^Main Page$', -- don't categorise\
      \ the main page.\n \n    -- Don't categorise the following pages or their subpages.\n    -- &quot;%f[/\\0]&quot; matches if the next character is &quot;/&quot; or the end of the string.\n    '^Wikipedia:Cascade%-protected items%f[/\\0]',\n    '^User:UBX%f[/\\\
      0]', -- The userbox &quot;template&quot; space.\n    '^User talk:UBX%f[/\\0]',\n \n    -- Don't categorise subpages of these pages, but allow\n    -- categorisation of the base page.\n    '^Wikipedia:Template messages/.*$',\n \n    '/[aA]rchive' -- Don't\
      \ categorise archives.\n}</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:12.604Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANamespace+detect%2Fdata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:12 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq53 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348949647, 4205992607, 4115547210
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42257476\" ns=\"828\" title=\"Module:Namespace detect/data\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-04-05T17:02:16Z\" comment=\"bug fix - use the demospace\
      \ parameter as both key and value in the argKeys table\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n--                          Namespace\
      \ detect data                             --\n-- This module holds data for [[Module:Namespace detect]] to be loaded per    --\n-- page, rather than per #invoke, for performance reasons.                    --\n--------------------------------------------------------------------------------\n\
      \nlocal cfg = require('Module:Namespace detect/config')\n\nlocal function addKey(t, key, defaultKey)\n\tif key ~= defaultKey then\n\t\tt[#t + 1] = key\n\tend\nend\n\n-- Get a table of parameters to query for each default parameter name.\n-- This allows\
      \ wikis to customise parameter names in the cfg table while\n-- ensuring that default parameter names will always work. The cfg table\n-- values can be added as a string, or as an array of strings.\n\nlocal defaultKeys = {\n\t'main',\n\t'talk',\n\t'other',\n\
      \t'subjectns',\n\t'demospace',\n\t'demopage'\n}\n\nlocal argKeys = {}\nfor i, defaultKey in ipairs(defaultKeys) do\n\targKeys[defaultKey] = {defaultKey}\nend\n\nfor defaultKey, t in pairs(argKeys) do\n\tlocal cfgValue = cfg[defaultKey]\n\tlocal cfgValueType\
      \ = type(cfgValue)\n\tif cfgValueType == 'string' then\n\t\taddKey(t, cfgValue, defaultKey)\n\telseif cfgValueType == 'table' then\n\t\tfor i, key in ipairs(cfgValue) do\n\t\t\taddKey(t, key, defaultKey)\n\t\tend\n\tend\n\tcfg[defaultKey] = nil -- Free\
      \ the cfg value as we don't need it any more.\nend\n\nlocal function getParamMappings()\n\t--[[\n\t-- Returns a table of how parameter names map to namespace names. The keys\n\t-- are the actual namespace names, in lower case, and the values are the\n\t\
      -- possible parameter names for that namespace, also in lower case. The\n\t-- table entries are structured like this:\n\t-- {\n\t--   [''] = {'main'},\n\t--   ['wikipedia'] = {'wikipedia', 'project', 'wp'},\n\t--   ...\n\t-- }\n\t--]]\n\tlocal mappings\
      \ = {}\n\tlocal mainNsName = mw.site.subjectNamespaces[0].name\n\tmainNsName = mw.ustring.lower(mainNsName)\n\tmappings[mainNsName] = mw.clone(argKeys.main)\n\tmappings['talk'] = mw.clone(argKeys.talk)\n\tfor nsid, ns in pairs(mw.site.subjectNamespaces)\
      \ do\n\t\tif nsid ~= 0 then -- Exclude main namespace.\n\t\t\tlocal nsname = mw.ustring.lower(ns.name)\n\t\t\tlocal canonicalName = mw.ustring.lower(ns.canonicalName)\n\t\t\tmappings[nsname] = {nsname}\n\t\t\tif canonicalName ~= nsname then\n\t\t\t\ttable.insert(mappings[nsname],\
      \ canonicalName)\n\t\t\tend\n\t\t\tfor _, alias in ipairs(ns.aliases) do\n\t\t\t\ttable.insert(mappings[nsname], mw.ustring.lower(alias))\n\t\t\tend\n\t\tend\n\tend\n\treturn mappings\nend\n\nreturn {\n\targKeys = argKeys,\n\tcfg = cfg,\n\tmappings = getParamMappings()\n\
      }</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:13.048Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANamespace+detect%2Fconfig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:13 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq53 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025864082, 4205993051, 4115547707
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="42256703" ns="828" title="Module:Namespace detect/config"><revisions><rev user="Mr. Stradivarius" timestamp="2014-04-05T17:03:49Z" comment="use cfg.demopage rather than cfg.page now that the default parameter has been changed on the /data page" contentformat="text/plain" contentmodel="Scribunto" xml:space="preserve">--------------------------------------------------------------------------------
      --                    Namespace detect configuration data                     --
      --                                                                            --
      -- This module stores configuration data for Module:Namespace detect. Here    --
      -- you can localise the module to your wiki's language.                       --
      --                                                                            --
      -- To activate a configuration item, you need to uncomment it. This means     --
      -- that you need to remove the text &quot;-- &quot; at the start of the line.           --
      --------------------------------------------------------------------------------

      local cfg = {} -- Don't edit this line.

      --------------------------------------------------------------------------------
      --                              Parameter names                               --
      -- These configuration items specify custom parameter names. Values added     --
      -- here will work in addition to the default English parameter names.         --
      -- To add one extra name, you can use this format:                            --
      --                                                                            --
      -- cfg.foo = 'parameter name'                                                 --
      --                                                                            --
      -- To add multiple names, you can use this format:                            --
      --                                                                            --
      -- cfg.foo = {'parameter name 1', 'parameter name 2', 'parameter name 3'}     --
      --------------------------------------------------------------------------------

      ---- This parameter displays content for the main namespace:
      -- cfg.main = 'main'

      ---- This parameter displays in talk namespaces:
      -- cfg.talk = 'talk'

      ---- This parameter displays content for &quot;other&quot; namespaces (namespaces for which
      ---- parameters have not been specified):
      -- cfg.other = 'other'

      ---- This parameter makes talk pages behave as though they are the corresponding
      ---- subject namespace. Note that this parameter is used with [[Module:Yesno]].
      ---- Edit that module to change the default values of &quot;yes&quot;, &quot;no&quot;, etc.
      -- cfg.subjectns = 'subjectns'

      ---- This parameter sets a demonstration namespace:
      -- cfg.demospace = 'demospace'

      ---- This parameter sets a specific page to compare:
      cfg.demopage = 'page'

      --------------------------------------------------------------------------------
      --                           Table configuration                              --
      -- These configuration items allow customisation of the &quot;table&quot; function,     --
      -- used to generate a table of possible parameters in the module              --
      -- documentation.                                                             --
      --------------------------------------------------------------------------------

      ---- The header for the namespace column in the wikitable containing the list of
      ---- possible subject-space parameters.
      -- cfg.wikitableNamespaceHeader = 'Namespace'

      ---- The header for the wikitable containing the list of possible subject-space
      ---- parameters.
      -- cfg.wikitableAliasesHeader = 'Aliases'

      --------------------------------------------------------------------------------
      --                        End of configuration data                           --
      --------------------------------------------------------------------------------

      return cfg -- Don't edit this line.</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:13.659Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3A&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:13 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348951502, 269524231, 4115548381
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:safesubst:" to="Template:Safesubst:" /></normalized><pages><page ns="10" title="Template:Safesubst:" missing="" /></pages></query></api>
- recorded: 2014-11-04T23:11:14.006Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AAbout&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq59 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103495535, 3268179664, 4115548943
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="2468023" ns="10" title="Template:About"><revisions><rev user="Steel1943" timestamp="2014-05-05T05:50:18Z" comment="TESTED edit on the [[/sandbox]] that allows template to render a &quot;This section...&quot; wording instead of a &quot;This page/category/article...&quot; wording without breaking any currently-existing transcluded templates - please see the [[/testcases]] subpage" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Hatnote|&lt;!--
      --&gt;{{#if: {{{1|}}}|&lt;!--
        --&gt;This {{#if:{{{section|}}}|section|{{namespace detect|main=article|category=category|other=page}}}} is about {{{1}}}.&amp;#32;&amp;#32;}}&lt;!--
      --&gt;For {{#if:{{{2|}}}|{{{2}}}|other uses}}, see {{#if:{{{3|}}}|[[{{{3}}}]]{{#ifeq:{{{4|}}}|and|&amp;#32;and {{#if:{{{5|}}}|[[{{{5}}}]]|[[{{PAGENAME}} (disambiguation)]]}}}}|[[{{PAGENAME}} (disambiguation)]]}}.&lt;!--
      --&gt;{{#if:{{{2|}}}|{{#if:{{{4|}}}|&lt;!--
        --&gt;{{#ifeq:{{{4|}}}|and||&lt;!-- &quot;and&quot; is a special word, don't output &quot;For and, ...&quot;
          --&gt;&amp;#32;&amp;#32;For {{#ifeq:{{{4}}}|1|other uses|{{{4}}}}}, see {{#if:{{{5|}}}|[[{{{5}}}]]{{#ifeq:{{{6|}}}|and|&amp;#32;and {{#if:{{{7|}}}|[[{{{7}}}]]|[[{{PAGENAME}} (disambiguation)]]}}}}|[[{{PAGENAME}} (disambiguation)]]}}.}}&lt;!--
        --&gt;{{#if:{{{6|}}}|&lt;!--
          --&gt;{{#ifeq:{{{6|}}}|and||&lt;!--
            --&gt;&amp;#32;&amp;#32;For {{#ifeq:{{{6}}}|1|other uses|{{{6}}}}}, see {{#if:{{{7|}}}|[[{{{7}}}]]{{#ifeq:{{{8|}}}|and|&amp;#32;and {{#if:{{{9|}}}|[[{{{9}}}]]|[[{{PAGENAME}} (disambiguation)]]}}}}|[[{{PAGENAME}} (disambiguation)]]}}.}}&lt;!--
          --&gt;{{#if:{{{8|}}}|&lt;!--
            --&gt;{{#ifeq:{{{8|}}}|and||&lt;!--
              --&gt;&amp;#32;&amp;#32;For {{#ifeq:{{{8}}}|1|other uses|{{{8}}}}}, see {{#if:{{{9|}}}|[[{{{9}}}]]|[[{{PAGENAME}} (disambiguation)]]}}.}}&lt;!--
          --&gt;}}&lt;!--
        --&gt;}}&lt;!--
      --&gt;}}}}}}&lt;!--
      --&gt;{{#if:{{{_nocat|}}}||{{#if:{{{1|}}}{{{2|}}}||{{#if:{{{3|}}}|[[Category:Hatnote templates using unusual parameters|A{{PAGENAME}}]]}}}}{{#ifeq:{{str left|{{{1}}}|3}}|is |[[Category:Hatnote templates using unusual parameters|B{{PAGENAME}}]]}}}}&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:14.285Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Anamespace+detect&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404077024, 3589280512, 4115549197
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:namespace detect" to="Template:Namespace detect" /></normalized><pages><page pageid="17433896" ns="10" title="Template:Namespace detect"><revisions><rev user="Mr. Stradivarius" timestamp="2013-06-24T14:20:22Z" comment="switch to Lua implementation" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Namespace detect|main}}&lt;noinclude&gt;

      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:14.609Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANamespace_detect&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226991707, 269524994, 4115549412
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Namespace_detect\" to=\"Module:Namespace detect\" /></normalized><pages><page pageid=\"39762919\" ns=\"828\" title=\"Module:Namespace detect\"><revisions><rev user=\"\
      Mr. Stradivarius\" timestamp=\"2014-04-05T17:01:23Z\" comment=\"use demopage instead of page as the main &quot;page&quot; parameter\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[[\n--------------------------------------------------------------------------------\n\
      --                                                                            --\n--                            NAMESPACE DETECT                                --\n--                                                                            --\n-- This\
      \ module implements the {{namespace detect}} template in Lua, with a    --\n-- few improvements: all namespaces and all namespace aliases are supported,  --\n-- and namespace names are detected automatically for the local wiki. The     --\n-- module can\
      \ also use the corresponding subject namespace value if it is     --\n-- used on a talk page. Parameter names can be configured for different wikis --\n-- by altering the values in the &quot;cfg&quot; table in                               --\n-- Module:Namespace\
      \ detect/config.                                            --\n--                                                                            --\n--------------------------------------------------------------------------------\n--]]\n\nlocal data = mw.loadData('Module:Namespace\
      \ detect/data')\nlocal argKeys = data.argKeys\nlocal cfg = data.cfg\nlocal mappings = data.mappings\n\nlocal yesno = require('Module:Yesno')\nlocal mArguments -- Lazily initialise Module:Arguments\nlocal mTableTools -- Lazily initilalise Module:TableTools\n\
      local ustringLower = mw.ustring.lower\n\nlocal p = {}\n\nlocal function fetchValue(t1, t2)\n\t-- Fetches a value from the table t1 for the first key in array t2 where\n\t-- a non-nil value of t1 exists.\n\tfor i, key in ipairs(t2) do\n\t\tlocal value =\
      \ t1[key]\n\t\tif value ~= nil then\n\t\t\treturn value\n\t\tend\n\tend\n\treturn nil\nend\n\nlocal function equalsArrayValue(t, value)\n\t-- Returns true if value equals a value in the array t. Otherwise\n\t-- returns false.\n\tfor i, arrayValue in ipairs(t)\
      \ do\n\t\tif value == arrayValue then\n\t\t\treturn true\n\t\tend\n\tend\n\treturn false\nend\n\nfunction p.getPageObject(page)\n\t-- Get the page object, passing the function through pcall in case of\n\t-- errors, e.g. being over the expensive function\
      \ count limit.\n\tif page then\n\t\tlocal success, pageObject = pcall(mw.title.new, page)\n\t\tif success then\n\t\t\treturn pageObject\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn mw.title.getCurrentTitle()\n\tend\nend\n\n-- Provided for backward\
      \ compatibility with other modules\nfunction p.getParamMappings()\n\treturn mappings\nend\n\nlocal function getNamespace(args)\n\t-- This function gets the namespace name from the page object.\n\tlocal page = fetchValue(args, argKeys.demopage)\n\tif page\
      \ == '' then\n\t\tpage = nil\n\tend\n\tlocal demospace = fetchValue(args, argKeys.demospace)\n\tif demospace == '' then\n\t\tdemospace = nil\n\tend\n\tlocal subjectns = fetchValue(args, argKeys.subjectns)\n\tlocal ret\n\tif demospace then\n\t\t-- Handle\
      \ &quot;demospace = main&quot; properly.\n\t\tif equalsArrayValue(argKeys.main, ustringLower(demospace)) then\n\t\t\tret = mw.site.namespaces[0].name\n\t\telse\n\t\t\tret = demospace\n\t\tend\n\telse\n\t\tlocal pageObject = p.getPageObject(page)\n\t\t\
      if pageObject then\n\t\t\tif pageObject.isTalkPage then\n\t\t\t\t-- Get the subject namespace if the option is set,\n\t\t\t\t-- otherwise use &quot;talk&quot;.\n\t\t\t\tif yesno(subjectns) then\n\t\t\t\t\tret = mw.site.namespaces[pageObject.namespace].subject.name\n\
      \t\t\t\telse\n\t\t\t\t\tret = 'talk'\n\t\t\t\tend\n\t\t\telse\n\t\t\t\tret = pageObject.nsText\n\t\t\tend\n\t\telse\n\t\t\treturn nil -- return nil if the page object doesn't exist.\n\t\tend\n\tend\n\tret = ret:gsub('_', ' ')\n\treturn ustringLower(ret)\n\
      end\n\nfunction p._main(args)\n\t-- Check the parameters stored in the mappings table for any matches.\n\tlocal namespace = getNamespace(args) or 'other' -- &quot;other&quot; avoids nil table keys\n\tlocal params = mappings[namespace] or {}\n\tlocal ret\
      \ = fetchValue(args, params)\n\t--[[\n\t-- If there were no matches, return parameters for other namespaces.\n\t-- This happens if there was no text specified for the namespace that\n\t-- was detected or if the demospace parameter is not a valid\n\t--\
      \ namespace. Note that the parameter for the detected namespace must be\n\t-- completely absent for this to happen, not merely blank.\n\t--]]\n\tif ret == nil then\n\t\tret = fetchValue(args, argKeys.other)\n\tend\n\treturn ret\nend\n\nfunction p.main(frame)\n\
      \tmArguments = require('Module:Arguments')\n\tlocal args = mArguments.getArgs(frame, {removeBlanks = false})\n\tlocal ret = p._main(args)\n\treturn ret or ''\nend\n\nfunction p.table(frame)\n\t--[[\n\t-- Create a wikitable of all subject namespace parameters,\
      \ for\n\t-- documentation purposes. The talk parameter is optional, in case it\n\t-- needs to be excluded in the documentation.\n\t--]]\n\t\n\t-- Load modules and initialise variables.\n\tmTableTools = require('Module:TableTools')\n\tlocal namespaces =\
      \ mw.site.namespaces\n\tlocal cfg = data.cfg\n\tlocal useTalk = type(frame) == 'table' \n\t\tand type(frame.args) == 'table' \n\t\tand yesno(frame.args.talk) -- Whether to use the talk parameter.\n\t\n\t-- Get the header names.\n\tlocal function checkValue(value,\
      \ default)\n\t\tif type(value) == 'string' then\n\t\t\treturn value\n\t\telse\n\t\t\treturn default\n\t\tend\n\tend\n\tlocal nsHeader = checkValue(cfg.wikitableNamespaceHeader, 'Namespace')\n\tlocal aliasesHeader = checkValue(cfg.wikitableAliasesHeader,\
      \ 'Aliases')\n\n\t-- Put the namespaces in order.\n\tlocal mappingsOrdered = {}\n\tfor nsname, params in pairs(mappings) do\n\t\tif useTalk or nsname ~= 'talk' then\n\t\t\tlocal nsid = namespaces[nsname].id\n\t\t\t-- Add 1, as the array must start with\
      \ 1; nsid 0 would be lost otherwise.\n\t\t\tnsid = nsid + 1 \n\t\t\tmappingsOrdered[nsid] = params\n\t\tend\n\tend\n\tmappingsOrdered = mTableTools.compressSparseArray(mappingsOrdered)\n\n\t-- Build the table.\n\tlocal ret = '{| class=&quot;wikitable&quot;'\n\
      \t\t.. '\\n|-'\n\t\t.. '\\n! ' .. nsHeader\n\t\t.. '\\n! ' .. aliasesHeader\n\tfor i, params in ipairs(mappingsOrdered) do\n\t\tfor j, param in ipairs(params) do\n\t\t\tif j == 1 then\n\t\t\t\tret = ret .. '\\n|-'\n\t\t\t\t\t.. '\\n| &lt;code&gt;' .. param\
      \ .. '&lt;/code&gt;'\n\t\t\t\t\t.. '\\n| '\n\t\t\telseif j == 2 then\n\t\t\t\tret = ret .. '&lt;code&gt;' .. param .. '&lt;/code&gt;'\n\t\t\telse\n\t\t\t\tret = ret .. ', &lt;code&gt;' .. param .. '&lt;/code&gt;'\n\t\t\tend\n\t\tend\n\tend\n\tret = ret\
      \ .. '\\n|-'\n\t\t.. '\\n|}'\n\treturn ret\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:15.196Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AHatnote&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404078066, 3589280942, 4115549748
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="945764" ns="10" title="Template:Hatnote"><revisions><rev user="SMcCandlish" timestamp="2014-05-23T15:55:04Z" comment="tweak" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Hatnote|hatnote}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:15.477Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AHatnote&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:15 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq46 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404078868, 2973942458, 4115550127
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42498502\" ns=\"828\" title=\"Module:Hatnote\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-10-07T10:35:12Z\" comment=\"detect piped link hacks made with the\
      \ {{!}} parser function\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n--                              Module:Hatnote                  \
      \              --\n--                                                                            --\n-- This module produces hatnote links and links to related articles. It       --\n-- implements the {{hatnote}} and {{format hatnote link}} meta-templates,\
      \ and --\n-- includes helper functions for other Lua hatnote modules.                   --\n--------------------------------------------------------------------------------\n\nlocal libraryUtil = require('libraryUtil')\nlocal checkType = libraryUtil.checkType\n\
      local mArguments -- lazily initialise [[Module:Arguments]]\nlocal yesno -- lazily initialise [[Module:Yesno]]\n\nlocal p = {}\n\n--------------------------------------------------------------------------------\n-- Helper functions\n--------------------------------------------------------------------------------\n\
      \nlocal function getArgs(frame)\n\t-- Fetches the arguments from the parent frame. Whitespace is trimmed and\n\t-- blanks are removed.\n\tmArguments = require('Module:Arguments')\n\treturn mArguments.getArgs(frame, {parentOnly = true})\nend\n\nlocal function\
      \ removeInitialColon(s)\n\t-- Removes the initial colon from a string, if present.\n\treturn s:match('^:?(.*)')\nend\n\nfunction p.findNamespaceId(link, removeColon)\n\t-- Finds the namespace id (namespace number) of a link or a pagename. This\n\t-- function\
      \ will not work if the link is enclosed in double brackets. Colons\n\t-- are trimmed from the start of the link by default. To skip colon\n\t-- trimming, set the removeColon parameter to true.\n\tcheckType('findNamespaceId', 1, link, 'string')\n\tcheckType('findNamespaceId',\
      \ 2, removeColon, 'boolean', true)\n\tif removeColon ~= false then\n\t\tlink = removeInitialColon(link)\n\tend\n\tlocal namespace = link:match('^(.-):')\n\tif namespace then\n\t\tlocal nsTable = mw.site.namespaces[namespace]\n\t\tif nsTable then\n\t\t\t\
      return nsTable.id\n\t\tend\n\tend\n\treturn 0\nend\n\nfunction p.formatPages(...)\n\t-- Formats a list of pages using formatLink and returns it as an array. Nil\n\t-- values are not allowed.\n\tlocal pages = {...}\n\tlocal ret = {}\n\tfor i, page in ipairs(pages)\
      \ do\n\t\tret[i] = p._formatLink(page)\n\tend\n\treturn ret\nend\n\nfunction p.formatPageTables(...)\n\t-- Takes a list of page/display tables and returns it as a list of\n\t-- formatted links. Nil values are not allowed.\n\tlocal pages = {...}\n\tlocal\
      \ links = {}\n\tfor i, t in ipairs(pages) do\n\t\tcheckType('formatPageTables', i, t, 'table')\n\t\tlocal link = t[1]\n\t\tlocal display = t[2]\n\t\tlinks[i] = p._formatLink(link, display)\n\tend\n\treturn links\nend\n\nfunction p.makeWikitextError(msg,\
      \ helpLink, addTrackingCategory)\n\t-- Formats an error message to be returned to wikitext. If\n\t-- addTrackingCategory is not false after being returned from\n\t-- [[Module:Yesno]], and if we are not on a talk page, a tracking category\n\t-- is added.\n\
      \tcheckType('makeWikitextError', 1, msg, 'string')\n\tcheckType('makeWikitextError', 2, helpLink, 'string', true)\n\tyesno = require('Module:Yesno')\n\tlocal title = mw.title.getCurrentTitle()\n\t-- Make the help link text.\n\tlocal helpText\n\tif helpLink\
      \ then\n\t\thelpText = ' ([[' .. helpLink .. '|help]])'\n\telse\n\t\thelpText = ''\n\tend\n\t-- Make the category text.\n\tlocal category\n\tif not title.isTalkPage and yesno(addTrackingCategory) ~= false then\n\t\tcategory = 'Hatnote templates with errors'\n\
      \t\tcategory = string.format(\n\t\t\t'[[%s:%s]]',\n\t\t\tmw.site.namespaces[14].name,\n\t\t\tcategory\n\t\t)\n\telse\n\t\tcategory = ''\n\tend\n\treturn string.format(\n\t\t'&lt;strong class=&quot;error&quot;&gt;Error: %s%s.&lt;/strong&gt;%s',\n\t\tmsg,\n\
      \t\thelpText,\n\t\tcategory\n\t)\nend\n\n--------------------------------------------------------------------------------\n-- Format link\n--\n-- Makes a wikilink from the given link and display values. Links are escaped\n-- with colons if necessary, and\
      \ links to sections are detected and displayed\n-- with &quot; § &quot; as a separator rather than the standard MediaWiki &quot;#&quot;. Used in\n-- the {{format hatnote link}} template.\n--------------------------------------------------------------------------------\n\
      \nfunction p.formatLink(frame)\n\tlocal args = getArgs(frame)\n\tlocal link = args[1]\n\tlocal display = args[2]\n\tif not link then\n\t\treturn p.makeWikitextError(\n\t\t\t'no link specified',\n\t\t\t'Template:Format hatnote link#Errors',\n\t\t\targs.category\n\
      \t\t)\n\tend\n\treturn p._formatLink(link, display)\nend\n\nfunction p._formatLink(link, display)\n\t-- Find whether we need to use the colon trick or not. We need to use the\n\t-- colon trick for categories and files, as otherwise category links\n\t--\
      \ categorise the page and file links display the file.\n\tcheckType('_formatLink', 1, link, 'string')\n\tcheckType('_formatLink', 2, display, 'string', true)\n\tlink = removeInitialColon(link)\n\tlocal namespace = p.findNamespaceId(link, false)\n\tlocal\
      \ colon\n\tif namespace == 6 or namespace == 14 then\n\t\tcolon = ':'\n\telse\n\t\tcolon = ''\n\tend\n\n\t-- Find whether a faux display value has been added with the {{!}} magic\n\t-- word.\n\tif not display then\n\t\tlocal prePipe, postPipe = link:match('^(.-)|(.*)$')\n\
      \t\tlink = prePipe or link\n\t\tdisplay = postPipe\n\tend\n\n\t-- Find the display value.\n\tif not display then\n\t\tlocal page, section = link:match('^(.-)#(.*)$')\n\t\tif page then\n\t\t\tdisplay = page .. ' § ' .. section\n\t\tend\n\tend\n\n\t-- Assemble\
      \ the link.\n\tif display then\n\t\treturn string.format('[[%s%s|%s]]', colon, link, display)\n\telse\n\t\treturn string.format('[[%s%s]]', colon, link)\n\tend\nend\n\n--------------------------------------------------------------------------------\n--\
      \ Hatnote\n--\n-- Produces standard hatnote text. Implements the {{hatnote}} template.\n--------------------------------------------------------------------------------\n\nfunction p.hatnote(frame)\n\tlocal args = getArgs(frame)\n\tlocal s = args[1]\n\t\
      local options = {}\n\tif not s then\n\t\treturn p.makeWikitextError(\n\t\t\t'no text specified',\n\t\t\t'Template:Hatnote#Errors',\n\t\t\targs.category\n\t\t)\n\tend\n\toptions.extraclasses = args.extraclasses\n\toptions.selfref = args.selfref\n\treturn\
      \ p._hatnote(s, options)\nend\n\nfunction p._hatnote(s, options)\n\tcheckType('_hatnote', 1, s, 'string')\n\tcheckType('_hatnote', 2, options, 'table', true)\n\tlocal classes = {'hatnote'}\n\tlocal extraclasses = options.extraclasses\n\tlocal selfref =\
      \ options.selfref\n\tif type(extraclasses) == 'string' then\n\t\tclasses[#classes + 1] = extraclasses\n\tend\n\tif selfref then\n\t\tclasses[#classes + 1] = 'selfref'\n\tend\n\treturn string.format(\n\t\t'&lt;div class=&quot;%s&quot;&gt;%s&lt;/div&gt;',\n\
      \t\ttable.concat(classes, ' '),\n\t\ts\n\t)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:15.752Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Astr+left&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:15 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq32 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530278252, 469327560, 4115550655
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:str left" to="Template:Str left" /></normalized><pages><page pageid="21696393" ns="10" title="Template:Str left"><revisions><rev user="Mr. Stradivarius" timestamp="2014-04-21T08:46:40Z" comment="don&#039;t expand a parameter around safesubst, as the includeonly tags already prevent this template from being substituted onto the template page" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{safesubst:padleft:|{{{2|1}}}|{{{1}}}}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:16.034Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3App-move-indef&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:16 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123461860, 2402485151, 4115550940
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:pp-move-indef" to="Template:Pp-move-indef" /></normalized><pages><page pageid="20814756" ns="10" title="Template:Pp-move-indef"><revisions><rev user="Mr. Stradivarius" timestamp="2014-09-18T01:43:57Z" comment="Changed protection level of Template:Pp-move-indef: [[WP:High-risk templates|Highly visible template]]: allow template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Pp-move-indef|main}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:16.335Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APp-move-indef&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:16 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055649508, 343383320, 4115551477
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"43852218\" ns=\"828\" title=\"Module:Pp-move-indef\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-09-18T01:37:33Z\" comment=\"make fixes for when we are called\
      \ from #invoke - the title parameter becomes a frame object\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module implements [[Template:Pp-move-indef]].\n\nlocal p = {}\n\nfunction p.main(title)\n\tif type(title)\
      \ == 'string' then\n\t\ttitle = mw.title.new(title)\n\telseif type(title) ~= 'table' or not title.text or not title.getContent then\n\t\t-- The title parameter is absent or not a title object. It could be a\n\t\t-- frame object if we are being called from\
      \ #invoke.\n\t\ttitle = mw.title.getCurrentTitle()\n\tend\n\t\n\tlocal level = title\n\t\tand title.protectionLevels\n\t\tand title.protectionLevels.move\n\t\tand title.protectionLevels.move[1]\n\tlocal namespace = title and title.namespace\n\n\tlocal\
      \ category\n\tif level == 'sysop' or level == 'templateeditor' then\n\t\tif namespace == 2 or namespace == 3 then\n\t\t\tcategory = 'Wikipedia move-protected user and user talk pages'\n\t\telseif namespace == 4 or namepace == 12 then\n\t\t\tcategory =\
      \ 'Wikipedia move-protected project pages'\n\t\telseif namespace == 100 then\n\t\t\tcategory = 'Wikipedia move-protected portals'\n\t\telseif title.isTalkPage then\n\t\t\tcategory = 'Wikipedia move-protected talk pages'\n\t\telse\n\t\t\tcategory = 'Wikipedia\
      \ indefinitely move-protected pages'\n\t\tend\n\telse\n\t\tcategory = 'Wikipedia pages with incorrect protection templates'\n\tend\n\n\treturn string.format(\n\t\t'[[%s:%s|%s]]',\n\t\tmw.site.namespaces[14].name, -- &quot;Category&quot;\n\t\tcategory,\n\
      \t\ttitle.text -- equivalent of {{PAGENAME}}\n\t)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:16.732Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3App-semi-blp&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:16 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq32 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1226995313, 469328675, 4115551919
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:pp-semi-blp" to="Template:Pp-semi-blp" /></normalized><pages><page pageid="41798927" ns="10" title="Template:Pp-semi-blp"><revisions><rev user="Callanecc" timestamp="2014-01-31T12:39:56Z" comment="Callanecc moved page [[Template:Pp-semi-blp]] to [[Template:Pp-blp]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Pp-blp]]
      {{R from move}}</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:17.035Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3APp-blp&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:17 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404082447, 3589283035, 4115552282
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="23908856" ns="10" title="Template:Pp-blp"><revisions><rev user="Mr. Stradivarius" timestamp="2014-08-05T17:16:09Z" comment="convert this to use [[Module:Protection banner]]; see [[Module talk:Protection banner#Proposal to convert all protection templates to use this module|here]] for details" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Protection banner|main}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:17.514Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AProtection_banner&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:17 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq41 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055651885, 654996358, 4115553037
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Protection_banner\" to=\"Module:Protection banner\" /></normalized><pages><page pageid=\"42040984\" ns=\"828\" title=\"Module:Protection banner\"><revisions><rev user=\"\
      Mr. Stradivarius\" timestamp=\"2014-10-14T21:48:57Z\" comment=\"add support for the &quot;demolevel&quot; parameter; code by myself and [[User:Jackmcbarn]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module\
      \ implements {{pp-meta}} and its daughter templates such as\n-- {{pp-dispute}}, {{pp-vandalism}} and {{pp-sock}}.\n\n-- Initialise necessary modules.\nrequire('Module:No globals')\nlocal newFileLink = require('Module:File link').new\nlocal effectiveProtectionLevel\
      \ = require('Module:Effective protection level')._main\nlocal yesno = require('Module:Yesno')\n\n-- Lazily initialise modules and objects we don't always need.\nlocal getArgs, makeMessageBox, lang\n\n-- Set constants.\nlocal CONFIG_MODULE = 'Module:Protection\
      \ banner/config'\n\n--------------------------------------------------------------------------------\n-- Helper functions\n--------------------------------------------------------------------------------\n\nlocal function makeCategoryLink(cat, sort)\n\t\
      local nsText = mw.site.namespaces[14].name\n\tif cat and sort then\n\t\treturn string.format(\n\t\t\t'[[%s:%s|%s]]',\n\t\t\tnsText,\n\t\t\tcat,\n\t\t\tsort\n\t\t)\n\telseif cat then\n\t\treturn string.format(\n\t\t\t'[[%s:%s]]',\n\t\t\tnsText,\n\t\t\t\
      cat\n\t\t)\n\telse\n\t\treturn ''\n\tend\nend\n\n-- Validation function for the expiry and the protection date\nlocal function validateDate(dateString, dateType)\n\tlang = lang or mw.language.getContentLanguage()\n\tlocal success, result = pcall(lang.formatDate,\
      \ lang, 'U', dateString)\n\tif success then\n\t\tresult = tonumber(result)\n\t\tif result then\n\t\t\treturn result\n\t\tend\n\tend\n\terror(string.format(\n\t\t'invalid %s (&quot;%s&quot;)',\n\t\tdateType,\n\t\ttostring(dateString)\n\t), 4)\nend\n\nlocal\
      \ function makeFullUrl(page, query, display)\n\treturn string.format(\n\t\t'[%s %s]',\n\t\ttostring(mw.uri.fullUrl(page, query)),\n\t\tdisplay\n\t)\nend\n\nlocal function toTableEnd(t, pos)\n\t-- Sends the value at position pos to the end of array t, and\
      \ shifts the\n\t-- other items down accordingly.\n\treturn table.insert(t, table.remove(t, pos))\nend\n\nlocal function walkHierarchy(hierarchy, start)\n\tlocal toWalk, retval = {[start] = true}, {}\n\twhile true do\n\t\t-- Can't use pairs() since we're\
      \ adding and removing things as we're iterating\n\t\tlocal k = next(toWalk)\n\t\tif k == nil then break end\n\t\ttoWalk[k] = nil\n\t\tretval[k] = true\n\t\tfor _,v in ipairs(hierarchy[k]) do\n\t\t\tif not retval[v] then\n\t\t\t\ttoWalk[v] = true\n\t\t\t\
      end\n\t\tend\n\tend\n\treturn retval\nend\n\n--------------------------------------------------------------------------------\n-- Protection class\n--------------------------------------------------------------------------------\n\nlocal Protection = {}\n\
      Protection.__index = Protection\n\nProtection.supportedActions = {\n\tedit = true,\n\tmove = true,\n\tautoreview = true\n}\n\nProtection.bannerConfigFields = {\n\t'text',\n\t'explanation',\n\t'tooltip',\n\t'alt',\n\t'link',\n\t'image'\n}\n\nfunction Protection.new(args,\
      \ cfg, title)\n\tlocal obj = {}\n\tobj._cfg = cfg\n\tobj.title = title or mw.title.getCurrentTitle()\n\n\t-- Set action\n\tif not args.action then\n\t\tobj.action = 'edit'\n\telseif Protection.supportedActions[args.action] then\n\t\tobj.action = args.action\n\
      \telse\n\t\terror(string.format(\n\t\t\t'invalid action (&quot;%s&quot;)',\n\t\t\ttostring(args.action)\n\t\t), 3)\n\tend\n\n\t-- Set level\n\tobj.level = args.demolevel or effectiveProtectionLevel(obj.action, obj.title)\n\tif obj.level == 'accountcreator'\
      \ then\n\t\t-- Lump titleblacklisted pages in with template-protected pages,\n\t\t-- since templateeditors can do both.\n\t\tobj.level = 'templateeditor'\n\telseif not obj.level or (obj.action == 'move' and obj.level == 'autoconfirmed') then\n\t\t-- Users\
      \ need to be autoconfirmed to move pages anyway, so treat\n\t\t-- semi-move-protected pages as unprotected.\n\t\tobj.level = '*'\n\tend\n\n\t-- Set expiry\n\tif args.expiry then\n\t\tif cfg.indefStrings[args.expiry] then\n\t\t\tobj.expiry = 'indef'\n\t\
      \telseif type(args.expiry) == 'number' then\n\t\t\tobj.expiry = args.expiry\n\t\telse\n\t\t\tobj.expiry = validateDate(args.expiry, 'expiry date')\n\t\tend\n\tend\n\n\t-- Set reason\n\tif args[1] then\n\t\tobj.reason = mw.ustring.lower(args[1])\n\t\tif\
      \ obj.reason:find('|') then\n\t\t\terror('reasons cannot contain the pipe character (&quot;|&quot;)', 3)\n\t\tend\n\tend\n\n\t-- Set protection date\n\tif args.date then\n\t\tobj.protectionDate = validateDate(args.date, 'protection date')\n\tend\n\t\n\t\
      -- Set banner config\n\tdo\n\t\tobj.bannerConfig = {}\n\t\tlocal configTables = {}\n\t\tif cfg.banners[obj.action] then\n\t\t\tconfigTables[#configTables + 1] = cfg.banners[obj.action][obj.reason]\n\t\tend\n\t\tif cfg.defaultBanners[obj.action] then\n\t\
      \t\tconfigTables[#configTables + 1] = cfg.defaultBanners[obj.action][obj.level]\n\t\t\tconfigTables[#configTables + 1] = cfg.defaultBanners[obj.action].default\n\t\tend\n\t\tconfigTables[#configTables + 1] = cfg.masterBanner\n\t\tfor i, field in ipairs(Protection.bannerConfigFields)\
      \ do\n\t\t\tfor j, t in ipairs(configTables) do\n\t\t\t\tif t[field] then\n\t\t\t\t\tobj.bannerConfig[field] = t[field]\n\t\t\t\t\tbreak\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn setmetatable(obj, Protection)\nend\n\nfunction Protection:isProtected()\n\
      \treturn self.level ~= '*'\nend\n\nfunction Protection:isTemporary()\n\treturn type(self.expiry) == 'number'\nend\n\nfunction Protection:makeProtectionCategory()\n\tlocal cfg = self._cfg\n\tlocal title = self.title\n\t\n\t-- Exit if the page is not protected.\n\
      \tif not self:isProtected() then\n\t\treturn ''\n\tend\n\t\n\t-- Get the expiry key fragment.\n\tlocal expiryFragment\n\tif self.expiry == 'indef' then\n\t\texpiryFragment = self.expiry\n\telseif type(self.expiry) == 'number' then\n\t\texpiryFragment =\
      \ 'temp'\n\tend\n\n\t-- Get the namespace key fragment.\n\tlocal namespaceFragment\n\tdo\n\t\tnamespaceFragment = cfg.categoryNamespaceKeys[title.namespace]\n\t\tif not namespaceFragment and title.namespace % 2 == 1 then\n\t\t\t\tnamespaceFragment = 'talk'\n\
      \t\tend\n\tend\n \n\t-- Define the order that key fragments are tested in. This is done with an\n\t-- array of tables containing the value to be tested, along with its\n\t-- position in the cfg.protectionCategories table.\n\tlocal order = {\n\t\t{val =\
      \ expiryFragment,    keypos = 1},\n\t\t{val = namespaceFragment, keypos = 2},\n\t\t{val = self.reason,       keypos = 3},\n\t\t{val = self.level,        keypos = 4},\n\t\t{val = self.action,       keypos = 5}\n\t}\n\n\t--[[\n\t-- The old protection templates\
      \ used an ad-hoc protection category system,\n\t-- with some templates prioritising namespaces in their categories, and\n\t-- others prioritising the protection reason. To emulate this in this module\n\t-- we use the config table cfg.reasonsWithNamespacePriority\
      \ to set the\n\t-- reasons for which namespaces have priority over protection reason.\n\t-- If we are dealing with one of those reasons, move the namespace table to\n\t-- the end of the order table, i.e. give it highest priority. If not, the\n\t-- reason\
      \ should have highest priority, so move that to the end of the table\n\t-- instead.\n\t--]]\n\tif self.reason and cfg.reasonsWithNamespacePriority[self.reason] then\n\t\t-- table.insert(order, 3, table.remove(order, 2))\n\t\ttoTableEnd(order, 2)\n\telse\n\
      \t\ttoTableEnd(order, 3)\n\tend\n \n\t--[[\n\t-- Define the attempt order. Inactive subtables (subtables with nil &quot;value&quot;\n\t-- fields) are moved to the end, where they will later be given the key\n\t-- &quot;all&quot;. This is to cut down on\
      \ the number of table lookups in\n\t-- cfg.protectionCategories, which grows exponentially with the number of\n\t-- non-nil keys. We keep track of the number of active subtables with the\n\t-- noActive parameter.\n\t--]]\n\tlocal noActive, attemptOrder\n\
      \tdo\n\t\tlocal active, inactive = {}, {}\n\t\tfor i, t in ipairs(order) do\n\t\t\tif t.val then\n\t\t\t\tactive[#active + 1] = t\n\t\t\telse\n\t\t\t\tinactive[#inactive + 1] = t\n\t\t\tend\n\t\tend\n\t\tnoActive = #active\n\t\tattemptOrder = active\n\t\
      \tfor i, t in ipairs(inactive) do\n\t\t\tattemptOrder[#attemptOrder + 1] = t\n\t\tend\n\tend\n \n\t--[[\n\t-- Check increasingly generic key combinations until we find a match. If a\n\t-- specific category exists for the combination of key fragments we\
      \ are\n\t-- given, that match will be found first. If not, we keep trying different\n\t-- key fragment combinations until we match using the key\n\t-- &quot;all-all-all-all-all&quot;.\n\t--\n\t-- To generate the keys, we index the key subtables using a\
      \ binary matrix\n\t-- with indexes i and j. j is only calculated up to the number of active\n\t-- subtables. For example, if there were three active subtables, the matrix\n\t-- would look like this, with 0 corresponding to the key fragment &quot;all&quot;,\
      \ and\n\t-- 1 corresponding to other key fragments.\n\t-- \n\t--   j 1  2  3\n\t-- i  \n\t-- 1   1  1  1\n\t-- 2   0  1  1\n\t-- 3   1  0  1\n\t-- 4   0  0  1\n\t-- 5   1  1  0\n\t-- 6   0  1  0\n\t-- 7   1  0  0\n\t-- 8   0  0  0\n\t-- \n\t-- Values of\
      \ j higher than the number of active subtables are set\n\t-- to the string &quot;all&quot;.\n\t--\n\t-- A key for cfg.protectionCategories is constructed for each value of i.\n\t-- The position of the value in the key is determined by the keypos field\
      \ in\n\t-- each subtable.\n\t--]]\n\tlocal cats = cfg.protectionCategories\n\tfor i = 1, 2^noActive do\n\t\tlocal key = {}\n\t\tfor j, t in ipairs(attemptOrder) do\n\t\t\tif j &gt; noActive then\n\t\t\t\tkey[t.keypos] = 'all'\n\t\t\telse\n\t\t\t\tlocal\
      \ quotient = i / 2 ^ (j - 1)\n\t\t\t\tquotient = math.ceil(quotient)\n\t\t\t\tif quotient % 2 == 1 then\n\t\t\t\t\tkey[t.keypos] = t.val\n\t\t\t\telse\n\t\t\t\t\tkey[t.keypos] = 'all'\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\t\tkey = table.concat(key, '|')\n\
      \t\tlocal attempt = cats[key]\n\t\tif attempt then\n\t\t\treturn makeCategoryLink(attempt, title.text)\n\t\tend\n\tend\n\treturn ''\nend\n\nfunction Protection:needsExpiry()\n\tlocal cfg = self._cfg\n\tlocal actionNeedsCheck = cfg.expiryCheckActions[self.action]\n\
      \treturn not self.expiry and (\n\t\tactionNeedsCheck or (\n\t\t\tactionNeedsCheck == nil\n\t\t\tand self.reason -- the old {{pp-protected}} didn't check for expiry\n\t\t\tand not cfg.reasonsWithoutExpiryCheck[self.reason]\n\t\t)\n\t)\nend\n\nfunction Protection:isIncorrect()\n\
      \tlocal expiry = self.expiry\n\treturn not self:isProtected()\n\t\tor type(expiry) == 'number' and expiry &lt; os.time()\nend\n\nfunction Protection:isTemplateProtectedNonTemplate()\n\tlocal action, namespace = self.action, self.title.namespace\n\treturn\
      \ self.level == 'templateeditor'\n\t\tand (\n\t\t\t(action ~= 'edit' and action ~= 'move')\n\t\t\tor (namespace ~= 10 and namespace ~= 828)\n\t\t)\nend\n\nfunction Protection:makeCategoryLinks()\n\tlocal msg = self._cfg.msg\n\tlocal ret = { self:makeProtectionCategory()\
      \ }\n\tif self:needsExpiry() then\n\t\tret[#ret + 1] = makeCategoryLink(\n\t\t\tmsg['tracking-category-expiry'],\n\t\t\tself.title.text\n\t\t)\n\tend\n\tif self:isIncorrect() then\n\t\tret[#ret + 1] = makeCategoryLink(\n\t\t\tmsg['tracking-category-incorrect'],\n\
      \t\t\tself.title.text\n\t\t)\n\tend\n\tif self:isTemplateProtectedNonTemplate() then\n\t\tret[#ret + 1] = makeCategoryLink(\n\t\t\tmsg['tracking-category-template'],\n\t\t\tself.title.text\n\t\t)\n\tend\n\treturn table.concat(ret)\nend\n\n--------------------------------------------------------------------------------\n\
      -- Blurb class\n--------------------------------------------------------------------------------\n\nlocal Blurb = {}\nBlurb.__index = Blurb\n\nBlurb.bannerTextFields = {\n\ttext = true,\n\texplanation = true,\n\ttooltip = true,\n\talt = true,\n\tlink =\
      \ true\n}\n\nfunction Blurb.new(protectionObj, args, cfg)\n\treturn setmetatable({\n\t\t_cfg = cfg,\n\t\t_protectionObj = protectionObj,\n\t\t_args = args\n\t}, Blurb)\nend\n\n-- Private methods --\n\nfunction Blurb:_formatDate(num)\n\t-- Formats a Unix\
      \ timestamp into dd Month, YYYY format.\n\tlang = lang or mw.language.getContentLanguage()\n\tlocal success, date = pcall(\n\t\tlang.formatDate,\n\t\tlang,\n\t\tself._cfg.msg['expiry-date-format'] or 'j F Y',\n\t\t'@' .. tostring(num)\n\t)\n\tif success\
      \ then\n\t\treturn date\n\tend\nend\n\nfunction Blurb:_getExpandedMessage(msgKey)\n\treturn self:_substituteParameters(self._cfg.msg[msgKey])\nend\n\nfunction Blurb:_substituteParameters(msg)\n\tif not self._params then\n\t\tlocal parameterFuncs = {}\n\
      \n\t\tparameterFuncs.CURRENTVERSION     = self._makeCurrentVersionParameter\n\t\tparameterFuncs.EDITREQUEST        = self._makeEditRequestParameter\n\t\tparameterFuncs.EXPIRY             = self._makeExpiryParameter\n\t\tparameterFuncs.EXPLANATIONBLURB\
      \   = self._makeExplanationBlurbParameter\n\t\tparameterFuncs.IMAGELINK          = self._makeImageLinkParameter\n\t\tparameterFuncs.INTROBLURB         = self._makeIntroBlurbParameter\n\t\tparameterFuncs.INTROFRAGMENT      = self._makeIntroFragmentParameter\n\
      \t\tparameterFuncs.PAGETYPE           = self._makePagetypeParameter\n\t\tparameterFuncs.PROTECTIONBLURB    = self._makeProtectionBlurbParameter\n\t\tparameterFuncs.PROTECTIONDATE     = self._makeProtectionDateParameter\n\t\tparameterFuncs.PROTECTIONLEVEL\
      \    = self._makeProtectionLevelParameter\n\t\tparameterFuncs.PROTECTIONLOG      = self._makeProtectionLogParameter\n\t\tparameterFuncs.TALKPAGE           = self._makeTalkPageParameter\n\t\tparameterFuncs.TOOLTIPBLURB       = self._makeTooltipBlurbParameter\n\
      \t\tparameterFuncs.TOOLTIPFRAGMENT    = self._makeTooltipFragmentParameter\n\t\tparameterFuncs.VANDAL             = self._makeVandalTemplateParameter\n\t\t\n\t\tself._params = setmetatable({}, {\n\t\t\t__index = function (t, k)\n\t\t\t\tlocal param\n\t\
      \t\t\tif parameterFuncs[k] then\n\t\t\t\t\tparam = parameterFuncs[k](self)\n\t\t\t\tend\n\t\t\t\tparam = param or ''\n\t\t\t\tt[k] = param\n\t\t\t\treturn param\n\t\t\tend\n\t\t})\n\tend\n\t\n\tmsg = msg:gsub('${(%u+)}', self._params)\n\treturn msg\nend\n\
      \nfunction Blurb:_makeCurrentVersionParameter()\n\t-- A link to the page history or the move log, depending on the kind of\n\t-- protection.\n\tlocal pagename = self._protectionObj.title.prefixedText\n\tif self._protectionObj.action == 'move' then\n\t\t\
      -- We need the move log link.\n\t\treturn makeFullUrl(\n\t\t\t'Special:Log',\n\t\t\t{type = 'move', page = pagename},\n\t\t\tself:_getExpandedMessage('current-version-move-display')\n\t\t)\n\telse\n\t\t-- We need the history link.\n\t\treturn makeFullUrl(\n\
      \t\t\tpagename,\n\t\t\t{action = 'history'},\n\t\t\tself:_getExpandedMessage('current-version-edit-display')\n\t\t)\n\tend\nend\n\nfunction Blurb:_makeEditRequestParameter()\n\tlocal mEditRequest = require('Module:Submit an edit request')\n\tlocal action\
      \ = self._protectionObj.action\n\tlocal level = self._protectionObj.level\n\t\n\t-- Get the edit request type.\n\tlocal requestType\n\tif action == 'edit' then\n\t\tif level == 'autoconfirmed' then\n\t\t\trequestType = 'semi'\n\t\telseif level == 'templateeditor'\
      \ then\n\t\t\trequestType = 'template'\n\t\tend\n\tend\n\trequestType = requestType or 'full'\n\t\n\t-- Get the display value.\n\tlocal display = self:_getExpandedMessage('edit-request-display')\n\n\treturn mEditRequest._link{type = requestType, display\
      \ = display}\nend\n\nfunction Blurb:_makeExpiryParameter()\n\tlocal expiry = self._protectionObj.expiry\n\tif type(expiry) == 'number' then\n\t\treturn self:_formatDate(expiry)\n\telse\n\t\treturn expiry\n\tend\nend\n\nfunction Blurb:_makeExplanationBlurbParameter()\n\
      \t-- Cover special cases first.\n\tif self._protectionObj.title.namespace == 8 then\n\t\t-- MediaWiki namespace\n\t\treturn self:_getExpandedMessage('explanation-blurb-nounprotect')\n\tend\n\n\t-- Get explanation blurb table keys\n\tlocal action = self._protectionObj.action\n\
      \tlocal level = self._protectionObj.level\n\tlocal talkKey = self._protectionObj.title.isTalkPage and 'talk' or 'subject'\n\n\t-- Find the message in the explanation blurb table and substitute any\n\t-- parameters.\n\tlocal explanations = self._cfg.explanationBlurbs\n\
      \tlocal msg\n\tif explanations[action][level] and explanations[action][level][talkKey] then\n\t\tmsg = explanations[action][level][talkKey]\n\telseif explanations[action][level] and explanations[action][level].default then\n\t\tmsg = explanations[action][level].default\n\
      \telseif explanations[action].default and explanations[action].default[talkKey] then\n\t\tmsg = explanations[action].default[talkKey]\n\telseif explanations[action].default and explanations[action].default.default then\n\t\tmsg = explanations[action].default.default\n\
      \telse\n\t\terror(string.format(\n\t\t\t'could not find explanation blurb for action &quot;%s&quot;, level &quot;%s&quot; and talk key &quot;%s&quot;',\n\t\t\taction,\n\t\t\tlevel,\n\t\t\ttalkKey\n\t\t), 8)\n\tend\n\treturn self:_substituteParameters(msg)\n\
      end\n\nfunction Blurb:_makeImageLinkParameter()\n\tlocal imageLinks = self._cfg.imageLinks\n\tlocal action = self._protectionObj.action\n\tlocal level = self._protectionObj.level\n\tlocal msg\n\tif imageLinks[action][level] then\n\t\tmsg = imageLinks[action][level]\n\
      \telseif imageLinks[action].default then\n\t\tmsg = imageLinks[action].default\n\telse\n\t\tmsg = imageLinks.edit.default\n\tend\n\treturn self:_substituteParameters(msg)\nend\n\nfunction Blurb:_makeIntroBlurbParameter()\n\tif self._protectionObj:isTemporary()\
      \ then\n\t\treturn self:_getExpandedMessage('intro-blurb-expiry')\n\telse\n\t\treturn self:_getExpandedMessage('intro-blurb-noexpiry')\n\tend\nend\n\nfunction Blurb:_makeIntroFragmentParameter()\n\tif self._protectionObj:isTemporary() then\n\t\treturn\
      \ self:_getExpandedMessage('intro-fragment-expiry')\n\telse\n\t\treturn self:_getExpandedMessage('intro-fragment-noexpiry')\n\tend\nend\n\nfunction Blurb:_makePagetypeParameter()\n\tlocal pagetypes = self._cfg.pagetypes\n\treturn pagetypes[self._protectionObj.title.namespace]\n\
      \t\tor pagetypes.default\n\t\tor error('no default pagetype defined', 8)\nend\n\nfunction Blurb:_makeProtectionBlurbParameter()\n\tlocal protectionBlurbs = self._cfg.protectionBlurbs\n\tlocal action = self._protectionObj.action\n\tlocal level = self._protectionObj.level\n\
      \tlocal msg\n\tif protectionBlurbs[action][level] then\n\t\tmsg = protectionBlurbs[action][level]\n\telseif protectionBlurbs[action].default then\n\t\tmsg = protectionBlurbs[action].default\n\telseif protectionBlurbs.edit.default then\n\t\tmsg = protectionBlurbs.edit.default\n\
      \telse\n\t\terror('no protection blurb defined for protectionBlurbs.edit.default', 8)\n\tend\n\treturn self:_substituteParameters(msg)\nend\n\nfunction Blurb:_makeProtectionDateParameter()\n\tlocal protectionDate = self._protectionObj.protectionDate\n\t\
      if type(protectionDate) == 'number' then\n\t\treturn self:_formatDate(protectionDate)\n\telse\n\t\treturn protectionDate\n\tend\nend\n\nfunction Blurb:_makeProtectionLevelParameter()\n\tlocal protectionLevels = self._cfg.protectionLevels\n\tlocal action\
      \ = self._protectionObj.action\n\tlocal level = self._protectionObj.level\n\tlocal msg\n\tif protectionLevels[action][level] then\n\t\tmsg = protectionLevels[action][level]\n\telseif protectionLevels[action].default then\n\t\tmsg = protectionLevels[action].default\n\
      \telseif protectionLevels.edit.default then\n\t\tmsg = protectionLevels.edit.default\n\telse\n\t\terror('no protection level defined for protectionLevels.edit.default', 8)\n\tend\n\treturn self:_substituteParameters(msg)\nend\n\nfunction Blurb:_makeProtectionLogParameter()\n\
      \tlocal pagename = self._protectionObj.title.prefixedText\n\tif self._protectionObj.action == 'autoreview' then\n\t\t-- We need the pending changes log.\n\t\treturn makeFullUrl(\n\t\t\t'Special:Log',\n\t\t\t{type = 'stable', page = pagename},\n\t\t\tself:_getExpandedMessage('pc-log-display')\n\
      \t\t)\n\telse\n\t\t-- We need the protection log.\n\t\treturn makeFullUrl(\n\t\t\t'Special:Log',\n\t\t\t{type = 'protect', page = pagename},\n\t\t\tself:_getExpandedMessage('protection-log-display')\n\t\t)\n\tend\nend\n\nfunction Blurb:_makeTalkPageParameter()\n\
      \treturn string.format(\n\t\t'[[%s:%s#%s|%s]]',\n\t\tmw.site.namespaces[self._protectionObj.title.namespace].talk.name,\n\t\tself._protectionObj.title.text,\n\t\tself._args.section or 'top',\n\t\tself:_getExpandedMessage('talk-page-link-display')\n\t)\n\
      end\n\nfunction Blurb:_makeTooltipBlurbParameter()\n\tif self._protectionObj:isTemporary() then\n\t\treturn self:_getExpandedMessage('tooltip-blurb-expiry')\n\telse\n\t\treturn self:_getExpandedMessage('tooltip-blurb-noexpiry')\n\tend\nend\n\nfunction\
      \ Blurb:_makeTooltipFragmentParameter()\n\tif self._protectionObj:isTemporary() then\n\t\treturn self:_getExpandedMessage('tooltip-fragment-expiry')\n\telse\n\t\treturn self:_getExpandedMessage('tooltip-fragment-noexpiry')\n\tend\nend\n\nfunction Blurb:_makeVandalTemplateParameter()\n\
      \treturn require('Module:Vandal-m')._main{\n\t\tself._args.user or self._protectionObj.title.baseText\n\t}\nend\n\n-- Public methods --\n\nfunction Blurb:makeBannerText(key)\n\t-- Validate input.\n\tif not key or not Blurb.bannerTextFields[key] then\n\t\
      \terror(string.format(\n\t\t\t'&quot;%s&quot; is not a valid banner config field',\n\t\t\ttostring(key)\n\t\t), 2)\n\tend\n\n\t-- Generate the text.\n\tlocal msg = self._protectionObj.bannerConfig[key]\n\tif type(msg) == 'string' then\n\t\treturn self:_substituteParameters(msg)\n\
      \telseif type(msg) == 'function' then\n\t\tmsg = msg(self._protectionObj, self._args)\n\t\tif type(msg) ~= 'string' then\n\t\t\terror(string.format(\n\t\t\t\t'bad output from banner config function with key &quot;%s&quot;'\n\t\t\t\t\t.. ' (expected string,\
      \ got %s)',\n\t\t\t\ttostring(key),\n\t\t\t\ttype(msg)\n\t\t\t), 4)\n\t\tend\n\t\treturn self:_substituteParameters(msg)\n\tend\nend\n\n--------------------------------------------------------------------------------\n-- BannerTemplate class\n--------------------------------------------------------------------------------\n\
      \nlocal BannerTemplate = {}\nBannerTemplate.__index = BannerTemplate\n\nfunction BannerTemplate.new(protectionObj, cfg)\n\tlocal obj = {}\n\tobj._cfg = cfg\n\n\t-- Set the image filename.\n\tlocal imageFilename = protectionObj.bannerConfig.image\n\tif\
      \ imageFilename then\n\t\tobj._imageFilename = imageFilename\n\telse\n\t\t-- If an image filename isn't specified explicitly in the banner config,\n\t\t-- generate it from the protection status and the namespace.\n\t\tlocal action = protectionObj.action\n\
      \t\tlocal level = protectionObj.level\n\t\tlocal namespace = protectionObj.title.namespace\n\t\tlocal reason = protectionObj.reason\n\t\t\n\t\t-- Deal with special cases first.\n\t\tif (\n\t\t\tnamespace == 10\n\t\t\tor namespace == 828\n\t\t\tor reason\
      \ and obj._cfg.indefImageReasons[reason]\n\t\t\t)\n\t\t\tand action == 'edit'\n\t\t\tand level == 'sysop'\n\t\t\tand not protectionObj:isTemporary()\n\t\tthen\n\t\t\t-- Fully protected modules and templates get the special red &quot;indef&quot;\n\t\t\t\
      -- padlock.\n\t\t\tobj._imageFilename = obj._cfg.msg['image-filename-indef']\n\t\telse\n\t\t\t-- Deal with regular protection types.\n\t\t\tlocal images = obj._cfg.images\n\t\t\tif images[action] then\n\t\t\t\tif images[action][level] then\n\t\t\t\t\t\
      obj._imageFilename = images[action][level]\n\t\t\t\telseif images[action].default then\n\t\t\t\t\tobj._imageFilename = images[action].default\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\treturn setmetatable(obj, BannerTemplate)\nend\n\nfunction BannerTemplate:setImageWidth(width)\n\
      \tself._imageWidth = width\nend\n\nfunction BannerTemplate:setImageTooltip(tooltip)\n\tself._imageCaption = tooltip\nend\n\nfunction BannerTemplate:renderImage()\n\tlocal filename = self._imageFilename\n\t\tor self._cfg.msg['image-filename-default']\n\t\
      \tor 'Transparent.gif'\n\treturn newFileLink(filename)\n\t\t:width(self._imageWidth or 20)\n\t\t:alt(self._imageAlt)\n\t\t:link(self._imageLink)\n\t\t:caption(self._imageCaption)\n\t\t:render()\nend\n\n--------------------------------------------------------------------------------\n\
      -- Banner class\n--------------------------------------------------------------------------------\n\nlocal Banner = setmetatable({}, BannerTemplate)\nBanner.__index = Banner\n\nfunction Banner.new(protectionObj, blurbObj, cfg)\n\tlocal obj = BannerTemplate.new(protectionObj,\
      \ cfg) -- This doesn't need the blurb.\n\tobj:setImageWidth(40)\n\tobj:setImageTooltip(blurbObj:makeBannerText('alt')) -- Large banners use the alt text for the tooltip.\n\tobj._reasonText = blurbObj:makeBannerText('text')\n\tobj._explanationText = blurbObj:makeBannerText('explanation')\n\
      \tobj._page = protectionObj.title.prefixedText -- Only makes a difference in testing.\n\treturn setmetatable(obj, Banner)\nend\n\nfunction Banner:__tostring()\n\t-- Renders the banner.\n\tmakeMessageBox = makeMessageBox or require('Module:Message box').main\n\
      \tlocal reasonText = self._reasonText or error('no reason text set', 2)\n\tlocal explanationText = self._explanationText\n\tlocal mbargs = {\n\t\tpage = self._page,\n\t\ttype = 'protection',\n\t\timage = self:renderImage(),\n\t\ttext = string.format(\n\
      \t\t\t&quot;'''%s'''%s&quot;,\n\t\t\treasonText,\n\t\t\texplanationText and '&lt;br /&gt;' .. explanationText or ''\n\t\t)\n\t}\n\treturn makeMessageBox('mbox', mbargs)\nend\n\n--------------------------------------------------------------------------------\n\
      -- Padlock class\n--------------------------------------------------------------------------------\n\nlocal Padlock = setmetatable({}, BannerTemplate)\nPadlock.__index = Padlock\n\nfunction Padlock.new(protectionObj, blurbObj, cfg)\n\tlocal obj = BannerTemplate.new(protectionObj,\
      \ cfg) -- This doesn't need the blurb.\n\tobj:setImageWidth(20)\n\tobj:setImageTooltip(blurbObj:makeBannerText('tooltip'))\n\tobj._imageAlt = blurbObj:makeBannerText('alt')\n\tobj._imageLink = blurbObj:makeBannerText('link')\n\tobj._right = cfg.padlockPositions[protectionObj.action]\n\
      \t\tor cfg.padlockPositions.default\n\t\tor '55px'\n\treturn setmetatable(obj, Padlock)\nend\n\nfunction Padlock:__tostring()\n\tlocal root = mw.html.create('div')\n\troot\n\t\t:addClass('metadata topicon nopopups')\n\t\t:attr('id', 'protected-icon')\n\
      \t\t:css{display = 'none', right = self._right}\n\t\t:wikitext(self:renderImage())\n\treturn tostring(root)\nend\n\n--------------------------------------------------------------------------------\n-- Exports\n--------------------------------------------------------------------------------\n\
      \nlocal p = {}\n\nfunction p._exportClasses()\n\t-- This is used for testing purposes.\n\treturn {\n\t\tProtection = Protection,\n\t\tBlurb = Blurb,\n\t\tBannerTemplate = BannerTemplate,\n\t\tBanner = Banner,\n\t\tPadlock = Padlock,\n\t}\nend\n\nfunction\
      \ p._main(args, cfg, title)\n\targs = args or {}\n\tcfg = cfg or require(CONFIG_MODULE)\n\n\tlocal protectionObj = Protection.new(args, cfg, title)\n\n\tlocal ret = {}\n\n\t-- If a page's edit protection is equally or more restrictive than its protection\
      \ from some other action,\n\t-- then don't bother displaying anything for the other action (except categories).\n\tif protectionObj.action == 'edit' or args.demolevel or not walkHierarchy(cfg.hierarchy, protectionObj.level)[effectiveProtectionLevel('edit',\
      \ protectionObj.title)] then\n\t\t-- Initialise the blurb object\n\t\tlocal blurbObj = Blurb.new(protectionObj, args, cfg)\n\t\n\t\t-- Render the banner\n\t\tif protectionObj:isProtected() then\n\t\t\tret[#ret + 1] = tostring(\n\t\t\t\t(yesno(args.small)\
      \ and Padlock or Banner)\n\t\t\t\t.new(protectionObj, blurbObj, cfg)\n\t\t\t)\n\t\tend\n\tend\n\n\t-- Render the categories\n\tif yesno(args.category) ~= false then\n\t\tret[#ret + 1] = protectionObj:makeCategoryLinks()\n\tend\n\t\n\treturn table.concat(ret)\t\
      \nend\n\nfunction p.main(frame, cfg)\n\tcfg = cfg or require(CONFIG_MODULE)\n\n\t-- Find default args, if any.\n\tlocal parent = frame.getParent and frame:getParent()\n\tlocal defaultArgs = parent and cfg.wrappers[parent:getTitle():gsub('/sandbox$', '')]\n\
      \n\t-- Find user args, and use the parent frame if we are being called from a\n\t-- wrapper template.\n\tgetArgs = getArgs or require('Module:Arguments').getArgs\n\tlocal userArgs = getArgs(frame, {\n\t\tparentOnly = defaultArgs,\n\t\tframeOnly = not defaultArgs\n\
      \t})\n\n\t-- Build the args table. User-specified args overwrite default args.\n\tlocal args = {}\n\tfor k, v in pairs(defaultArgs or {}) do\n\t\targs[k] = v\n\tend\n\tfor k, v in pairs(userArgs) do\n\t\targs[k] = v\n\tend\n\treturn p._main(args, cfg)\n\
      end\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:17.859Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANo+globals&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:17 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103502888, 343385102, 4115553571
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42567026\" ns=\"828\" title=\"Module:No globals\"><revisions><rev user=\"Jackmcbarn\" timestamp=\"2014-05-02T15:35:56Z\" comment=\"rm name exception\" contentformat=\"text/plain\"\
      \ contentmodel=\"Scribunto\" xml:space=\"preserve\">local mt = getmetatable(_G) or {}\nfunction mt.__index (t, k)\n\tif k ~= 'arg' then\n\t\terror('Tried to read nil global ' .. tostring(k), 2)\n\tend\n\treturn nil\nend\nfunction mt.__newindex(t, k, v)\n\
      \tif k ~= 'arg' then\n\t\terror('Tried to write global ' .. tostring(k), 2)\n\tend\n\trawset(t, k, v)\nend\nsetmetatable(_G, mt)</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:18.169Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AFile+link&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:18 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq60 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123466914, 361857295, 4115554295
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42903140\" ns=\"828\" title=\"Module:File link\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-06-04T00:06:16Z\" comment=\"Undid revision 611451330 by [[Special:Contributions/Mr.\
      \ Stradivarius|Mr. Stradivarius]] ([[User talk:Mr. Stradivarius|talk]]) whoops, that edit was supposed to be to the sandbox...\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module provides a library for formatting\
      \ file wikilinks.\n\nlocal libraryUtil = require('libraryUtil')\nlocal checkType = libraryUtil.checkType\n\nlocal fileLink = {}\n\nfunction fileLink.new(filename)\n\tcheckType('fileLink.new', 1, filename, 'string', true)\n\tlocal obj, data = {}, {}\n\t\
      \n\tlocal checkSelf = libraryUtil.makeCheckSelfFunction(\n\t\t'fileLink',\n\t\t'fileLink',\n\t\tobj,\n\t\t'fileLink object'\n\t)\n\t\n\t-- Set the filename if we were passed it as an input to fileLink.new.\n\tif filename then\n\t\tdata.theName = filename\n\
      \tend\n\t\n\tfunction data:name(s)\n\t\tcheckSelf(self, 'name')\n\t\tcheckType('fileLink:name', 1, s, 'string')\n\t\tdata.theName = s\n\t\treturn self\n\tend\n\t\n\tfunction data:format(s, filename)\n\t\tcheckSelf(self, 'format')\n\t\tcheckType('fileLink:format',\
      \ 1, s, 'string', true)\n\t\tcheckType('fileLink:format', 2, format, 'string', true)\n\t\tlocal validFormats = {\n\t\t\tthumb = true,\n\t\t\tthumbnail = true,\n\t\t\tframe = true,\n\t\t\tframed = true,\n\t\t\tframeless = true\n\t\t}\n\t\tif s == nil or\
      \ validFormats[s] then\n\t\t\tdata.theFormat = s\n\t\t\tdata.theFormatFilename = filename\n\t\telse\n\t\t\terror(string.format(\n\t\t\t\t&quot;bad argument #1 to 'fileLink:format' ('%s' is not a valid format)&quot;,\n\t\t\t\ts\n\t\t\t), 2)\n\t\tend\n\t\
      \treturn self\n\tend\n\n\tlocal function sizeError(methodName)\n\t\t-- Used for formatting duplication errors in size-related methods.\n\t\terror(string.format(\n\t\t\t&quot;duplicate size argument detected in '%s'&quot;\n\t\t\t.. &quot; ('upright' cannot\
      \ be used in conjunction with height or width)&quot;,\n\t\t\tmethodName\n\t\t), 3)\n\tend\n\t\n\tfunction data:width(px)\n\t\tcheckSelf(self, 'width')\n\t\tcheckType('fileLink:width', 1, px, 'number', true)\n\t\tif px and data.isUpright then\n\t\t\tsizeError('fileLink:width')\n\
      \t\tend\n\t\tdata.theWidth = px\n\t\treturn self\n\tend\n\t\n\tfunction data:height(px)\n\t\tcheckSelf(self, 'height')\n\t\tcheckType('fileLink:height', 1, px, 'number', true)\n\t\tif px and data.isUpright then\n\t\t\tsizeError('fileLink:height')\n\t\t\
      end\n\t\tdata.theHeight = px\n\t\treturn self\n\tend\n\t\n\tfunction data:upright(isUpright, factor)\n\t\tcheckSelf(self, 'upright')\n\t\tcheckType('fileLink:upright', 1, isUpright, 'boolean', true)\n\t\tcheckType('fileLink:upright', 2, factor, 'number',\
      \ true)\n\t\tif isUpright and (data.theWidth or data.theHeight) then\n\t\t\tsizeError('fileLink:upright')\n\t\tend\n\t\tdata.isUpright = isUpright\n\t\tdata.uprightFactor = factor\n\t\treturn self\n\tend\n\t\n\tfunction data:resetSize()\n\t\tcheckSelf(self,\
      \ 'resetSize')\n\t\tfor i, field in ipairs{'theWidth', 'theHeight', 'isUpright', 'uprightFactor'} do\n\t\t\tdata[field] = nil\n\t\tend\n\t\treturn self\n\tend\n\t\n\tfunction data:location(s)\n\t\tcheckSelf(self, 'location')\n\t\tcheckType('fileLink:location',\
      \ 1, s, 'string', true)\n\t\tlocal validLocations = {\n\t\t\tright = true,\n\t\t\tleft = true,\n\t\t\tcenter = true,\n\t\t\tnone = true\n\t\t}\n\t\tif s == nil or validLocations[s] then\n\t\t\tdata.theLocation = s\n\t\telse\n\t\t\terror(string.format(\n\
      \t\t\t\t&quot;bad argument #1 to 'fileLink:location' ('%s' is not a valid location)&quot;,\n\t\t\t\ts\n\t\t\t), 2)\n\t\tend\n\t\treturn self\n\tend\n\t\n\tfunction data:alignment(s)\n\t\tcheckSelf(self, 'alignment')\n\t\tcheckType('fileLink:alignment',\
      \ 1, s, 'string', true)\n\t\tlocal validAlignments = {\n\t\t\tbaseline = true,\n\t\t\tmiddle = true,\n\t\t\tsub = true,\n\t\t\tsuper = true,\n\t\t\t['text-top'] = true,\n\t\t\t['text-bottom'] = true,\n\t\t\ttop = true,\n\t\t\tbottom = true\n\t\t}\n\t\t\
      if s == nil or validAlignments[s] then\n\t\t\tdata.theAlignment = s\n\t\telse\n\t\t\terror(string.format(\n\t\t\t\t&quot;bad argument #1 to 'fileLink:alignment' ('%s' is not a valid alignment)&quot;,\n\t\t\t\ts\n\t\t\t), 2)\n\t\tend\n\t\treturn self\n\t\
      end\n\t\n\tfunction data:border(hasBorder)\n\t\tcheckSelf(self, 'border')\n\t\tcheckType('fileLink:border', 1, hasBorder, 'boolean', true)\n\t\tdata.hasBorder = hasBorder\n\t\treturn self\n\tend\n\t\n\tfunction data:link(s)\n\t\tcheckSelf(self, 'link')\n\
      \t\tcheckType('fileLink:link', 1, s, 'string', true)\n\t\tdata.theLink = s\n\t\treturn self\n\tend\n\t\n\tfunction data:alt(s)\n\t\tcheckSelf(self, 'alt')\n\t\tcheckType('fileLink:alt', 1, s, 'string', true)\n\t\tdata.theAlt = s\n\t\treturn self\n\tend\n\
      \t\n\tfunction data:page(num)\n\t\tcheckSelf(self, 'page')\n\t\tcheckType('fileLink:page', 1, num, 'number', true)\n\t\tdata.thePage = s\n\t\treturn self\n\tend\n\t\n\tfunction data:class(s)\n\t\tcheckSelf(self, 'class')\n\t\tcheckType('fileLink:class',\
      \ 1, s, 'string', true)\n\t\tdata.theClass = s\n\t\treturn self\n\tend\n\t\n\tfunction data:lang(s)\n\t\tcheckSelf(self, 'lang')\n\t\tcheckType('fileLink:lang', 1, s, 'string', true)\n\t\tdata.theLang = s\n\t\treturn self\n\tend\n\n\tlocal function checkTypeStringOrNum(funcName,\
      \ pos, arg)\n\t\tlocal argType = type(arg)\n\t\tif argType ~= 'nil' and argType ~= 'string' and argType ~= 'number' then\n\t\t\terror(string.format(\n\t\t\t\t&quot;bad argument #%d to '%s' (string or number expected, got %s)&quot;,\n\t\t\t\tpos,\n\t\t\t\
      \tfuncName,\n\t\t\t\targType\n\t\t\t), 3)\n\t\tend\n\tend\n\t\n\tfunction data:startTime(time)\n\t\tcheckSelf(self, 'startTime')\n\t\tcheckTypeStringOrNum('fileLink:startTime', 1, time)\n\t\tdata.theStartTime = time\n\t\treturn self\n\tend\n\t\n\tfunction\
      \ data:endTime(time)\n\t\tcheckSelf(self, 'endTime')\n\t\tcheckTypeStringOrNum('fileLink:endTime', 1, time)\n\t\tdata.theEndTime = time\n\t\treturn self\n\tend\n\t\n\tfunction data:thumbTime(time)\n\t\tcheckSelf(self, 'thumbTime')\n\t\tcheckTypeStringOrNum('fileLink:thumbTime',\
      \ 1, time)\n\t\tdata.theThumbTime = time\n\t\treturn self\n\tend\n\t\n\tfunction data:caption(s)\n\t\tcheckSelf(self, 'caption')\n\t\tcheckType('fileLink:caption', 1, s, 'string', true)\n\t\tdata.theCaption = s\n\t\treturn self\n\tend\n\t\n\tfunction data:render()\n\
      \t\tcheckSelf(self, 'render')\n\t\tlocal ret = {}\n\t\t\n\t\t-- Filename\n\t\tif not data.theName then\n\t\t\terror('fileLink:render: no filename was found')\n\t\tend\n\t\tret[#ret + 1] = 'File:' .. data.theName\n\t\t\n\t\t-- Format\n\t\tif data.theFormat\
      \ and data.theFormatFilename then\n\t\t\tret[#ret + 1] = data.theFormat .. '=' .. data.theFormatFilename\n\t\telseif data.theFormat then\n\t\t\tret[#ret + 1] = data.theFormat\n\t\tend\n\t\t\n\t\t-- Border\n\t\tif data.hasBorder then\n\t\t\tret[#ret + 1]\
      \ = 'border'\n\t\tend\n\t\t\n\t\t-- Location\n\t\tret[#ret + 1] = data.theLocation\n\n\t\t-- Alignment\n\t\tret[#ret + 1] = data.theAlignment\n\t\t\n\t\t-- Size\n\t\tif data.isUpright and data.uprightFactor then\n\t\t\tret[#ret + 1] = 'upright=' .. tostring(data.uprightFactor)\n\
      \t\telseif data.isUpright then\n\t\t\tret[#ret + 1] = 'upright'\n\t\telseif data.theWidth and data.theHeight then\n\t\t\tret[#ret + 1] = string.format('%dx%dpx', data.theWidth, data.theHeight)\n\t\telseif data.theWidth then\n\t\t\tret[#ret + 1] = tostring(data.theWidth)\
      \ .. 'px'\n\t\telseif data.theHeight then\n\t\t\tret[#ret + 1] = string.format('x%dpx', data.theHeight)\n\t\tend\n\t\t\n\t\t-- Render named parameters.\n\t\t-- That includes link, alt, page, class, lang, start, end, and thumbtime.\n\t\tdo\n\t\t\tlocal\
      \ namedParameters = {\n\t\t\t\t{'link', 'theLink'},\n\t\t\t\t{'alt', 'theAlt'},\n\t\t\t\t{'page', 'thePage'},\n\t\t\t\t{'class', 'theClass'},\n\t\t\t\t{'lang', 'theLang'},\n\t\t\t\t{'start', 'theStartTime'},\n\t\t\t\t{'end', 'theEndTime'},\n\t\t\t\t{'thumbtime',\
      \ 'theThumbTime'}\n\t\t\t}\n\t\t\tfor i, t in ipairs(namedParameters) do\n\t\t\t\tlocal parameter = t[1]\n\t\t\t\tlocal value = data[t[2]]\n\t\t\t\tif value then\n\t\t\t\t\tret[#ret + 1] = parameter .. '=' .. tostring(value)\n\t\t\t\tend\n\t\t\tend\n\t\
      \tend\n\n\t\t-- Caption\n\t\tret[#ret + 1] = data.theCaption\n\t\t\n\t\treturn string.format('[[%s]]', table.concat(ret, '|'))\n\tend\n\t\n\tlocal privateFields = {\n\t\ttheName = true,\n\t\ttheFormat = true,\n\t\ttheFormatFilename = true,\n\t\ttheWidth\
      \ = true,\n\t\ttheHeight = true,\n\t\tisUpright = true,\n\t\tuprightFactor = true,\n\t\ttheLocation = true,\n\t\ttheAlignment = true,\n\t\thasBorder = true,\n\t\ttheLink = true,\n\t\ttheAlt = true,\n\t\tthePage = true,\n\t\ttheClass = true,\n\t\ttheLang\
      \ = true,\n\t\ttheCaption = true\n\t}\n\t\n\tlocal readOnlyFields = {}\n\tfor field in pairs(data) do\n\t\treadOnlyFields[field] = true\n\tend\n\treadOnlyFields.theName = nil -- This is set if a filename is given to fileLink.new, so remove it.\n\t\n\t\
      local function restrictedFieldError(key, restriction)\n\t\terror(string.format(\n\t\t\t&quot;fileLink object field '%s' is %s&quot;,\n\t\t\ttostring(key),\n\t\t\trestriction\n\t\t), 3)\n\tend\n\t\n\tsetmetatable(obj, {\n\t\t__index = function (t, key)\n\
      \t\t\tif privateFields[key] then\n\t\t\t\trestrictedFieldError(key, 'private')\n\t\t\telse\n\t\t\t\treturn data[key]\n\t\t\tend\n\t\tend,\n\t\t__newindex = function (t, key, value)\n\t\t\tif privateFields[key] then\n\t\t\t\trestrictedFieldError(key, 'private')\n\
      \t\t\telseif readOnlyFields[key] then\n\t\t\t\trestrictedFieldError(key, 'read-only')\n\t\t\telse\n\t\t\t\tdata[key] = value\n\t\t\tend\n\t\tend,\n\t\t__tostring = function (t)\n\t\t\treturn t:render()\n\t\tend,\n\t\t__pairs = function ()\n\t\t\tlocal\
      \ temp = {}\n\t\t\tfor k, v in pairs(data) do\n\t\t\t\tif not privateFields[k] then\n\t\t\t\t\ttemp[k] = v\n\t\t\t\tend\n\t\t\tend\n\t\t\treturn pairs(temp)\n\t\tend\n\t})\n\t\n\treturn obj\nend\n\nreturn fileLink</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:18.473Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AEffective+protection+level&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:18 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq35 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055654296, 4156152791, 4115554524
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"41617327\" ns=\"828\" title=\"Module:Effective protection level\"><revisions><rev user=\"Jackmcbarn\" timestamp=\"2014-09-16T04:01:14Z\" comment=\"must be subpage too\" contentformat=\"\
      text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">local p = {}\n\n-- Returns the permission required to perform a given action on a given title.\n-- If no title is specified, the title of the page being displayed is used.\nfunction p._main(action,\
      \ pagename)\n\tlocal title\n\tif type(pagename) == 'table' and pagename.prefixedText then\n\t\ttitle = pagename\n\telseif pagename then\n\t\ttitle = mw.title.new(pagename)\n\telse\n\t\ttitle = mw.title.getCurrentTitle()\n\tend\n\tpagename = title.prefixedText\n\
      \tif action == 'autoreview' then\n\t\tlocal level = mw.getCurrentFrame():callParserFunction('PENDINGCHANGELEVEL', pagename)\n\t\tif level == 'review' then\n\t\t\treturn 'reviewer'\n\t\telseif level ~= '' then\n\t\t\treturn level\n\t\telse\n\t\t\treturn\
      \ nil -- not '*'. a page not being PC-protected is distinct from it being PC-protected with anyone able to review. also not '', as that would mean PC-protected but nobody can review\n\t\tend\n\telseif action ~= 'edit' and action ~= 'move' and action ~=\
      \ 'create' and action ~= 'upload' then\n\t\terror( 'First parameter must be one of edit, move, create, upload, autoreview', 2 )\n\tend\n\tif title.namespace == 8 then -- MediaWiki namespace\n\t\treturn 'sysop'\n\telseif title.namespace == 2 and title.isSubpage\
      \ and ( title.contentModel == 'javascript' or title.contentModel == 'css' ) then -- user JS or CSS page\n\t\treturn 'sysop'\n\tend\n\tlocal level = title.protectionLevels[action] and title.protectionLevels[action][1]\n\tif level == 'sysop' then\n\t\treturn\
      \ 'sysop'\n\telseif title.cascadingProtection.restrictions[action] and title.cascadingProtection.restrictions[action][1] then -- used by a cascading-protected page\n\t\treturn 'sysop'\n\telseif level == 'templateeditor' then\n\t\treturn 'templateeditor'\n\
      \telseif action == 'move' then\n\t\tlocal blacklistentry = mw.ext.TitleBlacklist.test('edit', pagename) -- Testing action edit is correct, since this is for the source page. The target page name gets tested with action move.\n\t\tif blacklistentry and\
      \ not blacklistentry.params.autoconfirmed then\n\t\t\treturn 'accountcreator'\n\t\telseif title.namespace == 6 then\n\t\t\treturn 'filemover'\n\t\telse\n\t\t\treturn 'autoconfirmed'\n\t\tend\n\tend\n\tlocal blacklistentry = mw.ext.TitleBlacklist.test(action,\
      \ pagename)\n\tif blacklistentry then\n\t\treturn blacklistentry.params.autoconfirmed and 'autoconfirmed' or 'accountcreator'\n\telseif level then\n\t\treturn level\n\telseif action == 'upload' then\n\t\treturn 'autoconfirmed'\n\telseif action == 'create'\
      \ and title.namespace % 2 == 0 and title.namespace ~= 118 then -- You need to be registered, but not autoconfirmed, to create non-talk pages other than drafts\n\t\treturn 'user'\n\telse\n\t\treturn '*'\n\tend\nend\n\nsetmetatable(p, { __index = function(t,\
      \ k)\n\treturn function(frame)\n\t\treturn t._main(k, frame.args[1])\n\tend\nend })\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:19.177Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AProtection+banner%2Fconfig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:18 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348960040, 343386601, 4115555253
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42982788\" ns=\"828\" title=\"Module:Protection banner/config\"><revisions><rev user=\"28bytes\" timestamp=\"2014-10-03T18:55:15Z\" comment=\"retarget ban link per MfD outcome\"\
      \ contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module provides configuration data for [[Module:Protection banner]].\n\nreturn {\n\n--------------------------------------------------------------------------------\n\
      --\n--                                BANNER DATA\n--\n--------------------------------------------------------------------------------\n\n--[[\n-- Banner data consists of six fields:\n-- * text - the main protection text that appears at the top of protection\n\
      --   banners.\n-- * explanation - the text that appears below the main protection text, used\n--   to explain the details of the protection.\n-- * tooltip - the tooltip text you see when you move the mouse over a small\n--   padlock icon.\n-- * link -\
      \ the page that the small padlock icon links to.\n-- * alt - the alt text for the small padlock icon. This is also used as tooltip\n--   text for the large protection banners.\n-- * image - the padlock image used in both protection banners and small padlock\n\
      --   icons.\n--\n-- The module checks in three separate tables to find a value for each field.\n-- First it checks the banners table, which has values specific to the reason\n-- for the page being protected. Then the module checks the defaultBanners\n\
      -- table, which has values specific to each protection level. Finally, the\n-- module checks the masterBanner table, which holds data for protection\n-- templates to use if no data has been found in the previous two tables.\n--\n-- The values in the banner\
      \ data can take parameters. These are specified\n-- using ${TEXTLIKETHIS} (a dollar sign preceding a parameter name\n-- enclosed in curly braces).\n--\n--                          Available parameters:\n--\n-- ${CURRENTVERSION} - a link to the page history\
      \ or the move log, with the\n-- display message &quot;current-version-edit-display&quot; or\n-- &quot;current-version-move-display&quot;.\n--\n-- ${EDITREQUEST} - a link to create an edit request for the current page.\n--\n-- ${EXPIRY} - the protection\
      \ expiry date in the format DD Month YYYY. If\n-- protection is indefinite or is not set, this is the blank string.\n--\n-- ${EXPLANATIONBLURB} - an explanation blurb, e.g. &quot;Please discuss any changes\n-- on the talk page; you may submit a request\
      \ to ask an administrator to make\n-- an edit if it is minor or supported by consensus.&quot;\n--\n-- ${IMAGELINK} - a link to set the image to, depending on the protection\n-- action and protection level.\n--\n-- ${INTROBLURB} - the PROTECTIONBLURB parameter,\
      \ plus the expiry if an expiry\n-- is set. E.g. &quot;Editing of this page by new or unregistered users is currently \n-- disabled until dd Month YYYY.&quot;\n--\n-- ${INTROFRAGMENT} - the same as ${INTROBLURB}, but without final punctuation\n-- so that\
      \ it can be used in run-on sentences.\n--\n-- ${PAGETYPE} - the type of the page, e.g. &quot;article&quot; or &quot;template&quot;.\n-- Defined in the cfg.pagetypes table.\n--\n-- ${PROTECTIONBLURB} - a blurb explaining the protection level of the page,\
      \ e.g.\n-- &quot;Editing of this page by new or unregistered users is currently disabled&quot;\n--\n-- ${PROTECTIONDATE} - the protection date, if it has been supplied to the\n-- template.\n--\n-- ${PROTECTIONLEVEL} - the protection level, e.g. &quot;fully\
      \ protected&quot; or\n-- &quot;semi-protected&quot;.\n--\n-- ${PROTECTIONLOG} - a link to the protection log or the pending changes log,\n-- depending on the protection action.\n--\n-- ${TALKPAGE} - a link to the talk page. If a section is specified, links\n\
      -- straight to that talk page section.\n--\n-- ${TOOLTIPBLURB} - uses the PAGETYPE, PROTECTIONTYPE and EXPIRY parameters to\n-- create a blurb like &quot;This template is semi-protected&quot;, or &quot;This article is\n-- move-protected until DD Month\
      \ YYYY&quot;.\n--\n-- ${VANDAL} - links for the specified username (or the root page name)\n-- using Module:Vandal-m.\n--\n--                                 Functions\n--\n-- For advanced users, it is possible to use Lua functions instead of strings\n\
      -- in the banner config tables. Using functions gives flexibility that is not\n-- possible just by using parameters. Functions take two arguments, the\n-- protection object and the template arguments, and they must output a string.\n--\n-- For example:\n\
      --\n-- text = function (protectionObj, args)\n--     if protectionObj.level == 'autoconfirmed' then\n--         return 'foo'\n--     else\n--         return 'bar'\n--     end\n-- end\n--\n-- Some protection object properties and methods that may be useful:\n\
      -- protectionObj.action - the protection action\n-- protectionObj.level - the protection level\n-- protectionObj.reason - the protection reason\n-- protectionObj.expiry - the expiry. Nil if unset, the string &quot;indef&quot; if set\n--     to indefinite,\
      \ and the protection time in unix time if temporary.\n-- protectionObj.protectionDate - the protection date in unix time, or nil if\n--     unspecified.\n-- protectionObj.bannerConfig - the banner config found by the module. Beware\n--     of editing the\
      \ config field used by the function, as it could create an\n--     infinite loop.\n-- protectionObj:isProtected - returns a boolean showing whether the page is\n--     protected.\n-- protectionObj:isTemporary - returns a boolean showing whether the expiry\
      \ is\n--     temporary.\n-- protectionObj:isIncorrect - returns a boolean showing whether the protection\n--     template is incorrect.\n--]]\n\n-- The master banner data, used if no values have been found in banners or\n-- defaultBanners.\nmasterBanner\
      \ = {\n\ttext = '${INTROBLURB}',\n\texplanation = '${EXPLANATIONBLURB}',\n\ttooltip = '${TOOLTIPBLURB}',\n\tlink = '${IMAGELINK}',\n\talt = 'Page ${PROTECTIONLEVEL}'\n},\n\n-- The default banner data. This holds banner data for different protection\n--\
      \ levels.\n-- *required* - this table needs edit, move, and autoreview subtables.\ndefaultBanners = {\n\tedit = {},\n\tmove = {},\n\tautoreview = {\n\t\tautoconfirmed = {\n\t\t\talt = 'Page protected with pending changes level 1',\n\t\t\ttooltip = 'All\
      \ edits by unregistered and new users are subject to review',\n\t\t\timage = 'Padlock-silver-light.svg'\n\t\t},\n\t\tdefault = {\n\t\t\talt = 'Page protected with pending changes level 2',\n\t\t\ttooltip = 'All edits by users who are not reviewers or administrators\
      \ are'\n\t\t\t\t.. ' subject to review',\n\t\t}\n\t}\n},\n\n-- The banner data. This holds banner data for different protection reasons.\n-- In fact, the reasons specified in this table control which reasons are\n-- valid inputs to the first positional\
      \ parameter.\n--\n-- There is also a non-standard &quot;description&quot; field that can be used for items\n-- in this table. This is a description of the protection reason for use in the\n-- module documentation.\n--\n-- *required* - this table needs\
      \ edit, move, and autoreview subtables.\nbanners = {\n\tedit = {\n\t\tblp = {\n\t\t\tdescription = 'For pages protected to promote compliance with the'\n\t\t\t\t.. ' [[Wikipedia:Biographies of living persons'\n\t\t\t\t.. '|biographies of living persons]]\
      \ policy.',\n\t\t\ttext = '${INTROFRAGMENT} to promote compliance with'\n\t\t\t\t.. ' [[Wikipedia:Biographies of living persons'\n\t\t\t\t.. &quot;|Wikipedia's&amp;nbsp;policy on&amp;nbsp;the&amp;nbsp;biographies&quot;\n\t\t\t\t.. ' of&amp;nbsp;living&amp;nbsp;people]].',\n\
      \t\t\ttooltip = '${TOOLTIPFRAGMENT} to promote compliance with the policy on'\n\t\t\t\t.. ' biographies of living people',\n\t\t},\n\t\tdmca = {\n\t\t\tdescription = 'For pages protected by the Wikimedia Foundation'\n\t\t\t\t.. ' due to Digital Millennium\
      \ Copyright Act takedown requests.',\n\t\t\texplanation = function (protectionObj, args)\n\t\t\t\tlocal ret = 'Pursuant to a rights owner notice under the Digital'\n\t\t\t\t\t.. ' Millennium Copyright Act (DMCA) regarding some content'\n\t\t\t\t\t.. '\
      \ in this article, the Wikimedia Foundation acted under'\n\t\t\t\t\t.. ' applicable law and took down and restricted the content'\n\t\t\t\t\t.. ' in question.'\n\t\t\t\tif args.notice then\n\t\t\t\t\tret = ret .. ' A copy of the received notice can be\
      \ found here: '\n\t\t\t\t\t\t.. args.notice .. '.'\n\t\t\t\tend\n\t\t\t\tret = ret .. ' For more information, including websites discussing'\n\t\t\t\t\t.. ' how to file a counter-notice, please see'\n\t\t\t\t\t.. &quot; [[Wikipedia:Office actions]] and\
      \ the article's ${TALKPAGE}.&quot;\n\t\t\t\t\t.. &quot;'''Do not remove this template from the article until the&quot;\n\t\t\t\t\t.. &quot; restrictions are withdrawn'''.&quot;\n\t\t\t\treturn ret\n\t\t\tend,\n\t\t\timage = 'Padlock-black.svg',\n\t\t},\n\
      \t\tdispute = {\n\t\t\tdescription = 'For pages protected due to editing disputes.',\n\t\t\ttext = function (protectionObj, args)\n\t\t\t\t-- Find the value of &quot;disputes&quot;.\n\t\t\t\tlocal display = 'disputes'\n\t\t\t\tlocal disputes\n\t\t\t\t\
      if args.section then\n\t\t\t\t\tdisputes = string.format(\n\t\t\t\t\t\t'[[%s:%s#%s|%s]]',\n\t\t\t\t\t\tmw.site.namespaces[protectionObj.title.namespace].talk.name,\n\t\t\t\t\t\tprotectionObj.title.text,\n\t\t\t\t\t\targs.section,\n\t\t\t\t\t\tdisplay\n\
      \t\t\t\t\t)\n\t\t\t\telse\n\t\t\t\t\tdisputes = display\n\t\t\t\tend\n\n\t\t\t\t-- Make the blurb, depending on the expiry.\n\t\t\t\tlocal msg\n\t\t\t\tif type(protectionObj.expiry) == 'number' then\n\t\t\t\t\tmsg = '${INTROFRAGMENT} or until editing %s\
      \ have been resolved.'\n\t\t\t\telse\n\t\t\t\t\tmsg = '${INTROFRAGMENT} until editing %s have been resolved.'\n\t\t\t\tend\n\t\t\t\treturn string.format(msg, disputes)\n\t\t\tend,\n\t\t\texplanation = &quot;This protection is '''not''' an endorsement of\
      \ the&quot;\n\t\t\t\t.. ' ${CURRENTVERSION}. ${EXPLANATIONBLURB}',\n\t\t\ttooltip = '${TOOLTIPFRAGMENT} due to editing disputes',\n\t\t},\n\t\tmainpage = {\n\t\t\tdescription = 'For pages protected for being displayed on the [[Main Page]].',\n\t\t\ttext\
      \ = 'This file is currently'\n\t\t\t\t.. ' [[Wikipedia:This page is protected|protected]] from'\n\t\t\t\t.. ' editing because it is currently or will soon be displayed'\n\t\t\t\t.. ' on the [[Main Page]].',\n\t\t\texplanation = 'Images on the Main Page\
      \ are protected due to their high'\n\t\t\t\t.. ' visibility. Please discuss any necessary changes on the ${TALKPAGE}.'\n\t\t\t\t.. '&lt;br /&gt;&lt;span style=&quot;font-size:90%;&quot;&gt;'\n\t\t\t\t.. &quot;'''Administrators:''' Once this image is definitely\
      \ off the Main Page,&quot;\n\t\t\t\t.. ' please unprotect this file, or reduce to semi-protection,'\n\t\t\t\t.. ' as appropriate.&lt;/span&gt;',\n\t\t},\n\t\toffice = {\n\t\t\tdescription = 'For pages protected by the Wikimedia Foundation.',\n\t\t\ttext\
      \ = function (protectionObj, args)\n\t\t\t\tlocal ret = 'This ${PAGETYPE} is currently under the'\n\t\t\t\t\t.. ' scrutiny of the'\n\t\t\t\t\t.. ' [[Wikipedia:Office actions|Wikimedia Foundation Office]]'\n\t\t\t\t\t.. ' and is protected.'\n\t\t\t\tif\
      \ protectionObj.protectionDate then\n\t\t\t\t\tret = ret .. ' It has been protected since ${PROTECTIONDATE}.'\n\t\t\t\tend\n\t\t\t\treturn ret\n\t\t\tend,\n\t\t\texplanation = &quot;If you can edit this page, please discuss all changes and&quot;\n\t\t\t\
      \t.. &quot; additions on the ${TALKPAGE} first. '''Do not remove protection from this&quot;\n\t\t\t\t.. &quot; page unless you are authorized by the Wikimedia Foundation to do&quot;\n\t\t\t\t.. &quot; so.'''&quot;,\n\t\t\timage = 'Padlock-black.svg',\n\
      \t\t},\n\t\treset = {\n\t\t\tdescription = 'For pages protected by the Wikimedia Foundation and'\n\t\t\t\t.. ' &quot;reset&quot; to a bare-bones version.',\n \t\t\ttext = 'This ${PAGETYPE} is currently under the'\n\t\t\t\t\t.. ' scrutiny of the'\n\t\t\t\
      \t\t.. ' [[Wikipedia:Office actions|Wikimedia Foundation Office]]'\n\t\t\t\t\t.. ' and is protected.',\n\t\t\texplanation = function (protectionObj, args)\n\t\t\t\tlocal ret = ''\n\t\t\t\tif protectionObj.protectionDate then\n\t\t\t\t\tret = ret .. 'On\
      \ ${PROTECTIONDATE} this ${PAGETYPE} was'\n\t\t\t\telse\n\t\t\t\t\tret = ret .. 'This ${PAGETYPE} has been'\n\t\t\t\tend\n\t\t\t\tret = ret .. ' reduced to a'\n\t\t\t\t.. ' simplified, &quot;bare bones&quot; version so that it may be completely'\n\t\t\t\
      \t.. ' rewritten to ensure it meets the policies of'\n\t\t\t\t.. ' [[WP:NPOV|Neutral Point of View]] and [[WP:V|Verifiability]].'\n\t\t\t\t.. ' Standard Wikipedia policies will apply to its rewriting—which'\n\t\t\t\t.. ' will eventually be open to all\
      \ editors—and will be strictly'\n\t\t\t\t.. ' enforced. The ${PAGETYPE} has been ${PROTECTIONLEVEL} while'\n\t\t\t\t.. ' it is being rebuilt.\\n\\n'\n\t\t\t\t.. 'Any insertion of material directly from'\n\t\t\t\t.. ' pre-protection revisions of the ${PAGETYPE}\
      \ will be removed, as'\n\t\t\t\t.. ' will any material added to the ${PAGETYPE} that is not properly'\n\t\t\t\t.. ' sourced. The associated talk page(s) were also cleared on the'\n\t\t\t\t.. &quot; same date.\\n\\n&quot;\n\t\t\t\t.. &quot;If you can edit\
      \ this page, please discuss all changes and&quot;\n\t\t\t\t.. &quot; additions on the ${TALKPAGE} first. '''Do not override&quot;\n\t\t\t\t.. &quot; this action, and do not remove protection from this page,&quot;\n\t\t\t\t.. &quot; unless you are authorized\
      \ by the Wikimedia Foundation&quot;\n\t\t\t\t.. &quot; to do so. No editor may remove this notice.'''&quot;\n\n\t\t\t\treturn ret\n\t\t\tend,\n\t\t\timage = 'Padlock-black.svg',\n\t\t},\n\t\tsock = {\n\t\t\tdescription = 'For pages protected due to'\n\t\
      \t\t\t.. ' [[Wikipedia:Sock puppetry|sock puppetry]].',\n\t\t\ttext = '${INTROFRAGMENT} to prevent [[Wikipedia:Sock puppetry|sock puppets]] of'\n\t\t\t\t.. ' [[Wikipedia:Blocking policy|blocked]] or'\n\t\t\t\t.. ' [[Wikipedia:Banning policy|banned users]]'\n\
      \t\t\t\t.. ' from editing it.',\n\t\t\ttooltip = '${TOOLTIPFRAGMENT} to prevent sock puppets of blocked or banned users from'\n\t\t\t\t.. ' editing it',\n\t\t},\n\t\ttemplate = {\n\t\t\tdescription = 'For [[Wikipedia:High-risk templates|high-risk]]'\n\t\
      \t\t\t.. ' templates and Lua modules.',\n\t\t\ttext = 'This is a permanently [[Help:Protection|protected]] ${PAGETYPE},'\n\t\t\t\t.. ' as it is [[Wikipedia:High-risk templates|high-risk]].',\n\t\t\texplanation = 'Please discuss any changes on the ${TALKPAGE};\
      \ you may'\n\t\t\t\t.. ' ${EDITREQUEST} to ask an'\n\t\t\t\t.. ' [[Wikipedia:Administrators|administrator]] or'\n\t\t\t\t.. ' [[Wikipedia:Template editor|template editor]] to make an edit if'\n\t\t\t\t.. ' it is [[Help:Minor edit#When to mark an edit as\
      \ a minor edit'\n\t\t\t\t.. '|uncontroversial]] or supported by'\n\t\t\t\t.. ' [[Wikipedia:Consensus|consensus]]. You can also'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection|request]] that the page be'\n\t\t\t\t.. ' unprotected.',\n\t\t\ttooltip\
      \ = 'This high-risk ${PAGETYPE} is permanently ${PROTECTIONLEVEL}'\n\t\t\t\t.. ' to prevent vandalism',\n\t\t\talt = 'Permanently protected ${PAGETYPE}',\n\t\t},\n\t\tusertalk = {\n\t\t\tdescription = 'For pages protected against disruptive edits by a'\n\
      \t\t\t\t.. ' particular user.',\n\t\t\ttext = '${INTROFRAGMENT} to prevent ${VANDAL} from using it to make disruptive edits,'\n\t\t\t\t.. ' such as abusing the'\n\t\t\t\t.. ' &amp;#123;&amp;#123;[[Template:unblock|unblock]]&amp;#125;&amp;#125; template.',\n\
      \t\t\texplanation = 'If you cannot edit this user talk page and you need to'\n\t\t\t\t.. ' make a change or leave a message, you can'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\t\t\t\t.. '#Current requests for edits to a protected page'\n\
      \t\t\t\t.. '|request an edit]],'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\t\t\t\t.. '#Current requests for reduction in protection level'\n\t\t\t\t.. '|request unprotection]],'\n\t\t\t\t.. ' [[Special:Userlogin|log in]],'\n\t\t\t\t.. '\
      \ or [[Special:UserLogin/signup|create an account]].',\n\t\t},\n\t\tvandalism = {\n\t\t\tdescription = 'For pages protected against'\n\t\t\t\t.. ' [[Wikipedia:Vandalism|vandalism]].',\n\t\t\ttext = '${INTROFRAGMENT} due to [[Wikipedia:Vandalism|vandalism]].',\n\
      \t\t\texplanation = function (protectionObj, args)\n\t\t\t\tlocal ret = ''\n\t\t\t\tif protectionObj.level == 'sysop' then\n\t\t\t\t\tret = ret .. &quot;This protection is '''not''' an endorsement of the&quot;\n\t\t\t\t\t\t.. ' ${CURRENTVERSION}. '\n\t\
      \t\t\tend\n\t\t\t\treturn ret .. '${EXPLANATIONBLURB}'\n\t\t\tend,\n\t\t\ttooltip = '${TOOLTIPFRAGMENT} due to vandalism',\n\t\t}\n\t},\n\tmove = {\n\t\tdispute = {\n\t\t\tdescription = 'For pages protected against page moves due to'\n\t\t\t\t.. ' disputes\
      \ over the page title.',\n\t\t\texplanation = &quot;This protection is '''not''' an endorsement of the&quot;\n\t\t\t\t.. ' ${CURRENTVERSION}. ${EXPLANATIONBLURB}',\n\t\t\timage = 'Padlock-olive.svg'\n\t\t},\n\t\tvandalism = {\n\t\t\tdescription = 'For\
      \ pages protected against'\n\t\t\t\t.. ' [[Wikipedia:Vandalism#Page-move vandalism'\n\t\t\t\t.. ' |page-move vandalism]].'\n\t\t}\n\t},\n\tautoreview = {}\n},\n\n--------------------------------------------------------------------------------\n--\n-- \
      \                           GENERAL DATA TABLES\n--\n--------------------------------------------------------------------------------\n\n--------------------------------------------------------------------------------\n-- Protection blurbs\n--------------------------------------------------------------------------------\n\
      \n-- This table produces the protection blurbs available with the\n-- ${PROTECTIONBLURB} parameter. It is sorted by protection action and\n-- protection level, and is checked by the module in the following order:\n-- 1. page's protection action, page's\
      \ protection level\n-- 2. page's protection action, default protection level\n-- 3. &quot;edit&quot; protection action, default protection level\n--\n-- It is possible to use banner parameters inside this table.\n-- *required* - this table needs edit,\
      \ move, and autoreview subtables.\nprotectionBlurbs = {\n\tedit = {\n\t\tdefault = 'This ${PAGETYPE} is currently [[Help:Protection|'\n\t\t\t.. 'protected]] from editing',\n\t\tautoconfirmed = 'Editing of this ${PAGETYPE} by [[Wikipedia:User access'\n\t\
      \t\t.. ' levels#New users|new]] or [[Wikipedia:User access levels#Unregistered'\n\t\t\t.. ' users|unregistered]] users is currently [[Help:Protection|disabled]]'\n\t},\n\tmove = {\n\t\tdefault = 'This ${PAGETYPE} is currently [[Help:Protection|protected]]'\n\
      \t\t\t.. ' from [[Help:Moving a page|page moves]]'\n\t},\n\tautoreview = {\n\t\tautoconfirmed = 'All edits made to this ${PAGETYPE} by'\n\t\t\t.. ' [[Wikipedia:User access levels#New users|new]] or'\n\t\t\t.. ' [[Wikipedia:User access levels#Unregistered\
      \ users|unregistered]]'\n\t\t\t.. ' users are currently'\n\t\t\t.. ' [[Wikipedia:Pending changes|subject to review]]',\n\t\tdefault = 'All edits made to this ${PAGETYPE} by users who are not'\n\t\t\t.. ' [[Wikipedia:Reviewing|reviewers]] or'\n\t\t\t..\
      \ ' [[Wikipedia:Administrators|administrators]] are currently'\n\t\t\t.. ' [[Wikipedia:Pending changes|subject to review]]'\n\t}\n},\n\n\n--------------------------------------------------------------------------------\n-- Explanation blurbs\n--------------------------------------------------------------------------------\n\
      \n-- This table produces the explanation blurbs available with the\n-- ${EXPLANATIONBLURB} parameter. It is sorted by protection action,\n-- protection level, and whether the page is a talk page or not. If the page is\n-- a talk page it will have a talk\
      \ key of &quot;talk&quot;; otherwise it will have a talk\n-- key of &quot;subject&quot;. The table is checked in the following order:\n-- 1. page's protection action, page's protection level, page's talk key\n-- 2. page's protection action, page's protection\
      \ level, default talk key\n-- 3. page's protection action, default protection level, page's talk key\n-- 4. page's protection action, default protection level, default talk key\n--\n-- It is possible to use banner parameters inside this table.\n-- *required*\
      \ - this table needs edit, move, and autoreview subtables.\nexplanationBlurbs = {\n\tedit = {\n\t\tautoconfirmed = {\n\t\t\tsubject = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details. If you'\n\
      \t\t\t\t.. ' cannot edit this ${PAGETYPE} and you wish to make a change, you can'\n\t\t\t\t.. ' ${EDITREQUEST}, discuss changes on the ${TALKPAGE},'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\t\t\t\t.. '#Current requests for reduction in\
      \ protection level'\n\t\t\t\t.. '|request unprotection]], [[Special:Userlogin|log in]], or'\n\t\t\t\t.. ' [[Special:UserLogin/signup|create an account]].',\n\t\t\tdefault = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG}\
      \ for more details. If you'\n\t\t\t\t.. ' cannot edit this ${PAGETYPE} and you wish to make a change, you can'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\t\t\t\t.. '#Current requests for reduction in protection level'\n\t\t\t\t.. '|request\
      \ unprotection]], [[Special:Userlogin|log in]], or'\n\t\t\t\t.. ' [[Special:UserLogin/signup|create an account]].',\n\t\t},\n\t\tdefault = {\n\t\t\tsubject = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG}\
      \ for more details.'\n\t\t\t\t.. ' Please discuss any changes on the ${TALKPAGE}; you'\n\t\t\t\t.. ' may ${EDITREQUEST} to ask an'\n\t\t\t\t.. ' [[Wikipedia:Administrators|administrator]] to make an edit if it'\n\t\t\t\t.. ' is [[Help:Minor edit#When to\
      \ mark an edit as a minor edit'\n\t\t\t\t.. '|uncontroversial]] or supported by [[Wikipedia:Consensus'\n\t\t\t\t.. '|consensus]]. You may also [[Wikipedia:Requests for'\n\t\t\t\t.. ' page protection#Current requests for reduction in protection level'\n\
      \t\t\t\t.. '|request]] that this page be unprotected.',\n\t\t\tdefault = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details.'\n\t\t\t\t.. ' You may [[Wikipedia:Requests for page'\n\t\t\t\t..\
      \ ' protection#Current requests for edits to a protected page|request an'\n\t\t\t\t.. ' edit]] to this page, or [[Wikipedia:Requests for'\n\t\t\t\t.. ' page protection#Current requests for reduction in protection level'\n\t\t\t\t.. '|ask]] for it to be\
      \ unprotected.'\n\t\t}\n\t},\n\tmove = {\n\t\tdefault = {\n\t\t\tsubject = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details.'\n\t\t\t\t.. ' The page may still be edited but cannot be moved'\n\
      \t\t\t\t.. ' until unprotected. Please discuss any suggested moves on the'\n\t\t\t\t.. ' ${TALKPAGE} or at [[Wikipedia:Requested moves]]. You can also'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection|request]] that the page be'\n\t\t\t\t.. ' unprotected.',\n\
      \t\t\tdefault = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details.'\n\t\t\t\t.. ' The page may still be edited but cannot be moved'\n\t\t\t\t.. ' until unprotected. Please discuss any suggested\
      \ moves at'\n\t\t\t\t.. ' [[Wikipedia:Requested moves]]. You can also'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection|request]] that the page be'\n\t\t\t\t.. ' unprotected.'\n\t\t}\n\t},\n\tautoreview = {\n\t\tdefault = {\n\t\t\treviewer = 'See\
      \ the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details.'\n\t\t\t\t.. ' Edits to this ${PAGETYPE} will not be visible to readers'\n\t\t\t\t.. ' until they are accepted by a reviewer or an administrator.'\n\
      \t\t\t\t.. ' To avoid the need for your edits to be reviewed, you may'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\t\t\t\t.. '#Current requests for reduction in protection level'\n\t\t\t\t.. '|request unprotection]]. Experienced editors may\
      \ also'\n\t\t\t\t.. ' request the [[Wikipedia:Reviewing|reviewer user right]].',\n\t\t\tdefault = 'See the [[Wikipedia:Protection policy|'\n\t\t\t\t.. 'protection policy]] and ${PROTECTIONLOG} for more details.'\n\t\t\t\t.. ' Edits to this ${PAGETYPE}\
      \ by new and unregistered users'\n\t\t\t\t.. ' will not be visible to readers until they are accepted by'\n\t\t\t\t.. ' a reviewer. To avoid the need for your edits to be'\n\t\t\t\t.. ' reviewed, you may'\n\t\t\t\t.. ' [[Wikipedia:Requests for page protection'\n\
      \t\t\t\t.. '#Current requests for reduction in protection level'\n\t\t\t\t.. '|request unprotection]], [[Special:Userlogin|log in]], or'\n\t\t\t\t.. ' [[Special:UserLogin/signup|create an account]].'\n\t\t},\n\t}\n},\n\n--------------------------------------------------------------------------------\n\
      -- Protection levels\n--------------------------------------------------------------------------------\n\n-- This table provides the data for the ${PROTECTIONLEVEL} parameter, which\n-- produces a short label for different protection levels. It is sorted\
      \ by\n-- protection action and proteciton level, and is checked in the following\n-- order:\n-- 1. page's protection action, page's protection level\n-- 2. page's protection action, default protection level\n-- 3. &quot;edit&quot; protection action, default\
      \ protection level\n--\n-- It is possible to use banner parameters inside this table.\n-- *required* - this table needs edit, move, and autoreview subtables.\nprotectionLevels = {\n\tedit = {\n\t\tdefault = 'protected',\n\t\ttemplateeditor = 'template-protected',\n\
      \t\tautoconfirmed = 'semi-protected',\n\t},\n\tmove = {\n\t\tdefault = 'move-protected'\n\t},\n\tautoreview = {\n\t}\n},\n\n--------------------------------------------------------------------------------\n-- Images\n--------------------------------------------------------------------------------\n\
      \n-- This table lists different padlock images for each protection action and\n-- protection level. It is used if an image is not specified in any of the\n-- banner data tables, and if the page does not satisfy the conditions for using\n-- the ['image-filename-indef']\
      \ image. It is checked in the following order:\n-- 1. page's protection action, page's protection level\n-- 2. page's protection action, default protection level\nimages = {\n\tedit = {\n\t\tdefault = 'Padlock.svg',\n\t\ttemplateeditor = 'Padlock-pink.svg',\n\
      \t\tautoconfirmed = 'Padlock-silver.svg'\n\t},\n\tmove = {\n\t\tdefault = 'Padlock-olive.svg',\n\t},\n\tautoreview = {\n\t\tautoconfirmed = 'Padlock-silver-light.svg',\n\t\tdefault = 'Padlock-orange.svg'\n\t}\n},\n\n-- Pages with a reason specified in\
      \ this table will show the special &quot;indef&quot;\n-- padlock, defined in the 'image-filename-indef' message, if no expiry is set.\nindefImageReasons = {\n\ttemplate = true\n},\n\n--------------------------------------------------------------------------------\n\
      -- Image links\n--------------------------------------------------------------------------------\n\n-- This table provides the data for the ${IMAGELINK} parameter, which gets\n-- the image link for small padlock icons based on the page's protection action\n\
      -- and protection level. It is checked in the following order:\n-- 1. page's protection action, page's protection level\n-- 2. page's protection action, default protection level\n-- 3. &quot;edit&quot; protection action, default protection level\n--\n\
      -- It is possible to use banner parameters inside this table.\n-- *required* - this table needs edit, move, and autoreview subtables.\nimageLinks = {\n\tedit = {\n\t\tdefault = 'Wikipedia:Protection policy#full',\n\t\ttemplateeditor = 'Wikipedia:Protection\
      \ policy#template',\n\t\tautoconfirmed = 'Wikipedia:Protection policy#semi'\n\t},\n\tmove = {\n\t\tdefault = 'Wikipedia:Protection policy#move'\n\t},\n\tautoreview = {\n\t\tautoconfirmed = 'Wikipedia:Protection policy#pc1',\n\t\treviewer = 'Wikipedia:Protection\
      \ policy#pc2'\n\t}\n},\n\n--------------------------------------------------------------------------------\n-- Padlock positions\n--------------------------------------------------------------------------------\n\n-- This table provides the data for the\
      \ &quot;right&quot; CSS property for small padlock\n-- icons, which determines where the icon appears on the top bar among the other\n-- top icons. The data is stored by protection action. If no value is found for\n-- the action, the default field is used.\n\
      padlockPositions = {\n\tautoreview = '85px',\n\tdefault = '55px'\n},\n\n--------------------------------------------------------------------------------\n-- Protection categories\n--------------------------------------------------------------------------------\n\
      \n--[[\n-- The protection categories are stored in the protectionCategories table.\n-- Keys to this table are made up of the following strings:\n--\n-- 1. the expiry date\n-- 2. the namespace\n-- 3. the protection reason (e.g. &quot;dispute&quot; or &quot;vandalism&quot;)\n\
      -- 4. the protection level (e.g. &quot;sysop&quot; or &quot;autoconfirmed&quot;)\n-- 5. the action (e.g. &quot;edit&quot; or &quot;move&quot;)\n-- \n-- When the module looks up a category in the table, first it will will check to\n-- see a key exists that\
      \ corresponds to all five parameters. For example, a\n-- user page semi-protected from vandalism for two weeks would have the key\n-- &quot;temp-user-vandalism-autoconfirmed-edit&quot;. If no match is found, the module\n-- changes the first part of the\
      \ key to &quot;all&quot; and checks the table again. It\n-- keeps checking increasingly generic key combinations until it finds the\n-- field, or until it reaches the key &quot;all-all-all-all-all&quot;.\n--\n-- The module uses a binary matrix to determine\
      \ the order in which to search.\n-- This is best demonstrated by a table. In this table, the &quot;0&quot; values\n-- represent &quot;all&quot;, and the &quot;1&quot; values represent the original data (e.g.\n-- &quot;indef&quot; or &quot;file&quot; or\
      \ &quot;vandalism&quot;).\n--\n--        expiry    namespace reason   level     action\n-- order\n-- 1      1         1         1        1         1\n-- 2      0         1         1        1         1\n-- 3      1         0         1        1         1\n\
      -- 4      0         0         1        1         1\n-- 5      1         1         0        1         1\n-- 6      0         1         0        1         1\n-- 7      1         0         0        1         1\n-- 8      0         0         0        1   \
      \      1\n-- 9      1         1         1        0         1\n-- 10     0         1         1        0         1\n-- 11     1         0         1        0         1\n-- 12     0         0         1        0         1\n-- 13     1         1         0  \
      \      0         1\n-- 14     0         1         0        0         1\n-- 15     1         0         0        0         1\n-- 16     0         0         0        0         1\n-- 17     1         1         1        1         0\n-- 18     0         1  \
      \       1        1         0\n-- 19     1         0         1        1         0\n-- 20     0         0         1        1         0\n-- 21     1         1         0        1         0\n-- 22     0         1         0        1         0\n-- 23     1  \
      \       0         0        1         0\n-- 24     0         0         0        1         0\n-- 25     1         1         1        0         0\n-- 26     0         1         1        0         0\n-- 27     1         0         1        0         0\n-- 28\
      \     0         0         1        0         0\n-- 29     1         1         0        0         0\n-- 30     0         1         0        0         0\n-- 31     1         0         0        0         0\n-- 32     0         0         0        0       \
      \  0\n--\n-- In this scheme the action has the highest priority, as it is the last\n-- to change, and the expiry has the least priority, as it changes the most.\n-- The priorities of the expiry, the protection level and the action are\n-- fixed, but the\
      \ priorities of the reason and the namespace can be swapped\n-- through the use of the cfg.bannerDataNamespaceHasPriority table.\n--]]\n\n-- If the reason specified to the template is listed in this table,\n-- namespace data will take priority over reason\
      \ data in the protectionCategories\n-- table.\nreasonsWithNamespacePriority = {\n\tvandalism = true,\n},\n\n-- The string to use as a namespace key for the protectionCategories table for each\n-- namespace number.\ncategoryNamespaceKeys = {\n\t[  2] =\
      \ 'user',\n\t[  3] = 'user',\n\t[  4] = 'project',\n\t[  6] = 'file',\n\t[  8] = 'mediawiki',\n\t[ 10] = 'template',\n\t[ 12] = 'project',\n\t[ 14] = 'category',\n\t[100] = 'portal',\n},\n\nprotectionCategories = {\n\t['all|all|all|all|all']          \
      \        = 'Wikipedia protected pages',\n\t['all|all|office|all|all']               = 'Wikipedia Office-protected pages',\n\t['all|all|reset|all|all']                = 'Wikipedia Office-protected pages',\n\t['all|all|dmca|all|all']                 = 'Wikipedia\
      \ Office-protected pages',\n\t['all|all|mainpage|all|all']             = 'Protected main page images',\n\t['all|template|all|all|edit']            = 'Wikipedia protected templates',\n\t['all|all|all|autoconfirmed|edit']       = 'Wikipedia semi-protected\
      \ pages',\n\t['indef|all|all|autoconfirmed|edit']     = 'Wikipedia indefinitely semi-protected pages',\n\t['all|all|blp|autoconfirmed|edit']       = 'Wikipedia indefinitely semi-protected biographies of living people',\n\t['temp|all|blp|autoconfirmed|edit']\
      \      = 'Wikipedia temporarily semi-protected biographies of living people',\n\t['all|all|dispute|autoconfirmed|edit']   = 'Wikipedia pages semi-protected due to dispute',\n\t['all|all|sock|autoconfirmed|edit']      = 'Wikipedia pages semi-protected from\
      \ banned users',\n\t['all|all|vandalism|autoconfirmed|edit'] = 'Wikipedia pages semi-protected against vandalism',\n\t['all|category|all|autoconfirmed|edit']  = 'Wikipedia semi-protected categories',\n\t['all|file|all|autoconfirmed|edit']      = 'Semi-protected\
      \ images',\n\t['all|portal|all|autoconfirmed|edit']    = 'Semi-protected portals',\n\t['all|project|all|autoconfirmed|edit']   = 'Semi-protected project pages',\n\t['all|talk|all|autoconfirmed|edit']      = 'Semi-protected talk pages',\n\t['all|template|all|autoconfirmed|edit']\
      \  = 'Wikipedia semi-protected templates',\n\t['all|template|all|autoconfirmed|edit']  = 'Wikipedia semi-protected templates',\n\t['all|user|all|autoconfirmed|edit']      = 'Wikipedia semi-protected user and user talk pages',\n\t['all|all|blp|sysop|edit']\
      \               = 'Wikipedia indefinitely protected biographies of living people',\n\t['temp|all|blp|sysop|edit']              = 'Wikipedia temporarily protected biographies of living people',\n\t['all|all|dispute|sysop|edit']           = 'Wikipedia pages\
      \ protected due to dispute',\n\t['all|all|sock|sysop|edit']              = 'Wikipedia pages protected from banned users',\n\t['all|all|vandalism|sysop|edit']         = 'Wikipedia pages protected against vandalism',\n\t['all|category|all|sysop|edit']  \
      \        = 'Wikipedia protected categories',\n\t['all|file|all|sysop|edit']              = 'Protected images',\n\t['all|project|all|sysop|edit']           = 'Protected project pages',\n\t['all|talk|all|sysop|edit']              = 'Protected talk pages',\n\
      \t['all|template|all|sysop|edit']          = 'Wikipedia protected templates',\n\t['all|user|all|sysop|edit']              = 'Wikipedia protected user and user talk pages',\n\t['all|all|all|sysop|move']               = 'Wikipedia move-protected pages',\n\
      \t['indef|all|all|sysop|move']             = 'Wikipedia indefinitely move-protected pages',\n\t['all|all|dispute|sysop|move']           = 'Wikipedia pages move-protected due to dispute',\n\t['all|all|vandalism|sysop|move']         = 'Wikipedia pages move-protected\
      \ due to vandalism',\n\t['all|portal|all|sysop|move']            = 'Wikipedia move-protected portals',\n\t['all|portal|all|sysop|move']            = 'Wikipedia move-protected portals',\n\t['all|project|all|sysop|move']           = 'Wikipedia move-protected\
      \ project pages',\n\t['all|talk|all|sysop|move']              = 'Wikipedia move-protected talk pages',\n\t['all|template|all|sysop|move']          = 'Wikipedia move-protected templates',\n\t['all|user|all|sysop|move']              = 'Wikipedia move-protected\
      \ user and user talk pages',\n\t['all|all|all|autoconfirmed|autoreview'] = 'Wikipedia pending changes protected pages (level 1)',\n\t['all|all|all|reviewer|autoreview']      = 'Wikipedia pending changes protected pages (level 2)',\n},\n\n--------------------------------------------------------------------------------\n\
      -- Expiry category config\n--------------------------------------------------------------------------------\n\n-- This table configures the expiry category behaviour for each protection\n-- action.\n-- * If set to true, setting that action will always\
      \ categorise the page if\n--   an expiry parameter is not set.\n-- * If set to false, setting that action will never categorise the page.\n-- * If set to nil, the module will categorise the page if:\n--   1) an expiry parameter is not set, and\n--   2)\
      \ a reason is provided, and\n--   3) the specified reason is not blacklisted in the reasonsWithoutExpiryCheck\n--      table.\n\nexpiryCheckActions = {\n\tedit = nil,\n\tmove = false,\n\tautoreview = true\n},\n\nreasonsWithoutExpiryCheck = {\n\tblp = true,\n\
      \ttemplate = true,\n},\n\n--------------------------------------------------------------------------------\n-- Pagetypes\n--------------------------------------------------------------------------------\n\n-- This table produces the page types available\
      \ with the ${PAGETYPE} parameter.\n-- Keys are namespace numbers, or the string &quot;default&quot; for the default value.\npagetypes = {\n\t[0] = 'article',\n\t[6] = 'file',\n\t[10] = 'template',\n\t[14] = 'category',\n\t[828] = 'module',\n\tdefault =\
      \ 'page'\n},\n\n--------------------------------------------------------------------------------\n-- Strings marking indefinite protection\n--------------------------------------------------------------------------------\n\n-- This table contains values\
      \ passed to the expiry parameter that mean the page\n-- is protected indefinitely.\nindefStrings = {\n\t['indef'] = true,\n\t['indefinite'] = true,\n\t['indefinitely'] = true,\n\t['infinite'] = true,\n},\n\n--------------------------------------------------------------------------------\n\
      -- Group hierarchy\n--------------------------------------------------------------------------------\n\n-- This table maps each group to all groups that have a superset of the original\n-- group's page editing permissions.\nhierarchy = {\n\tsysop = {},\n\
      \treviewer = {'sysop'},\n\tfilemover = {'sysop'},\n\ttemplateeditor = {'sysop'},\n\taccountcreator = {'templateeditor'},\n\tautoconfirmed = {'reviewer', 'filemover', 'accountcreator'},\n\tuser = {'autoconfirmed'},\n\t['*'] = {'user'}\n},\n\n--------------------------------------------------------------------------------\n\
      -- Wrapper templates and their default arguments\n--------------------------------------------------------------------------------\n\n-- This table contains wrapper templates used with the module, and their\n-- default arguments. Templates specified in\
      \ this table should contain the\n-- following invocation, and no other template content:\n--\n-- {{#invoke:Protection banner|main}}\n--\n-- If other content is desired, it can be added between\n-- &lt;noinclude&gt;...&lt;/noinclude&gt; tags.\n--\n-- When\
      \ a user calls one of these wrapper templates, they will use the\n-- default arguments automatically. The arguments cannot be overwritten by the\n-- user.\nwrappers = {\n\t['Template:Pp']                         = {},\n\t['Template:Pp-blp']           \
      \          = {'blp'},\n\t-- we don't need Template:Pp-create\n\t['Template:Pp-dispute']                 = {'dispute'},\n\t['Template:Pp-main-page']                = {'mainpage'},\n\t['Template:Pp-move']                    = {action = 'move'},\n\t['Template:Pp-move-dispute']\
      \            = {'dispute', action = 'move'},\n\t-- we don't need Template:Pp-move-indef\n\t['Template:Pp-move-vandalism']          = {'vandalism', action = 'move'},\n\t['Template:Pp-office']                  = {'office'},\n\t['Template:Pp-office-dmca']\
      \             = {'dmca'},\n\t['Template:Pp-pc1']                     = {action = 'autoreview', small = true},\n\t['Template:Pp-pc2']                     = {action = 'autoreview', small = true},\n\t['Template:Pp-reset']                   = {'reset'},\n\t\
      ['Template:Pp-semi-indef']              = {expiry = 'indef', small = true},\n\t['Template:Pp-sock']                    = {'sock'},\n\t['Template:Pp-template']                = {'template', small = true},\n\t['Template:Pp-usertalk']                = {'usertalk'},\n\
      \t['Template:Pp-vandalism']               = {'vandalism'},\n},\n\n--------------------------------------------------------------------------------\n-- \n--                                 MESSAGES\n-- \n--------------------------------------------------------------------------------\n\
      \nmsg = {\n\n--------------------------------------------------------------------------------\n-- Intro blurb and intro fragment\n--------------------------------------------------------------------------------\n\n-- These messages specify what is produced\
      \ by the ${INTROBLURB} and\n-- ${INTROFRAGMENT} parameters. If the protection is temporary they use the\n-- intro-blurb-expiry or intro-fragment-expiry, and if not they use\n-- intro-blurb-noexpiry or intro-fragment-noexpiry.\n-- It is possible to use\
      \ banner parameters in these messages.\n['intro-blurb-expiry'] = '${PROTECTIONBLURB} until ${EXPIRY}.',\n['intro-blurb-noexpiry'] = '${PROTECTIONBLURB}.',\n['intro-fragment-expiry'] = '${PROTECTIONBLURB} until ${EXPIRY},',\n['intro-fragment-noexpiry']\
      \ = '${PROTECTIONBLURB}',\n\n--------------------------------------------------------------------------------\n-- Tooltip blurb\n--------------------------------------------------------------------------------\n\n-- These messages specify what is produced\
      \ by the ${TOOLTIPBLURB} parameter.\n-- If the protection is temporary the tooltip-blurb-expiry message is used, and\n-- if not the tooltip-blurb-noexpiry message is used.\n-- It is possible to use banner parameters in these messages.\n['tooltip-blurb-expiry']\
      \ = 'This ${PAGETYPE} is ${PROTECTIONLEVEL} until ${EXPIRY}.',\n['tooltip-blurb-noexpiry'] = 'This ${PAGETYPE} is ${PROTECTIONLEVEL}.',\n['tooltip-fragment-expiry'] = 'This ${PAGETYPE} is ${PROTECTIONLEVEL} until ${EXPIRY},',\n['tooltip-fragment-noexpiry']\
      \ = 'This ${PAGETYPE} is ${PROTECTIONLEVEL}',\n\n--------------------------------------------------------------------------------\n-- Special explanation blurb\n--------------------------------------------------------------------------------\n\n-- An explanation\
      \ blurb for pages that cannot be unprotected, e.g. for pages\n-- in the MediaWiki namespace.\n-- It is possible to use banner parameters in this message.\n['explanation-blurb-nounprotect'] = 'See the [[Wikipedia:Protection policy|'\n\t.. 'protection policy]]\
      \ and ${PROTECTIONLOG} for more details.'\n\t.. ' Please discuss any changes on the ${TALKPAGE}; you'\n\t.. ' may ${EDITREQUEST} to ask an'\n\t.. ' [[Wikipedia:Administrators|administrator]] to make an edit if it'\n\t.. ' is [[Help:Minor edit#When to mark\
      \ an edit as a minor edit'\n\t.. '|uncontroversial]] or supported by [[Wikipedia:Consensus'\n\t.. '|consensus]].',\n\n--------------------------------------------------------------------------------\n-- Protection log display values\n--------------------------------------------------------------------------------\n\
      \n-- These messages determine the display values for the protection log link\n-- or the pending changes log link produced by the ${PROTECTIONLOG} parameter.\n-- It is possible to use banner parameters in these messages.\n['protection-log-display'] = 'protection\
      \ log',\n['pc-log-display'] = 'pending changes log',\n\n--------------------------------------------------------------------------------\n-- Current version display values\n--------------------------------------------------------------------------------\n\
      \n-- These messages determine the display values for the page history link\n-- or the move log link produced by the ${CURRENTVERSION} parameter.\n-- It is possible to use banner parameters in these messages.\n['current-version-move-display'] = 'current\
      \ title',\n['current-version-edit-display'] = 'current version',\n\n--------------------------------------------------------------------------------\n-- Talk page\n--------------------------------------------------------------------------------\n\n-- This\
      \ message determines the display value of the talk page link produced\n-- with the ${TALKPAGE} parameter.\n-- It is possible to use banner parameters in this message.\n['talk-page-link-display'] = 'talk page',\n\n--------------------------------------------------------------------------------\n\
      -- Edit requests\n--------------------------------------------------------------------------------\n\n-- This message determines the display value of the edit request link produced\n-- with the ${EDITREQUEST} parameter.\n-- It is possible to use banner\
      \ parameters in this message.\n['edit-request-display'] = 'submit an edit request',\n\n--------------------------------------------------------------------------------\n-- Expiry date format\n--------------------------------------------------------------------------------\n\
      \n-- This is the format for the blurb expiry date. It should be valid input for\n-- the first parameter of the #time parser function.\n['expiry-date-format'] = 'F j, Y',\n\n--------------------------------------------------------------------------------\n\
      -- Tracking categories\n--------------------------------------------------------------------------------\n\n-- These messages determine which tracking categories the module outputs.\n['tracking-category-incorrect'] = 'Wikipedia pages with incorrect protection\
      \ templates',\n['tracking-category-expiry'] = 'Wikipedia protected pages without expiry',\n['tracking-category-template'] = 'Wikipedia template-protected pages other than templates and modules',\n\n--------------------------------------------------------------------------------\n\
      -- Images\n--------------------------------------------------------------------------------\n\n-- These are images that are not defined by their protection action and protection level.\n['image-filename-indef'] = 'Padlock-red.svg',\n['image-filename-default']\
      \ = 'Transparent.gif',\n\n--------------------------------------------------------------------------------\n-- End messages\n--------------------------------------------------------------------------------\n}\n\n--------------------------------------------------------------------------------\n\
      -- End configuration\n--------------------------------------------------------------------------------\n}</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:19.584Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AUse+mdy+dates&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:19 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq44 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530286200, 3460502122, 4115556572
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="20999385" ns="10" title="Template:Use mdy dates"><revisions><rev user="AnomieBOT II" timestamp="2013-11-17T18:23:55Z" comment="[[Module:Unsubst|Unsubstifying]] template, so {{subst:Use mdy dates}} results in {{Use mdy dates|date=...}}" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||$N=Use mdy dates |date=__DATE__ |$B=
      {{DMCA|Use mdy dates|from|{{{date|}}}}}
      }}&lt;noinclude&gt;{{Documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:20.111Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ADMCA&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:19 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq44 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404089783, 3460502814, 4115557345
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="23226218" ns="10" title="Template:DMCA"><revisions><rev user="MSGJ" timestamp="2009-06-16T18:18:41Z" comment="pp now on doc" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Dated maintenance category
       |onlyarticles=yes
       |1={{{1|}}}
       |2={{{2|}}}
       |3={{{3|}}}
       |4={{{4|}}}
       |5={{{5|}}}
      }}&lt;noinclude&gt;
      {{documentation|Template:Dated maintenance category/doc}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:20.375Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ADated+maintenance+category&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:20 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227004073, 269532445, 4115558069
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="22598546" ns="10" title="Template:Dated maintenance category"><revisions><rev user="John of Reading" timestamp="2014-01-08T08:14:55Z" comment="Second attempt. Those spaces upset inline templates such as {{As of}}. Instead, try an unconditional &lt;nowiki/&gt;" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;nowiki/&gt;&lt;!--This nowiki helps to prevent whitespace at the top of articles--&gt;{{#ifeq:{{FULLROOTPAGENAME}}|Wikipedia:Template messages|&lt;!--Do not categorize--&gt;|&lt;!--
      --&gt;{{#ifexpr:{{#if:{{NAMESPACE}}|0|1}}+{{#ifeq:{{{onlyarticles|no}}}|yes|0|1}}
       |{{#if:{{{3|}}}
        |[[Category:{{{1}}} {{{2}}} {{{3}}}]]&lt;!--
      --&gt;{{#ifexist:Category:{{{1}}} {{{2}}} {{{3}}}
          |&lt;!--
       --&gt;|[[Category:Articles with invalid date parameter in template]]&lt;!--
      --&gt;}}
        |[[Category:{{#if:{{{5|}}}
                     |{{{5}}}&lt;!--
                  --&gt;|{{{1}}}&lt;!--
                 --&gt;}}]]&lt;!--
      --&gt;}}{{#if:{{{4|}}}
            |[[Category:{{{4}}}]]}}&lt;!--
        --&gt;}}&lt;!--
      --&gt;}}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:20.687Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFULLROOTPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:20 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq36 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123473037, 4276339704, 4115558491
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"34701984\" ns=\"10\" title=\"Template:FULLROOTPAGENAME\"><revisions><rev user=\"PrimeHunter\" timestamp=\"2012-02-12T12:42:22Z\" comment=\"Protected Template:FULLROOTPAGENAME:\
      \ [[WP:High-risk templates|Highly visible template]] ([edit=sysop] (indefinite) [move=sysop] (indefinite))\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{ {{{|safesubst:}}}#if: {{ {{{|safesubst:}}}Ns has subpages | {{\
      \ {{{|safesubst:}}}#if:{{{1|}}}|{{ {{{|safesubst:}}}NAMESPACE:{{{1}}}}}|{{ {{{|safesubst:}}}NAMESPACE}}}} }} \n  | {{ {{{|safesubst:}}}#titleparts:{{ {{{|safesubst:}}}#if:{{{1|}}}|{{{1}}}|{{ {{{|safesubst:}}}FULLPAGENAME}}}}|1}}\n  | {{ {{{|safesubst:}}}#if:{{{1|}}}|{{{1}}}|{{\
      \ {{{|safesubst:}}}FULLPAGENAME}}}}\n}}&lt;noinclude&gt;\n\n{{documentation}}\n\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:21.008Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3ANAMESPACE%3A%7B%7B%7B1%7D%7D%7D&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:21 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq35 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348963688, 4156156727, 4115558835
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page title="Template:safesubst:NAMESPACE:{{{1}}}" invalid="" /></pages></query></api>
- recorded: 2014-11-04T23:11:21.318Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3ANAMESPACE&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:21 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq53 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025880185, 4206002931, 4115559171
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:safesubst:NAMESPACE" to="Template:Safesubst:NAMESPACE" /></normalized><pages><page ns="10" title="Template:Safesubst:NAMESPACE" missing="" /></pages></query></api>
- recorded: 2014-11-04T23:11:21.702Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3ANs+has+subpages&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:21 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq52 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530290597, 388584400, 4115559689
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:safesubst:Ns has subpages" to="Template:Safesubst:Ns has subpages" /></normalized><pages><page ns="10" title="Template:Safesubst:Ns has subpages" missing="" /></pages></query></api>
- recorded: 2014-11-04T23:11:21.962Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3AFULLPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:22 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq31 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348968390, 882867119, 4115560219
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:safesubst:FULLPAGENAME" to="Template:Safesubst:FULLPAGENAME" /></normalized><pages><page ns="10" title="Template:Safesubst:FULLPAGENAME" missing="" /></pages></query></api>
- recorded: 2014-11-04T23:11:22.552Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ABirth+date+and+age&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:22 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227007764, 269534584, 4115560555
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="6658694" ns="10" title="Template:Birth date and age"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T03:38:54Z" comment="Changed protection level of Template:Birth date and age: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;&lt;span style=&quot;display:none&quot;&gt; (&lt;span class=&quot;bday&quot;&gt;{{{1|{{{year}}}}}}-{{padleft:{{{2|{{{month}}}}}}|2|0}}-{{padleft:{{{3|{{{day}}}}}}|2|0}}&lt;/span&gt;) &lt;/span&gt;{{#if:{{{df|}}}|{{#expr:{{{3|{{{day}}}}}}}} {{MONTHNAME|{{{2|{{{month}}}}}}}}|{{MONTHNAME|{{{2|{{{month}}}}}}}} {{#expr:{{{3|{{{day}}}}}}}},}} {{{1|{{{year}}}}}}&lt;span class=&quot;noprint ForceAgeToShow&quot;&gt; (age&amp;nbsp;{{age | {{{1|{{{year}}}}}} | {{{2|{{{month}}}}}} | {{{3|{{{day}}}}}} }})&lt;/span&gt;&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:22.893Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AMONTHNAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:22 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404096080, 3156569972, 4115560935
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="4858813" ns="10" title="Template:MONTHNAME"><revisions><rev user="WOSlinker" timestamp="2010-10-04T15:40:38Z" comment="remove {{pp-template}}" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#if:{{{1|}}}|{{#switch:{{MONTHNUMBER|{{{1}}}}}|1=January|2=February|3=March|4=April|5=May|6=June|7=July|8=August|9=September|10=October|11=November|12=December|Incorrect required parameter 1=''month''!}}|Missing required parameter 1=''month''!}}&lt;/includeonly&gt;&lt;noinclude&gt;

      {{Documentation}}
      &lt;!-- Add categories and interwikis to the /doc subpage, not here! --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:23.489Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AMONTHNUMBER&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:23 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq44 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103513460, 3460506018, 4115561203
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="4859929" ns="10" title="Template:MONTHNUMBER"><revisions><rev user="WOSlinker" timestamp="2010-10-04T15:40:33Z" comment="remove {{pp-template}}" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#if:{{{1|}}}
       |{{#switch:{{lc:{{{1}}}}}
        |january|jan=1
        |february|feb=2
        |march|mar=3
        |apr|april=4
        |may=5
        |june|jun=6
        |july|jul=7
        |august|aug=8
        |september|sep|sept=9
        |october|oct=10
        |november|nov=11
        |december|dec=12
        |{{#ifexpr:{{{1}}}&lt;0
         |{{#ifexpr:(({{{1}}})round 0)!=({{{1}}})
          |{{#expr:12-(((0.5-({{{1}}}))round 0)mod 12)}}
          |{{#expr:12-(((11.5-({{{1}}}))round 0)mod 12)}}
         }}
        |{{#expr:(((10.5+{{{1}}})round 0)mod 12)+1}}
        }}
       }}
       |Missing required parameter 1=''month''!
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;!-- Add categories and interwikis to the /doc subpage, not here! --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:23.781Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aage&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:23 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530293433, 319072487, 4115561524
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:age" to="Template:Age" /></normalized><pages><page pageid="4844043" ns="10" title="Template:Age"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T02:32:03Z" comment="Changed protection level of Template:Age: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#expr:({{{4|{{CURRENTYEAR}}}}})-({{{1}}})-(({{{5|{{CURRENTMONTH}}}}})&lt;({{{2}}})or({{{5|{{CURRENTMONTH}}}}})=({{{2}}})and({{{6|{{CURRENTDAY}}}}})&lt;({{{3}}}))}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:24.096Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+news&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:24 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103514512, 3156570471, 4115561660
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite news" to="Template:Cite news" /></normalized><pages><page pageid="4321630" ns="10" title="Template:Cite news"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:57:36Z" comment="Changed protection level of Template:Cite news: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=news
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:26.724Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Acitation%2FCS1&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:24 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103514792, 3439962653, 4115561881
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:citation/CS1\" to=\"Module:Citation/CS1\" /></normalized><pages><page pageid=\"38573037\" ns=\"828\" title=\"Module:Citation/CS1\"><revisions><rev user=\"Trappist the\
      \ monk\" timestamp=\"2014-10-24T14:36:06Z\" comment=\"Better version of strip_apostrophe_markup()?\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\nlocal z = {\n\terror_categories = {};\t\t-- for categorizing citations\
      \ that contain errors\n\terror_ids = {};\n\tmessage_tail = {};\n\tmaintenance_cats = {};\t\t-- for categorizing citations that aren't erroneous per se, but could use a little work\n\tproperties_cats = {};\t\t-- for categorizing citations based on certain\
      \ properties, language of source for instance\n}\n\n-- Whether variable is set or not\nfunction is_set( var )\n\treturn not (var == nil or var == '');\nend\n\n-- First set variable or nil if none\nfunction first_set(...)\n\tlocal list = {...};\n\tfor _,\
      \ var in pairs(list) do\n\t\tif is_set( var ) then\n\t\t\treturn var;\n\t\tend\n\tend\nend\n\n-- Whether needle is in haystack\nfunction inArray( needle, haystack )\n\tif needle == nil then\n\t\treturn false;\n\tend\n\tfor n,v in ipairs( haystack ) do\n\
      \t\tif v == needle then\n\t\t\treturn n;\n\t\tend\n\tend\n\treturn false;\nend\n\n--[[\nCategorize and emit an error message when the citation contains one or more deprecated parameters.  Because deprecated parameters (currently |day=, |month=,\n|coauthor=,\
      \ and |coauthors=) aren't related to each other and because these parameters may be concatenated into the variables used by |date= and |author#= (and aliases)\ndetails of which parameter caused the error message are not provided.  Only one error message\
      \ is emitted regardless of the number of deprecated parameters in the citation.\n]]\nfunction deprecated_parameter()\n\tif true ~= Page_in_deprecated_cat then\t-- if we haven't been here before then set a \n\t\tPage_in_deprecated_cat=true;\t\t-- sticky\
      \ flag so that if there are more than one deprecated parameter the category is added only once\n\t\ttable.insert( z.message_tail, { seterror( 'deprecated_params', {}, true ) } );\t\t-- add error message\n\tend\nend\n\n-- Populates numbered arguments in\
      \ a message string using an argument table.\nfunction substitute( msg, args )\n--\treturn args and tostring( mw.message.newRawMessage( msg, args ) ) or msg;\n\treturn args and mw.message.newRawMessage( msg, args ):plain() or msg;\nend\n\n--[[\nApply kerning\
      \ to open the space between the quote mark provided by the Module and a leading or trailing quote mark contained in a |title= or |chapter= parameter's value.\nThis function will positive kern  either single or double quotes:\n\t&quot;'Unkerned title with\
      \ leading and trailing single quote marks'&quot;\n\t&quot; 'Kerned title with leading and trailing single quote marks' &quot; (in real life the kerning isn't as wide as this example)\n]]\nfunction kern_quotes (str)\n\tlocal left='&lt;span style=&quot;padding-left:0.2em;&quot;&gt;%1&lt;/span&gt;';\t\
      \t-- spacing to use when title contains leading single or double quote mark\n\tlocal right='&lt;span style=&quot;padding-right:0.2em;&quot;&gt;%1&lt;/span&gt;';\t\t-- spacing to use when title contains trailing single or double quote mark\n\t\n\tif  str:match\
      \ (&quot;^[\\&quot;\\'][^\\']&quot;) then\n\t\tstr = string.gsub( str, &quot;^[\\&quot;\\']&quot;, left, 1 );\t\t\t\t-- replace (captured) leading single or double quote with left-side &lt;span&gt;\n\tend\n\tif str:match (&quot;[^\\'][\\&quot;\\']$&quot;)\
      \ then\n\t\tstr = string.gsub( str, &quot;[\\&quot;\\']$&quot;, right, 1 );\t\t\t-- replace (captured) trailing single or double quote with right-side &lt;span&gt;\n\tend\n\treturn str;\nend\n\n--[[--------------------------&lt; F O R M A T _ S C R I P\
      \ T _ V A L U E &gt;----------------------------------------\n\n|script-title= holds title parameters that are not written in Latin based scripts: Chinese, Japanese, Arabic, Hebrew, etc. These scripts should\nnot be italicized and may be written right-to-left.\
      \  The value supplied by |script-title= is concatenated onto Title after Title has been wrapped\nin italic markup.\n\nRegardless of language, all values provided by |script-title= are wrapped in &lt;bdi&gt;...&lt;/bdi&gt; tags to isolate rtl languages\
      \ from the English left to right.\n\n|script-title= provides a unique feature.  The value in |script-title= may be prefixed with a two-character ISO639-1 language code and a colon:\n\t|script-title=ja:*** *** (where * represents a Japanese character)\n\
      Spaces between the two-character code and the colon and the colon and the first script character are allowed:\n\t|script-title=ja : *** ***\n\t|script-title=ja: *** ***\n\t|script-title=ja :*** ***\nSpaces preceding the prefix are allowed: |script-title\
      \ = ja:*** ***\n\nThe prefix is checked for validity.  If it is a valid ISO639-1 language code, the lang attribute (lang=&quot;ja&quot;) is added to the &lt;bdi&gt; tag so that browsers can\nknow the language the tag contains.  This may help the browser\
      \ render the script more correctly.  If the prefix is invalid, the lang attribute\nis not added.  At this time there is no error message for this condition.\n\nAt this writing, only |script-title= is supported.  It is anticipated that additional parameters\
      \ will be created to use this function.\n\nTODO: error messages when prefix is invalid ISO639-1 code; when script_value has prefix but no script;\n]]\n\nfunction format_script_value (script_value)\n\tlocal lang='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- initialize\
      \ to empty string\n\tlocal name;\n\tif script_value:match('^%l%l%s*:') then\t\t\t\t\t\t\t\t\t\t-- if first 3 non-space characters are script language prefix\n\t\tlang = script_value:match('^(%l%l)%s*:%s*%S.*');\t\t\t\t\t\t-- get the language prefix or\
      \ nil if there is no script\n\t\tif not is_set (lang) then\n\t\t\treturn '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- script_value was just the prefix so return empty string\n\t\tend\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if we get this far we have prefix\
      \ and script\n\t\tname = mw.language.fetchLanguageName( lang, &quot;en&quot; );\t\t\t\t\t\t-- get language name so that we can use it to categorize\n\t\tif is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- is prefix a proper ISO 639-1 language code?\n\t\t\
      \tscript_value = script_value:gsub ('^%l%l%s*:%s*', '');\t\t\t\t-- strip prefix from script\n\t\t\tif inArray (lang, {'ar', 'ja', 'ko', 'he', 'zh'}) then\t\t\t\t-- is prefix one of these language codes?\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 uses\
      \ ' .. name .. '-language script ('..lang..')');\t-- categorize in language-specific categories\n\t\t\telse\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 uses foreign language script');\t-- use this category as a catchall until language-specific category\
      \ is available\n\t\t\tend\n\t\t\tlang = ' lang=&quot;' .. lang .. '&quot; ';\t\t\t\t\t\t\t\t\t-- convert prefix into a lang attribute\n\t\telse\n\t\t\tlang = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- invalid so set lang to empty string\n\t\tend\n\tend\n\tscript_value\
      \ = '&lt;bdi' .. lang .. '&gt;' .. script_value .. '&lt;/bdi&gt;';\t\t\t-- isolate incase script is rlt\n\n\treturn script_value;\nend\n\n--[[--------------------------&lt; S C R I P T _ C O N C A T E N A T E &gt;------------------------------------------\n\
      \nInitially for |title= and |script-title=, this function concatenates those two parameter values after the script value has been \nwrapped in &lt;bdi&gt; tags.\n]]\n\nfunction script_concatenate (title, script)\n\tif is_set (script) then\n\t\tscript =\
      \ format_script_value (script);\t\t\t\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; returns empty string on error\n\t\tif is_set (script) then\n\t\t\ttitle = title .. ' ' .. script;\t\t\t\t\t\t\t\t\t\t-- concatenate title and script\
      \ title\n\t\tend\n\tend\n\treturn title;\nend\n\n-- Wraps a string using a message_list configuration taking one argument\nfunction wrap( key, str, lower )\n\tif not is_set( str ) then\n\t\treturn &quot;&quot;;\n\telseif inArray( key, { 'italic-title',\
      \ 'trans-italic-title' } ) then\n\t\tstr = safeforitalics( str );\n\tend\n\tif lower == true then\n\t\treturn substitute( cfg.messages[key]:lower(), {str} );\n\telse\n\t\treturn substitute( cfg.messages[key], {str} );\n\tend\t\t\nend\n\n--[[\nArgument\
      \ wrapper.  This function provides support for argument \nmapping defined in the configuration file so that multiple names\ncan be transparently aliased to single internal variable.\n]]\nfunction argument_wrapper( args )\n\tlocal origin = {};\n\t\n\treturn\
      \ setmetatable({\n\t\tORIGIN = function( self, k )\n\t\t\tlocal dummy = self[k]; --force the variable to be loaded.\n\t\t\treturn origin[k];\n\t\tend\n\t},\n\t{\n\t\t__index = function ( tbl, k )\n\t\t\tif origin[k] ~= nil then\n\t\t\t\treturn nil;\n\t\
      \t\tend\n\t\t\t\n\t\t\tlocal args, list, v = args, cfg.aliases[k];\n\t\t\t\n\t\t\tif type( list ) == 'table' then\n\t\t\t\tv, origin[k] = selectone( args, list, 'redundant_parameters' );\n\t\t\t\tif origin[k] == nil then\n\t\t\t\t\torigin[k] = ''; -- Empty\
      \ string, not nil\n\t\t\t\tend\n\t\t\telseif list ~= nil then\n\t\t\t\tv, origin[k] = args[list], list;\n\t\t\telse\n\t\t\t\t-- maybe let through instead of raising an error?\n\t\t\t\t-- v, origin[k] = args[k], k;\n\t\t\t\terror( cfg.messages['unknown_argument_map']\
      \ );\n\t\t\tend\n\t\t\t\n\t\t\t-- Empty strings, not nil;\n\t\t\tif v == nil then\n\t\t\t\tv = cfg.defaults[k] or '';\n\t\t\t\torigin[k] = '';\n\t\t\tend\n\t\t\t\n\t\t\ttbl = rawset( tbl, k, v );\n\t\t\treturn v;\n\t\tend,\n\t});\nend\n\n--[[\nLooks for\
      \ a parameter's name in the whitelist.\n\nParameters in the whitelist can have three values:\n\ttrue - active, supported parameters\n\tfalse - deprecated, supported parameters\n\tnil - unsupported parameters\n]]\nfunction validate( name )\n\tlocal name\
      \ = tostring( name );\n\tlocal state = whitelist.basic_arguments[ name ];\n\t\n\t-- Normal arguments\n\tif true == state then return true; end\t\t-- valid actively supported parameter\n\tif false == state then\n\t\tdeprecated_parameter ();\t\t\t\t-- parameter\
      \ is deprecated but still supported\n\t\treturn true;\n\tend\n\t\n\t-- Arguments with numbers in them\n\tname = name:gsub( &quot;%d+&quot;, &quot;#&quot; );\t\t\t\t-- replace digit(s) with # (last25 becomes last#\n\tstate = whitelist.numbered_arguments[\
      \ name ];\n\tif true == state then return true; end\t\t-- valid actively supported parameter\n\tif false == state then\n\t\tdeprecated_parameter ();\t\t\t\t-- parameter is deprecated but still supported\n\t\treturn true;\n\tend\n\t\n\treturn false;\t\t\
      \t\t\t\t\t\t-- Not supported because not found or name is set to nil\nend\n\n-- Formats a comment for error trapping\nfunction errorcomment( content, hidden )\n\treturn wrap( hidden and 'hidden-error' or 'visible-error', content );\nend\n\n--[[\nSets an\
      \ error condition and returns the appropriate error message.  The actual placement\nof the error message in the output is the responsibility of the calling function.\n]]\nfunction seterror( error_id, arguments, raw, prefix, suffix )\n\tlocal error_state\
      \ = cfg.error_conditions[ error_id ];\n\t\n\tprefix = prefix or &quot;&quot;;\n\tsuffix = suffix or &quot;&quot;;\n\t\n\tif error_state == nil then\n\t\terror( cfg.messages['undefined_error'] );\n\telseif is_set( error_state.category ) then\n\t\ttable.insert(\
      \ z.error_categories, error_state.category );\n\tend\n\t\n\tlocal message = substitute( error_state.message, arguments );\n\t\n\tmessage = message .. &quot; ([[&quot; .. cfg.messages['help page link'] .. \n\t\t&quot;#&quot; .. error_state.anchor .. &quot;|&quot;\
      \ ..\n\t\tcfg.messages['help page label'] .. &quot;]])&quot;;\n\t\n\tz.error_ids[ error_id ] = true;\n\tif inArray( error_id, { 'bare_url_missing_title', 'trans_missing_title' } )\n\t\t\tand z.error_ids['citation_missing_title'] then\n\t\treturn '', false;\n\
      \tend\n\t\n\tmessage = table.concat({ prefix, message, suffix });\n\t\n\tif raw == true then\n\t\treturn message, error_state.hidden;\n\tend\t\t\n\t\t\n\treturn errorcomment( message, error_state.hidden );\nend\n\n-- Formats a wiki style external link\n\
      function externallinkid(options)\n\tlocal url_string = options.id;\n\tif options.encode == true or options.encode == nil then\n\t\turl_string = mw.uri.encode( url_string );\n\tend\n\treturn mw.ustring.format( '[[%s|%s]]%s[%s%s%s %s]',\n\t\toptions.link,\
      \ options.label, options.separator or &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, url_string, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n-- Formats a wiki style internal link\nfunction internallinkid(options)\n\treturn\
      \ mw.ustring.format( '[[%s|%s]]%s[[%s%s%s|%s]]',\n\t\toptions.link, options.label, options.separator or &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, options.id, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n-- Format an\
      \ external link with error checking\nfunction externallink( URL, label, source )\n\tlocal error_str = &quot;&quot;;\n\tif not is_set( label ) then\n\t\tlabel = URL;\n\t\tif is_set( source ) then\n\t\t\terror_str = seterror( 'bare_url_missing_title', {\
      \ wrap( 'parameter', source ) }, false, &quot; &quot; );\n\t\telse\n\t\t\terror( cfg.messages[&quot;bare_url_no_origin&quot;] );\n\t\tend\t\t\t\n\tend\n\tif not checkurl( URL ) then\n\t\terror_str = seterror( 'bad_url', {}, false, &quot; &quot; ) .. error_str;\n\
      \tend\n\treturn table.concat({ &quot;[&quot;, URL, &quot; &quot;, safeforurl( label ), &quot;]&quot;, error_str });\nend\n\n-- Formats a link to Amazon\nfunction amazon(id, domain)\n\tif checkisbn( id ) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- see if asin value\
      \ is a 10-digit isbn\n\t\ttable.insert( z.maintenance_cats, &quot;CS1 maint: ASIN uses ISBN&quot;);\t\t\t-- add to maint category so a bot or awb script can replace |asin= with |isbn=\n\tend\n\tif not is_set(domain) then \n\t\tdomain = &quot;com&quot;;\n\
      \telseif inArray (domain, {'jp', 'uk'}) then\t\t\t-- Japan, United Kingdom\n\t\tdomain = &quot;co.&quot; .. domain;\n\telseif inArray (domain, {'au', 'br', 'mx'}) then\t-- Australia, Brazil, Mexico\n\t\tdomain = &quot;com.&quot; .. domain;\n\tend\n\tlocal\
      \ handler = cfg.id_handlers['ASIN'];\n\treturn externallinkid({link = handler.link,\n\t\tlabel=handler.label , prefix=&quot;//www.amazon.&quot;..domain..&quot;/dp/&quot;,id=id,\n\t\tencode=handler.encode, separator = handler.separator})\nend\n\n--[[\n\
      format and error check arXiv identifier.  There are two valid forms of the identifier:\nthe first form, valid only between date codes 9108 and 0703 is:\n\tarXiv:&lt;archive&gt;.&lt;class&gt;/&lt;date code&gt;&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;archive&gt;\
      \ is a string of alpha characters - may be hyphenated; no other punctuation\n\t&lt;class&gt; is a string of alpha characters - may be hyphenated; no other punctuation\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits\
      \ of the four-digit year and MM is the month number January = 01\n\t\tfirst digit of YY for this form can only 9 and 0\n\t&lt;number&gt; is a three-digit number\n\t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces (undocumented)\n\
      \t\nthe second form, valid from April 2007 is:\n\tarXiv:&lt;date code&gt;.&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits of the four-digit year and MM is the month number January\
      \ = 01\n\t&lt;number&gt; is a four-digit number\n\t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces\n]]\n\nfunction arxiv (id)\n\tlocal handler = cfg.id_handlers['ARXIV'];\n\tlocal year, month, version;\n\tlocal err_cat\
      \ = &quot;&quot;\n\t\n\tyear, month, version = id:match(&quot;^%a[%a%.%-]+/([90]%d)([01]%d)%d%d%d([v%d]*)$&quot;);\t\t\t\t-- test for the 9108-0703 format\n\tif not year then\t\t-- arXiv id is not proper 9108-0703 form\n\t\tyear, month, version = id:match(&quot;^(%d%d)([01]%d)%.%d%d%d%d([v%d]*)$&quot;);\t\
      -- test for the 0704- format\n\t\tif not year then\t\n\t\t\terr_cat = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t\t\t-- arXiv id doesn't match either format\n\t\telse\t-- id is the 0704- format\n\t\t\tyear = tonumber(year);\n\t\t\tmonth = tonumber(month);\n\
      \t\t\tif ((7 &gt; year) or (1 &gt; month and 12 &lt; month)) or\t\t\t\t\t-- is year invalid or is month invalid? (doesn't test for future years)\n\t\t\t\t((7 == year) and (4 &gt; month)) or\t\t\t\t\t\t\t\t-- when year is 07, is month invalid (before April)?\n\
      \t\t\t\tis_set (version) and nil == version:match(&quot;v%d+&quot;) then\t\t\t-- is version proper format of single 'v' followed by digits?\n\t\t\t\t\terr_cat = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t-- set error message\n\t\t\tend\n\t\tend\n\telse\t\
      -- id is the 9108-0703 format; are the date values ok\n\t\tyear = tonumber(year);\n\t\tmonth = tonumber(month);\n\t\tif ((91 &gt; year and 7 &lt; year) or (1 &gt; month and 12 &lt; month)) or\t\t\t-- if invalid year or invalid month\n\t\t\t((91 == year\
      \ and 8 &gt; month) or (7 == year and 3 &lt; month)) or \t\t-- if years ok, are starting and ending months ok?\n\t\t\t\tis_set (version) and nil == version:match(&quot;v%d+&quot;) then\t\t\t-- is version proper format of single 'v' followed by digits?\n\
      \t\t\t\t\terr_cat = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t-- set error message\n\t\tend\n\tend\n\n\treturn externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\
      \ .. err_cat;\nend\n\n--[[\nlccn normalization (http://www.loc.gov/marc/lccn-namespace.html#normalization)\n1. Remove all blanks.\n2. If there is a forward slash (/) in the string, remove it, and remove all characters to the right of the forward slash.\n\
      3. If there is a hyphen in the string:\n\ta. Remove it.\n\tb. Inspect the substring following (to the right of) the (removed) hyphen. Then (and assuming that steps 1 and 2 have been carried out):\n\t\t1. All these characters should be digits, and there\
      \ should be six or less. (not done in this function)\n\t\t2. If the length of the substring is less than 6, left-fill the substring with zeroes until the length is six.\n\nReturns a normalized lccn for lccn() to validate.  There is no error checking (step\
      \ 3.b.1) performed in this function.\n]]\n\nfunction normalize_lccn (lccn)\n\tlccn = lccn:gsub (&quot;%s&quot;, &quot;&quot;);\t\t\t\t\t\t\t\t\t-- 1. strip whitespace\n\n\tif nil ~= string.find (lccn,'/') then\n\t\tlccn = lccn:match (&quot;(.-)/&quot;);\t\
      \t\t\t\t\t\t\t-- 2. remove forward slash and all character to the right of it\n\tend\n\n\tlocal prefix\n\tlocal suffix\n\tprefix, suffix = lccn:match (&quot;(.+)%-(.+)&quot;);\t\t\t\t\t\t-- 3.a remove hyphen by splitting the string into prefix and suffix\n\
      \n\tif nil ~= suffix then\t\t\t\t\t\t\t\t\t\t\t-- if there was a hyphen\n\t\tsuffix=string.rep(&quot;0&quot;, 6-string.len (suffix)) .. suffix;\t-- 3.b.2 left fill the suffix with 0s if suffix length less than 6\n\t\tlccn=prefix..suffix;\t\t\t\t\t\t\t\t\
      \t\t-- reassemble the lccn\n\tend\n\t\n\treturn lccn;\n\tend\n\n--[[\nFormat LCCN link and do simple error checking.  LCCN is a character string 8-12 characters long. The length of the LCCN dictates the character type of the first 1-3 characters; the\n\
      rightmost eight are always digits. http://info-uri.info/registry/OAIHandler?verb=GetRecord&amp;metadataPrefix=reg&amp;identifier=info:lccn/\n\nlength = 8 then all digits\nlength = 9 then lccn[1] is lower case alpha\nlength = 10 then lccn[1] and lccn[2]\
      \ are both lower case alpha or both digits\nlength = 11 then lccn[1] is lower case alpha, lccn[2] and lccn[3] are both lower case alpha or both digits\nlength = 12 then lccn[1] and lccn[2] are both lower case alpha\n\n]]\nfunction lccn(lccn)\n\tlocal handler\
      \ = cfg.id_handlers['LCCN'];\n\tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that LCCN is valid\n\tlocal id = lccn;\t\t\t\t\t\t\t\t\t-- local copy of the lccn\n\n\tid = normalize_lccn (id);\t\t\t\t\t\t\t-- get canonical form (no whitespace, hyphens,\
      \ forward slashes)\n\tlocal len = id:len();\t\t\t\t\t\t\t\t-- get the length of the lccn\n\n\tif 8 == len then\n\t\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t-- if LCCN has anything but digits (nil if only digits)\n\t\t\terr_cat = ' ' .. seterror(\
      \ 'bad_lccn' );\t-- set an error message\n\t\tend\n\telseif 9 == len then\t\t\t\t\t\t\t\t-- LCCN should be adddddddd\n\t\tif nil == id:match(&quot;%l%d%d%d%d%d%d%d%d&quot;) then\t\t\t-- does it match our pattern?\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn'\
      \ );\t-- set an error message\n\t\tend\n\telseif 10 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddd or dddddddddd\n\t\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if LCCN has anything but digits (nil if only digits) ...\n\t\t\tif nil ==\
      \ id:match(&quot;^%l%l%d%d%d%d%d%d%d%d&quot;) then\t-- ... see if it matches our pattern\n\t\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match, set an error message\n\t\t\tend\n\t\tend\n\telseif 11 == len then\t\t\t\t\t\t\t\t-- LCCN should be\
      \ aaadddddddd or adddddddddd\n\t\tif not (id:match(&quot;^%l%l%l%d%d%d%d%d%d%d%d&quot;) or id:match(&quot;^%l%d%d%d%d%d%d%d%d%d%d&quot;)) then\t-- see if it matches one of our patterns\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match, set an\
      \ error message\n\t\tend\n\telseif 12 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddddd\n\t\tif not id:match(&quot;^%l%l%d%d%d%d%d%d%d%d%d%d&quot;) then\t-- see if it matches our pattern\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match,\
      \ set an error message\n\t\tend\n\telse\n\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t\t-- wrong length, set an error message\n\tend\n\n\tif not is_set (err_cat) and nil ~= lccn:find ('%s') then\n\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t\t-- lccn\
      \ contains a space, set an error message\n\tend\n\n\treturn externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=lccn,separator=handler.separator, encode=handler.encode}) .. err_cat;\nend\n\n--[[\nFormat PMID and\
      \ do simple error checking.  PMIDs are sequential numbers beginning at 1 and counting up.  This code checks the PMID to see that it\ncontains only digits and is less than test_limit; the value in local variable test_limit will need to be updated periodically\
      \ as more PMIDs are issued.\n]]\nfunction pmid(id)\n\tlocal test_limit = 30000000;\t\t\t\t\t\t-- update this value as PMIDs approach\n\tlocal handler = cfg.id_handlers['PMID'];\n\tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that PMID is valid\n\t\n\t\
      if id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMID has anything but digits\n\t\terr_cat = ' ' .. seterror( 'bad_pmid' );\t\t-- set an error message\n\telse\t\t\t\t\t\t\t\t\t\t\t\t-- PMID is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\
      \t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or test_limit &lt; id_num then\t\t-- if PMID is outside test limit boundaries\n\t\t\terr_cat = ' ' .. seterror( 'bad_pmid' );\t-- set an error message\n\t\tend\n\tend\n\t\n\treturn externallinkid({link\
      \ = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode}) .. err_cat;\nend\n\n--[[\nDetermines if a PMC identifier's online version is embargoed. Compares the date in |embargo= against\
      \ today's date.  If embargo date is\nin the future, returns true; otherwise, returns false because the embargo has expired or |embargo= not set in this cite.\n]]\nfunction is_embargoed(embargo)\n\tif is_set(embargo) then\n\t\tlocal lang = mw.getContentLanguage();\n\
      \t\tlocal good1, embargo_date, good2, todays_date;\n\t\tgood1, embargo_date = pcall( lang.formatDate, lang, 'U', embargo );\n\t\tgood2, todays_date = pcall( lang.formatDate, lang, 'U' );\n\t\n\t\tif good1 and good2 and tonumber( embargo_date ) &gt;= tonumber(\
      \ todays_date ) then\t--is embargo date is in the future?\n\t\t\treturn true;\t-- still embargoed\n\t\tend\n\tend\n\treturn false;\t\t\t-- embargo expired or |embargo= not set\nend\n\n--[[\nFormat a PMC, do simple error checking, and check for embargoed\
      \ articles.\n\nThe embargo parameter takes a date for a value. If the embargo date is in the future\nthe PMC identifier will not be linked to the article.  If the embargo specifies a date in the past, or if it is empty or omitted, then\nthe PMC identifier\
      \ is linked to the article through the link at cfg.id_handlers['PMC'].prefix.\n\nPMCs are sequential numbers beginning at 1 and counting up.  This code checks the PMC to see that it contains only digits and is less\nthan test_limit; the value in local\
      \ variable test_limit will need to be updated periodically as more PMCs are issued.\n]]\nfunction pmc(id, embargo)\n\tlocal test_limit = 5000000;\t\t\t\t\t\t\t-- update this value as PMCs approach\n\tlocal handler = cfg.id_handlers['PMC'];\n\tlocal err_cat\
      \ =  '';\t\t\t\t\t\t\t\t-- presume that PMC is valid\n\t\n\tlocal text;\n\n\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMC has anything but digits\n\t\terr_cat = ' ' .. seterror( 'bad_pmc' );\t\t\t-- set an error message\n\telse\t\t\t\t\t\t\
      \t\t\t\t\t\t-- PMC is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or test_limit &lt; id_num then\t\t-- if PMC is outside test limit boundaries\n\t\t\terr_cat = ' ' .. seterror(\
      \ 'bad_pmc' );\t\t-- set an error message\n\t\tend\n\tend\n\t\n\tif is_embargoed(embargo) then\n\t\ttext=&quot;[[&quot; .. handler.link .. &quot;|&quot; .. handler.label .. &quot;]]:&quot; .. handler.separator .. id .. err_cat;\t--still embargoed so no\
      \ external link\n\telse\n\t\ttext = externallinkid({link = handler.link, label = handler.label,\t\t\t--no embargo date, ok to link to article\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode}) .. err_cat;\n\tend\n\t\
      return text;\nend\n\n-- Formats a DOI and checks for DOI errors.\n\n-- DOI names contain two parts: prefix and suffix separated by a forward slash.\n--  Prefix: directory indicator '10.' followed by a registrant code\n--  Suffix: character string of any\
      \ length chosen by the registrant\n\n-- This function checks a DOI name for: prefix/suffix.  If the doi name contains spaces or endashes,\n-- or, if it ends with a period or a comma, this function will emit a bad_doi error message.\n\n-- DOI names are\
      \ case-insensitive and can incorporate any printable Unicode characters so the test for spaces, endash,\n-- and terminal punctuation may not be technically correct but it appears, that in practice these characters are rarely if ever used in doi names.\n\
      \nfunction doi(id, inactive)\n\tlocal cat = &quot;&quot;\n\tlocal handler = cfg.id_handlers['DOI'];\n\t\n\tlocal text;\n\tif is_set(inactive) then\n\t\tlocal inactive_year = inactive:match(&quot;%d%d%d%d&quot;) or '';\t\t-- try to get the year portion\
      \ from the inactive date\n\t\ttext = &quot;[[&quot; .. handler.link .. &quot;|&quot; .. handler.label .. &quot;]]:&quot; .. id;\n\t\tif is_set(inactive_year) then\n\t\t\ttable.insert( z.error_categories, &quot;Pages with DOIs inactive since &quot; .. inactive_year\
      \ );\n\t\telse\n\t\t\ttable.insert( z.error_categories, &quot;Pages with inactive DOIs&quot; );\t-- when inactive doesn't contain a recognizable year\n\t\tend\n\t\tinactive = &quot; (&quot; .. cfg.messages['inactive'] .. &quot; &quot; .. inactive .. &quot;)&quot;\
      \ \n\telse \n\t\ttext = externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n\t\tinactive = &quot;&quot; \n\tend\n\n\tif nil == id:match(&quot;^10%.[^%s–]-/[^%s–\
      ]-[^%.,]$&quot;) then\t-- doi must begin with '10.', must contain a fwd slash, must not contain spaces or endashes, and must not end with period or comma\n\t\tcat = ' ' .. seterror( 'bad_doi' );\n\tend\n\treturn text .. inactive .. cat \nend\n\n-- Formats\
      \ an OpenLibrary link, and checks for associated errors.\nfunction openlibrary(id)\n\tlocal code = id:match(&quot;^%d+([AMW])$&quot;);\t\t\t\t\t-- only digits followed by 'A', 'M', or 'W'\n\tlocal handler = cfg.id_handlers['OL'];\n\n\tif ( code == &quot;A&quot;\
      \ ) then\n\t\treturn externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/authors/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telseif ( code == &quot;M&quot; ) then\n\t\t\
      return externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/books/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telseif ( code == &quot;W&quot; ) then\n\t\treturn externallinkid({link=handler.link,\
      \ label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/works/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telse\n\t\treturn externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/OL&quot;,id=id,\
      \ separator=handler.separator,\n\t\t\tencode = handler.encode}) .. \n\t\t\t' ' .. seterror( 'bad_ol' );\n\tend\nend\n\n--[[\nValidate and format an issn.  This code fixes the case where an editor has included an ISSN in the citation but has separated the\
      \ two groups of four\ndigits with a space.  When that condition occurred, the resulting link looked like this:\n\n\t|issn=0819 4327 gives: [http://www.worldcat.org/issn/0819 4327 0819 4327]  -- can't have spaces in an external link\n\t\nThis code now prevents\
      \ that by inserting a hyphen at the issn midpoint.  It also validates the issn for length and makes sure that the checkdigit agrees\nwith the calculated value.  Incorrect length (8 digits), characters other than 0-9 and X, or checkdigit / calculated value\
      \ mismatch will all cause a check issn\nerror message.  The issn is always displayed with a hyphen, even if the issn was given as a single group of 8 digits.\n]]\nfunction issn(id)\n\tlocal issn_copy = id;\t\t-- save a copy of unadulterated issn; use this\
      \ version for display if issn does not validate\n\tlocal handler = cfg.id_handlers['ISSN'];\n\tlocal text;\n\tlocal valid_issn = true;\n\n\tid=id:gsub( &quot;[%s-–]&quot;, &quot;&quot; );\t\t\t\t\t\t\t\t\t-- strip spaces, hyphens, and endashes from the\
      \ issn\n\n\tif 8 ~= id:len() or nil == id:match( &quot;^%d*X?$&quot; ) then\t\t-- validate the issn: 8 digits long, containing only 0-9 or X in the last position\n\t\tvalid_issn=false;\t\t\t\t\t\t\t\t\t\t-- wrong length or improper character\n\telse\n\t\
      \tvalid_issn=is_valid_isxn(id, 8);\t\t\t\t\t\t-- validate issn\n\tend\n\n\tif true == valid_issn then\n\t\tid = string.sub( id, 1, 4 ) .. &quot;-&quot; .. string.sub( id, 5 );\t-- if valid, display correctly formatted version\n\telse\n\t\tid = issn_copy;\t\
      \t\t\t\t\t\t\t\t\t\t-- if not valid, use the show the invalid issn with error message\n\tend\n\t\n\ttext = externallinkid({link = handler.link, label = handler.label,\n\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n\
      \ \n\tif false == valid_issn then\n\t\ttext = text .. ' ' .. seterror( 'bad_issn' )\t\t\t-- add an error message if the issn is invalid\n\tend \n\t\n\treturn text\nend\n\n--[[\nThis function sets default title types (equivalent to the citation including\
      \ |type=&lt;default value&gt;) for those citations that have defaults.\nAlso handles the special case where it is desirable to omit the title type from the rendered citation (|type=none).\n]]\nfunction set_titletype(cite_class, title_type)\n\tif is_set(title_type)\
      \ then\n\t\tif &quot;none&quot; == title_type then\n\t\t\ttitle_type = &quot;&quot;;\t\t\t\t\t-- if |type=none then type parameter not displayed\n\t\tend\n\t\treturn title_type;\t\t\t\t\t\t-- if |type= has been set to any other value use that value\n\t\
      end\n\n\tif &quot;AV-media-notes&quot; == cite_class or &quot;DVD-notes&quot; == cite_class then\t\t-- if this citation is cite AV media notes or cite DVD notes\n\t\treturn &quot;Media notes&quot;;\t\t\t\t\t-- display AV media notes / DVD media notes annotation\n\
      \n\telseif &quot;podcast&quot; == cite_class then\t\t\t-- if this citation is cite podcast\n\t\treturn &quot;Podcast&quot;;\t\t\t\t\t\t-- display podcast annotation\n\n\telseif &quot;pressrelease&quot; == cite_class then\t-- if this citation is cite press\
      \ release\n\t\treturn &quot;Press release&quot;;\t\t\t\t\t-- display press release annotation\n\n\telseif &quot;techreport&quot; == cite_class then\t\t-- if this citation is cite techreport\n\t\treturn &quot;Technical report&quot;;\t\t\t\t-- display techreport\
      \ annotation\n\t\n\telseif &quot;thesis&quot; == cite_class then\t\t\t-- if this citation is cite thesis (degree option handled after this function returns)\n\t\t\treturn &quot;Thesis&quot;;\t\t\t\t\t-- display simple thesis annotation (without |degree=\
      \ modification)\n\tend\nend\n\n--[[\nDetermines whether a URL string is valid\n\nAt present the only check is whether the string appears to \nbe prefixed with a URI scheme.  It is not determined whether \nthe URI scheme is valid or whether the URL is otherwise\
      \ well \nformed.\n]]\nfunction checkurl( url_str )\n\t-- Protocol-relative or URL scheme\n\treturn url_str:sub(1,2) == &quot;//&quot; or url_str:match( &quot;^[^/]*:&quot; ) ~= nil;\nend\n\n-- Removes irrelevant text and dashes from ISBN number\n-- Similar\
      \ to that used for Special:BookSources\nfunction cleanisbn( isbn_str )\n\treturn isbn_str:gsub( &quot;[^-0-9X]&quot;, &quot;&quot; );\nend\n\n--[[--------------------------&lt; E S C A P E _ L U A _ M A G I C _ C H A R S &gt;----------------------------------\n\
      \nReturns a string where all of lua's magic characters have been escaped.  This is important because functions like\nstring.gsub() treat their pattern and replace strings as patterns, not literal strings.\n]]\nfunction escape_lua_magic_chars (argument)\n\
      \targument = argument:gsub(&quot;%%&quot;, &quot;%%%%&quot;);\t\t\t\t\t\t\t\t\t\t-- replace % with %%\n\targument = argument:gsub(&quot;([%^%$%(%)%.%[%]%*%+%-%?])&quot;, &quot;%%%1&quot;);\t\t\t\t-- replace all other lua magic pattern characters\n\treturn\
      \ argument;\nend\n\n--[[--------------------------&lt; S T R I P _ A P O S T R O P H E _ M A R K U P &gt;--------------------------------\n\nStrip wiki italic and bold markup from argument so that it doesn't contaminate COinS metadata.\nThis function strips\
      \ common patterns of apostrophe markup.  We presume that editors who have taken the time to\nmarkup a title have, as a result, provided valid markup. When they don't, some single apostrophes are left behind.\n\n]]\nfunction strip_apostrophe_markup (argument)\n\
      \tif not is_set (argument) then return argument; end\n\n\twhile true do\n\t\tif argument:match (&quot;%'%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- bold italic (5)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'%'&quot;, &quot;&quot;);\t\t\t\t\t\t\t-- remove\
      \ all instances of it\n\t\telseif argument:match (&quot;%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- italic start and end without content (4)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'&quot;, &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'%'&quot;)\
      \ then\t\t\t\t\t\t\t\t\t-- bold (3)\n\t\t\targument=argument:gsub(&quot;%'%'%'&quot;, &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'&quot;) then\t\t\t\t\t\t\t\t\t\t-- italic (2)\n\t\t\targument=argument:gsub(&quot;%'%'&quot;, &quot;&quot;);\n\t\t\
      else\n\t\t\tbreak;\n\t\tend\n\tend\n\treturn argument;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- done\nend\n\n--[[--------------------------&lt; M A K E _ C O I N S _ T I T L E &gt;----------------------------------------------\n\nMakes a title for COinS from Title\
      \ and / or ScriptTitle (or any other name-script pairs)\n\nApostrophe markup (bold, italics) is stripped from each value so that the COinS metadata isn't correupted with strings\nof %27%27...\n]]\n\nfunction make_coins_title (title, script)\n\tif is_set\
      \ (title) then\n\t\ttitle = strip_apostrophe_markup (title);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\telse\n\t\ttitle='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure title is an empty string\n\tend\n\tif is_set (script) then\n\t\tscript\
      \ = script:gsub ('^%l%l%s*:%s*', '');\t\t\t\t\t\t\t\t-- remove language prefix if present (script value may now be empty string)\n\t\tscript = strip_apostrophe_markup (script);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\telse\n\t\tscript='';\t\t\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure script is an empty string\n\tend\n\tif is_set (title) and is_set (script) then\n\t\tscript = ' ' .. script;\t\t\t\t\t\t\t\t\t\t\t\t\t-- add a space before we concatenate\n\tend\n\treturn title .. script;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t-- return the concatenation\nend\n\n--[[--------------------------&lt; G E T _ C O I N S _ P A G E S &gt;------------------------------------------------\n\nExtract page numbers from external wikilinks in any of the |page=, |pages=,\
      \ or |at= parameters for use in COinS.\n\n]]\nfunction get_coins_pages (pages)\n\tlocal pattern;\n\tif not is_set (pages) then return pages; end\t\t\t\t\t\t\t\t-- if no page numbers then we're done\n\t\n\twhile true do\n\t\tpattern = pages:match(&quot;%[(%w*:?//[^\
      \ ]+%s+)[%w%d].*%]&quot;);\t\t\t\t\t-- pattern is the opening bracket, the url and following space(s): &quot;[url &quot;\n\t\tif nil == pattern then break; end\t\t\t\t\t\t\t\t\t\t-- no more urls\n\t\tpattern = escape_lua_magic_chars (pattern);\t\t\t\t\t\
      \t\t\t-- pattern is not a literal string; escape lua's magic pattern characters\n\t\tpages = pages:gsub(pattern, &quot;&quot;);\t\t\t\t\t\t\t\t\t\t-- remove as many instances of pattern as possible\n\tend\n\tpages = pages:gsub(&quot;[%[%]]&quot;, &quot;&quot;);\t\
      \t\t\t\t\t\t\t\t\t\t-- remove the brackets\n\tpages = pages:gsub(&quot;–&quot;, &quot;-&quot; );\t\t\t\t\t\t\t-- replace endashes with hyphens\n\tpages = pages:gsub(&quot;&amp;%w+;&quot;, &quot;-&quot; );\t\t\t\t\t\t-- and replace html entities (&amp;ndash;\
      \ etc.) with hyphens; do we need to replace numerical entities like &amp;#32; and the like?\n\treturn pages;\nend\n\n--[[\nISBN-10 and ISSN validator code calculates checksum across all isbn/issn digits including the check digit. ISBN-13 is checked in\
      \ checkisbn().\nIf the number is valid the result will be 0. Before calling this function, issbn/issn must be checked for length and stripped of dashes,\nspaces and other non-isxn characters.\n]]\nfunction is_valid_isxn (isxn_str, len)\n\tlocal temp =\
      \ 0;\n\tisxn_str = { isxn_str:byte(1, len) };\t-- make a table of bytes\n\tlen = len+1;\t\t\t\t\t\t\t-- adjust to be a loop counter\n\tfor i, v in ipairs( isxn_str ) do\t\t-- loop through all of the bytes and calculate the checksum\n\t\tif v == string.byte(\
      \ &quot;X&quot; ) then\t\t-- if checkdigit is X\n\t\t\ttemp = temp + 10*( len - i );\t-- it represents 10 decimal\n\t\telse\n\t\t\ttemp = temp + tonumber( string.char(v) )*(len-i);\n\t\tend\n\tend\n\treturn temp % 11 == 0;\t\t\t\t\t-- returns true if calculation\
      \ result is zero\nend\n\n-- Determines whether an ISBN string is valid\nfunction checkisbn( isbn_str )\n\tif nil ~= isbn_str:match(&quot;[^%s-0-9X]&quot;) then return false; end\t\t-- fail if isbn_str contains anything but digits, hyphens, or the uppercase\
      \ X\n\tisbn_str = isbn_str:gsub( &quot;-&quot;, &quot;&quot; ):gsub( &quot; &quot;, &quot;&quot; );\t-- remove hyphens and spaces\n\tlocal len = isbn_str:len();\n \n\tif len ~= 10 and len ~= 13 then\n\t\treturn false;\n\tend\n\n\tif len == 10 then\n\t\t\
      if isbn_str:match( &quot;^%d*X?$&quot; ) == nil then return false; end\n\t\treturn is_valid_isxn(isbn_str, 10);\n\telse\n\t\tlocal temp = 0;\n\t\tif isbn_str:match( &quot;^97[89]%d*$&quot; ) == nil then return false; end\t-- isbn13 begins with 978 or 979\n\
      \t\tisbn_str = { isbn_str:byte(1, len) };\n\t\tfor i, v in ipairs( isbn_str ) do\n\t\t\ttemp = temp + (3 - 2*(i % 2)) * tonumber( string.char(v) );\n\t\tend\n\t\treturn temp % 10 == 0;\n\tend\nend\n\n-- Gets the display text for a wikilink like [[A|B]]\
      \ or [[B]] gives B\nfunction removewikilink( str )\n\treturn (str:gsub( &quot;%[%[([^%[%]]*)%]%]&quot;, function(l)\n\t\treturn l:gsub( &quot;^[^|]*|(.*)$&quot;, &quot;%1&quot; ):gsub(&quot;^%s*(.-)%s*$&quot;, &quot;%1&quot;);\n\tend));\nend\n\n-- Escape\
      \ sequences for content that will be used for URL descriptions\nfunction safeforurl( str )\n\tif str:match( &quot;%[%[.-%]%]&quot; ) ~= nil then \n\t\ttable.insert( z.message_tail, { seterror( 'wikilink_in_url', {}, true ) } );\n\tend\n\t\n\treturn str:gsub(\
      \ '[%[%]\\n]', {\t\n\t\t['['] = '&amp;#91;',\n\t\t[']'] = '&amp;#93;',\n\t\t['\\n'] = ' ' } );\nend\n\n-- Converts a hyphen to a dash\nfunction hyphentodash( str )\n\tif not is_set(str) or str:match( &quot;[%[%]{}&lt;&gt;]&quot; ) ~= nil then\n\t\treturn\
      \ str;\n\tend\t\n\treturn str:gsub( '-', '–' );\nend\n\n-- Protects a string that will be wrapped in wiki italic markup '' ... ''\nfunction safeforitalics( str )\n\t--[[ Note: We cannot use &lt;i&gt; for italics, as the expected behavior for\n\titalics\
      \ specified by ''...'' in the title is that they will be inverted\n\t(i.e. unitalicized) in the resulting references.  In addition, &lt;i&gt; and ''\n\ttend to interact poorly under Mediawiki's HTML tidy. ]]\n\t\n\tif not is_set(str) then\n\t\treturn str;\n\
      \telse\n\t\tif str:sub(1,1) == &quot;'&quot; then str = &quot;&lt;span /&gt;&quot; .. str; end\n\t\tif str:sub(-1,-1) == &quot;'&quot; then str = str .. &quot;&lt;span /&gt;&quot;; end\n\t\t\n\t\t-- Remove newlines as they break italics.\n\t\treturn str:gsub(\
      \ '\\n', ' ' );\n\tend\nend\n\n--[[\nJoins a sequence of strings together while checking for duplicate separation characters.\n\nTODO: safejoin() has a flaw where it won't remove the duplicate character from a |title= / |url= combination.\nThis is because\
      \ by the time we get here, |title=http://somesite.com and |title=Document Title. have been combined:\n\t[http://somesite.com and ''Document Title.'']\nso that now, the last character is not sepc but is ] (unless sepc == ']' which breaks the external link)\n\
      ]]\nfunction safejoin( tbl, duplicate_char )\n\t--[[\n\tNote: we use string functions here, rather than ustring functions.\n\t\n\tThis has considerably faster performance and should work correctly as \n\tlong as the duplicate_char is strict ASCII.  The\
      \ strings\n\tin tbl may be ASCII or UTF8.\n\t]]\n\t\n\tlocal str = '';\n\tlocal comp = '';\n\tlocal end_chr = '';\n\tlocal trim;\n\tfor _, value in ipairs( tbl ) do\n\t\tif value == nil then value = ''; end\n\t\t\n\t\tif str == '' then\n\t\t\tstr = value;\n\
      \t\telseif value ~= '' then\n\t\t\tif value:sub(1,1) == '&lt;' then\n\t\t\t\t-- Special case of values enclosed in spans and other markup.\n\t\t\t\tcomp = value:gsub( &quot;%b&lt;&gt;&quot;, &quot;&quot; );\n\t\t\telse\n\t\t\t\tcomp = value;\n\t\t\tend\n\
      \t\t\t\n\t\t\tif comp:sub(1,1) == duplicate_char then\n\t\t\t\ttrim = false;\n\t\t\t\tend_chr = str:sub(-1,-1);\n\t\t\t\t-- str = str .. &quot;&lt;HERE(enchr=&quot; .. end_chr.. &quot;)&quot;\n\t\t\t\tif end_chr == duplicate_char then\n\t\t\t\t\tstr =\
      \ str:sub(1,-2);\n\t\t\t\telseif end_chr == &quot;'&quot; then\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char .. &quot;''&quot; then\n\t\t\t\t\t\tstr = str:sub(1, -4) .. &quot;''&quot;;\n\t\t\t\t\telseif str:sub(-5,-1) == duplicate_char .. &quot;]]''&quot;\
      \ then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-4,-1) == duplicate_char .. &quot;]''&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\tend\n\t\t\t\telseif end_chr == &quot;]&quot; then\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char .. &quot;]]&quot;\
      \ then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-2,-1) == duplicate_char .. &quot;]&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\tend\n\t\t\t\telseif end_chr == &quot; &quot; then\n\t\t\t\t\tif str:sub(-2,-1) == duplicate_char .. &quot; &quot;\
      \ then\n\t\t\t\t\t\tstr = str:sub(1,-3);\n\t\t\t\t\tend\n\t\t\t\tend\n\n\t\t\t\tif trim then\n\t\t\t\t\tif value ~= comp then \n\t\t\t\t\t\tlocal dup2 = duplicate_char;\n\t\t\t\t\t\tif dup2:match( &quot;%A&quot; ) then dup2 = &quot;%&quot; .. dup2; end\n\
      \t\t\t\t\t\t\n\t\t\t\t\t\tvalue = value:gsub( &quot;(%b&lt;&gt;)&quot; .. dup2, &quot;%1&quot;, 1 )\n\t\t\t\t\telse\n\t\t\t\t\t\tvalue = value:sub( 2, -1 );\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\t\tstr = str .. value;\n\t\tend\n\tend\n\treturn str;\n\
      end  \n\n-- Attempts to convert names to initials.\nfunction reducetoinitials(first)\n\tlocal initials = {}\n\tlocal i = 0;\t\t\t\t\t\t\t\t\t\t-- counter for number of initials\n\tfor word in string.gmatch(first, &quot;%S+&quot;) do\n\t\ttable.insert(initials,\
      \ string.sub(word,1,1))\t-- Vancouver format does not include full stops.\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t-- bump the counter \n\t\tif 2 &lt;= i then break; end\t\t\t\t\t\t-- only two initials allowed in Vancouver system; if 2, quit\n\tend\n\treturn\
      \ table.concat(initials)\t\t\t\t\t\t-- Vancouver format does not include spaces.\nend\n\n-- Formats a list of people (e.g. authors / editors) \nfunction listpeople(control, people)\n\tlocal sep = control.sep;\n\tlocal namesep = control.namesep\n\tlocal\
      \ format = control.format\n\tlocal maximum = control.maximum\n\tlocal lastauthoramp = control.lastauthoramp;\n\tlocal text = {}\n\tlocal etal = false;\n\t\n\tif sep:sub(-1,-1) ~= &quot; &quot; then sep = sep .. &quot; &quot; end\n\tif maximum ~= nil and\
      \ maximum &lt; 1 then return &quot;&quot;, 0; end\n\t\n\tfor i,person in ipairs(people) do\n\t\tif is_set(person.last) then\n\t\t\tlocal mask = person.mask\n\t\t\tlocal one\n\t\t\tlocal sep_one = sep;\n\t\t\tif maximum ~= nil and i &gt; maximum then\n\t\
      \t\t\tetal = true;\n\t\t\t\tbreak;\n\t\t\telseif (mask ~= nil) then\n\t\t\t\tlocal n = tonumber(mask)\n\t\t\t\tif (n ~= nil) then\n\t\t\t\t\tone = string.rep(&quot;&amp;mdash;&quot;,n)\n\t\t\t\telse\n\t\t\t\t\tone = mask;\n\t\t\t\t\tsep_one = &quot; &quot;;\n\
      \t\t\t\tend\n\t\t\telse\n\t\t\t\tone = person.last\n\t\t\t\tlocal first = person.first\n\t\t\t\tif is_set(first) then \n\t\t\t\t\tif ( &quot;vanc&quot; == format ) then first = reducetoinitials(first) end\n\t\t\t\t\tone = one .. namesep .. first \n\t\t\
      \t\tend\n\t\t\t\tif is_set(person.link) and person.link ~= control.page_name then\n\t\t\t\t\tone = &quot;[[&quot; .. person.link .. &quot;|&quot; .. one .. &quot;]]&quot;\t\t-- link author/editor if this page is not the author's/editor's page\n\t\t\t\t\
      end\n\n\t\t\t\tif is_set(person.link) and nil ~= person.link:find(&quot;//&quot;) then one = one .. &quot; &quot; .. seterror( 'bad_authorlink' ) end\t-- check for url in author link;\n\t\t\tend\n\t\t\ttable.insert( text, one )\n\t\t\ttable.insert( text,\
      \ sep_one )\n\t\tend\n\tend\n\n\tlocal count = #text / 2;\n\tif count &gt; 0 then \n\t\tif count &gt; 1 and is_set(lastauthoramp) and not etal then\n\t\t\ttext[#text-2] = &quot; &amp; &quot;;\n\t\tend\n\t\ttext[#text] = nil; \n\tend\n\t\n\tlocal result\
      \ = table.concat(text) -- construct list\n\tif etal then \n\t\tlocal etal_text = cfg.messages['et al'];\n\t\tresult = result .. &quot; &quot; .. etal_text;\n\tend\n\t\n\t-- if necessary wrap result in &lt;span&gt; tag to format in Small Caps\n\tif ( &quot;scap&quot;\
      \ == format ) then result = \n\t\t'&lt;span class=&quot;smallcaps&quot; style=&quot;font-variant:small-caps&quot;&gt;' .. result .. '&lt;/span&gt;';\n\tend \n\treturn result, count\nend\n\n-- Generates a CITEREF anchor ID.\nfunction anchorid( options )\n\
      \treturn &quot;CITEREF&quot; .. table.concat( options );\nend\n\n--[[\nGets name list from the input arguments\n\nSearches through args in sequential order to find |lastn= and |firstn= parameters (or their aliases), and their matching link and mask parameters.\n\
      Stops searching when both |lastn= and |firstn= are not found in args after two sequential attempts: found |last1=, |last2=, and |last3= but doesn't\nfind |last4= and |last5= then the search is done.\n\nThis function emits an error message when there is\
      \ a |firstn= without a matching |lastn=.  When there are 'holes' in the list of last names, |last1= and |last3=\nare present but |last2= is missing, an error message is emitted. |lastn= is not required to have a matching |firstn=.\n]]\nfunction extractnames(args,\
      \ list_name)\n\tlocal names = {};\t\t\t-- table of names\n\tlocal last;\t\t\t\t\t-- individual name components\n\tlocal first;\n\tlocal link;\n\tlocal mask;\n\tlocal i = 1;\t\t\t\t-- loop counter/indexer\n\tlocal n = 1;\t\t\t\t-- output table indexer\n\
      \tlocal count = 0;\t\t\t-- used to count the number of times we haven't found a |last= (or alias for authors, |editor-last or alias for editors)\n\t\n\tlocal err_msg_list_name = list_name:match (&quot;(%w+)List&quot;) .. 's list';\t\t-- modify AuthorList\
      \ or EditorList for use in error messages if necessary\n\n\twhile true do\n\t\tlast = selectone( args, cfg.aliases[list_name .. '-Last'], 'redundant_parameters', i );\t\t-- search through args for name components beginning at 1\n\t\tfirst = selectone(\
      \ args, cfg.aliases[list_name .. '-First'], 'redundant_parameters', i );\n\t\tlink = selectone( args, cfg.aliases[list_name .. '-Link'], 'redundant_parameters', i );\n\t\tmask = selectone( args, cfg.aliases[list_name .. '-Mask'], 'redundant_parameters',\
      \ i );\n\n\t\tif first and not last then\t\t\t\t\t\t\t\t\t\t\t\t-- if there is a firstn without a matching lastn\n\t\t\ttable.insert( z.message_tail, { seterror( 'first_missing_last', {err_msg_list_name, i}, true ) } );\t-- add this error message\n\t\t\
      elseif not first and not last then\t\t\t\t\t\t\t\t\t\t-- if both firstn and lastn aren't found, are we done?\n\t\t\tcount = count + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t-- number of times we haven't found last and first\n\t\t\tif 2 == count then\t\t\t\t\t\t\t\t\
      \t\t\t\t\t-- two missing names and we give up\n\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- normal exit or there is a two-name hole in the list; can't tell which\n\t\t\tend\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- we have last with or without a\
      \ first\n\t\t\tnames[n] = {last = last, first = first, link = link, mask = mask};\t-- add this name to our names list\n\t\t\tn = n + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next location in the names table\n\t\t\tif 1 == count then\t\t\t\t\t\t\t\t\t\
      \t\t\t\t-- if the previous name was missing\n\t\t\t\ttable.insert( z.message_tail, { seterror( 'missing_name', {err_msg_list_name, i-1}, true ) } );\t\t-- add this error message\n\t\t\tend\n\t\t\tcount = 0;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- reset the counter,\
      \ we're looking for two consecutive missing names\n\t\tend\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next args location\n\tend\n\treturn names;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- all done, return our list of names\nend\n\n-- Populates ID\
      \ table from arguments using configuration settings\nfunction extractids( args )\n\tlocal id_list = {};\n\tfor k, v in pairs( cfg.id_handlers ) do\t\n\t\tv = selectone( args, v.parameters, 'redundant_parameters' );\n\t\tif is_set(v) then id_list[k] = v;\
      \ end\n\tend\n\treturn id_list;\nend\n\n-- Takes a table of IDs and turns it into a table of formatted ID outputs.\nfunction buildidlist( id_list, options )\n\tlocal new_list, handler = {};\n\t\n\tfunction fallback(k) return { __index = function(t,i) return\
      \ cfg.id_handlers[k][i] end } end;\n\t\n\tfor k, v in pairs( id_list ) do\n\t\t-- fallback to read-only cfg\n\t\thandler = setmetatable( { ['id'] = v }, fallback(k) );\n\t\t\n\t\tif handler.mode == 'external' then\n\t\t\ttable.insert( new_list, {handler.label,\
      \ externallinkid( handler ) } );\n\t\telseif handler.mode == 'internal' then\n\t\t\ttable.insert( new_list, {handler.label, internallinkid( handler ) } );\n\t\telseif handler.mode ~= 'manual' then\n\t\t\terror( cfg.messages['unknown_ID_mode'] );\n\t\t\
      elseif k == 'DOI' then\n\t\t\ttable.insert( new_list, {handler.label, doi( v, options.DoiBroken ) } );\n\t\telseif k == 'ARXIV' then\n\t\t\ttable.insert( new_list, {handler.label, arxiv( v ) } ); \n\t\telseif k == 'ASIN' then\n\t\t\ttable.insert( new_list,\
      \ {handler.label, amazon( v, options.ASINTLD ) } ); \n\t\telseif k == 'LCCN' then\n\t\t\ttable.insert( new_list, {handler.label, lccn( v ) } );\n\t\telseif k == 'OL' then\n\t\t\ttable.insert( new_list, {handler.label, openlibrary( v ) } );\n\t\telseif\
      \ k == 'PMC' then\n\t\t\ttable.insert( new_list, {handler.label, pmc( v, options.Embargo ) } );\n\t\telseif k == 'PMID' then\n\t\t\ttable.insert( new_list, {handler.label, pmid( v ) } );\n\t\telseif k == 'ISSN' then\n\t\t\ttable.insert( new_list, {handler.label,\
      \ issn( v ) } );\n\t\telseif k == 'ISBN' then\n\t\t\tlocal ISBN = internallinkid( handler );\n\t\t\tif not checkisbn( v ) and not is_set(options.IgnoreISBN) then\n\t\t\t\tISBN = ISBN .. seterror( 'bad_isbn', {}, false, &quot; &quot;, &quot;&quot; );\n\t\
      \t\tend\n\t\t\ttable.insert( new_list, {handler.label, ISBN } );\t\t\t\t\n\t\telse\n\t\t\terror( cfg.messages['unknown_manual_ID'] );\n\t\tend\n\tend\n\t\n\tfunction comp( a, b )\t-- used in following table.sort()\n\t\treturn a[1] &lt; b[1];\n\tend\n\t\
      \n\ttable.sort( new_list, comp );\n\tfor k, v in ipairs( new_list ) do\n\t\tnew_list[k] = v[2];\n\tend\n\t\n\treturn new_list;\nend\n  \n-- Chooses one matching parameter from a list of parameters to consider\n-- Generates an error if more than one match\
      \ is present.\nfunction selectone( args, possible, error_condition, index )\n\tlocal value = nil;\n\tlocal selected = '';\n\tlocal error_list = {};\n\t\n\tif index ~= nil then index = tostring(index); end\n\t\n\t-- Handle special case of &quot;#&quot;\
      \ replaced by empty string\n\tif index == '1' then\n\t\tfor _, v in ipairs( possible ) do\n\t\t\tv = v:gsub( &quot;#&quot;, &quot;&quot; );\n\t\t\tif is_set(args[v]) then\n\t\t\t\tif value ~= nil and selected ~= v then\n\t\t\t\t\ttable.insert( error_list,\
      \ v );\n\t\t\t\telse\n\t\t\t\t\tvalue = args[v];\n\t\t\t\t\tselected = v;\n\t\t\t\tend\n\t\t\tend\n\t\tend\t\t\n\tend\n\t\n\tfor _, v in ipairs( possible ) do\n\t\tif index ~= nil then\n\t\t\tv = v:gsub( &quot;#&quot;, index );\n\t\tend\n\t\tif is_set(args[v])\
      \ then\n\t\t\tif value ~= nil and selected ~=  v then\n\t\t\t\ttable.insert( error_list, v );\n\t\t\telse\n\t\t\t\tvalue = args[v];\n\t\t\t\tselected = v;\n\t\t\tend\n\t\tend\n\tend\n\t\n\tif #error_list &gt; 0 then\n\t\tlocal error_str = &quot;&quot;;\n\
      \t\tfor _, k in ipairs( error_list ) do\n\t\t\tif error_str ~= &quot;&quot; then error_str = error_str .. cfg.messages['parameter-separator'] end\n\t\t\terror_str = error_str .. wrap( 'parameter', k );\n\t\tend\n\t\tif #error_list &gt; 1 then\n\t\t\terror_str\
      \ = error_str .. cfg.messages['parameter-final-separator'];\n\t\telse\n\t\t\terror_str = error_str .. cfg.messages['parameter-pair-separator'];\n\t\tend\n\t\terror_str = error_str .. wrap( 'parameter', selected );\n\t\ttable.insert( z.message_tail, { seterror(\
      \ error_condition, {error_str}, true ) } );\n\tend\n\t\n\treturn value, selected;\nend\n\n-- COinS metadata (see &lt;http://ocoins.info/&gt;) allows automated tools to parse\n-- the citation information.\nfunction COinS(data)\n\tif 'table' ~= type(data)\
      \ or nil == next(data) then\n\t\treturn '';\n\tend\n\t\n\tlocal ctx_ver = &quot;Z39.88-2004&quot;;\n\t\n\t-- treat table strictly as an array with only set values.\n\tlocal OCinSoutput = setmetatable( {}, {\n\t\t__newindex = function(self, key, value)\n\
      \t\t\tif is_set(value) then\n\t\t\t\trawset( self, #self+1, table.concat{ key, '=', mw.uri.encode( removewikilink( value ) ) } );\n\t\t\tend\n\t\tend\n\t});\n\t\n\tif is_set(data.Chapter) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;bookitem&quot;;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Chapter;\n\t\tOCinSoutput[&quot;rft.atitle&quot;] = data.Title;\n\telseif is_set(data.Periodical) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:journal&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;article&quot;;\n\t\tOCinSoutput[&quot;rft.jtitle&quot;] = data.Periodical;\n\t\tOCinSoutput[&quot;rft.atitle&quot;] = data.Title;\n\telse\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;book&quot;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Title;\n\tend\n\t\n\tOCinSoutput[&quot;rft.place&quot;] = data.PublicationPlace;\n\tOCinSoutput[&quot;rft.date&quot;] = data.Date;\n\tOCinSoutput[&quot;rft.series&quot;]\
      \ = data.Series;\n\tOCinSoutput[&quot;rft.volume&quot;] = data.Volume;\n\tOCinSoutput[&quot;rft.issue&quot;] = data.Issue;\n\tOCinSoutput[&quot;rft.pages&quot;] = data.Pages;\n\tOCinSoutput[&quot;rft.edition&quot;] = data.Edition;\n\tOCinSoutput[&quot;rft.pub&quot;]\
      \ = data.PublisherName;\n\t\n\tfor k, v in pairs( data.ID_list ) do\n\t\tlocal id, value = cfg.id_handlers[k].COinS;\n\t\tif k == 'ISBN' then value = cleanisbn( v ); else value = v; end\n\t\tif string.sub( id or &quot;&quot;, 1, 4 ) == 'info' then\n\t\t\
      \tOCinSoutput[&quot;rft_id&quot;] = table.concat{ id, &quot;/&quot;, v };\n\t\telse\n\t\t\tOCinSoutput[ id ] = value;\n\t\tend\n\tend\n\t\n\tlocal last, first;\n\tfor k, v in ipairs( data.Authors ) do\n\t\tlast, first = v.last, v.first;\n\t\tif k == 1\
      \ then\n\t\t\tif is_set(last) then\n\t\t\t\tOCinSoutput[&quot;rft.aulast&quot;] = last;\n\t\t\tend\n\t\t\tif is_set(first) then \n\t\t\t\tOCinSoutput[&quot;rft.aufirst&quot;] = first;\n\t\t\tend\n\t\tend\n\t\tif is_set(last) and is_set(first) then\n\t\t\
      \tOCinSoutput[&quot;rft.au&quot;] = table.concat{ last, &quot;, &quot;, first };\n\t\telseif is_set(last) then\n\t\t\tOCinSoutput[&quot;rft.au&quot;] = last;\n\t\tend\n\tend\n\t\n\tOCinSoutput.rft_id = data.URL;\n\tOCinSoutput.rfr_id = table.concat{ &quot;info:sid/&quot;,\
      \ mw.site.server:match( &quot;[^/]*$&quot; ), &quot;:&quot;, data.RawPage };\n\tOCinSoutput = setmetatable( OCinSoutput, nil );\n\t\n\t-- sort with version string always first, and combine.\n\ttable.sort( OCinSoutput );\n\ttable.insert( OCinSoutput, 1,\
      \ &quot;ctx_ver=&quot; .. ctx_ver );  -- such as &quot;Z39.88-2004&quot;\n\treturn table.concat(OCinSoutput, &quot;&amp;&quot;);\nend\n\n\n--[[--------------------------&lt; G E T _ I S O 6 3 9 _ C O D E &gt;------------------------------------------------\n\
      \nValidates language names provided in |language= parameter if not an ISO639-1 code.  Handles the special case that is Norwegian where\nISO639-1 code 'no' is mapped to language name 'Norwegian Bokmål' by Extention:CLDR.\n\nReturns the language name and\
      \ associated ISO639-1 code.  Because case of the source may be incorrect or different from the case that Wikimedia\nuses, the name comparisons are done in lower case and when a match is found, the Wikimedia version (assumed to be correct) is returned along\n\
      with the code.  When there is no match, we return the original language name string.\n\nmw.language.fetchLanguageNames() will return a list of languages that aren't part of ISO639-1. Names that aren't ISO639-1 but that are included\nin the list will be\
      \ found if that name is provided in the |language= parameter.  For example, if |language=Samaritan Aramaic, that name will be\nfound with the associated code 'sam', not an ISO639-1 code.  When names are found and the associated code is not two characters,\
      \ this function\nreturns only the Wikimedia language name.\n\nAdapted from code taken from Module:Check ISO 639-1.\n]]\n\nfunction get_iso639_code (lang)\n\tif 'Norwegian' == lang then\n\t\treturn lang, 'no';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- special case\
      \ related to Wikimedia remap of code 'no' at Extension:CLDR\n\tend\n\t\n\tlocal languages = mw.language.fetchLanguageNames('en', 'all')\t\t\t\t-- get a list of language names known to Wikimedia\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- ('all' is required\
      \ for North Ndebele, South Ndebele, and Ojibwa)\n\tlocal langlc = mw.ustring.lower(lang);\t\t\t\t\t\t\t\t\t\t-- lower case version for comparisons\n\t\n\tfor code, name in pairs(languages) do\t\t\t\t\t\t\t\t\t\t-- scan the list to see if we can find our\
      \ language\n\t\tif langlc == mw.ustring.lower(name) then\n\t\t\tif 2 ~= code:len() then\t\t\t\t\t\t\t\t\t\t\t\t-- ISO639-1 codes only\n\t\t\t\treturn name;\t\t\t\t\t\t\t\t\t\t\t\t\t-- so return the name but not the code\n\t\t\tend\n\t\t\treturn name, code;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t-- found it, return name to ensure proper capitalization and the ISO639-1 code\n\t\tend\n\tend\n\treturn lang;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not valid language; return language in original case and nil for ISO639-1 code\nend\n\
      \n--[[--------------------------&lt; L A N G U A G E _ P A R A M E T E R &gt;------------------------------------------\n\nGet language name from ISO639-1 code value provided.  If a code is valid use the returned name; if not, then use the value that was\
      \ provided with the language parameter.\n\nThere is an exception.  There are three ISO639-1 codes for Norewegian language variants.  There are two official variants: Norwegian Bokmål (code 'nb') and\nNorwegian Nynorsk (code 'nn').  The third, code 'no',\
      \  is defined by ISO639-1 as 'Norwegian' though in Norway this is pretty much meaningless.  However, it appears\nthat on enwiki, editors are for the most part unaware of the nb and nn variants (compare page counts for these variants at Category:Articles\
      \ with non-English-language external links.\n\nBecause Norwegian Bokmål is the most common language variant, Media wiki has been modified to return Norwegian Bokmål for ISO639-1 code 'no'. Here we undo that and\nreturn 'Norwegian' when editors use |language=no.\
      \  We presume that editors don't know about the variants or can't descriminate between them.\n\nSee Help talk:Citation Style_1#An ISO 639-1 language name test\n\nWhen |language= contains a valid ISO639-1 code, the page is assigned to the category for that\
      \ code: Category:Norwegian-language sources (no) if\nthe page is a mainspace page and the ISO639-1 code is not 'en'.  Similarly, if the  parameter is |language=Norwegian, it will be categorized in the same way.\n\nTODO: Error message when language or language\
      \ code is not ISO639-1?\n]]\n\nfunction language_parameter (lang, namespace)\n\tlocal code;\t\t\t-- the ISO639-1 two character code\n\tlocal name;\t\t\t-- the language name\n\tlocal test='';\n\t\t\n\tif 0 == namespace and (('en' == lang:lower()) or ('english'\
      \ == lang:lower())) then\n\t\ttable.insert (z.maintenance_cats, 'CS1 maint: English language specified');\t\t-- add maintenance category if |language=English or |language=en in article space\n\tend\n\n\tif 2 == lang:len() then\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t-- ISO639-1 language code are 2 characters (fetchLanguageName also supports 3 character codes)\n\t\tname = mw.language.fetchLanguageName( lang:lower(), &quot;en&quot; );\t\t\t\t-- get ISO 639-1 language name if Language is a proper code\n\tend\n\n\t\
      if is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if Language specified a valid ISO639-1 code\n\t\tcode = lang:lower();\t\t\t\t\t\t\t\t\t\t\t\t\t-- save it\n\telse\n\t\tname, code = get_iso639_code (lang);\t\t\t\t\t\t\t\t\t-- attempt to get code from\
      \ name (assign name here so that we are sure of proper capitalization)\n\tend\n\n\tif is_set (code) then\n\t\tif 'no' == code then name = 'Norwegian' end;\t\t\t\t\t\t\t-- override wikimedia when code is 'no'\n\t\t\tif 0 == namespace and 'en' ~= code then\t\
      \t\t\t\t-- is this page main / article space and English not the language?\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 ' .. name .. '-language sources (' .. code .. ')');\t-- in main space and not English: categorize\n\t\t\tend\n\t\tend\n\treturn (&quot;\
      \ &quot; .. wrap( 'language', name));\t\t\t\t\t\t\t\t\t-- wrap with '(in ...)'\nend\n\n\n\n\n--[[--------------------------&lt; C I T A T I O N 0 &gt;------------------------------------------------------------\nThis is the main function doing the majority\
      \ of the citation\nformatting.\n]]\nfunction citation0( config, args)\n\t--[[ \n\tLoad Input Parameters\n\tThe argument_wrapper facilitates the mapping of multiple\n\taliases to single internal variable.\n\t]]\n\tlocal A = argument_wrapper( args );\n\n\
      \tlocal i \n\tlocal PPrefix = A['PPrefix']\n\tlocal PPPrefix = A['PPPrefix']\n\tif is_set( A['NoPP'] ) then PPPrefix = &quot;&quot; PPrefix = &quot;&quot; end\n\t\n\t-- Pick out the relevant fields from the arguments.  Different citation templates\n\t\
      -- define different field names for the same underlying things.\t\n\tlocal Authors = A['Authors'];\n\tlocal a = extractnames( args, 'AuthorList' );\n\n\tlocal Coauthors = A['Coauthors'];\n\tlocal Others = A['Others'];\n\tlocal Editors = A['Editors'];\n\
      \tlocal e = extractnames( args, 'EditorList' );\n\n\tlocal Year = A['Year'];\n\tlocal PublicationDate = A['PublicationDate'];\n\tlocal OrigYear = A['OrigYear'];\n\tlocal Date = A['Date'];\n\tlocal LayDate = A['LayDate'];\n\t-------------------------------------------------\
      \ Get title data\n\tlocal Title = A['Title'];\n\tlocal ScriptTitle = A['ScriptTitle'];\n\tlocal BookTitle = A['BookTitle'];\n\tlocal Conference = A['Conference'];\n\tlocal TransTitle = A['TransTitle'];\n\tlocal TitleNote = A['TitleNote'];\n\tlocal TitleLink\
      \ = A['TitleLink'];\n\tlocal Chapter = A['Chapter'];\n\tlocal ChapterLink = A['ChapterLink'];\n\tlocal TransChapter = A['TransChapter'];\n\tlocal TitleType = A['TitleType'];\n\tlocal Degree = A['Degree'];\n\tlocal Docket = A['Docket'];\n\tlocal ArchiveURL\
      \ = A['ArchiveURL'];\n\tlocal URL = A['URL']\n\tlocal URLorigin = A:ORIGIN('URL');\t\t\t\t\t\t\t\t\t\t\t-- get name of parameter that holds URL\n\tlocal ChapterURL = A['ChapterURL'];\n\tlocal ChapterURLorigin = A:ORIGIN('ChapterURL');\t\t\t\t\t\t\t-- get\
      \ name of parameter that holds ChapterURL\n\tlocal ConferenceURL = A['ConferenceURL'];\n\tlocal ConferenceURLorigin = A:ORIGIN('ConferenceURL');\t\t\t\t\t\t-- get name of parameter that holds ConferenceURL\n\tlocal Periodical = A['Periodical'];\n\n\tlocal\
      \ Series = A['Series'];\n\tlocal Volume = A['Volume'];\n\tlocal Issue = A['Issue'];\n\tlocal Position = '';\n\tlocal Page = A['Page'];\n\tlocal Pages = hyphentodash( A['Pages'] );\t\n\tlocal At = A['At'];\n\n\tlocal Edition = A['Edition'];\n\tlocal PublicationPlace\
      \ = A['PublicationPlace']\n\tlocal Place = A['Place'];\n\t\n\tlocal PublisherName = A['PublisherName'];\n\tlocal RegistrationRequired = A['RegistrationRequired'];\n\tlocal SubscriptionRequired = A['SubscriptionRequired'];\n\tlocal Via = A['Via'];\n\tlocal\
      \ AccessDate = A['AccessDate'];\n\tlocal ArchiveDate = A['ArchiveDate'];\n\tlocal Agency = A['Agency'];\n\tlocal DeadURL = A['DeadURL']\n\tlocal Language = A['Language'];\n\tlocal Format = A['Format'];\n\tlocal Ref = A['Ref'];\n\tlocal DoiBroken = A['DoiBroken'];\n\
      \tlocal ID = A['ID'];\n\tlocal ASINTLD = A['ASINTLD'];\n\tlocal IgnoreISBN = A['IgnoreISBN'];\n\tlocal Embargo = A['Embargo'];\n\n\tlocal ID_list = extractids( args );\n--[[ Hide unfinished cite newsgroup code so that long delayed update can take place\n\
      \t-- special case for cite newsgroup which uses |id= for a usenet article or post id\n\t-- |id= is not included in COinS so here we convert it to an ID that will be included in COinS\n\tif ('newsgroup' == config.CitationClass) and (is_set (ID)) then\n\t\
      \tID_list['USENETID']=ID;\t\t\t-- add this new 'id' to the list of IDs\n\t\tID = '';\t\t\t\t\t\t-- and unset\n\tend\n]]\t\n\tlocal Quote = A['Quote'];\n\tlocal PostScript = A['PostScript'];\n\n\tlocal LayURL = A['LayURL'];\n\tlocal LaySource = A['LaySource'];\n\
      \tlocal Transcript = A['Transcript'];\n\tlocal TranscriptURL = A['TranscriptURL'] \n\tlocal TranscriptURLorigin = A:ORIGIN('TranscriptURL');\t\t\t\t\t\t-- get name of parameter that holds TranscriptURL\n\tlocal sepc = A['Separator'];\n\n\tlocal LastAuthorAmp\
      \ = A['LastAuthorAmp'];\n\tlocal no_tracking_cats = A['NoTracking'];\n\n--these are used by cite interview\n\tlocal Callsign = A['Callsign'];\n\tlocal City = A['City'];\n\tlocal Cointerviewers = A['Cointerviewers'];\t\t\t-- deprecated\n\tlocal Interviewer\
      \ = A['Interviewer'];\t\t\t\t-- deprecated\n\tlocal Program = A['Program'];\n\n--local variables that are not cs1 parameters\n\tlocal page_type;\t\t\t\t\t\t\t\t\t-- is this needed?  Doesn't appear to be used anywhere;\n\tlocal use_lowercase = ( sepc ~=\
      \ '.' );\n\tlocal this_page = mw.title.getCurrentTitle();\t\t--Also used for COinS and for language\n\tlocal anchor_year;\t\t\t\t\t\t\t\t\t-- used in the CITEREF identifier\n\tlocal COinS_date;\t\t\t\t\t\t\t\t\t-- used in the COinS metadata\n\n-- Set postscript\
      \ default.\n\tif not is_set (PostScript) then\t\t\t\t\t\t-- if |postscript= has not been set (Postscript is nil which is the default for {{citation}}) and\n\t\tif (config.CitationClass ~= &quot;citation&quot;) then\t-- this template is not a citation template\n\
      \t\t\tPostScript = '.';\t\t\t\t\t\t\t-- must be a cite xxx template so set postscript to default (period)\n\t\tend\n\telse\n\t\tif PostScript:lower() == 'none' then\t\t\t-- if |postscript=none then\n\t\t\tPostScript = '';\t\t\t\t\t\t\t-- no postscript\n\
      \t\tend\n\tend\n\n--check this page to see if it is in one of the namespaces that cs1 is not supposed to add to the error categories.\n\tif not is_set(no_tracking_cats) then\t\t\t\t-- ignore if we are already not going to categorize this page\n\t\tif inArray\
      \ (this_page.nsText, cfg.uncategorized_namespaces) then\n\t\t\tno_tracking_cats = &quot;true&quot;;\t\t\t\t\t-- set no_tracking_cats\n\t\tend\n\tend\n\n-- check for extra |page=, |pages= or |at= parameters. \n\tif is_set(Page) then\n\t\tif is_set(Pages)\
      \ or is_set(At) then\n\t\t\tPage = Page .. &quot; &quot; .. seterror('extra_pages');\t-- add error message\n\t\t\tPages = '';\t\t\t\t\t\t\t\t\t\t-- unset the others\n\t\t\tAt = '';\n\t\tend\n\telseif is_set(Pages) then\n\t\tif is_set(At) then\n\t\t\tPages\
      \ = Pages .. &quot; &quot; .. seterror('extra_pages');\t-- add error messages\n\t\t\tAt = '';\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\tend\n\tend\t\n\n-- both |publication-place= and |place= (|location=) allowed if different\n\tif not is_set(PublicationPlace)\
      \ and is_set(Place) then\n\t\tPublicationPlace = Place;\t\t\t\t\t\t\t-- promote |place= (|location=) to |publication-place\n\tend\n\t\n\tif PublicationPlace == Place then Place = ''; end\t\t-- don't need both if they are the same\n\t\n--[[\nParameter remapping\
      \ for cite encyclopedia:\nWhen the citation has these parameters:\n\t|encyclopedia and |title then map |title to |article and |encyclopedia to |title\n\t|encyclopedia and |article then map |encyclopedia to |title\n\t|encyclopedia then map |encyclopedia\
      \ to |title\n\n\t|trans_title maps to |trans_chapter when |title is re-mapped\n\nAll other combinations of |encyclopedia, |title, and |article are not modified\n]]\n\tif ( config.CitationClass == &quot;encyclopaedia&quot; ) then\n\t\tif is_set(Periodical)\
      \ then\t\t\t\t\t-- Periodical is set when |encyclopedia is set\n\t\t\tif is_set(Title) then\n\t\t\t\tif not is_set(Chapter) then\n\t\t\t\t\tChapter = Title;\t\t\t\t-- |encyclopedia and |title are set so map |title to |article and |encyclopedia to |title\n\
      \t\t\t\t\tTransChapter = TransTitle;\n\t\t\t\t\tTitle = Periodical;\n\t\t\t\t\tPeriodical = '';\t\t\t\t-- redundant so unset\n\t\t\t\t\tTransTitle = '';\t\t\t\t-- redundant so unset\n\t\t\t\tend\n\t\t\telse\t\t\t\t\t\t\t\t\t-- |title not set\n\t\t\t\t\
      Title = Periodical;\t\t\t\t\t-- |encyclopedia set and |article set or not set so map |encyclopedia to |title\n\t\t\t\tPeriodical = '';\t\t\t\t\t-- redundant so unset\n\t\t\tend\n\t\tend\n\tend\n\n--special cases for citation.\n\tif (config.CitationClass\
      \ == &quot;citation&quot;) then\t\t-- for citation templates\n\t\tif not is_set (Ref) then\t\t\t\t\t\t-- if |ref= is not set\n\t\t\tRef = &quot;harv&quot;;\t\t\t\t\t\t\t\t-- set default |ref=harv\n\t\tend\n\t\tif not is_set (sepc) then\t\t\t\t\t\t-- if\
      \ |separator= is not set\n\t\t\tsepc = ',';\t\t\t\t\t\t\t\t\t-- set citation separator to its default (comma)\n\t\tend\n\telse\t\t\t\t\t\t\t\t\t\t\t\t-- not a citation template\n\t\tif not is_set (sepc) then\t\t\t\t\t\t-- if |separator= has not been set\n\
      \t\t\tsepc = '.';\t\t\t\t\t\t\t\t\t-- set cite xxx separator to its default (period)\n\t\tend\n\tend\n\n-- check for special case where |separator=none\n\tif 'none' == sepc:lower() then\t\t\t\t\t\t-- if |separator=none\n\t\tsepc = '';\t\t\t\t\t\t\t\t\t\
      \t-- then set it to an empty string\n\tend\n\n-- Special case for cite techreport.\n\tif (config.CitationClass == &quot;techreport&quot;) then\t-- special case for cite techreport\n\t\tif is_set(Issue) then\t\t\t\t\t\t-- cite techreport uses 'number',\
      \ which other citations aliase to 'issue'\n\t\t\tif not is_set(ID) then\t\t\t\t\t-- can we use ID for the &quot;number&quot;?\n\t\t\t\tID = Issue;\t\t\t\t\t\t\t-- yes, use it\n\t\t\t\tIssue = &quot;&quot;;\t\t\t\t\t\t\t-- unset Issue so that &quot;number&quot;\
      \ isn't duplicated in the rendered citation or COinS metadata\n\t\t\telse\t\t\t\t\t\t\t\t\t-- can't use ID so emit error message\n\t\t\t\tID = ID .. &quot; &quot; .. seterror('redundant_parameters', '&lt;code&gt;&amp;#124;id=&lt;/code&gt; and &lt;code&gt;&amp;#124;number=&lt;/code&gt;');\n\
      \t\t\tend\n\t\tend\t\n\tend\n\n-- special case for cite interview\n\tif (config.CitationClass == &quot;interview&quot;) then\n\t\tif is_set(Program) then\n\t\t\tID = ' ' .. Program;\n\t\tend\n\t\tif is_set(Callsign) then\n\t\t\tif is_set(ID) then\n\t\t\
      \t\tID = ID .. sepc .. ' ' .. Callsign;\n\t\t\telse\n\t\t\t\tID = ' ' .. Callsign;\n\t\t\tend\n\t\tend\n\t\tif is_set(City) then\n\t\t\tif is_set(ID) then\n\t\t\t\tID = ID .. sepc .. ' ' .. City;\n\t\t\telse\n\t\t\t\tID = ' ' .. City;\n\t\t\tend\n\t\t\
      end\n\n\t\tif is_set(Interviewer) then\n\t\t\tif is_set(TitleType) then\n\t\t\t\tOthers = ' ' .. TitleType .. ' with ' .. Interviewer;\n\t\t\t\tTitleType = '';\n\t\t\telse\n\t\t\t\tOthers = ' ' .. 'Interview with ' .. Interviewer;\n\t\t\tend\n\t\t\tif\
      \ is_set(Cointerviewers) then\n\t\t\t\tOthers = Others .. sepc .. ' ' .. Cointerviewers;\n\t\t\tend\n\t\telse\n\t\t\tOthers = '(Interview)';\n\t\tend\n\tend\n\n--Account for the oddity that is {{cite journal}} with |pmc= set and |url= not set\n\tif config.CitationClass\
      \ == &quot;journal&quot; and not is_set(URL) and is_set(ID_list['PMC']) then\n\t\tif not is_embargoed(Embargo) then\n\t\t\tURL=cfg.id_handlers['PMC'].prefix .. ID_list['PMC'];\t-- set url to be the same as the PMC external link if not embargoed\n\t\t\t\
      URLorigin = cfg.id_handlers['PMC'].parameters[1];\t\t-- set URLorigin to parameter name for use in error message if citation is missing a |title=\n\t\tend\n\tend\n\n-- Account for the oddity that is {{cite conference}}, before generation of COinS data.\n\
      --TODO: if this is only for {{cite conference}}, shouldn't we be checking? (if config.CitationClass=='conference' then ...)\n\tif is_set(BookTitle) then\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = BookTitle;\n\
      \t\tTitleLink = '';\n\t\tTransTitle = '';\n\tend\n\n-- Account for the oddity that is {{cite episode}}, before generation of COinS data.\n--[[\t-- {{cite episode}} is not currently supported by this module\n\tif config.CitationClass == &quot;episode&quot;\
      \ then\n\t\tlocal AirDate = A['AirDate'];\n\t\tlocal SeriesLink = A['SeriesLink'];\n\t\tlocal Season = A['Season'];\n\t\tlocal SeriesNumber = A['SeriesNumber'];\n\t\tlocal Network = A['Network'];\n\t\tlocal Station = A['Station'];\n\t\tlocal s, n = {},\
      \ {};\n\t\tlocal Sep = (first_set(A[&quot;SeriesSeparator&quot;], A[&quot;Separator&quot;]) or &quot;&quot;) .. &quot; &quot;;\n\t\t\n\t\tif is_set(Issue) then table.insert(s, cfg.messages[&quot;episode&quot;] .. &quot; &quot; .. Issue); Issue = ''; end\n\
      \t\tif is_set(Season) then table.insert(s, cfg.messages[&quot;season&quot;] .. &quot; &quot; .. Season); end\n\t\tif is_set(SeriesNumber) then table.insert(s, cfg.messages[&quot;series&quot;] .. &quot; &quot; .. SeriesNumber); end\n\t\tif is_set(Network)\
      \ then table.insert(n, Network); end\n\t\tif is_set(Station) then table.insert(n, Station); end\n\t\t\n\t\tDate = Date or AirDate;\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = Series;\n\t\tTitleLink =\
      \ SeriesLink;\n\t\tTransTitle = '';\n\t\t\n\t\tSeries = table.concat(s, Sep);\n\t\tID = table.concat(n, Sep);\n\tend\n-- end of {{cite episode}} stuff]]\n\n-- legacy: promote concatenation of |day=, |month=, and |year= to Date if Date not set; or, promote\
      \ PublicationDate to Date if neither Date nor Year are set.\n\tif not is_set(Date) then\n\t\tDate = Year;\t\t\t\t\t\t-- promote Year to Date\n\t\tYear = nil;\t\t\t\t\t\t\t-- make nil so Year as empty string isn't used for CITEREF\n\t\tif is_set(Date) then\n\
      \t\t\tlocal Month = A['Month'];\n\t\t\tif is_set(Month) then\n\t\t\t\tDate = Month .. &quot; &quot; .. Date;\n\t\t\t\tlocal Day = A['Day']\n\t\t\t\tif is_set(Day) then Date = Day .. &quot; &quot; .. Date end\n\t\t\tend\n\t\telseif is_set(PublicationDate)\
      \ then\t-- use PublicationDate when |date= and |year= are not set\n\t\t\tDate = PublicationDate;\t\t\t-- promote PublicationDate to Date\n\t\t\tPublicationDate = '';\t\t\t-- unset, no longer needed\n\t\tend\n\tend\n\n\tif PublicationDate == Date then PublicationDate\
      \ = ''; end\t-- if PublicationDate is same as Date, don't display in rendered citation\n\n\n--[[\nGo test all of the date-holding parameters for valid MOS:DATE format and make sure that dates are real dates. This must be done before we do COinS because\
      \ here is where\nwe get the date used in the metadata.\n\nDate validation supporting code is in Module:Citation/CS1/Date_validation\n]]\n\tanchor_year, COinS_date, error_message = dates({['accessdate']=AccessDate, ['airdate']=AirDate, ['archivedate']=ArchiveDate,\
      \ ['date']=Date, ['doi_brokendate']=DoiBroken,\n\t\t['embargo']=Embargo, ['laydate']=LayDate, ['publicationdate']=PublicationDate, ['year']=Year});\n\tif is_set(error_message) then\n\t\ttable.insert( z.message_tail, { seterror( 'bad_date', {error_message},\
      \ true ) } );\t-- add this error message\n\tend\n\n-- At this point fields may be nil if they weren't specified in the template use.  We can use that fact.\n\n\t-- COinS metadata (see &lt;http://ocoins.info/&gt;) for\n\t-- automated parsing of citation\
      \ information.\n\t-- this is the function call to COinS()\n\tlocal OCinSoutput = COinS{\n\t\t['Periodical'] = Periodical,\n\t\t['Chapter'] = strip_apostrophe_markup (Chapter),\t\t\t\t\t\t-- Chapter stripped of bold / italic wikimarkup\n\t\t['Title'] =\
      \ make_coins_title (Title, ScriptTitle),\t\t\t\t\t\t-- Title and ScriptTitle stripped of bold / italic wikimarkup\n\t\t['PublicationPlace'] = PublicationPlace,\n\t\t['Date'] = first_set(COinS_date, Date),\t\t-- COinS_date has correctly formatted date if\
      \ Date is valid; any reason to keep Date here?  Should we be including invalid dates in metadata?\n\t\t['Series'] = Series,\n\t\t['Volume'] = Volume,\n\t\t['Issue'] = Issue,\n\t\t['Pages'] = get_coins_pages (first_set(Page, Pages, At)),\t\t\t\t-- pages\
      \ stripped of external links\n\t\t['Edition'] = Edition,\n\t\t['PublisherName'] = PublisherName,\n\t\t['URL'] = first_set( URL, ChapterURL ),\n\t\t['Authors'] = a,\n\t\t['ID_list'] = ID_list,\n\t\t['RawPage'] = this_page.prefixedText,\n\t};\n--[[Why is\
      \ this here?  Why are we mapping Title to Chapter when Periodical is set?\n\tif is_set(Periodical) and not is_set(Chapter) and is_set(Title) then\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = '';\n\t\t\
      TitleLink = '';\n\t\tTransTitle = '';\n\tend\n]]\n--[[ Hide unfinished cite newsgroup code so that long delayed update can take place\n-- special case for cite newsgroup.  Do this after COinS because we are modifying Publishername and ID\n\tif 'newsgroup'\
      \ == config.CitationClass then\n\t\tif is_set (PublisherName) then\n\t\t\tPublisherName = '[Newsgroup]:&amp;nbsp;' ..  externallink( 'news:' .. PublisherName, PublisherName );\n\t\tend\n\tend\n]]\n\n\n\t-- Now perform various field substitutions.\n\t--\
      \ We also add leading spaces and surrounding markup and punctuation to the\n\t-- various parts of the citation, but only when they are non-nil.\n\tif not is_set(Authors) then\n\t\tlocal Maximum = tonumber( A['DisplayAuthors'] );\n\t\t\n\t\t-- Preserve\
      \ old-style implicit et al.\n\t\tif not is_set(Maximum) and #a == 9 then \n\t\t\tMaximum = 8;\n\t\t\ttable.insert( z.message_tail, { seterror('implict_etal_author', {}, true ) } );\n\t\telseif not is_set(Maximum) then\n\t\t\tMaximum = #a + 1;\n\t\tend\n\
      \t\t\t\n\t\tlocal control = { \n\t\t\tsep = A[&quot;AuthorSeparator&quot;] .. &quot; &quot;,\n\t\t\tnamesep = (first_set(A[&quot;AuthorNameSeparator&quot;], A[&quot;NameSeparator&quot;]) or &quot;&quot;) .. &quot; &quot;,\n\t\t\tformat = A[&quot;AuthorFormat&quot;],\n\
      \t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via authorlinkn\n\t\t};\n\t\t\n\t\t-- If the coauthor field is also used, prevent ampersand\
      \ and et al. formatting.\n\t\tif is_set(Coauthors) then\n\t\t\tcontrol.lastauthoramp = nil;\n\t\t\tcontrol.maximum = #a + 1;\n\t\tend\n\t\t\n\t\tAuthors = listpeople(control, a) \n\tend\n\n\tif not is_set(Authors) and is_set(Coauthors) then\t-- coauthors\
      \ aren't displayed if one of authors=, authorn=, or lastn= isn't specified\n\t\ttable.insert( z.message_tail, { seterror('coauthors_missing_author', {}, true) } );\t-- emit error message\n\tend\n\n\tlocal EditorCount\n\tif not is_set(Editors) then\n\t\t\
      local Maximum = tonumber( A['DisplayEditors'] );\n\t\t-- Preserve old-style implicit et al.\n\t\tif not is_set(Maximum) and #e == 4 then \n\t\t\tMaximum = 3;\n\t\t\ttable.insert( z.message_tail, { seterror('implict_etal_editor', {}, true) } );\n\t\telseif\
      \ not is_set(Maximum) then\n\t\t\tMaximum = #e + 1;\n\t\tend\n\n\t\tlocal control = { \n\t\t\tsep = A[&quot;EditorSeparator&quot;] .. &quot; &quot;,\n\t\t\tnamesep = (first_set(A[&quot;EditorNameSeparator&quot;], A[&quot;NameSeparator&quot;]) or &quot;&quot;)\
      \ .. &quot; &quot;,\n\t\t\tformat = A['EditorFormat'],\n\t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via authorlinkn\n\t\t};\n\n\t\tEditors,\
      \ EditorCount = listpeople(control, e);\n\telse\n\t\tEditorCount = 1;\n\tend\n\n\tlocal Cartography = &quot;&quot;;\n\tlocal Scale = &quot;&quot;;\n\tif config.CitationClass == &quot;map&quot; then\n\t\tif not is_set( Authors ) and is_set( PublisherName\
      \ ) then\n\t\t\tAuthors = PublisherName;\n\t\t\tPublisherName = &quot;&quot;;\n\t\tend\n\t\tCartography = A['Cartography'];\n\t\tif is_set( Cartography ) then\n\t\t\tCartography = sepc .. &quot; &quot; .. wrap( 'cartography', Cartography, use_lowercase\
      \ );\n\t\tend\t\t\n\t\tScale = A['Scale'];\n\t\tif is_set( Scale ) then\n\t\t\tScale = sepc .. &quot; &quot; .. Scale;\n\t\tend\t\t\n\tend\n\t\n\tif  not is_set(URL) and\n\t\tnot is_set(ChapterURL) and\n\t\tnot is_set(ArchiveURL) and\n\t\tnot is_set(ConferenceURL)\
      \ and\n\t\tnot is_set(TranscriptURL) then\n\t\t\n\t\t-- Test if cite web or cite podcast |url= is missing or empty \n\t\tif inArray(config.CitationClass, {&quot;web&quot;,&quot;podcast&quot;}) then\t\n\t\t\ttable.insert( z.message_tail, { seterror( 'cite_web_url',\
      \ {}, true ) } );\n\t\tend\n\t\t\n\t\t-- Test if accessdate is given without giving a URL\n\t\tif is_set(AccessDate) then\n\t\t\ttable.insert( z.message_tail, { seterror( 'accessdate_missing_url', {}, true ) } );\n\t\t\tAccessDate = '';\n\t\tend\n\t\t\n\
      \t\t-- Test if format is given without giving a URL\n\t\tif is_set(Format) then\n\t\t\tFormat = Format .. seterror( 'format_missing_url' );\n\t\tend\n\tend\n\t\n\t-- Test if citation has no title\n\tif\tnot is_set(Title) and\n\t\tnot is_set(Periodical)\
      \ and\n\t\tnot is_set(Conference) and\n\t\tnot is_set(TransTitle) and\n\t\tnot is_set(ScriptTitle) then\n\t\ttable.insert( z.message_tail, { seterror( 'citation_missing_title', {}, true ) } );\n\tend\n\t\n\tFormat = is_set(Format) and &quot; (&quot; ..\
      \ Format .. &quot;)&quot; or &quot;&quot;;\n\t\n\tlocal OriginalURL = URL\n\tDeadURL = DeadURL:lower();\n\tif is_set( ArchiveURL ) then\n\t\tif ( DeadURL ~= &quot;no&quot; ) then\n\t\t\tURL = ArchiveURL\n\t\t\tURLorigin = A:ORIGIN('ArchiveURL')\n\t\tend\n\
      \tend\n\t\n\t-- Format chapter / article title\n\tif is_set(Chapter) and is_set(ChapterLink) then \n\t\tChapter = &quot;[[&quot; .. ChapterLink .. &quot;|&quot; .. Chapter .. &quot;]]&quot;;\n\tend\n\n\tChapter = kern_quotes (Chapter);\t\t\t\t-- if necessary,\
      \ separate chapter title's leading and trailing quote marks from Module provided quote marks\n\tChapter = wrap( 'quoted-title', Chapter );\n\tTransChapter = wrap( 'trans-quoted-title', TransChapter );\n\n\tlocal TransError = &quot;&quot;\n\tif is_set(TransChapter)\
      \ then\n\t\tif not is_set(Chapter) then\n\t\t\tTransError = &quot; &quot; .. seterror( 'trans_missing_chapter' );\t\t-- add error message\n\t\telse\n\t\t\tTransChapter = &quot; &quot; .. TransChapter;\n\t\tend\n\tend\n\t\n\tChapter = Chapter .. TransChapter;\n\
      \t\n\tif is_set(Chapter) then\n\t\tif not is_set(ChapterLink) then\n\t\t\tif is_set(ChapterURL) then\n\t\t\t\tChapter = externallink( ChapterURL, Chapter ) .. TransError;\n\t\t\t\tif not is_set(URL) then\n\t\t\t\t\tChapter = Chapter .. Format;\n\t\t\t\t\
      \tFormat = &quot;&quot;;\n\t\t\t\tend\n\t\t\telseif is_set(URL) then \n\t\t\t\tChapter = externallink( URL, Chapter ) .. TransError .. Format;\n\t\t\t\tURL = &quot;&quot;;\n\t\t\t\tFormat = &quot;&quot;;\n\t\t\telse\n\t\t\t\tChapter = Chapter .. TransError;\n\
      \t\t\tend\t\t\t\n\t\telseif is_set(ChapterURL) then\n\t\t\tChapter = Chapter .. &quot; &quot; .. externallink( ChapterURL, nil, ChapterURLorigin ) .. TransError;\t-- ChapterURLorigin holds the name of parameter\n\t\telse\n\t\t\tChapter = Chapter .. TransError;\n\
      \t\tend\n\t\tChapter = Chapter .. sepc .. &quot; &quot; -- with end-space\n\telseif is_set(ChapterURL) then\n\t\tChapter = &quot; &quot; .. externallink( ChapterURL, nil, ChapterURLorigin ) .. sepc .. &quot; &quot;;\n\tend\t\t\n\t\n\t-- Format main title.\n\
      \tif is_set(TitleLink) and is_set(Title) then\n\t\tTitle = &quot;[[&quot; .. TitleLink .. &quot;|&quot; .. Title .. &quot;]]&quot;\n\tend\n\n\tif inArray(config.CitationClass, {&quot;web&quot;,&quot;news&quot;,&quot;journal&quot;,&quot;pressrelease&quot;,&quot;conference&quot;,&quot;podcast&quot;})\
      \ then\n\t\tTitle = kern_quotes (Title);\t\t\t\t\t\t\t\t\t\t\t-- if necessary, separate title's leading and trailing quote marks from Module provided quote marks\n\t\tTitle = wrap( 'quoted-title', Title );\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\
      \t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title is wrapped\n\t\tTransTitle = wrap( 'trans-quoted-title', TransTitle );\n--\t\tChapter = '';\t\t\t\t\t\t\t\t-- chapter not allowed - disabled because doing this\
      \ here doesn't display error msg and promoted url is lost\n\telse\n\t\tTitle = wrap( 'italic-title', Title );\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title\
      \ is wrapped\n\t\tTransTitle = wrap( 'trans-italic-title', TransTitle );\n\tend\n\n\tTransError = &quot;&quot;;\n\tif is_set(TransTitle) then\n\t\tif is_set(Title) then\n\t\t\tTransTitle = &quot; &quot; .. TransTitle;\n\t\telse\n\t\t\tTransError = &quot;\
      \ &quot; .. seterror( 'trans_missing_title' );\n\t\tend\n\tend\n\t\n\tTitle = Title .. TransTitle;\n\t\n\tif is_set(Title) then\n\t\tif not is_set(TitleLink) and is_set(URL) then \n\t\t\tTitle = externallink( URL, Title ) .. TransError .. Format\t   \n\
      \t\t\tURL = &quot;&quot;;\n\t\t\tFormat = &quot;&quot;;\n\t\telse\n\t\t\tTitle = Title .. TransError;\n\t\tend\n\tend\n\n\tif is_set(Place) then\n\t\tPlace = &quot; &quot; .. wrap( 'written', Place, use_lowercase ) .. sepc .. &quot; &quot;;\n\tend\n\t\n\
      \tif is_set(Conference) then\n\t\tif is_set(ConferenceURL) then\n\t\t\tConference = externallink( ConferenceURL, Conference );\n\t\tend\n\t\tConference = sepc .. &quot; &quot; .. Conference\n\telseif is_set(ConferenceURL) then\n\t\tConference = sepc ..\
      \ &quot; &quot; .. externallink( ConferenceURL, nil, ConferenceURLorigin );\n\tend\n\t\n\tif not is_set(Position) then\n\t\tlocal Minutes = A['Minutes'];\n\t\tif is_set(Minutes) then\n\t\t\tPosition = &quot; &quot; .. Minutes .. &quot; &quot; .. cfg.messages['minutes'];\n\
      \t\telse\n\t\t\tlocal Time = A['Time'];\n\t\t\tif is_set(Time) then\n\t\t\t\tlocal TimeCaption = A['TimeCaption']\n\t\t\t\tif not is_set(TimeCaption) then\n\t\t\t\t\tTimeCaption = cfg.messages['event'];\n\t\t\t\t\tif sepc ~= '.' then\n\t\t\t\t\t\tTimeCaption\
      \ = TimeCaption:lower();\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\tPosition = &quot; &quot; .. TimeCaption .. &quot; &quot; .. Time;\n\t\t\tend\n\t\tend\n\telse\n\t\tPosition = &quot; &quot; .. Position;\n\t\tAt = '';\n\tend\n\t\n\tif not is_set(Page) then\n\
      \t\tif is_set(Pages) then\n\t\t\tif is_set(Periodical) and\n\t\t\t\tnot inArray(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;}) then\n\t\t\t\tPages = &quot;: &quot; .. Pages;\n\t\t\
      \telseif tonumber(Pages) ~= nil then\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPrefix .. Pages;\n\t\t\telse\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPPrefix .. Pages;\n\t\t\tend\n\t\tend\n\telse\n\t\tif is_set(Periodical) and\n\t\t\tnot inArray(config.CitationClass,\
      \ {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;}) then\n\t\t\tPage = &quot;: &quot; .. Page;\n\t\telse\n\t\t\tPage = sepc ..&quot; &quot; .. PPrefix .. Page;\n\t\tend\n\tend\n\t\n\tAt = is_set(At) and\
      \ (sepc .. &quot; &quot; .. At) or &quot;&quot;;\n\tPosition = is_set(Position) and (sepc .. &quot; &quot; .. Position) or &quot;&quot;;\n\tif config.CitationClass == 'map' then\n\t\tlocal Section = A['Section'];\n\t\tlocal Inset = A['Inset'];\n\t\tif\
      \ first_set( Pages, Page, At ) ~= nil or sepc ~= '.' then\n\t\t\tif is_set( Section ) then\n\t\t\t\tSection = &quot;, &quot; .. wrap( 'section', Section, true );\n\t\t\tend\n\t\t\tif is_set( Inset ) then\n\t\t\t\tInset = &quot;, &quot; .. wrap( 'inset',\
      \ Inset, true );\n\t\t\tend\n\t\telse\n\t\t\tif is_set( Section ) then\n\t\t\t\tSection = sepc .. &quot; &quot; .. wrap( 'section', Section, use_lowercase );\n\t\t\t\tif is_set( Inset ) then\n\t\t\t\t\tInset = &quot;, &quot; .. wrap( 'inset', Inset, true\
      \ );\n\t\t\t\tend\n\t\t\telseif is_set( Inset ) then\n\t\t\t\tInset = sepc .. &quot; &quot; .. wrap( 'inset', Inset, use_lowercase );\n\t\t\tend\t\t\t\n\t\tend\t\t\t\n\t\tAt = At .. Section .. Inset;\t\t\n\tend\t\n\n\tif is_set (Language) then\n\t\tLanguage\
      \ = language_parameter (Language, this_page.namespace);\t\t\t-- format, categories (article namespace only), name from ISO639-1, etc\n\telse\n\t\tLanguage=&quot;&quot;;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- language not specified so make sure this is an empty\
      \ string;\n\tend\n\n\tOthers = is_set(Others) and (sepc .. &quot; &quot; .. Others) or &quot;&quot;;\n\n-- handle type parameter for those CS1 citations that have default values\n\n\tif inArray(config.CitationClass, {&quot;AV-media-notes&quot;, &quot;DVD-notes&quot;,\
      \ &quot;podcast&quot;, &quot;pressrelease&quot;, &quot;techreport&quot;, &quot;thesis&quot;}) then\n\t\tTitleType = set_titletype (config.CitationClass, TitleType);\n\t\tif is_set(Degree) and &quot;Thesis&quot; == TitleType then\t-- special case for cite\
      \ thesis\n\t\t\tTitleType = Degree .. &quot; thesis&quot;;\n\t\tend\n\tend\n\n\tif is_set(TitleType) then\t\t\t\t\t-- if type parameter is specified\n\t\tTitleType = &quot; (&quot; .. TitleType .. &quot;)&quot;;\t-- display it in parentheses\n\tend\n\n\
      \tTitleNote = is_set(TitleNote) and (sepc .. &quot; &quot; .. TitleNote) or &quot;&quot;;\n\tEdition = is_set(Edition) and (&quot; &quot; .. wrap( 'edition', Edition )) or &quot;&quot;;\n\tIssue = is_set(Issue) and (&quot; (&quot; .. Issue .. &quot;)&quot;)\
      \ or &quot;&quot;;\n\tSeries = is_set(Series) and (sepc .. &quot; &quot; .. Series) or &quot;&quot;;\n\tOrigYear = is_set(OrigYear) and (&quot; [&quot; .. OrigYear .. &quot;]&quot;) or &quot;&quot;;\n\tAgency = is_set(Agency) and (sepc .. &quot; &quot;\
      \ .. Agency) or &quot;&quot;;\n\n\tif is_set(Volume) then\n\t\tif ( mw.ustring.len(Volume) &gt; 4 )\n\t\t  then Volume = sepc ..&quot; &quot; .. Volume;\n\t\t  else Volume = &quot; &lt;b&gt;&quot; .. hyphentodash(Volume) .. &quot;&lt;/b&gt;&quot;;\n\t\t\
      end\n\tend\n\n--[[ This code commented out while discussion continues until after week of 2014-03-23 live module update;\n\tif is_set(Volume) then\n\t\tif ( mw.ustring.len(Volume) &gt; 4 )\n\t\t  then Volume = sepc .. &quot; &quot; .. Volume;\n\t\t  else\n\
      \t\t\t  Volume = &quot; &lt;b&gt;&quot; .. hyphentodash(Volume) .. &quot;&lt;/b&gt;&quot;;\n\t\t\t  if is_set(Series) then Volume = sepc .. Volume;\n\t\t\t  end\n\t\tend\n\tend\n]]\t\n\t------------------------------------ totally unrelated data\n\t--[[\
      \ Loosely mimic {{subscription required}} template; Via parameter identifies a delivery source that is not the publisher; these sources often, but not always, exist\n\tbehind a registration or paywall.  So here, we've chosen to decouple via from subscription\
      \ (via has never been part of the registration required template).\n\t\n\tSubscription implies paywall; Registration does not.  If both are used in a citation, the subscription required link note is displayed. There are no error messages for this condition.\n\
      \t]]\n\tif is_set(Via) then\n\t\tVia = &quot; &quot; .. wrap( 'via', Via );\n\tend\n\n\tif is_set(SubscriptionRequired) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot; .. cfg.messages['subscription']; --here when 'via' parameter not used but 'subscription'\
      \ is\n\telseif is_set(RegistrationRequired) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot; .. cfg.messages['registration']; --here when 'via' and 'subscription' parameters not used but 'registration' is\n\tend\n\n\tif is_set(AccessDate) then\n\t\
      \tlocal retrv_text = &quot; &quot; .. cfg.messages['retrieved']\n\t\tif (sepc ~= &quot;.&quot;) then retrv_text = retrv_text:lower() end\n\t\tAccessDate = '&lt;span class=&quot;reference-accessdate&quot;&gt;' .. sepc\n\t\t\t.. substitute( retrv_text, {AccessDate}\
      \ ) .. '&lt;/span&gt;'\n\tend\n\t\n\tif is_set(ID) then ID = sepc ..&quot; &quot;.. ID; end\n   \tif &quot;thesis&quot; == config.CitationClass and is_set(Docket) then\n\t\tID = sepc ..&quot; Docket &quot;.. Docket .. ID;\n\tend\n\n\t\n\tID_list = buildidlist(\
      \ ID_list, {DoiBroken = DoiBroken, ASINTLD = ASINTLD, IgnoreISBN = IgnoreISBN, Embargo=Embargo} );\n\n\tif is_set(URL) then\n\t\tURL = &quot; &quot; .. externallink( URL, nil, URLorigin );\n\tend\n\n\tif is_set(Quote) then\n\t\tif Quote:sub(1,1) == '&quot;'\
      \ and Quote:sub(-1,-1) == '&quot;' then\n\t\t\tQuote = Quote:sub(2,-2);\n\t\tend\n\t\tQuote = sepc ..&quot; &quot; .. wrap( 'quoted-text', Quote ); \n\t\tPostScript = &quot;&quot;;\t\t\t\t\t\t\t-- CS1 does not supply terminal punctuation when |quote= is\
      \ set\n\tend\n\t\n\tlocal Archived\n\tif is_set(ArchiveURL) then\n\t\tif not is_set(ArchiveDate) then\n\t\t\tArchiveDate = seterror('archive_missing_date');\n\t\tend\n\t\tif &quot;no&quot; == DeadURL then\n\t\t\tlocal arch_text = cfg.messages['archived'];\n\
      \t\t\tif sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( cfg.messages['archived-not-dead'],\n\t\t\t\t{ externallink( ArchiveURL, arch_text ), ArchiveDate } );\n\t\t\tif not is_set(OriginalURL)\
      \ then\n\t\t\t\tArchived = Archived .. &quot; &quot; .. seterror('archive_missing_url');\t\t\t\t\t\t\t   \n\t\t\tend\n\t\telseif is_set(OriginalURL) then\n\t\t\tlocal arch_text = cfg.messages['archived-dead'];\n\t\t\tif sepc ~= &quot;.&quot; then arch_text\
      \ = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( arch_text,\n\t\t\t\t{ externallink( OriginalURL, cfg.messages['original'] ), ArchiveDate } );\n\t\telse\n\t\t\tlocal arch_text = cfg.messages['archived-missing'];\n\t\t\t\
      if sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( arch_text, \n\t\t\t\t{ seterror('archive_missing_url'), ArchiveDate } );\n\t\tend\n\telse\n\t\tArchived = &quot;&quot;\n\tend\n\t\n\t\
      local Lay\n\tif is_set(LayURL) then\n\t\tif is_set(LayDate) then LayDate = &quot; (&quot; .. LayDate .. &quot;)&quot; end\n\t\tif is_set(LaySource) then \n\t\t\tLaySource = &quot; &amp;ndash; ''&quot; .. safeforitalics(LaySource) .. &quot;''&quot;;\n\t\
      \telse\n\t\t\tLaySource = &quot;&quot;;\n\t\tend\n\t\tif sepc == '.' then\n\t\t\tLay = sepc .. &quot; &quot; .. externallink( LayURL, cfg.messages['lay summary'] ) .. LaySource .. LayDate\n\t\telse\n\t\t\tLay = sepc .. &quot; &quot; .. externallink( LayURL,\
      \ cfg.messages['lay summary']:lower() ) .. LaySource .. LayDate\n\t\tend\t\t\t\n\telse\n\t\tLay = &quot;&quot;;\n\tend\n\t\n\tif is_set(Transcript) then\n\t\tif is_set(TranscriptURL) then Transcript = externallink( TranscriptURL, Transcript ); end\n\t\
      elseif is_set(TranscriptURL) then\n\t\tTranscript = externallink( TranscriptURL, nil, TranscriptURLorigin );\n\tend\n\t\n\tlocal Publisher;\n\tif is_set(Periodical) and\n\t\tnot inArray(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;pressrelease&quot;,&quot;podcast&quot;})\
      \ then\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace) then\n\t\t\t\tPublisher = PublicationPlace .. &quot;: &quot; .. PublisherName;\n\t\t\telse\n\t\t\t\tPublisher = PublisherName;  \n\t\t\tend\n\t\telseif is_set(PublicationPlace)\
      \ then\n\t\t\tPublisher= PublicationPlace;\n\t\telse \n\t\t\tPublisher = &quot;&quot;;\n\t\tend\n\t\tif is_set(PublicationDate) then\n\t\t\tif is_set(Publisher) then\n\t\t\t\tPublisher = Publisher .. &quot;, &quot; .. wrap( 'published', PublicationDate\
      \ );\n\t\t\telse\n\t\t\t\tPublisher = PublicationDate;\n\t\t\tend\n\t\tend\n\t\tif is_set(Publisher) then\n\t\t\tPublisher = &quot; (&quot; .. Publisher .. &quot;)&quot;;\n\t\tend\n\telse\n\t\tif is_set(PublicationDate) then\n\t\t\tPublicationDate = &quot;\
      \ (&quot; .. wrap( 'published', PublicationDate ) .. &quot;)&quot;;\n\t\tend\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace) then\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublicationPlace .. &quot;: &quot; .. PublisherName ..\
      \ PublicationDate;\n\t\t\telse\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublisherName .. PublicationDate;  \n\t\t\tend\t\t\t\n\t\telseif is_set(PublicationPlace) then \n\t\t\tPublisher= sepc .. &quot; &quot; .. PublicationPlace .. PublicationDate;\n\
      \t\telse \n\t\t\tPublisher = PublicationDate;\n\t\tend\n\tend\n\t\n\t-- Several of the above rely upon detecting this as nil, so do it last.\n\tif is_set(Periodical) then\n\t\tif is_set(Title) or is_set(TitleNote) then \n\t\t\tPeriodical = sepc .. &quot;\
      \ &quot; .. wrap( 'italic-title', Periodical ) \n\t\telse \n\t\t\tPeriodical = wrap( 'italic-title', Periodical )\n\t\tend\n\tend\n\n--[[\nHandle the oddity that is cite speech.  This code overrides whatever may be the value assigned to TitleNote (through\
      \ |department=) and forces it to be &quot; (Speech)&quot; so that\nthe annotation directly follows the |title= parameter value in the citation rather than the |event= parameter value (if provided).\n]]\n\tif &quot;speech&quot; == config.CitationClass then\t\
      \t\t\t-- cite speech only\n\t\tTitleNote = &quot; (Speech)&quot;;\t\t\t\t\t\t\t-- annotate the citation\n\t\tif is_set (Periodical) then\t\t\t\t\t\t\t-- if Periodical, perhaps because of an included |website= or |journal= parameter \n\t\t\tif is_set (Conference)\
      \ then\t\t\t\t\t\t-- and if |event= is set\n\t\t\t\tConference = Conference .. sepc .. &quot; &quot;;\t\t-- then add appropriate punctuation to the end of the Conference variable before rendering\n\t\t\tend\n\t\tend\n\tend\n\n\t-- Piece all bits together\
      \ at last.  Here, all should be non-nil.\n\t-- We build things this way because it is more efficient in LUA\n\t-- not to keep reassigning to the same string variable over and over.\n\n\tlocal tcommon\n\tif inArray(config.CitationClass, {&quot;journal&quot;,&quot;citation&quot;})\
      \ and is_set(Periodical) then\n\t\tif is_set(Others) then Others = Others .. sepc .. &quot; &quot; end\n\t\ttcommon = safejoin( {Others, Title, TitleNote, Conference, Periodical, Format, TitleType, Scale, Series, \n\t\t\tLanguage, Cartography, Edition,\
      \ Publisher, Agency, Volume, Issue}, sepc );\n\telse \n\t\ttcommon = safejoin( {Title, TitleNote, Conference, Periodical, Format, TitleType, Scale, Series, Language, \n\t\t\tVolume, Issue, Others, Cartography, Edition, Publisher, Agency}, sepc );\n\tend\n\
      \t\n\tif #ID_list &gt; 0 then\n\t\tID_list = safejoin( { sepc .. &quot; &quot;,  table.concat( ID_list, sepc .. &quot; &quot; ), ID }, sepc );\n\telse\n\t\tID_list = ID;\n\tend\n\t\n\tlocal idcommon = safejoin( { ID_list, URL, Archived, AccessDate, Via,\
      \ SubscriptionRequired, Lay, Quote }, sepc );\n\tlocal text;\n\tlocal pgtext = Position .. Page .. Pages .. At;\n\t\n\tif is_set(Authors) then\n\t\tif is_set(Coauthors) then\n\t\t\tAuthors = Authors .. A['AuthorSeparator'] .. &quot; &quot; .. Coauthors\n\
      \t\tend\n\t\tif is_set(Date) then\n\t\t\tDate = &quot; (&quot;..Date..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telseif string.sub(Authors,-1,-1) == sepc then\n\t\t\tAuthors = Authors .. &quot; &quot;\n\t\telse\n\t\t\tAuthors = Authors ..\
      \ sepc .. &quot; &quot;\n\t\tend\n\t\tif is_set(Editors) then\n\t\t\tlocal in_text = &quot; &quot;;\n\t\t\tlocal post_text = &quot;&quot;;\n\t\t\tif is_set(Chapter) then\n\t\t\t\tin_text = in_text .. cfg.messages['in'] .. &quot; &quot;\n\t\t\telse\n\t\t\
      \t\tif EditorCount &lt;= 1 then\n\t\t\t\t\tpost_text = &quot;, &quot; .. cfg.messages['editor'];\n\t\t\t\telse\n\t\t\t\t\tpost_text = &quot;, &quot; .. cfg.messages['editors'];\n\t\t\t\tend\n\t\t\tend \n\t\t\tif (sepc ~= '.') then in_text = in_text:lower()\
      \ end\n\t\t\tEditors = in_text .. Editors .. post_text;\n\t\t\tif (string.sub(Editors,-1,-1) == sepc)\n\t\t\t\tthen Editors = Editors .. &quot; &quot;\n\t\t\t\telse Editors = Editors .. sepc .. &quot; &quot;\n\t\t\tend\n\t\tend\n\t\ttext = safejoin( {Authors,\
      \ Date, Chapter, Place, Editors, tcommon }, sepc );\n\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\telseif is_set(Editors) then\n\t\tif is_set(Date) then\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editor'];\n\
      \t\t\telse\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editors'];\n\t\t\tend\n\t\t\tDate = &quot; (&quot; .. Date ..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telse\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors\
      \ .. &quot; (&quot; .. cfg.messages['editor'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\t\t\telse\n\t\t\t\tEditors = Editors .. &quot; (&quot; .. cfg.messages['editors'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\t\t\tend\n\t\tend\n\t\ttext = safejoin(\
      \ {Editors, Date, Chapter, Place, tcommon}, sepc );\n\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\telse\n\t\tif is_set(Date) then\n\t\t\tif ( string.sub(tcommon,-1,-1) ~= sepc )\n\t\t\t  then Date = sepc ..&quot; &quot; .. Date .. OrigYear\n\
      \t\t\t  else Date = &quot; &quot; .. Date .. OrigYear\n\t\t\tend\n\t\tend\n\t\tif config.CitationClass==&quot;journal&quot; and is_set(Periodical) then\n\t\t\ttext = safejoin( {Chapter, Place, tcommon}, sepc );\n\t\t\ttext = safejoin( {text, pgtext, Date,\
      \ idcommon}, sepc );\n\t\telse\n\t\t\ttext = safejoin( {Chapter, Place, tcommon, Date}, sepc );\n\t\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\t\tend\n\tend\n\t\n\tif is_set(PostScript) and PostScript ~= sepc then\n\t\ttext = safejoin( {text,\
      \ sepc}, sepc );  --Deals with italics, spaces, etc.\n\t\ttext = text:sub(1,-sepc:len()-1);\n--\t\ttext = text:sub(1,-2);\t--Remove final separator (assumes that sepc is only one character)\n\tend\t\n\t\n\ttext = safejoin( {text, PostScript}, sepc );\n\
      \n\t-- Now enclose the whole thing in a &lt;span/&gt; element\n\tlocal options = {};\n\t\n\tif is_set(config.CitationClass) and config.CitationClass ~= &quot;citation&quot; then\n\t\toptions.class = &quot;citation &quot; .. config.CitationClass;\n\telse\n\
      \t\toptions.class = &quot;citation&quot;;\n\tend\n\t\n\tif is_set(Ref) and Ref:lower() ~= &quot;none&quot; then\n\t\tlocal id = Ref\n\t\tif ( &quot;harv&quot; == Ref ) then\n\t\t\tlocal names = {} --table of last names &amp; year\n\t\t\tif #a &gt; 0 then\n\
      \t\t\t\tfor i,v in ipairs(a) do \n\t\t\t\t\tnames[i] = v.last \n\t\t\t\t\tif i == 4 then break end\n\t\t\t\tend\n\t\t\telseif #e &gt; 0 then\n\t\t\t\tfor i,v in ipairs(e) do \n\t\t\t\t\tnames[i] = v.last \n\t\t\t\t\tif i == 4 then break end\t\t\t\t\n\t\
      \t\t\tend\n\t\t\tend\n\t\t\tnames[ #names + 1 ] = first_set(Year, anchor_year);\t-- Year first for legacy citations\n\t\t\tid = anchorid(names)\n\t\tend\n\t\toptions.id = id;\n\tend\n\t\n\tif string.len(text:gsub(&quot;&lt;span[^&gt;/]*&gt;.-&lt;/span&gt;&quot;,\
      \ &quot;&quot;):gsub(&quot;%b&lt;&gt;&quot;,&quot;&quot;)) &lt;= 2 then\n\t\tz.error_categories = {};\n\t\ttext = seterror('empty_citation');\n\t\tz.message_tail = {};\n\tend\n\t\n\tif is_set(options.id) then \n\t\ttext = '&lt;span id=&quot;' .. mw.uri.anchorEncode(options.id)\
      \ ..'&quot; class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\telse\n\t\ttext = '&lt;span class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\tend\t\
      \t\n\n\tlocal empty_span = '&lt;span style=&quot;display:none;&quot;&gt;&amp;nbsp;&lt;/span&gt;';\n\t\n\t-- Note: Using display: none on then COinS span breaks some clients.\n\tlocal OCinS = '&lt;span title=&quot;' .. OCinSoutput .. '&quot; class=&quot;Z3988&quot;&gt;'\
      \ .. empty_span .. '&lt;/span&gt;';\n\ttext = text .. OCinS;\n\t\n\tif #z.message_tail ~= 0 then\n\t\ttext = text .. &quot; &quot;;\n\t\tfor i,v in ipairs( z.message_tail ) do\n\t\t\tif is_set(v[1]) then\n\t\t\t\tif i == #z.message_tail then\n\t\t\t\t\t\
      text = text .. errorcomment( v[1], v[2] );\n\t\t\t\telse\n\t\t\t\t\ttext = text .. errorcomment( v[1] .. &quot;; &quot;, v[2] );\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\t\n\tno_tracking_cats = no_tracking_cats:lower();\n\tif inArray(no_tracking_cats,\
      \ {&quot;&quot;, &quot;no&quot;, &quot;false&quot;, &quot;n&quot;}) then\n\t\tfor _, v in ipairs( z.error_categories ) do\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _, v in ipairs( z.maintenance_cats ) do\t\t\t\t\t\t\t\t-- append\
      \ maintenance categories\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _, v in ipairs( z.properties_cats ) do\t\t\t\t\t\t\t\t-- append maintenance categories\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\tend\n\t\n\t\
      return text\nend\n\n-- This is used by templates such as {{cite book}} to create the actual citation text.\nfunction z.citation(frame)\n\tlocal pframe = frame:getParent()\n\t\n\tif nil ~= string.find( frame:getTitle(), 'sandbox', 1, true ) then\t\t\t\t\
      -- did the {{#invoke:}} use sandbox version?\n\t\tcfg = mw.loadData( 'Module:Citation/CS1/Configuration/sandbox' );\t-- load sandbox versions of Configuration and Whitelist and ...\n\t\twhitelist = mw.loadData( 'Module:Citation/CS1/Whitelist/sandbox' );\n\
      \t\tdates = require('Module:Citation/CS1/Date_validation/sandbox').dates\t-- ... sandbox version of date validation code\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- otherwise\n\t\tcfg = mw.loadData( 'Module:Citation/CS1/Configuration' );\t\t\t-- load live\
      \ versions of Configuration and Whitelist and ...\n\t\twhitelist = mw.loadData( 'Module:Citation/CS1/Whitelist' );\n\t\tdates = require('Module:Citation/CS1/Date_validation').dates\t\t-- ... live version of date validation code\n\tend\n\t\n\tlocal args\
      \ = {};\n\tlocal suggestions = {};\n\tlocal error_text, error_state;\n\n\tlocal config = {};\n\tfor k, v in pairs( frame.args ) do\n\t\tconfig[k] = v;\n\t\targs[k] = v;\t   \n\tend\t\n\n\tfor k, v in pairs( pframe.args ) do\n\t\tif v ~= '' then\n\t\t\t\
      if not validate( k ) then\t\t\t\n\t\t\t\terror_text = &quot;&quot;;\n\t\t\t\tif type( k ) ~= 'string' then\n\t\t\t\t\t-- Exclude empty numbered parameters\n\t\t\t\t\tif v:match(&quot;%S+&quot;) ~= nil then\n\t\t\t\t\t\terror_text, error_state = seterror(\
      \ 'text_ignored', {v}, true );\n\t\t\t\t\tend\n\t\t\t\telseif validate( k:lower() ) then \n\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored_suggest', {k, k:lower()}, true );\n\t\t\t\telse\n\t\t\t\t\tif #suggestions == 0 then\n\t\t\t\t\t\
      \tsuggestions = mw.loadData( 'Module:Citation/CS1/Suggestions' );\n\t\t\t\t\tend\n\t\t\t\t\tif suggestions[ k:lower() ] ~= nil then\n\t\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored_suggest', {k, suggestions[ k:lower() ]}, true );\n\t\
      \t\t\t\telse\n\t\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored', {k}, true );\n\t\t\t\t\tend\n\t\t\t\tend\t\t\t\t  \n\t\t\t\tif error_text ~= '' then\n\t\t\t\t\ttable.insert( z.message_tail, {error_text, error_state} );\n\t\t\t\tend\t\
      \t\t\t\n\t\t\tend\n\t\t\targs[k] = v;\n\t\telseif args[k] ~= nil or (k == 'postscript') then\n\t\t\targs[k] = v;\n\t\tend\t\t\n\tend\t\n\t\n\treturn citation0( config, args)\nend\n\nreturn z</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:27.179Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Amarriage&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:27 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227014563, 3156572502, 4115564200
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Template:marriage\" to=\"Template:Marriage\" /></normalized><pages><page pageid=\"22011862\" ns=\"10\" title=\"Template:Marriage\"><revisions><rev user=\"Hydrargyrum\" timestamp=\"\
      2014-10-23T00:50:32Z\" comment=\"avoid redirects within template\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">&lt;includeonly&gt;&lt;!--\n\n     To do:  Alternate format/s such as &quot;Mildred Harris (1918–20; div.)&quot;\
      \ rather than &quot;Mildred Harris (m. 1918; div. 1920)&quot;.\n             Producing e.g. {{marriage|1234|1256}} = &quot;(m. 1234–56)&quot; or just &quot;(1234–56)&quot;...?\n\n --&gt;&lt;span itemscope itemtype=&quot;https://en.wikipedia.org/wiki/{{BASEPAGENAME}}&quot;&gt;&lt;!--\n\
      \     --&gt;{{#if:{{{show|}}} |{{{show|}}} &lt;!--                                              (?)\n      --&gt;| {{#if:{{{1|}}} |{{trim|{{{1}}}}}&amp;nbsp;}}&lt;!--                                  (Display first parameter (usually a name))\n       \
      \   --&gt;{{#switch:{{{()|}}} |small|smaller=&lt;span style=&quot;font-size:85%;&quot;&gt;}}&lt;!--      (Start smaller size if |()=small[er])\n          --&gt;(&lt;!--                                                                       (Start parenthesis\
      \ carrying marriage data)\n               --&gt;{{abbr|m.|married}}&amp;nbsp;&lt;!--                                       (Insert &quot;m.&quot;/&quot;married&quot;) [make optional if context already supplied?]\n               --&gt;{{#ifeq:{{{2|}}}|{{getyear|{{{2|}}}}}\
      \ |{{{2|}}}&lt;!--                    (If {{{2}}} is a year, display as is...\n                --&gt;| {{abbr|1={{getyear|{{{2|}}}}} |2={{{2|{{#time:F j, Y}}}}}}}&lt;!--  ...otherwise extract and display year\n               --&gt;}}&lt;!--           \
      \                                                          and present remainder in tooltip)\n               --&gt;{{#if:{{{3|}}} &lt;!--                                                    (If {{{3}}} supplied...\n                --&gt;|  {{#ifeq:{{{3|}}}|\
      \ |&lt;!--                                             ...then if {{{3}}} isn't nothing,\n                    --&gt;|   {{#ifeq:{{{end|{{{reason|}}}}}}| |– |&amp;#59;&amp;#32;}}&lt;!--            add {{{end}}} (if supplied))\n                        --&gt;{{#switch:{{{end|{{{reason|}}}}}}\n\
      \                            | div | div. | divorced = {{abbr|div.|divorced}}&amp;#32;\n                            | w | w. | wid | wid. | widowed = {{abbr|wid.|widowed}}&amp;#32;\n                            | = &lt;!--(reason marriage ended not supplied)--&gt;\n\
      \                            | #default = {{{end|{{{reason|}}}}}}&amp;#32;\n                      }}   }}&lt;!--\n                   --&gt;{{#ifeq:{{{end|{{{reason|}}}}}}|\n                       &lt;!----------Adding third parameter (end date) if {{{end}}}\
      \ not supplied:---------&gt;\n                       | {{#ifexpr:(floor({{#time:Y|{{{3|}}}}}/100))-(floor({{#time:Y|{{{2|}}}}}/100))=0\n                          | {{#ifeq:{{{3|}}}|{{get-year|{{{3|}}}}}\n                             | {{padleft: {{#expr:{{#time:Y|{{{3|}}}}}-(floor({{#time:Y|{{{2|}}}}}/100))*100}}\
      \ |2 |0 }}\n                             | {{abbr|1={{padleft: {{#expr: {{#time:Y|{{{3|}}}}}-(floor({{#time:Y|{{{2|}}}}}/100))*100 }} |2 |0 }} |2={{{3|}}} }}\n                            }}\n                          | {{#ifeq:{{{3|}}}|{{getyear|{{{3|}}}}}\
      \ |{{{3|}}}\n                             | {{abbr|1={{getyear|{{{3|}}}}} |2={{{3|}}} }}\n                         }} }}\n                       &lt;!----------Adding third parameter (end date) if {{{end}}} supplied:---------&gt;\n                    \
      \   | {{#ifeq:{{{3|}}}|{{get-year|{{{3|}}}}} |{{{3|}}}\n                          | {{abbr|1={{get-year|{{{3|}}}}} |2={{{3|}}} }} \n                      }} }}\n                   |\n                  }}&lt;!--\n          --&gt;)&lt;!--               \
      \                                                         (Close parenthesis carrying marriage data)\n          --&gt;{{#switch:{{{()|}}} |small|smaller=&lt;/span&gt;}} &lt;!--                            (End smaller size (if |()=small[er]))\n     --&gt;}}&lt;!--\n\
      \ --&gt;&lt;/span&gt;&lt;!--\n--&gt;&lt;/includeonly&gt;&lt;noinclude&gt;{{Documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:27.649Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Atrim&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:27 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530298806, 952142876, 4115565063
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:trim" to="Template:Trim" /></normalized><pages><page pageid="21815705" ns="10" title="Template:Trim"><revisions><rev user="MSGJ" timestamp="2011-02-09T15:02:43Z" comment="moved [[Template:Str trim]] to [[Template:Trim]]: merge duplicate templates" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{ {{{|safesubst:}}}#if:1|{{{1|}}}}}&lt;/includeonly&gt;&lt;noinclude&gt;

      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:28.099Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aabbr&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:28 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123486013, 952143297, 4115565592
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:abbr" to="Template:Abbr" /></normalized><pages><page pageid="2557713" ns="10" title="Template:Abbr"><revisions><rev user="Edokter" timestamp="2014-10-04T18:36:56Z" comment="Reverted edits by [[Special:Contribs/Sardanaphalus|Sardanaphalus]] ([[User talk:Sardanaphalus|talk]]) to last version by Edokter" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;abbr {{#if:{{{class|}}}|class=&quot;{{{class}}}&quot;}} {{#if:{{{id|}}}|id=&quot;{{{id}}}&quot;}} {{#if:{{{style|}}}|style=&quot;{{{style}}}&quot;}} title=&quot;{{#tag:nowiki|{{{2|}}}}}&quot;&gt;{{#switch: {{{3|}}}
        | u | unicode | Unicode = {{Unicode|{{{1|}}}}}
        | i | IPA = {{IPA|{{{1|}}}}}
        | {{{1|}}} }}&lt;/abbr&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:29.020Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Agetyear&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:28 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348978133, 3439966181, 4115566311
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:getyear" to="Template:Getyear" /></normalized><pages><page pageid="43069411" ns="10" title="Template:Getyear"><revisions><rev user="Sardanaphalus" timestamp="2014-06-30T10:45:01Z" comment="update" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#redirect [[Template:Get year]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:29.633Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AGet+year&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:29 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq48 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055675652, 296381763, 4115567456
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="22055578" ns="10" title="Template:Get year"><revisions><rev user="Sardanaphalus" timestamp="2014-06-30T10:44:17Z" comment="Sardanaphalus moved page [[Template:Get-year]] to [[Template:Get year]]: No hyphen per related templates in [[:Category:Date mathematics templates]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#ifeq:&quot;{{lc:{{{1|1900}}}}}&quot;|&quot;{{Four digit|{{#expr:{{{1|1900}}}}}}}&quot;|{{{1|1900}}}|{{#time:Y|{{{1|November 1, 1900}}} }}}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:30.395Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFour+digit&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:30 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530303590, 319077759, 4115568075
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="4901135" ns="10" title="Template:Four digit"><revisions><rev user="The Mol Man" timestamp="2014-07-03T14:43:30Z" comment="doc to subpage" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{padleft:{{{1|0}}}|4|0}}&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:31.016Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aget-year&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:31 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq62 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227021762, 3622008809, 4115569250
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:get-year" to="Template:Get-year" /></normalized><pages><page pageid="43180264" ns="10" title="Template:Get-year"><revisions><rev user="Sardanaphalus" timestamp="2014-06-30T10:44:17Z" comment="Sardanaphalus moved page [[Template:Get-year]] to [[Template:Get year]]: No hyphen per related templates in [[:Category:Date mathematics templates]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Get year]]
      {{R from move}}</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:31.701Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aubl&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:31 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227022776, 2402501148, 4115569978
    body: '<?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:ubl" to="Template:Ubl" /></normalized><pages><page pageid="27549298" ns="10" title="Template:Ubl"><revisions><rev user="Courcelles" timestamp="2010-09-12T02:20:49Z" comment="Protected
      Template:Ubl: Batch semi-protection of highly visible templates listed on [[Wikipedia:Database reports/Unprotected templates with many transclusions/4]]  Any that were full-protected I will restore. using [[WP:TW|TW]] ([edit=autoconfirmed] (inde" contentformat="text/x-wiki"
      contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Unbulleted list]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:11:32.493Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AUnbulleted+list&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:32 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq32 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348984441, 469344405, 4115570668
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="27486458" ns="10" title="Template:Unbulleted list"><revisions><rev user="Mr. Stradivarius" timestamp="2014-05-26T01:21:32Z" comment="switch to using [[Module:List]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{&lt;includeonly&gt;safesubst:&lt;/includeonly&gt;#invoke:list|unbulleted}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:33.629Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Alist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:33 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055682964, 319080601, 4115571453
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:list\" to=\"Module:List\" /></normalized><pages><page pageid=\"41068627\" ns=\"828\" title=\"Module:List\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-06-12T09:21:46Z\"\
      \ comment=\"remove li_style, ul_style and ol_style parameters, allow itemn_style and itemn_value parameters, and add a tracking category for item_stylen and item_valuen parameters\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\"\
      >-- This module outputs different kinds of lists. At the moment, bulleted,\n-- unbulleted, horizontal, ordered, and horizontal ordered lists are supported.\n\nlocal libUtil = require('libraryUtil')\nlocal checkType = libUtil.checkType\nlocal mTableTools\
      \ = require('Module:TableTools')\n\nlocal p = {}\n\nlocal listTypes = {\n\t['bulleted'] = true,\n\t['unbulleted'] = true,\n\t['horizontal'] = true,\n\t['ordered'] = true,\n\t['horizontal_ordered'] = true\n}\n\nfunction p.makeListData(listType, args)\n\t\
      -- Constructs a data table to be passed to p.renderList.\n\tlocal data = {}\n\n\t-- Classes\n\tdata.classes = {}\n\tif listType == 'horizontal' or listType == 'horizontal_ordered' then\n\t\ttable.insert(data.classes, 'hlist')\n\telseif listType == 'unbulleted'\
      \ then\n\t\ttable.insert(data.classes, 'plainlist')\n\tend\n\ttable.insert(data.classes, args.class)\n\n\t-- Main div style\n\tdata.style = args.style\n\n\t-- Indent for horizontal lists\n\tif listType == 'horizontal' or listType == 'horizontal_ordered'\
      \ then\n\t\tlocal indent = tonumber(args.indent)\n\t\tindent = indent and indent * 1.6 or 0\n\t\tif indent &gt; 0 then\n\t\t\tdata.marginLeft = indent .. 'em'\n\t\tend\n\tend\n\t\n\t-- List style types for ordered lists\n\t-- This could be &quot;1, 2,\
      \ 3&quot;, &quot;a, b, c&quot;, or a number of others. The list style\n\t-- type is either set by the &quot;type&quot; attribute or the &quot;list-style-type&quot; CSS\n\t-- property.\n\tif listType == 'ordered' or listType == 'horizontal_ordered' then\
      \ \n\t\tdata.listStyleType = args.list_style_type or args['list-style-type']\n\t\tdata.type = args['type']\n\n\t\t-- Detect invalid type attributes and attempt to convert them to\n\t\t-- list-style-type CSS properties.\n\t\tif data.type \n\t\t\tand not\
      \ data.listStyleType\n\t\t\tand not tostring(data.type):find('^%s*[1AaIi]%s*$')\n\t\tthen\n\t\t\tdata.listStyleType = data.type\n\t\t\tdata.type = nil\n\t\tend\n\tend\n\t\n\t-- List tag type\n\tif listType == 'ordered' or listType == 'horizontal_ordered'\
      \ then\n\t\tdata.listTag = 'ol'\n\telse\n\t\tdata.listTag = 'ul'\n\tend\n\n\t-- Start number for ordered lists\n\tdata.start = args.start\n\tif listType == 'horizontal_ordered' then\n\t\t-- Apply fix to get start numbers working with horizontal ordered\
      \ lists.\n\t\tlocal startNum = tonumber(data.start)\n\t\tif startNum then\n\t\t\tdata.counterReset = 'listitem ' .. tostring(startNum - 1)\n\t\tend\n\tend\n\n\t-- List style\n\t -- ul_style and ol_style are included for backwards compatibility. No\n\t\
      \ -- distinction is made for ordered or unordered lists.\n\tdata.listStyle = args.list_style\n\n\t-- List items\n\t-- li_style is included for backwards compatibility. item_style was included\n\t-- to be easier to understand for non-coders.\n\tdata.itemStyle\
      \ = args.item_style or args.li_style\n\tdata.items = {}\n\tfor i, num in ipairs(mTableTools.numKeys(args)) do\n\t\tlocal item = {}\n\t\titem.content = args[num]\n\t\titem.style = args['item' .. tostring(num) .. '_style']\n\t\t\tor args['item_style' ..\
      \ tostring(num)]\n\t\titem.value = args['item' .. tostring(num) .. '_value']\n\t\t\tor args['item_value' .. tostring(num)]\n\t\ttable.insert(data.items, item)\n\tend\n\t\n\treturn data\nend\n\nfunction p.renderList(data)\n\t-- Renders the list HTML.\n\t\
      \n\t-- Return the blank string if there are no list items.\n\tif type(data.items) ~= 'table' or #data.items &lt; 1 then\n\t\treturn ''\n\tend\n\t\n\t-- Render the main div tag.\n\tlocal root = mw.html.create('div')\n\tfor i, class in ipairs(data.classes\
      \ or {}) do\n\t\troot:addClass(class)\n\tend\n\troot:css{['margin-left'] = data.marginLeft}\n\tif data.style then\n\t\troot:cssText(data.style)\n\tend\n\n\t-- Render the list tag.\n\tlocal list = root:tag(data.listTag or 'ul')\n\tlist\n\t\t:attr{start\
      \ = data.start, type = data.type}\n\t\t:css{\n\t\t\t['counter-reset'] = data.counterReset,\n\t\t\t['list-style-type'] = data.listStyleType\n\t\t}\n\tif data.listStyle then\n\t\tlist:cssText(data.listStyle)\n\tend\n\n\t-- Render the list items\n\tfor i,\
      \ t in ipairs(data.items or {}) do\n\t\tlocal item = list:tag('li')\n\t\tif data.itemStyle then\n\t\t\titem:cssText(data.itemStyle)\n\t\tend\n\t\tif t.style then\n\t\t\titem:cssText(t.style)\n\t\tend\n\t\titem\n\t\t\t:attr{value = t.value}\n\t\t\t:wikitext(t.content)\n\
      \tend\n\n\treturn tostring(root)\nend\n\nfunction p.renderTrackingCategories(args)\n\tlocal isDeprecated = false -- Tracks deprecated parameters.\n\tfor k, v in pairs(args) do\n\t\tk = tostring(k)\n\t\tif k:find('^item_style%d+$') or k:find('^item_value%d+$')\
      \ then\n\t\t\tisDeprecated = true\n\t\t\tbreak\n\t\tend\n\tend\n\tlocal ret = ''\n\tif isDeprecated then\n\t\tret = ret .. '[[Category:List templates with deprecated parameters]]'\n\tend\n\treturn ret\nend\n\nfunction p.makeList(listType, args)\n\tif not\
      \ listType or not listTypes[listType] then\n\t\terror(string.format(\n\t\t\t&quot;bad argument #1 to 'makeList' ('%s' is not a valid list type)&quot;,\n\t\t\ttostring(listType)\n\t\t), 2)\n\tend\n\tcheckType('makeList', 2, args, 'table')\n\tlocal data\
      \ = p.makeListData(listType, args)\n\tlocal list = p.renderList(data)\n\tlocal trackingCategories = p.renderTrackingCategories(args)\n\treturn list .. trackingCategories\nend\n\nfor listType in pairs(listTypes) do\n\tp[listType] = function (frame)\n\t\t\
      local mArguments = require('Module:Arguments')\n\t\tlocal origArgs = mArguments.getArgs(frame)\n\t\t-- Copy all the arguments to a new table, for faster indexing.\n\t\tlocal args = {}\n\t\tfor k, v in pairs(origArgs) do\n\t\t\targs[k] = v\n\t\tend\n\t\t\
      return p.makeList(listType, args)\n\tend\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:35.164Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ATableTools&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:34 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq36 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025901263, 4276351393, 4115573268
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"41371028\" ns=\"828\" title=\"Module:TableTools\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-05-25T14:11:02Z\" comment=\"fix cleanPattern function - some of\
      \ the character classes were still being magic even when they were inside the set, so escape them all\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[[\n------------------------------------------------------------------------------------\n\
      --                               TableTools                                       --\n--                                                                                --\n-- This module includes a number of functions for dealing with Lua tables.     \
      \   --\n-- It is a meta-module, meant to be called from other Lua modules, and should     --\n-- not be called directly from #invoke.                                           --\n------------------------------------------------------------------------------------\n\
      --]]\n\nlocal libraryUtil = require('libraryUtil')\n\nlocal p = {}\n\n-- Define often-used variables and functions.\nlocal floor = math.floor\nlocal infinity = math.huge\nlocal checkType = libraryUtil.checkType\n\n--[[\n------------------------------------------------------------------------------------\n\
      -- isPositiveInteger\n--\n-- This function returns true if the given value is a positive integer, and false\n-- if not. Although it doesn't operate on tables, it is included here as it is\n-- useful for determining whether a given table key is in the array\
      \ part or the\n-- hash part of a table.\n------------------------------------------------------------------------------------\n--]]\nfunction p.isPositiveInteger(v)\n\tif type(v) == 'number' and v &gt;= 1 and floor(v) == v and v &lt; infinity then\n\t\t\
      return true\n\telse\n\t\treturn false\n\tend\nend\n\n--[[\n------------------------------------------------------------------------------------\n-- isNan\n--\n-- This function returns true if the given number is a NaN value, and false\n-- if not. Although\
      \ it doesn't operate on tables, it is included here as it is\n-- useful for determining whether a value can be a valid table key. Lua will\n-- generate an error if a NaN is used as a table key.\n------------------------------------------------------------------------------------\n\
      --]]\nfunction p.isNan(v)\n\tif type(v) == 'number' and tostring(v) == '-nan' then\n\t\treturn true\n\telse\n\t\treturn false\n\tend\nend\n\n--[[\n------------------------------------------------------------------------------------\n-- shallowClone\n--\n\
      -- This returns a clone of a table. The value returned is a new table, but all\n-- subtables and functions are shared. Metamethods are respected, but the returned\n-- table will have no metatable of its own.\n------------------------------------------------------------------------------------\n\
      --]]\nfunction p.shallowClone(t)\n\tlocal ret = {}\n\tfor k, v in pairs(t) do\n\t\tret[k] = v\n\tend\n\treturn ret\nend\n\n--[[\n------------------------------------------------------------------------------------\n-- removeDuplicates\n--\n-- This removes\
      \ duplicate values from an array. Non-positive-integer keys are\n-- ignored. The earliest value is kept, and all subsequent duplicate values are\n-- removed, but otherwise the array order is unchanged.\n------------------------------------------------------------------------------------\n\
      --]]\nfunction p.removeDuplicates(t)\n\tcheckType('removeDuplicates', 1, t, 'table')\n\tlocal isNan = p.isNan\n\tlocal ret, exists = {}, {}\n\tfor i, v in ipairs(t) do\n\t\tif isNan(v) then\n\t\t\t-- NaNs can't be table keys, and they are also unique,\
      \ so we don't need to check existence.\n\t\t\tret[#ret + 1] = v\n\t\telse\n\t\t\tif not exists[v] then\n\t\t\t\tret[#ret + 1] = v\n\t\t\t\texists[v] = true\n\t\t\tend\n\t\tend\t\n\tend\n\treturn ret\nend\t\t\t\n\n--[[\n------------------------------------------------------------------------------------\n\
      -- numKeys\n--\n-- This takes a table and returns an array containing the numbers of any numerical\n-- keys that have non-nil values, sorted in numerical order.\n------------------------------------------------------------------------------------\n--]]\n\
      function p.numKeys(t)\n\tcheckType('numKeys', 1, t, 'table')\n\tlocal isPositiveInteger = p.isPositiveInteger\n\tlocal nums = {}\n\tfor k, v in pairs(t) do\n\t\tif isPositiveInteger(k) then\n\t\t\tnums[#nums + 1] = k\n\t\tend\n\tend\n\ttable.sort(nums)\n\
      \treturn nums\nend\n\n--[[\n------------------------------------------------------------------------------------\n-- affixNums\n--\n-- This takes a table and returns an array containing the numbers of keys with the\n-- specified prefix and suffix. For\
      \ example, for the table\n-- {a1 = 'foo', a3 = 'bar', a6 = 'baz'} and the prefix &quot;a&quot;, affixNums will\n-- return {1, 3, 6}.\n------------------------------------------------------------------------------------\n--]]\nfunction p.affixNums(t, prefix,\
      \ suffix)\n\tcheckType('affixNums', 1, t, 'table')\n\tcheckType('affixNums', 2, prefix, 'string', true)\n\tcheckType('affixNums', 3, suffix, 'string', true)\n\n\tlocal function cleanPattern(s)\n\t\t-- Cleans a pattern so that the magic characters ()%.[]*+-?^$\
      \ are interpreted literally.\n\t\ts = s:gsub('([%(%)%%%.%[%]%*%+%-%?%^%$])', '%%%1')\n\t\treturn s\n\tend\n\n\tprefix = prefix or ''\n\tsuffix = suffix or ''\n\tprefix = cleanPattern(prefix)\n\tsuffix = cleanPattern(suffix)\n\tlocal pattern = '^' .. prefix\
      \ .. '([1-9]%d*)' .. suffix .. '$'\n\n\tlocal nums = {}\n\tfor k, v in pairs(t) do\n\t\tif type(k) == 'string' then\t\t\t\n\t\t\tlocal num = mw.ustring.match(k, pattern)\n\t\t\tif num then\n\t\t\t\tnums[#nums + 1] = tonumber(num)\n\t\t\tend\n\t\tend\n\t\
      end\n\ttable.sort(nums)\n\treturn nums\nend\n\n--[[\n------------------------------------------------------------------------------------\n-- numData\n--\n-- Given a table with keys like (&quot;foo1&quot;, &quot;bar1&quot;, &quot;foo2&quot;, &quot;baz2&quot;),\
      \ returns a table\n-- of subtables in the format \n-- { [1] = {foo = 'text', bar = 'text'}, [2] = {foo = 'text', baz = 'text'} }\n-- Keys that don't end with an integer are stored in a subtable named &quot;other&quot;.\n-- The compress option compresses\
      \ the table so that it can be iterated over with\n-- ipairs.\n------------------------------------------------------------------------------------\n--]]\nfunction p.numData(t, compress)\n\tcheckType('numData', 1, t, 'table')\n\tcheckType('numData', 2,\
      \ compress, 'boolean', true)\n\tlocal ret = {}\n\tfor k, v in pairs(t) do\n\t\tlocal prefix, num = mw.ustring.match(tostring(k), '^([^0-9]*)([1-9][0-9]*)$')\n\t\tif num then\n\t\t\tnum = tonumber(num)\n\t\t\tlocal subtable = ret[num] or {}\n\t\t\tif prefix\
      \ == '' then\n\t\t\t\t-- Positional parameters match the blank string; put them at the start of the subtable instead.\n\t\t\t\tprefix = 1\n\t\t\tend\n\t\t\tsubtable[prefix] = v\n\t\t\tret[num] = subtable\n\t\telse\n\t\t\tlocal subtable = ret.other or {}\n\
      \t\t\tsubtable[k] = v\n\t\t\tret.other = subtable\n\t\tend\n\tend\n\tif compress then\n\t\tlocal other = ret.other\n\t\tret = p.compressSparseArray(ret)\n\t\tret.other = other\n\tend\n\treturn ret\nend\n\n--[[\n------------------------------------------------------------------------------------\n\
      -- compressSparseArray\n--\n-- This takes an array with one or more nil values, and removes the nil values\n-- while preserving the order, so that the array can be safely traversed with\n-- ipairs.\n------------------------------------------------------------------------------------\n\
      --]]\nfunction p.compressSparseArray(t)\n\tcheckType('compressSparseArray', 1, t, 'table')\n\tlocal ret = {}\n\tlocal nums = p.numKeys(t)\n\tfor _, num in ipairs(nums) do\n\t\tret[#ret + 1] = t[num]\n\tend\n\treturn ret\nend\n\n--[[\n------------------------------------------------------------------------------------\n\
      -- sparseIpairs\n--\n-- This is an iterator for sparse arrays. It can be used like ipairs, but can\n-- handle nil values.\n------------------------------------------------------------------------------------\n--]]\nfunction p.sparseIpairs(t)\n\tcheckType('sparseIpairs',\
      \ 1, t, 'table')\n\tlocal nums = p.numKeys(t)\n\tlocal i = 0\n\tlocal lim = #nums\n\treturn function ()\n\t\ti = i + 1\n\t\tif i &lt;= lim then\n\t\t\tlocal key = nums[i]\n\t\t\treturn key, t[key]\n\t\telse\n\t\t\treturn nil, nil\n\t\tend\n\tend\nend\n\
      \n--[[\n------------------------------------------------------------------------------------\n-- size\n--\n-- This returns the size of a key/value pair table. It will also work on arrays,\n-- but for arrays it is more efficient to use the # operator.\n\
      ------------------------------------------------------------------------------------\n--]]\nfunction p.size(t)\n\tcheckType('size', 1, t, 'table')\n\tlocal i = 0\n\tfor k in pairs(t) do\n\t\ti = i + 1\n\tend\n\treturn i\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:36.703Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AInfobox+person&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:36 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq39 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227031165, 3682474872, 4115575502
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"3382507\" ns=\"10\" title=\"Template:Infobox person\"><revisions><rev user=\"Frietjes\" timestamp=\"2014-08-12T21:32:23Z\" comment=\"match logic used by label and data (strange\
      \ behaviour when first is blank), and remove additional lang which is set by the backend software\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Infobox|child={{{child|}}}\n| bodyclass  = biography vcard\n| bodystyle\
      \  = {{#if:{{{box_width|}}}|width:{{{box_width}}};}}\n| above      = {{br separated entries\n |1={{#if:{{{honorific prefix|{{{honorific_prefix|}}}}}}|&lt;span class=&quot;honorific-prefix&quot; style=&quot;font-size: small&quot;&gt;{{{honorific prefix|{{{honorific_prefix|}}}}}}&lt;/span&gt;}}\n\
      \ |2={{#if:{{{name|&lt;includeonly&gt;{{PAGENAME}}&lt;/includeonly&gt;}}}|&lt;span class=&quot;fn&quot;&gt;{{{name|{{PAGENAME}}}}}&lt;/span&gt;}}\n |3={{#if:{{{honorific suffix|{{{honorific_suffix|}}}}}}|&lt;span class=&quot;honorific-suffix&quot; style=&quot;font-size:\
      \ small&quot;&gt;{{{honorific suffix|{{{honorific_suffix|}}}}}}&lt;/span&gt;}}\n }}\n| image      = {{#invoke:InfoboxImage|InfoboxImage|image={{{image|}}}|size={{{image size|{{{image_size|{{{imagesize|}}}}}}}}}|sizedefault=frameless|upright=1|alt={{{alt|}}}|suppressplaceholder=yes}}\n\
      | caption    = {{{image caption|{{{caption|{{{image_caption|}}}}}}}}}\n\n| labelstyle = padding-right:0.65em;&lt;!--(to ensure sufficient gap between any (long/unwrapped) label and subsequent data on same line)--&gt;\n\n| label1     = Native&amp;nbsp;name\n\
      | data1      = {{#if:{{{native_name|}}}|&lt;span class=&quot;nickname&quot; {{#if:{{{native_name_lang|}}}|lang=&quot;{{{native_name_lang}}}&quot;}}&gt;{{{native_name}}}&lt;/span&gt; }}\n\n| label10     = Born\n| data10      = {{br separated entries|1={{#if:{{{birth_name|{{{birthname|}}}}}}|&lt;span\
      \ class=&quot;nickname&quot;&gt;{{{birth_name|{{{birthname|}}}}}}&lt;/span&gt;}}|2={{{birth_date|}}}|3={{#if:{{{birth_place|}}}|&lt;span class=&quot;birthplace&quot;&gt;{{{birth_place|}}}&lt;/span&gt;}}}}\n\n| label11     = Baptised\n| data11      = {{#if:{{{birth_date|}}}||{{{baptised|}}}}}\n\
      \n| label12     = Disappeared\n| data12      = {{br separated entries|{{{disappeared_date|}}}|{{{disappeared_place|}}} }}\n\n| label13     = Status\n| data13      = {{{status|{{{disappeared_status|}}}}}}\n\n| label14     = Died\n| data14      = {{br separated\
      \ entries|1={{{death_date|}}}|2={{#if:{{{death_place|}}}|&lt;span class=&quot;deathplace&quot;&gt;{{{death_place|}}}&lt;/span&gt;}}}}\n\n| label15     = {{Longitem|Cause&amp;nbsp;of death}}\n| data15      = {{{death cause|{{{death_cause|}}}}}}\n\n| label16\
      \     = {{Longitem|Body discovered}}\n| data16      = {{{body discovered|{{{body_discovered|}}}}}}\n\n| label17     = {{Longitem|Resting place}}\n| class17     = label\n| data17      = {{br separated entries|{{{resting place|{{{resting_place|{{{restingplace|}}}}}}}}}|{{{resting\
      \ place coordinates|{{{resting_place_coordinates|{{{restingplacecoordinates|}}}}}}}}}}}\n\n| label18     = Monuments\n| data18      = {{{monuments|}}}\n\n| label19     = Residence\n| class19     = {{#if:{{{death_date|}}}{{{death_place|}}}||label}}\n| data19\
      \      = {{{residence|}}}\n\n| class20    = category\n| label20    = Nationality\n| data20     = {{{nationality|}}}\n\n| label21    = Other&amp;nbsp;names\n| class21    = nickname\n| data21     = {{{other names|{{{other_names|{{{othername|{{{alias|}}}}}}}}}}}}\n\
      \n| class22    = category\n| label22    = Ethnicity\n| data22     = {{{ethnicity|}}}\n\n| class23    = category\n| label23    = Citizenship\n| data23     = {{{citizenship|}}}\n\n| label24    = Education\n| data24     = {{{education|}}}\n\n| label25   \
      \ = Alma&amp;nbsp;mater\n| data25     = {{{alma mater|{{{alma_mater|}}}}}}\n\n| label26    = Occupation\n| class26    = role\n| data26     = {{{occupation|}}}\n\n| label27    = Years&amp;nbsp;active\n| data27     = {{{years active|{{{years_active|{{{yearsactive|}}}}}}}}}\n\
      \n| label28    = Employer\n| data28     = {{{employer|}}}\n| class28    = org\n\n| label29    = Organization\n| data29     = {{{organization|{{{organizations|}}}}}}\n| class29    = org\n\n| label30    = Agent\n| data30     = {{{agent|}}}\n| class30   \
      \ = agent\n\n| label31    = Known&amp;nbsp;for\n| data31     = {{{known for|{{{known_for|{{{known|}}}}}}}}}\n\n| label32    = &lt;span style=&quot;white-space:nowrap;&quot;&gt;{{#if:{{{credits|}}}|Notable credit(s)|Notable work(s)}}&lt;/span&gt;\n| data32\
      \     = {{#if:{{{credits|}}}|{{{credits}}}|{{{notable works|{{{notable_works|}}}}}}}}\n\n| label33    = Style\n| data33     = {{{style|}}}\n| class33    = category\n\n| label36    = Home&amp;nbsp;town\n| data36     = {{{home town|{{{home_town|}}}}}}\n\n\
      | label37    = Salary\n| data37     = {{{salary|}}}\n\n| label38    = Net&amp;nbsp;worth\n| data38     = {{{net worth|{{{net_worth|{{{networth|}}}}}}}}}\n\n| label39    = Height\n| data39     = {{{height|}}}\n\n| label40    = Weight\n| data40     = {{{weight|}}}\n\
      \n| label41    = Television\n| data41     = {{{television|}}}\n\n| label42    = Title\n| data42     = {{{title|}}}\n| class42    = title\n\n| label43    = Term\n| data43     = {{{term|}}}\n\n| label44    = Predecessor\n| data44     = {{{predecessor|}}}\n\
      \n| label45    = Successor\n| data45     = {{{successor|}}}\n\n| label46    = {{Longitem|Political party}}\n| data46     = {{{party|}}}\n| class46    = org\n\n| label47    = Movement\n| data47     = {{{movement|}}}\n| class47    = category\n\n| label48\
      \    = &lt;span style=&quot;white-space:nowrap;&quot;&gt;Opponent(s)&lt;/span&gt;\n| data48     = {{{opponents|}}}\n\n| label49    = {{Longitem|Board member&amp;nbsp;of}}\n| data49     = {{{boards|}}}\n\n| label50    = Religion\n| data50     = {{{religion|}}}\n\
      | class50    = category\n\n| label51    = Denomination\n| data51     = {{{denomination|}}}\n| class51    = category\n\n| label52    = {{Longitem|Criminal charge}}\n| data52     = {{{criminal charge|{{{criminal_charge|}}}}}}\n\n| label53    = {{Longitem|Criminal\
      \ penalty}}\n| data53     = {{{criminal penalty|{{{criminal_penalty|}}}}}}\n\n| label54    = &lt;span style=&quot;padding:0.1em 0;line-height:1.2em&quot;&gt;{{#if:{{{judicial_status|{{{judicial status|}}}}}}|Judicial status|Criminal status}}&lt;/span&gt;\n\
      | data54      = {{#if:{{{judicial status|{{{judicial_status|}}}}}} | {{{judicial status|{{{judicial_status}}}}}} | {{{criminal status|{{{criminal_status|}}}}}} }}\n| class54    = category\n\n| label55    = &lt;span style=&quot;white-space:nowrap;&quot;&gt;Spouse(s)&lt;/span&gt;\n\
      | data55     = {{{spouse|}}}\n\n| label56    = &lt;span style=&quot;white-space:nowrap;&quot;&gt;Partner(s)&lt;/span&gt;\n| data56     = {{{partner|{{{domesticpartner|{{{domestic_partner|}}}}}}}}}\n\n| label57    = Children\n| data57     = {{{children|}}}\n\
      \n| label58    = Parents\n| data58     = {{{parents|}}}\n\n| label59    = Relatives\n| data59     = {{{relations|{{{relatives|}}}}}}\n\n| label60    = Family\n| data60     = {{{family|}}}\n\n| label61    = Call-sign\n| data61     = {{{callsign|}}}\n\n\
      | label62    = Awards\n| data62     = {{{awards|}}}\n\n| label63    = {{#if:{{{honours|}}}|Honours|Honors}}\n| data63     = {{#if:{{{honours|}}}|{{{honours}}}|{{{honors|}}}}}\n\n| data64     = {{{misc|{{{module|}}}}}}\n| data65     = {{{misc2|{{{module2|}}}}}}\n\
      | data66     = {{{misc3|{{{module3|}}}}}}\n| data67     = {{{misc4|{{{module4|}}}}}}\n| data68     = {{{misc5|{{{module5|}}}}}}\n| data69     = {{{misc6|{{{module6|}}}}}}\n\n| label70    = Signature\n| data70     = {{#if:{{{signature|}}}|{{#invoke:InfoboxImage|InfoboxImage|image={{{signature|}}}|size={{{signature_size|}}}|sizedefault=150px|alt={{{signature\
      \ alt|{{{signature_alt|}}}}}}}} }}\n\n| header71   = {{#if:{{{website|{{{homepage|{{{URL|}}}}}}}}}|Website}}\n| data72     = {{{website|{{{homepage|{{{URL|}}}}}}}}}\n\n| below      = {{#if:{{{footnotes|}}}|'''Notes'''&lt;div style=&quot;line-height:1.2em;&quot;&gt;{{{footnotes}}}&lt;/div&gt;}}\n\
      | belowstyle = border-top:1px solid #aaaaaa; text-align:left\n\n}}{{main other|&lt;!--\n\n--&gt;{{#if:{{{1|}}}|{{#ifeq:{{NAMESPACE}}|{{ns:0}}|[[Category:Infobox person using numbered parameter]]}}}}&lt;!--\n--&gt;{{#if:{{{box_width|}}}|[[Category:Infobox\
      \ person using boxwidth parameter]]}}&lt;!--\n--&gt;{{#if:{{{death_date|}}}{{{death_place|}}}|{{#if:{{{salary|}}}{{{net worth|{{{net_worth|{{{networth|}}}}}}}}}|[[Category:Infobox person using certain parameters when dead]]}}}}&lt;!--\n--&gt;{{#if:{{{influences|}}}{{{influenced|}}}|[[Category:Infobox\
      \ person using influence]]}}&lt;!--\n--&gt;{{#if:{{{pronunciation|}}}|[[Category:Biography template using pronunciation]]}}&lt;!--\n\n--&gt;{{#if:{{{signature|}}}|[[Category:Biography with signature]]}}[[Category:Articles with hCards]]\n}}&lt;noinclude&gt;\n\
      &lt;!---Please add categories to the &lt;includeonly&gt; section at the bottom of the /doc subpage---&gt;\n{{documentation}} \n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:37.100Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Abr+separated+entries&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:37 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055692314, 269547894, 4115576949
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:br separated entries" to="Template:Br separated entries" /></normalized><pages><page pageid="27461703" ns="10" title="Template:Br separated entries"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T03:44:55Z" comment="Changed protection level of Template:Br separated entries: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{&lt;includeonly&gt;safesubst:&lt;/includeonly&gt;#invoke:br separated entries|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:37.621Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Abr_separated_entries&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:37 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103538268, 343405073, 4115577652
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:br_separated_entries\" to=\"Module:Br separated entries\" /></normalized><pages><page pageid=\"39891097\" ns=\"828\" title=\"Module:Br separated entries\"><revisions><rev\
      \ user=\"Mr. Stradivarius\" timestamp=\"2013-11-15T15:08:56Z\" comment=\"Changed protection level of Module:Br separated entries: [[Wikipedia:Lua/Modules|High-risk Lua module]]: allow template editors ([Edit=Allow only template editors and admins] (indefinite)\
      \ [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">local p = {}\n\nlocal function _main( args )\n    local sep = '&lt;br /&gt;'\n    local lastsep\n    local t\
      \ = {}\n    for i, v in ipairs( args ) do\n        table.insert( t, v )\n        if mw.ustring.match( v, '%S' ) then\n            table.insert( t, sep )\n            lastsep = #t\n        end\n    end\n    if lastsep then\n        table.remove( t, lastsep\
      \ )\n    end\n    return table.concat( t )\nend\n\nfunction p.main( frame )\n    local origArgs\n    if frame == mw.getCurrentFrame() then\n        -- We're being called via #invoke. If the invoking template passed any arguments,\n        -- use them.\
      \ Otherwise, use the arguments that were passed into the template.\n        origArgs = frame:getParent().args\n        for k, v in pairs( frame.args ) do\n            origArgs = frame.args\n            break\n        end\n    else        \n        -- We're\
      \ being called from another module or from the debug console, so assume\n        -- the arguments are passed in directly.\n        origArgs = frame\n    end\n    \n    -- Use integer args only, and allow for explicit positional arguments\n    -- that are\
      \ specified out of order, e.g. {{br separated entries|3=entry3}}.\n    -- After processing, the args can be accessed accurately from ipairs.\n    local args = {}\n    for k, v in pairs( origArgs ) do\n        if type( k ) == 'number' and k &gt;= 1 and\
      \ math.floor( k ) == k then\n            table.insert( args, k )\n        end\n    end\n    table.sort( args )\n    for i,v in ipairs( args ) do\n        args[ i ] = origArgs[ v ]\n    end\n    \n    return _main( args )\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:38.130Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AInfoboxImage&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:38 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103539383, 3298509714, 4115578455
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38581924\" ns=\"828\" title=\"Module:InfoboxImage\"><revisions><rev user=\"Jackmcbarn\" timestamp=\"2014-10-24T22:44:21Z\" comment=\"add a sanity check to help debug an intermittent\
      \ error\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- Inputs:\n--    image - Can either be a bare filename (with or without the File:/Image: prefix) or a fully formatted image link\n--    size - size to display the\
      \ image\n--    maxsize - maximum size for image\n--    sizedefault - default size to display the image if size param is blank\n--    alt - alt text for image\n--    title - title text for image\n--    border - set to yes if border\n--    center - set to\
      \ yes, if the image has to be centered\n--    upright - upright image param\n--    suppressplaceholder - if yes then checks to see if image is a placeholder and suppresses it\n--    link - page to visit when clicking on image\n-- Outputs:\n--    Formatted\
      \ image.\n-- More details available at the &quot;Module:InfoboxImage/doc&quot; page\n\nlocal i = {};\n\nlocal placeholder_image = {\n    &quot;Blue - Replace this image female.svg&quot;,\n    &quot;Blue - Replace this image male.svg&quot;,\n    &quot;Female\
      \ no free image yet.png&quot;,\n    &quot;Flag of None (square).svg&quot;,\n    &quot;Flag of None.svg&quot;,\n    &quot;Flag of.svg&quot;,\n    &quot;Green - Replace this image female.svg&quot;,\n    &quot;Green - Replace this image male.svg&quot;,\n\
      \    &quot;Image is needed female.svg&quot;,\n    &quot;Image is needed male.svg&quot;,\n    &quot;Location map of None.svg&quot;,\n    &quot;Male no free image yet.png&quot;,\n    &quot;Missing flag.png&quot;,\n    &quot;No flag.svg&quot;,\n    &quot;No\
      \ free portrait.svg&quot;,\n    &quot;No portrait (female).svg&quot;,\n    &quot;No portrait (male).svg&quot;,\n    &quot;Red - Replace this image female.svg&quot;,\n    &quot;Red - Replace this image male.svg&quot;,\n    &quot;Replace this image female\
      \ (blue).svg&quot;,\n    &quot;Replace this image female.svg&quot;,\n    &quot;Replace this image male (blue).svg&quot;,\n    &quot;Replace this image male.svg&quot;,\n    &quot;Silver - Replace this image female.svg&quot;,\n    &quot;Silver - Replace\
      \ this image male.svg&quot;,\n    &quot;Replace this image.svg&quot;,\n\t&quot;Cricket no pic.png&quot;,\n\t&quot;CarersLogo.gif&quot;,\n\t&quot;Diagram Needed.svg&quot;,\n\t&quot;Example.jpg&quot;,\n\t&quot;Image placeholder.png&quot;,\n\t&quot;No male\
      \ portrait.svg&quot;,\n\t&quot;Nocover-upload.png&quot;,\n\t&quot;NoDVDcover copy.png&quot;,\n\t&quot;Noribbon.svg&quot;,\n\t&quot;No portrait-BFD-test.svg&quot;,\n\t&quot;Placeholder barnstar ribbon.png&quot;,\n\t&quot;Project Trains no image.png&quot;,\n\
      \t&quot;Image-request.png&quot;,\n\t&quot;Sin bandera.svg&quot;,\n\t&quot;Sin escudo.svg&quot;,\n\t&quot;Replace this image - temple.png&quot;,\n\t&quot;Replace this image butterfly.png&quot;,\n\t&quot;Replace this image.svg&quot;,\n\t&quot;Replace this\
      \ image1.svg&quot;,\n\t&quot;Resolution angle.png&quot;,\n\t&quot;Image-No portrait-text-BFD-test.svg&quot;,\n\t&quot;Insert image here.svg&quot;,\n\t&quot;No image available.png&quot;,\n\t&quot;NO IMAGE YET square.png&quot;,\n\t&quot;NO IMAGE YET.png&quot;,\n\
      \t&quot;No Photo Available.svg&quot;,\n\t&quot;No Screenshot.svg&quot;,\n\t&quot;No-image-available.jpg&quot;,\n\t&quot;Null.png&quot;,\n\t&quot;PictureNeeded.gif&quot;,\n\t&quot;Place holder.jpg&quot;,\n\t&quot;Unbenannt.JPG&quot;,\n\t&quot;UploadACopyrightFreeImage.svg&quot;,\n\
      \t&quot;UploadAnImage.gif&quot;,\n\t&quot;UploadAnImage.svg&quot;,\n\t&quot;UploadAnImageShort.svg&quot;,\n\t&quot;CarersLogo.gif&quot;,\n\t&quot;Diagram Needed.svg&quot;,\n\t&quot;No male portrait.svg&quot;,\n\t&quot;NoDVDcover copy.png&quot;,\n\t&quot;Placeholder\
      \ barnstar ribbon.png&quot;,\n\t&quot;Project Trains no image.png&quot;,\n\t&quot;Image-request.png&quot;,\n}\n\nfunction i.IsPlaceholder(image)\n    -- change underscores to spaces\n    image = mw.ustring.gsub(image, &quot;_&quot;, &quot; &quot;);\n \
      \   assert(image ~= nil, 'mw.ustring.gsub must not return nil')\n    -- if image starts with [[ then remove that and anything after |\n    if mw.ustring.sub(image,1,2) == &quot;[[&quot; then\n        image = mw.ustring.sub(image,3);\n        image = mw.ustring.gsub(image,\
      \ &quot;([^|]*)|.*&quot;, &quot;%1&quot;);\n    end\n    -- Trim spaces\n    image = mw.ustring.gsub(image, '^[ ]*(.-)[ ]*$', '%1');\n    -- remove prefix if exists\n    local allNames = mw.site.namespaces[6].aliases\n    allNames[#allNames + 1] = mw.site.namespaces[6].name\n\
      \    allNames[#allNames + 1] = mw.site.namespaces[6].canonicalName\n    for i, name in ipairs(allNames) do\n        if mw.ustring.lower(mw.ustring.sub(image, 1, mw.ustring.len(name) + 1)) == mw.ustring.lower(name .. &quot;:&quot;) then\n            image\
      \ = mw.ustring.sub(image, mw.ustring.len(name) + 2);\n            break\n        end\n    end\n    -- Trim spaces\n    image = mw.ustring.gsub(image, '^[ ]*(.-)[ ]*$', '%1');\n    -- capitalise first letter\n    image = mw.ustring.upper(mw.ustring.sub(image,1,1))\
      \ .. mw.ustring.sub(image,2);\n\n    for i,j in pairs(placeholder_image) do\n        if image == j then\n            return true\n        end\n    end\n    return false\nend\n\nfunction i.InfoboxImage(frame)\n    local image = frame.args[&quot;image&quot;];\n\
      \    \n    if image == &quot;&quot; or image == nil then\n        return &quot;&quot;;\n    end\n    if image == &quot;&amp;nbsp;&quot; then\n        return image;\n    end\n    if frame.args[&quot;suppressplaceholder&quot;] ~= &quot;no&quot; then\n  \
      \      if i.IsPlaceholder(image) == true then\n            return &quot;&quot;;\n        end\n    end\n\n    if mw.ustring.lower(mw.ustring.sub(image,1,5)) == &quot;http:&quot; then\n        return &quot;&quot;;\n    end\n    if mw.ustring.lower(mw.ustring.sub(image,1,6))\
      \ == &quot;[http:&quot; then\n        return &quot;&quot;;\n    end\n    if mw.ustring.lower(mw.ustring.sub(image,1,7)) == &quot;[[http:&quot; then\n        return &quot;&quot;;\n    end\n    if mw.ustring.lower(mw.ustring.sub(image,1,6)) == &quot;https:&quot;\
      \ then\n        return &quot;&quot;;\n    end\n    if mw.ustring.lower(mw.ustring.sub(image,1,7)) == &quot;[https:&quot; then\n        return &quot;&quot;;\n    end\n    if mw.ustring.lower(mw.ustring.sub(image,1,8)) == &quot;[[https:&quot; then\n    \
      \    return &quot;&quot;;\n    end\n\n    if mw.ustring.sub(image,1,2) == &quot;[[&quot; then\n        -- search for thumbnail images and add to tracking cat if found\n        if mw.title.getCurrentTitle().namespace == 0 and (mw.ustring.find(image, &quot;|%s*thumb%s*[|%]]&quot;)\
      \ or mw.ustring.find(image, &quot;|%s*thumbnail%s*[|%]]&quot;)) then\n            return image .. &quot;[[Category:Pages using infoboxes with thumbnail images]]&quot;;\n        else\n            return image;\n        end\n    elseif mw.ustring.sub(image,1,2)\
      \ == &quot;{{&quot; and mw.ustring.sub(image,1,3) ~= &quot;{{{&quot; then\n        return image;\n    elseif mw.ustring.sub(image,1,1) == &quot;&lt;&quot; then\n        return image;\n    elseif mw.ustring.sub(image,1,5) == mw.ustring.char(127)..&quot;UNIQ&quot;\
      \ then\n        -- Found strip marker at begining, so pass don't process at all\n        return image;\n    else\n        local result = &quot;&quot;;\n        local size = frame.args[&quot;size&quot;];\n        local maxsize = frame.args[&quot;maxsize&quot;];\n\
      \        local sizedefault = frame.args[&quot;sizedefault&quot;];\n        local alt = frame.args[&quot;alt&quot;];\n        local link = frame.args[&quot;link&quot;];\n        local title = frame.args[&quot;title&quot;];\n        local border = frame.args[&quot;border&quot;];\n\
      \        local upright = frame.args[&quot;upright&quot;] or &quot;&quot;;\n        local thumbtime = frame.args[&quot;thumbtime&quot;] or &quot;&quot;;\n        local center= frame.args[&quot;center&quot;];\n        \n        -- remove prefix if exists\n\
      \        local allNames = mw.site.namespaces[6].aliases\n        allNames[#allNames + 1] = mw.site.namespaces[6].name\n        allNames[#allNames + 1] = mw.site.namespaces[6].canonicalName\n        for i, name in ipairs(allNames) do\n            if mw.ustring.lower(mw.ustring.sub(image,\
      \ 1, mw.ustring.len(name) + 1)) == mw.ustring.lower(name .. &quot;:&quot;) then\n                image = mw.ustring.sub(image, mw.ustring.len(name) + 2);\n                break\n            end\n        end\n        \n        if maxsize ~= &quot;&quot;\
      \ and maxsize ~= nil then\n            -- if no sizedefault then set to maxsize\n            if sizedefault == &quot;&quot; or sizedefault == nil then\n                sizedefault = maxsize\n            end\n            -- check to see if size bigger than\
      \ maxsize\n            if size ~= &quot;&quot; and size ~= nil then\n                local sizenumber = tonumber(mw.ustring.match(size,&quot;%d*&quot;)) or 0;\n                local maxsizenumber = tonumber(mw.ustring.match(maxsize,&quot;%d*&quot;)) or\
      \ 0;\n                if sizenumber&gt;maxsizenumber and maxsizenumber&gt;0 then\n                    size = maxsize;\n                end\n            end\n        end\n        -- add px to size if just a number\n        if (tonumber(size) or 0) &gt;\
      \ 0 then\n            size = size .. &quot;px&quot;;\n        end\n        \n        result = &quot;[[File:&quot; .. image;\n        if size ~= &quot;&quot; and size ~= nil then\n            result = result .. &quot;|&quot; .. size;\n        elseif sizedefault\
      \ ~= &quot;&quot; and sizedefault ~= nil then\n            result = result .. &quot;|&quot; .. sizedefault;\n        else\n            result = result .. &quot;|frameless&quot;;\n        end\n        if center == &quot;yes&quot; then\n            result\
      \ = result .. &quot;|center&quot;\n        end\n        if alt ~= &quot;&quot; and alt ~= nil then\n            result = result .. &quot;|alt=&quot; .. alt;\n        end\n        if link ~= &quot;&quot; and link ~= nil then\n            result = result\
      \ .. &quot;|link=&quot; .. link;\n        end\n        if border == &quot;yes&quot; then\n            result = result .. &quot;|border&quot;;\n        end\n        if upright ~= &quot;&quot; then\n            result = result .. &quot;|upright=&quot; ..\
      \ upright;\n        end\n        if thumbtime ~= &quot;&quot; then\n            result = result .. &quot;|thumbtime=&quot; .. thumbtime;\n        end\n        if title ~= &quot;&quot; and title ~= nil then\n            result = result .. &quot;|&quot;\
      \ .. title;\n        elseif alt ~= &quot;&quot; and alt ~= nil then\n            result = result .. &quot;|&quot; .. alt;\n        end\n        result = result .. &quot;]]&quot;;\n        \n        return result;\n    end\nend\n\nreturn i;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:38.444Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALongitem&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:38 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq31 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103540089, 882882892, 4115579034
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="38040101" ns="10" title="Template:Longitem"><revisions><rev user="Sardanaphalus" timestamp="2014-08-22T19:07:18Z" comment="surplus space" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;div style=&quot;padding:0.1em 0;line-height:1.2em;{{{style|{{#if:{{{2|}}}|{{{1}}}}}}}}&quot;&gt;{{#if:{{{2|}}}|{{{2}}}|{{{1}}}}}&lt;/div&gt;&lt;noinclude&gt;{{Documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:38.770Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AInfobox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:38 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq61 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025910011, 3811670334, 4115579276
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="891845" ns="10" title="Template:Infobox"><revisions><rev user="Nihiltres" timestamp="2014-01-10T23:01:27Z" comment="Undid revision 590143379 by [[Special:Contributions/Kaldari|Kaldari]] ([[User talk:Kaldari|talk]]); breaks everything" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Infobox|infobox}}&lt;noinclude&gt;

      {{documentation}}
      &lt;!-- Categories go in the /doc subpage, and interwikis go in Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:39.326Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AInfobox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:39 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025910331, 3589305948, 4115579610
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38808424\" ns=\"828\" title=\"Module:Infobox\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-11-01T01:33:05Z\" comment=\"add a missing rowstyle per protected\
      \ edit request by [[User:Frietjes]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--\n-- This module implements {{Infobox}}\n--\n \nlocal p = {}\n\nlocal args = {}\nlocal origArgs\nlocal root\n\nlocal function union(t1,\
      \ t2)\n    -- Returns the union of the values of two tables, as a sequence.\n    local vals = {}\n    for k, v in pairs(t1) do\n        vals[v] = true\n    end\n    for k, v in pairs(t2) do\n        vals[v] = true\n    end\n    local ret = {}\n    for\
      \ k, v in pairs(vals) do\n        table.insert(ret, k)\n    end\n    return ret\nend\n\nlocal function getArgNums(prefix)\n    -- Returns a table containing the numbers of the arguments that exist\n    -- for the specified prefix. For example, if the prefix\
      \ was 'data', and\n    -- 'data1', 'data2', and 'data5' exist, it would return {1, 2, 5}.\n    local nums = {}\n    for k, v in pairs(args) do\n        local num = tostring(k):match('^' .. prefix .. '([1-9]%d*)$')\n        if num then table.insert(nums,\
      \ tonumber(num)) end\n    end\n    table.sort(nums)\n    return nums\nend\n\nlocal function addRow(rowArgs)\n    -- Adds a row to the infobox, with either a header cell\n    -- or a label/data cell combination.\n    if rowArgs.header then\n        root\n\
      \            :tag('tr')\n                :addClass(rowArgs.rowclass)\n                :cssText(rowArgs.rowstyle)\n                :attr('id', rowArgs.rowid)\n                :tag('th')\n                    :attr('colspan', 2)\n                    :attr('id',\
      \ rowArgs.headerid)\n                    :addClass(rowArgs.class)\n                    :addClass(args.headerclass)\n                    :css('text-align', 'center')\n                    :cssText(args.headerstyle)\n                    :wikitext(rowArgs.header)\n\
      \    elseif rowArgs.data then\n        local row = root:tag('tr')\n        row:addClass(rowArgs.rowclass)\n        row:cssText(rowArgs.rowstyle)\n        row:attr('id', rowArgs.rowid)\n        if rowArgs.label then\n            row\n                :tag('th')\n\
      \                    :attr('scope', 'row')\n                    :attr('id', rowArgs.labelid)\n                    :css('text-align', 'left')\n                    :cssText(args.labelstyle)\n                    :wikitext(rowArgs.label)\n                \
      \    :done()\n        end\n        \n        local dataCell = row:tag('td')\n        if not rowArgs.label then \n            dataCell\n                :attr('colspan', 2)\n                :css('text-align', 'center') \n        end\n        dataCell\n \
      \           :attr('id', rowArgs.dataid)\n            :addClass(rowArgs.class)\n            :cssText(rowArgs.datastyle)\n            :newline()\n            :wikitext(rowArgs.data)\n    end\nend\n\nlocal function renderTitle()\n    if not args.title then\
      \ return end\n\n    root\n        :tag('caption')\n            :addClass(args.titleclass)\n            :cssText(args.titlestyle)\n            :wikitext(args.title)\nend\n\nlocal function renderAboveRow()\n    if not args.above then return end\n    \n \
      \   root\n        :tag('tr')\n            :tag('th')\n                :attr('colspan', 2)\n                :addClass(args.aboveclass)\n                :css('text-align', 'center')\n                :css('font-size', '125%')\n                :css('font-weight',\
      \ 'bold')\n                :cssText(args.abovestyle)\n                :wikitext(args.above)\nend\n\nlocal function renderBelowRow()\n    if not args.below then return end\n    \n    root\n        :tag('tr')\n            :tag('td')\n                :attr('colspan',\
      \ '2')\n                :addClass(args.belowclass)\n                :css('text-align', 'center')\n                :cssText(args.belowstyle)\n                :newline()\n                :wikitext(args.below)\nend\n\nlocal function renderSubheaders()\n \
      \   if args.subheader then\n        args.subheader1 = args.subheader\n    end\n    if args.subheaderrowclass then\n        args.subheaderrowclass1 = args.subheaderrowclass\n    end\n    local subheadernums = getArgNums('subheader')\n    for k, num in ipairs(subheadernums)\
      \ do\n        addRow({\n            data = args['subheader' .. tostring(num)],\n            datastyle = args.subheaderstyle or args['subheaderstyle' .. tostring(num)],\n            class = args.subheaderclass,\n            rowclass = args['subheaderrowclass'\
      \ .. tostring(num)]\n        })\n    end\nend\n\nlocal function renderImages()\n    if args.image then\n        args.image1 = args.image\n    end\n    if args.caption then\n        args.caption1 = args.caption\n    end\n    local imagenums = getArgNums('image')\n\
      \    for k, num in ipairs(imagenums) do\n        local caption = args['caption' .. tostring(num)]\n        local data = mw.html.create():wikitext(args['image' .. tostring(num)])\n        if caption then\n            data\n                :tag('div')\n\
      \                    :cssText(args.captionstyle)\n                    :wikitext(caption)\n        end\n        addRow({\n            data = tostring(data),\n            datastyle = args.imagestyle,\n            class = args.imageclass,\n            rowclass\
      \ = args['imagerowclass' .. tostring(num)]\n        })\n    end\nend\n\nlocal function renderRows()\n    -- Gets the union of the header and data argument numbers,\n    -- and renders them all in order using addRow.\n    local rownums = union(getArgNums('header'),\
      \ getArgNums('data'))\n    table.sort(rownums)\n    for k, num in ipairs(rownums) do\n        addRow({\n            header = args['header' .. tostring(num)],\n            label = args['label' .. tostring(num)],\n            data = args['data' .. tostring(num)],\n\
      \            datastyle = args.datastyle,\n            class = args['class' .. tostring(num)],\n            rowclass = args['rowclass' .. tostring(num)],\n            rowstyle = args['rowstyle' .. tostring(num)],\n            dataid = args['dataid' .. tostring(num)],\n\
      \            labelid = args['labelid' .. tostring(num)],\n            headerid = args['headerid' .. tostring(num)],\n            rowid = args['rowid' .. tostring(num)]\n        })\n    end\nend\n\nlocal function renderNavBar()\n    if not args.name then\
      \ return end\n    \n    root\n        :tag('tr')\n            :tag('td')\n                :attr('colspan', '2')\n                :css('text-align', 'right')\n                :wikitext(mw.getCurrentFrame():expandTemplate({ \n                    title =\
      \ 'navbar', \n                    args = { args.name, mini = 1 }\n                }))\nend\n\nlocal function renderItalicTitle()\n    local italicTitle = args['italic title'] and mw.ustring.lower(args['italic title'])\n    if italicTitle == '' or italicTitle\
      \ == 'force' or italicTitle == 'yes' then\n        root:wikitext(mw.getCurrentFrame():expandTemplate({title = 'italic title'}))\n    end\nend\n\nlocal function renderTrackingCategories()\n    if args.decat ~= 'yes' then\n        if #(getArgNums('data'))\
      \ == 0 and mw.title.getCurrentTitle().namespace == 0 then\n            root:wikitext('[[Category:Articles which use infobox templates with no data rows]]')\n        end\n        if args.child == 'yes' and args.title then\n            root:wikitext('[[Category:Articles\
      \ which use embedded infobox templates with the title parameter]]')\n        end\n    end\nend\n\nlocal function _infobox()\n    -- Specify the overall layout of the infobox, with special settings\n    -- if the infobox is used as a 'child' inside another\
      \ infobox.\n    if args.child ~= 'yes' then\n        root = mw.html.create('table')\n        \n        root\n            :addClass('infobox')\n            :addClass(args.bodyclass)\n            :css('border-spacing', '3px')\n            \n            if\
      \ args.subbox == 'yes' then\n                root\n                    :css('padding', '0')\n                    :css('border', 'none')\n                    :css('margin', '-3px')\n                    :css('width', 'auto')\n                    :css('min-width',\
      \ '100%')\n                    :css('font-size', '100%')\n                    :css('clear', 'none')\n                    :css('float', 'none')\n                    :css('background-color', 'transparent')\n            else\n                root\n      \
      \              :css('width', '22em')\n            end\n        root\n            :cssText(args.bodystyle)\n    \n        renderTitle()\n        renderAboveRow()\n    else\n        root = mw.html.create()\n        \n        root\n            :wikitext(args.title)\n\
      \    end\n\n    renderSubheaders()\n    renderImages() \n    renderRows() \n    renderBelowRow()  \n    renderNavBar()\n    renderItalicTitle()\n    renderTrackingCategories()\n    \n    return tostring(root)\nend\n\nlocal function preprocessSingleArg(argName)\n\
      \    -- If the argument exists and isn't blank, add it to the argument table.\n    -- Blank arguments are treated as nil to match the behaviour of ParserFunctions.\n    if origArgs[argName] and origArgs[argName] ~= '' then\n        args[argName] = origArgs[argName]\n\
      \    end\nend\n\nlocal function preprocessArgs(prefixTable, step)\n    -- Assign the parameters with the given prefixes to the args table, in order, in batches\n    -- of the step size specified. This is to prevent references etc. from appearing in the\n\
      \    -- wrong order. The prefixTable should be an array containing tables, each of which has\n    -- two possible fields, a &quot;prefix&quot; string and a &quot;depend&quot; table. The function always parses\n    -- parameters containing the &quot;prefix&quot;\
      \ string, but only parses parameters in the &quot;depend&quot;\n    -- table if the prefix parameter is present and non-blank.\n    if type(prefixTable) ~= 'table' then\n        error(&quot;Non-table value detected for the prefix table&quot;, 2)\n    end\n\
      \    if type(step) ~= 'number' then\n        error(&quot;Invalid step value detected&quot;, 2)\n    end\n    \n    -- Get arguments without a number suffix, and check for bad input.\n    for i,v in ipairs(prefixTable) do\n        if type(v) ~= 'table'\
      \ or type(v.prefix) ~= &quot;string&quot; or (v.depend and type(v.depend) ~= 'table') then\n            error('Invalid input detected to preprocessArgs prefix table', 2)\n        end\n        preprocessSingleArg(v.prefix)\n        -- Only parse the depend\
      \ parameter if the prefix parameter is present and not blank.\n        if args[v.prefix] and v.depend then\n            for j, dependValue in ipairs(v.depend) do\n                if type(dependValue) ~= 'string' then\n                    error('Invalid\
      \ &quot;depend&quot; parameter value detected in preprocessArgs')\n                end\n                preprocessSingleArg(dependValue)\n            end\n        end\n    end\n\n    -- Get arguments with number suffixes.\n    local a = 1 -- Counter variable.\n\
      \    local moreArgumentsExist = true\n    while moreArgumentsExist == true do\n        moreArgumentsExist = false\n        for i = a, a + step - 1 do\n            for j,v in ipairs(prefixTable) do\n                local prefixArgName = v.prefix .. tostring(i)\n\
      \                if origArgs[prefixArgName] then\n                    moreArgumentsExist = true -- Do another loop if any arguments are found, even blank ones.\n                    preprocessSingleArg(prefixArgName)\n                end\n             \
      \   -- Process the depend table if the prefix argument is present and not blank, or\n                -- we are processing &quot;prefix1&quot; and &quot;prefix&quot; is present and not blank, and\n                -- if the depend table is present.\n   \
      \             if v.depend and (args[prefixArgName] or (i == 1 and args[v.prefix])) then\n                    for j,dependValue in ipairs(v.depend) do\n                        local dependArgName = dependValue .. tostring(i)\n                        preprocessSingleArg(dependArgName)\n\
      \                    end\n                end\n            end\n        end\n        a = a + step\n    end\nend\n \nfunction p.infobox(frame)\n    -- If called via #invoke, use the args passed into the invoking template.\n    -- Otherwise, for testing\
      \ purposes, assume args are being passed directly in.\n    if frame == mw.getCurrentFrame() then\n        origArgs = frame:getParent().args\n    else\n        origArgs = frame\n    end\n    \n    -- Parse the data parameters in the same order that the\
      \ old {{infobox}} did, so that\n    -- references etc. will display in the expected places. Parameters that depend on\n    -- another parameter are only processed if that parameter is present, to avoid\n    -- phantom references appearing in article reference\
      \ lists.\n    preprocessSingleArg('child')\n    preprocessSingleArg('bodyclass')\n    preprocessSingleArg('subbox')\n    preprocessSingleArg('bodystyle')\n    preprocessSingleArg('title')\n    preprocessSingleArg('titleclass')\n    preprocessSingleArg('titlestyle')\n\
      \    preprocessSingleArg('above')\n    preprocessSingleArg('aboveclass')\n    preprocessSingleArg('abovestyle')\n    preprocessArgs({\n        {prefix = 'subheader', depend = {'subheaderstyle', 'subheaderrowclass'}}\n    }, 10)\n    preprocessSingleArg('subheaderstyle')\n\
      \    preprocessSingleArg('subheaderclass')\n    preprocessArgs({\n        {prefix = 'image', depend = {'caption', 'imagerowclass'}}\n    }, 10)\n    preprocessSingleArg('captionstyle')\n    preprocessSingleArg('imagestyle')\n    preprocessSingleArg('imageclass')\n\
      \    preprocessArgs({\n        {prefix = 'header'},\n        {prefix = 'data', depend = {'label'}},\n        {prefix = 'rowclass'},\n        {prefix = 'rowstyle'},\n        {prefix = 'class'},\n        {prefix = 'dataid'},\n        {prefix = 'labelid'},\n\
      \        {prefix = 'headerid'},\n        {prefix = 'rowid'}\n    }, 50)\n    preprocessSingleArg('headerclass')\n    preprocessSingleArg('headerstyle')\n    preprocessSingleArg('labelstyle')\n    preprocessSingleArg('datastyle')\n    preprocessSingleArg('below')\n\
      \    preprocessSingleArg('belowclass')\n    preprocessSingleArg('belowstyle')\n    preprocessSingleArg('name')\n    args['italic title'] = origArgs['italic title'] -- different behaviour if blank or absent\n    preprocessSingleArg('decat')\n \n    return\
      \ _infobox()\nend\n \nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:39.771Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Amain+other&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:39 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348997679, 952155186, 4115579849
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Template:main other\" to=\"Template:Main other\" /></normalized><pages><page pageid=\"17220251\" ns=\"10\" title=\"Template:Main other\"><revisions><rev user=\"WOSlinker\"\
      \ timestamp=\"2010-10-04T14:46:48Z\" comment=\"remove {{pp-template}}\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{#switch:\n  &lt;!--If no or empty &quot;demospace&quot; parameter then detect namespace--&gt;\n  {{#if:{{{demospace|}}}\
      \ \n  | {{lc: {{{demospace}}} }}    &lt;!--Use lower case &quot;demospace&quot;--&gt;\n  | {{#ifeq:{{NAMESPACE}}|{{ns:0}}\n    | main\n    | other\n    }} \n  }}\n| main     = {{{1|}}}\n| other\n| #default = {{{2|}}}\n}}&lt;noinclude&gt;\n\n{{documentation}}\n\
      &lt;!-- Add categories and interwikis to the /doc subpage, not here! --&gt;\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:40.052Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+web&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:40 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055698518, 269550572, 4115580281
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite web" to="Template:Cite web" /></normalized><pages><page pageid="4148498" ns="10" title="Template:Cite web"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:56:36Z" comment="Changed protection level of Template:Cite web: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=web
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:40.696Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Ayoutube&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:40 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 348998565, 1470638162, 4115580544
    body: '<?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:youtube" to="Template:Youtube" /></normalized><pages><page pageid="6921498" ns="10" title="Template:Youtube"><revisions><rev user="WOSlinker" timestamp="2013-10-19T20:46:34Z"
      comment="Changed protection level of Template:Youtube: allow template editors to modify ([Edit=Protected template] (indefinite) [Move=Protected template] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT
      [[Template:YouTube]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:11:41.042Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AYouTube&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:41 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227039618, 319088498, 4115580880
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="5579775" ns="10" title="Template:YouTube"><revisions><rev user="Zyxw" timestamp="2014-09-14T10:18:53Z" comment="Remove any leading spaces from 1st unnamed parameter that would break link. Tested first with [[Template:YouTube/sandbox]] and [[Template:YouTube/testcases]]." contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">[https://www.youtube.com/{{#if:{{{user|{{{u|{{{channel|}}}}}}}}}
       |user/{{{user|{{{u|{{{channel|}}}}}}}}} {{{title|{{#if:{{{1|}}}|{{{1}}}|{{PAGENAME}}}}}}}'s channel]
       |{{#if:{{{s|{{{show|}}}}}}
        |show/{{{s|{{{show|}}}}}} {{{title|{{#if:{{{1|}}}|{{{1}}}|''{{PAGENAME}}''}}}}}] show
        |{{#if:{{{sid|{{{showid|}}}}}}
         |show?p={{{sid|{{{showid|}}}}}} {{{title|{{#if:{{{1|}}}|{{{1}}}|''{{PAGENAME}}''}}}}}] show
         |watch?v={{{id|{{Trim|{{{1|}}}}}}}} {{{title|{{#if:{{{2|}}}|{{{2}}}|Video}}}}}]
        }}
       }}
      }} on {{#ifeq:{{{link}}}|no
       |YouTube
       |[[YouTube]]
      }}&lt;noinclude&gt;{{documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:41.614Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Apt+icon&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:41 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404127637, 290973243, 4115581329
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:pt icon" to="Template:Pt icon" /></normalized><pages><page pageid="2004642" ns="10" title="Template:Pt icon"><revisions><rev user="Plastikspork" timestamp="2013-10-19T16:51:14Z" comment="Fix" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Language icon|pt|Portuguese}}&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:41.995Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALanguage+icon&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:42 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq54 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227041201, 217018231, 4115581976
    body: '<?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="40797933" ns="10" title="Template:Language icon"><revisions><rev user="Anthony Appleyard" timestamp="2013-10-15T08:22:12Z" comment="Anthony Appleyard moved page [[Template:Language
      icon]] to [[Template:Link language]]: Requested at [[WP:RM]] as uncontroversial ([[Special:Permalink/577248632|permalink]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Link language]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:11:42.608Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALink+language&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:42 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103547033, 2402511679, 4115582556
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="3483283" ns="10" title="Template:Link language"><revisions><rev user="Anthony Appleyard" timestamp="2013-10-15T08:22:10Z" comment="Anthony Appleyard moved page [[Template:Language icon]] to [[Template:Link language]]: Requested at [[WP:RM]] as uncontroversial ([[Special:Permalink/577248632|permalink]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#ifexist:Template:ISO 639 name {{{1&lt;noinclude&gt;|&lt;/noinclude&gt;}}}
       |&lt;span class=&quot;languageicon&quot; style=&quot;font-size:0.95em; font-weight:bold; color:#555;&quot;&gt;({{ISO 639 name {{{1}}}}})&lt;/span&gt;{{category handler
        |main={{#ifeq:{{{1|}}}|en||[[Category:Articles with {{ISO 639 name {{{1}}}}}-language external links]]}}
       }}
       |{{error|Invalid language code.}}
      }}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:43.155Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AISO+639+name+pt&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:43 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025915849, 290974904, 4115583316
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="19087029" ns="10" title="Template:ISO 639 name pt"><revisions><rev user="Nyttend" timestamp="2010-02-28T00:01:38Z" comment="Protected Template:ISO 639 name pt: [[WP:HRT|Highly visible template]]: Without protection, this can be used to vandalise Template:Pt ([edit=sysop] (indefinite) [move=sysop] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">Portuguese&lt;noinclude&gt;
      {{ISO 639 name conversion template doc|{{ISO 639 name pt}}|pt}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:43.769Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:43 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq46 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349003534, 2973969963, 4115583773
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:category handler" to="Template:Category handler" /></normalized><pages><page pageid="25084818" ns="10" title="Template:Category handler"><revisions><rev user="Mr. Stradivarius" timestamp="2013-10-20T10:48:53Z" comment="Changed protection level of Template:Category handler: [[WP:High-risk templates|Highly visible template]]: allow template editors to edit ([Edit=Protected template] (indefinite) [Move=Protected template] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Category handler|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Add categories to the /doc subpage, and interwikis to Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:44.993Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory_handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:44 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq32 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103550332, 469355613, 4115584121
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Category_handler\" to=\"Module:Category handler\" /></normalized><pages><page pageid=\"39772274\" ns=\"828\" title=\"Module:Category handler\"><revisions><rev user=\"\
      Mr. Stradivarius\" timestamp=\"2014-07-22T05:08:26Z\" comment=\"allow invocations specifying the page parameter to use the mw.loadData optimisations, and don&#039;t call mw.title.new every time\" contentformat=\"text/plain\" contentmodel=\"Scribunto\"\
      \ xml:space=\"preserve\">--------------------------------------------------------------------------------\n--                                                                            --\n--                              CATEGORY HANDLER              \
      \                --\n--                                                                            --\n--      This module implements the {{category handler}} template in Lua,      --\n--      with a few improvements: all namespaces and all namespace aliases\
      \     --\n--      are supported, and namespace names are detected automatically for     --\n--      the local wiki. This module requires [[Module:Namespace detect]]      --\n--      and [[Module:Yesno]] to be available on the local wiki. It can be    \
      \ --\n--      configured for different wikis by altering the values in              --\n--      [[Module:Category handler/config]], and pages can be blacklisted      --\n--      from categorisation by using [[Module:Category handler/blacklist]].   --\n\
      --                                                                            --\n--------------------------------------------------------------------------------\n\n-- Load required modules\nlocal yesno = require('Module:Yesno')\n\n-- Lazily load things\
      \ we don't always need\nlocal mShared, mappings\n\nlocal p = {}\n\n--------------------------------------------------------------------------------\n-- Helper functions\n--------------------------------------------------------------------------------\n\
      \nlocal function trimWhitespace(s, removeBlanks)\n\tif type(s) ~= 'string' then\n\t\treturn s\n\tend\n\ts = s:match('^%s*(.-)%s*$')\n\tif removeBlanks then\n\t\tif s ~= '' then\n\t\t\treturn s\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn s\n\
      \tend\nend\n\n--------------------------------------------------------------------------------\n-- CategoryHandler class\n--------------------------------------------------------------------------------\n\nlocal CategoryHandler = {}\nCategoryHandler.__index\
      \ = CategoryHandler\n\nfunction CategoryHandler.new(data, args)\n\tlocal obj = setmetatable({ _data = data, _args = args }, CategoryHandler)\n\t\n\t-- Set the title object\n\tdo\n\t\tlocal pagename = obj:parameter('demopage')\n\t\tlocal success, titleObj\n\
      \t\tif pagename then\n\t\t\tsuccess, titleObj = pcall(mw.title.new, pagename)\n\t\tend\n\t\tif success and titleObj then\n\t\t\tobj.title = titleObj\n\t\t\tif titleObj == mw.title.getCurrentTitle() then\n\t\t\t\tobj._usesCurrentTitle = true\n\t\t\tend\n\
      \t\telse\n\t\t\tobj.title = mw.title.getCurrentTitle()\n\t\t\tobj._usesCurrentTitle = true\n\t\tend\n\tend\n\n\t-- Set suppression parameter values\n\tfor _, key in ipairs{'nocat', 'categories'} do\n\t\tlocal value = obj:parameter(key)\n\t\tvalue = trimWhitespace(value,\
      \ true)\n\t\tobj['_' .. key] = yesno(value)\n\tend\n\tdo\n\t\tlocal subpage = obj:parameter('subpage')\n\t\tlocal category2 = obj:parameter('category2')\n\t\tif type(subpage) == 'string' then\n\t\t\tsubpage = mw.ustring.lower(subpage)\n\t\tend\n\t\tif\
      \ type(category2) == 'string' then\n\t\t\tsubpage = mw.ustring.lower(category2)\n\t\tend\n\t\tobj._subpage = trimWhitespace(subpage, true)\n\t\tobj._category2 = trimWhitespace(category2) -- don't remove blank values\n\tend\n\treturn obj\nend\n\nfunction\
      \ CategoryHandler:parameter(key)\n\tlocal parameterNames = self._data.parameters[key]\n\tlocal pntype = type(parameterNames)\n\tif pntype == 'string' or pntype == 'number' then\n\t\treturn self._args[parameterNames]\n\telseif pntype == 'table' then\n\t\
      \tfor _, name in ipairs(parameterNames) do\n\t\t\tlocal value = self._args[name]\n\t\t\tif value ~= nil then\n\t\t\t\treturn value\n\t\t\tend\n\t\tend\n\t\treturn nil\n\telse\n\t\terror(string.format(\n\t\t\t'invalid config key &quot;%s&quot;',\n\t\t\t\
      tostring(key)\n\t\t), 2)\n\tend\nend\n\nfunction CategoryHandler:isSuppressedByArguments()\n\treturn\n\t\t-- See if a category suppression argument has been set.\n\t\tself._nocat == true\n\t\tor self._categories == false\n\t\tor (\n\t\t\tself._category2\n\
      \t\t\tand self._category2 ~= self._data.category2Yes\n\t\t\tand self._category2 ~= self._data.category2Negative\n\t\t)\n\n\t\t-- Check whether we are on a subpage, and see if categories are\n\t\t-- suppressed based on our subpage status.\n\t\tor self._subpage\
      \ == self._data.subpageNo and self.title.isSubpage\n\t\tor self._subpage == self._data.subpageOnly and not self.title.isSubpage\nend\n\nfunction CategoryHandler:shouldSkipBlacklistCheck()\n\t-- Check whether the category suppression arguments indicate\
      \ we\n\t-- should skip the blacklist check.\n\treturn self._nocat == false\n\t\tor self._categories == true\n\t\tor self._category2 == self._data.category2Yes\nend\n\nfunction CategoryHandler:matchesBlacklist()\n\tif self._usesCurrentTitle then\n\t\treturn\
      \ self._data.currentTitleMatchesBlacklist\n\telse\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\treturn mShared.matchesBlacklist(\n\t\t\tself.title.prefixedText,\n\t\t\tmw.loadData('Module:Category handler/blacklist')\n\t\t)\n\
      \tend\nend\n\nfunction CategoryHandler:isSuppressed()\n\t-- Find if categories are suppressed by either the arguments or by\n\t-- matching the blacklist.\n\treturn self:isSuppressedByArguments()\n\t\tor not self:shouldSkipBlacklistCheck() and self:matchesBlacklist()\n\
      end\n\nfunction CategoryHandler:getNamespaceParameters()\n\tif self._usesCurrentTitle then\n\t\treturn self._data.currentTitleNamespaceParameters\n\telse\n\t\tif not mappings then\n\t\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\
      \t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\t\tend\n\t\treturn mShared.getNamespaceParameters(\n\t\t\tself.title,\n\t\t\tmappings\n\t\t)\n\tend\nend\n\nfunction CategoryHandler:namespaceParametersExist()\n\t-- Find\
      \ whether any namespace parameters have been specified.\n\t-- We use the order &quot;all&quot; --&gt; namespace params --&gt; &quot;other&quot; as this is what\n\t-- the old template did.\n\tif self:parameter('all') then\n\t\treturn true\n\tend\n\tif not\
      \ mappings then\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\tend\n\tfor ns, params in pairs(mappings) do\n\t\tfor i, param in ipairs(params) do\n\
      \t\t\tif self._args[param] then\n\t\t\t\treturn true\n\t\t\tend\n\t\tend\n\tend\n\tif self:parameter('other') then\n\t\treturn true\n\tend\n\treturn false\nend\n\nfunction CategoryHandler:getCategories()\n\tlocal params = self:getNamespaceParameters()\n\
      \tlocal nsCategory\n\tfor i, param in ipairs(params) do\n\t\tlocal value = self._args[param]\n\t\tif value ~= nil then\n\t\t\tnsCategory = value\n\t\t\tbreak\n\t\tend\n\tend\n\tif nsCategory ~= nil or self:namespaceParametersExist() then\n\t\t-- Namespace\
      \ parameters exist - advanced usage.\n\t\tif nsCategory == nil then\n\t\t\tnsCategory = self:parameter('other')\n\t\tend\n\t\tlocal ret = {self:parameter('all')}\n\t\tlocal numParam = tonumber(nsCategory)\n\t\tif numParam and numParam &gt;= 1 and math.floor(numParam)\
      \ == numParam then\n\t\t\t-- nsCategory is an integer\n\t\t\tret[#ret + 1] = self._args[numParam]\n\t\telse\n\t\t\tret[#ret + 1] = nsCategory\n\t\tend\n\t\tif #ret &lt; 1 then\n\t\t\treturn nil\n\t\telse\n\t\t\treturn table.concat(ret)\n\t\tend\n\telseif\
      \ self._data.defaultNamespaces[self.title.namespace] then\n\t\t-- Namespace parameters don't exist, simple usage.\n\t\treturn self._args[1]\n\tend\n\treturn nil\nend\n\n--------------------------------------------------------------------------------\n\
      -- Exports\n--------------------------------------------------------------------------------\n\nlocal p = {}\n\nfunction p._exportClasses()\n\t-- Used for testing purposes.\n\treturn {\n\t\tCategoryHandler = CategoryHandler\n\t}\nend\n\nfunction p._main(args,\
      \ data)\n\tdata = data or mw.loadData('Module:Category handler/data')\n\tlocal handler = CategoryHandler.new(data, args)\n\tif handler:isSuppressed() then\n\t\treturn nil\n\tend\n\treturn handler:getCategories()\nend\n\nfunction p.main(frame, data)\n\t\
      data = data or mw.loadData('Module:Category handler/data')\n\tlocal args = require('Module:Arguments').getArgs(frame, {\n\t\twrappers = data.wrappers,\n\t\tvalueFunc = function (k, v)\n\t\t\tv = trimWhitespace(v)\n\t\t\tif type(k) == 'number' then\n\t\t\
      \t\tif v ~= '' then\n\t\t\t\t\treturn v\n\t\t\t\telse\n\t\t\t\t\treturn nil\n\t\t\t\tend\n\t\t\telse\n\t\t\t\treturn v\n\t\t\tend\n\t\tend\n\t})\n\treturn p._main(args, data)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:45.462Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+journal&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:45 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq53 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055708538, 4206024309, 4115585234
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite journal" to="Template:Cite journal" /></normalized><pages><page pageid="4740319" ns="10" title="Template:Cite journal"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:56:56Z" comment="Changed protection level of Template:Cite journal: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Citation/CS1|citation
      |CitationClass=journal
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:46.671Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACitation%2FCS1&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:46 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055709130, 3156590329, 4115585559
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38573037\" ns=\"828\" title=\"Module:Citation/CS1\"><revisions><rev user=\"Trappist the monk\" timestamp=\"2014-10-24T14:36:06Z\" comment=\"Better version of strip_apostrophe_markup()?\"\
      \ contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\nlocal z = {\n\terror_categories = {};\t\t-- for categorizing citations that contain errors\n\terror_ids = {};\n\tmessage_tail = {};\n\tmaintenance_cats = {};\t\t-- for categorizing\
      \ citations that aren't erroneous per se, but could use a little work\n\tproperties_cats = {};\t\t-- for categorizing citations based on certain properties, language of source for instance\n}\n\n-- Whether variable is set or not\nfunction is_set( var )\n\
      \treturn not (var == nil or var == '');\nend\n\n-- First set variable or nil if none\nfunction first_set(...)\n\tlocal list = {...};\n\tfor _, var in pairs(list) do\n\t\tif is_set( var ) then\n\t\t\treturn var;\n\t\tend\n\tend\nend\n\n-- Whether needle\
      \ is in haystack\nfunction inArray( needle, haystack )\n\tif needle == nil then\n\t\treturn false;\n\tend\n\tfor n,v in ipairs( haystack ) do\n\t\tif v == needle then\n\t\t\treturn n;\n\t\tend\n\tend\n\treturn false;\nend\n\n--[[\nCategorize and emit an\
      \ error message when the citation contains one or more deprecated parameters.  Because deprecated parameters (currently |day=, |month=,\n|coauthor=, and |coauthors=) aren't related to each other and because these parameters may be concatenated into the\
      \ variables used by |date= and |author#= (and aliases)\ndetails of which parameter caused the error message are not provided.  Only one error message is emitted regardless of the number of deprecated parameters in the citation.\n]]\nfunction deprecated_parameter()\n\
      \tif true ~= Page_in_deprecated_cat then\t-- if we haven't been here before then set a \n\t\tPage_in_deprecated_cat=true;\t\t-- sticky flag so that if there are more than one deprecated parameter the category is added only once\n\t\ttable.insert( z.message_tail,\
      \ { seterror( 'deprecated_params', {}, true ) } );\t\t-- add error message\n\tend\nend\n\n-- Populates numbered arguments in a message string using an argument table.\nfunction substitute( msg, args )\n--\treturn args and tostring( mw.message.newRawMessage(\
      \ msg, args ) ) or msg;\n\treturn args and mw.message.newRawMessage( msg, args ):plain() or msg;\nend\n\n--[[\nApply kerning to open the space between the quote mark provided by the Module and a leading or trailing quote mark contained in a |title= or\
      \ |chapter= parameter's value.\nThis function will positive kern  either single or double quotes:\n\t&quot;'Unkerned title with leading and trailing single quote marks'&quot;\n\t&quot; 'Kerned title with leading and trailing single quote marks' &quot;\
      \ (in real life the kerning isn't as wide as this example)\n]]\nfunction kern_quotes (str)\n\tlocal left='&lt;span style=&quot;padding-left:0.2em;&quot;&gt;%1&lt;/span&gt;';\t\t-- spacing to use when title contains leading single or double quote mark\n\
      \tlocal right='&lt;span style=&quot;padding-right:0.2em;&quot;&gt;%1&lt;/span&gt;';\t\t-- spacing to use when title contains trailing single or double quote mark\n\t\n\tif  str:match (&quot;^[\\&quot;\\'][^\\']&quot;) then\n\t\tstr = string.gsub( str,\
      \ &quot;^[\\&quot;\\']&quot;, left, 1 );\t\t\t\t-- replace (captured) leading single or double quote with left-side &lt;span&gt;\n\tend\n\tif str:match (&quot;[^\\'][\\&quot;\\']$&quot;) then\n\t\tstr = string.gsub( str, &quot;[\\&quot;\\']$&quot;, right,\
      \ 1 );\t\t\t-- replace (captured) trailing single or double quote with right-side &lt;span&gt;\n\tend\n\treturn str;\nend\n\n--[[--------------------------&lt; F O R M A T _ S C R I P T _ V A L U E &gt;----------------------------------------\n\n|script-title=\
      \ holds title parameters that are not written in Latin based scripts: Chinese, Japanese, Arabic, Hebrew, etc. These scripts should\nnot be italicized and may be written right-to-left.  The value supplied by |script-title= is concatenated onto Title after\
      \ Title has been wrapped\nin italic markup.\n\nRegardless of language, all values provided by |script-title= are wrapped in &lt;bdi&gt;...&lt;/bdi&gt; tags to isolate rtl languages from the English left to right.\n\n|script-title= provides a unique feature.\
      \  The value in |script-title= may be prefixed with a two-character ISO639-1 language code and a colon:\n\t|script-title=ja:*** *** (where * represents a Japanese character)\nSpaces between the two-character code and the colon and the colon and the first\
      \ script character are allowed:\n\t|script-title=ja : *** ***\n\t|script-title=ja: *** ***\n\t|script-title=ja :*** ***\nSpaces preceding the prefix are allowed: |script-title = ja:*** ***\n\nThe prefix is checked for validity.  If it is a valid ISO639-1\
      \ language code, the lang attribute (lang=&quot;ja&quot;) is added to the &lt;bdi&gt; tag so that browsers can\nknow the language the tag contains.  This may help the browser render the script more correctly.  If the prefix is invalid, the lang attribute\n\
      is not added.  At this time there is no error message for this condition.\n\nAt this writing, only |script-title= is supported.  It is anticipated that additional parameters will be created to use this function.\n\nTODO: error messages when prefix is invalid\
      \ ISO639-1 code; when script_value has prefix but no script;\n]]\n\nfunction format_script_value (script_value)\n\tlocal lang='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- initialize to empty string\n\tlocal name;\n\tif script_value:match('^%l%l%s*:') then\t\t\
      \t\t\t\t\t\t\t\t-- if first 3 non-space characters are script language prefix\n\t\tlang = script_value:match('^(%l%l)%s*:%s*%S.*');\t\t\t\t\t\t-- get the language prefix or nil if there is no script\n\t\tif not is_set (lang) then\n\t\t\treturn '';\t\t\t\
      \t\t\t\t\t\t\t\t\t\t\t\t-- script_value was just the prefix so return empty string\n\t\tend\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if we get this far we have prefix and script\n\t\tname = mw.language.fetchLanguageName( lang, &quot;en&quot; );\t\t\t\
      \t\t\t-- get language name so that we can use it to categorize\n\t\tif is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- is prefix a proper ISO 639-1 language code?\n\t\t\tscript_value = script_value:gsub ('^%l%l%s*:%s*', '');\t\t\t\t-- strip prefix from\
      \ script\n\t\t\tif inArray (lang, {'ar', 'ja', 'ko', 'he', 'zh'}) then\t\t\t\t-- is prefix one of these language codes?\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 uses ' .. name .. '-language script ('..lang..')');\t-- categorize in language-specific\
      \ categories\n\t\t\telse\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 uses foreign language script');\t-- use this category as a catchall until language-specific category is available\n\t\t\tend\n\t\t\tlang = ' lang=&quot;' .. lang .. '&quot; ';\t\t\t\
      \t\t\t\t\t\t-- convert prefix into a lang attribute\n\t\telse\n\t\t\tlang = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- invalid so set lang to empty string\n\t\tend\n\tend\n\tscript_value = '&lt;bdi' .. lang .. '&gt;' .. script_value .. '&lt;/bdi&gt;';\t\t\t--\
      \ isolate incase script is rlt\n\n\treturn script_value;\nend\n\n--[[--------------------------&lt; S C R I P T _ C O N C A T E N A T E &gt;------------------------------------------\n\nInitially for |title= and |script-title=, this function concatenates\
      \ those two parameter values after the script value has been \nwrapped in &lt;bdi&gt; tags.\n]]\n\nfunction script_concatenate (title, script)\n\tif is_set (script) then\n\t\tscript = format_script_value (script);\t\t\t\t\t\t\t\t\t-- &lt;bdi&gt; tags,\
      \ lang atribute, categorization, etc; returns empty string on error\n\t\tif is_set (script) then\n\t\t\ttitle = title .. ' ' .. script;\t\t\t\t\t\t\t\t\t\t-- concatenate title and script title\n\t\tend\n\tend\n\treturn title;\nend\n\n-- Wraps a string\
      \ using a message_list configuration taking one argument\nfunction wrap( key, str, lower )\n\tif not is_set( str ) then\n\t\treturn &quot;&quot;;\n\telseif inArray( key, { 'italic-title', 'trans-italic-title' } ) then\n\t\tstr = safeforitalics( str );\n\
      \tend\n\tif lower == true then\n\t\treturn substitute( cfg.messages[key]:lower(), {str} );\n\telse\n\t\treturn substitute( cfg.messages[key], {str} );\n\tend\t\t\nend\n\n--[[\nArgument wrapper.  This function provides support for argument \nmapping defined\
      \ in the configuration file so that multiple names\ncan be transparently aliased to single internal variable.\n]]\nfunction argument_wrapper( args )\n\tlocal origin = {};\n\t\n\treturn setmetatable({\n\t\tORIGIN = function( self, k )\n\t\t\tlocal dummy\
      \ = self[k]; --force the variable to be loaded.\n\t\t\treturn origin[k];\n\t\tend\n\t},\n\t{\n\t\t__index = function ( tbl, k )\n\t\t\tif origin[k] ~= nil then\n\t\t\t\treturn nil;\n\t\t\tend\n\t\t\t\n\t\t\tlocal args, list, v = args, cfg.aliases[k];\n\
      \t\t\t\n\t\t\tif type( list ) == 'table' then\n\t\t\t\tv, origin[k] = selectone( args, list, 'redundant_parameters' );\n\t\t\t\tif origin[k] == nil then\n\t\t\t\t\torigin[k] = ''; -- Empty string, not nil\n\t\t\t\tend\n\t\t\telseif list ~= nil then\n\t\
      \t\t\tv, origin[k] = args[list], list;\n\t\t\telse\n\t\t\t\t-- maybe let through instead of raising an error?\n\t\t\t\t-- v, origin[k] = args[k], k;\n\t\t\t\terror( cfg.messages['unknown_argument_map'] );\n\t\t\tend\n\t\t\t\n\t\t\t-- Empty strings, not\
      \ nil;\n\t\t\tif v == nil then\n\t\t\t\tv = cfg.defaults[k] or '';\n\t\t\t\torigin[k] = '';\n\t\t\tend\n\t\t\t\n\t\t\ttbl = rawset( tbl, k, v );\n\t\t\treturn v;\n\t\tend,\n\t});\nend\n\n--[[\nLooks for a parameter's name in the whitelist.\n\nParameters\
      \ in the whitelist can have three values:\n\ttrue - active, supported parameters\n\tfalse - deprecated, supported parameters\n\tnil - unsupported parameters\n]]\nfunction validate( name )\n\tlocal name = tostring( name );\n\tlocal state = whitelist.basic_arguments[\
      \ name ];\n\t\n\t-- Normal arguments\n\tif true == state then return true; end\t\t-- valid actively supported parameter\n\tif false == state then\n\t\tdeprecated_parameter ();\t\t\t\t-- parameter is deprecated but still supported\n\t\treturn true;\n\t\
      end\n\t\n\t-- Arguments with numbers in them\n\tname = name:gsub( &quot;%d+&quot;, &quot;#&quot; );\t\t\t\t-- replace digit(s) with # (last25 becomes last#\n\tstate = whitelist.numbered_arguments[ name ];\n\tif true == state then return true; end\t\t--\
      \ valid actively supported parameter\n\tif false == state then\n\t\tdeprecated_parameter ();\t\t\t\t-- parameter is deprecated but still supported\n\t\treturn true;\n\tend\n\t\n\treturn false;\t\t\t\t\t\t\t\t-- Not supported because not found or name is\
      \ set to nil\nend\n\n-- Formats a comment for error trapping\nfunction errorcomment( content, hidden )\n\treturn wrap( hidden and 'hidden-error' or 'visible-error', content );\nend\n\n--[[\nSets an error condition and returns the appropriate error message.\
      \  The actual placement\nof the error message in the output is the responsibility of the calling function.\n]]\nfunction seterror( error_id, arguments, raw, prefix, suffix )\n\tlocal error_state = cfg.error_conditions[ error_id ];\n\t\n\tprefix = prefix\
      \ or &quot;&quot;;\n\tsuffix = suffix or &quot;&quot;;\n\t\n\tif error_state == nil then\n\t\terror( cfg.messages['undefined_error'] );\n\telseif is_set( error_state.category ) then\n\t\ttable.insert( z.error_categories, error_state.category );\n\tend\n\
      \t\n\tlocal message = substitute( error_state.message, arguments );\n\t\n\tmessage = message .. &quot; ([[&quot; .. cfg.messages['help page link'] .. \n\t\t&quot;#&quot; .. error_state.anchor .. &quot;|&quot; ..\n\t\tcfg.messages['help page label'] ..\
      \ &quot;]])&quot;;\n\t\n\tz.error_ids[ error_id ] = true;\n\tif inArray( error_id, { 'bare_url_missing_title', 'trans_missing_title' } )\n\t\t\tand z.error_ids['citation_missing_title'] then\n\t\treturn '', false;\n\tend\n\t\n\tmessage = table.concat({\
      \ prefix, message, suffix });\n\t\n\tif raw == true then\n\t\treturn message, error_state.hidden;\n\tend\t\t\n\t\t\n\treturn errorcomment( message, error_state.hidden );\nend\n\n-- Formats a wiki style external link\nfunction externallinkid(options)\n\t\
      local url_string = options.id;\n\tif options.encode == true or options.encode == nil then\n\t\turl_string = mw.uri.encode( url_string );\n\tend\n\treturn mw.ustring.format( '[[%s|%s]]%s[%s%s%s %s]',\n\t\toptions.link, options.label, options.separator or\
      \ &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, url_string, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n-- Formats a wiki style internal link\nfunction internallinkid(options)\n\treturn mw.ustring.format( '[[%s|%s]]%s[[%s%s%s|%s]]',\n\
      \t\toptions.link, options.label, options.separator or &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, options.id, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n-- Format an external link with error checking\nfunction externallink(\
      \ URL, label, source )\n\tlocal error_str = &quot;&quot;;\n\tif not is_set( label ) then\n\t\tlabel = URL;\n\t\tif is_set( source ) then\n\t\t\terror_str = seterror( 'bare_url_missing_title', { wrap( 'parameter', source ) }, false, &quot; &quot; );\n\t\
      \telse\n\t\t\terror( cfg.messages[&quot;bare_url_no_origin&quot;] );\n\t\tend\t\t\t\n\tend\n\tif not checkurl( URL ) then\n\t\terror_str = seterror( 'bad_url', {}, false, &quot; &quot; ) .. error_str;\n\tend\n\treturn table.concat({ &quot;[&quot;, URL,\
      \ &quot; &quot;, safeforurl( label ), &quot;]&quot;, error_str });\nend\n\n-- Formats a link to Amazon\nfunction amazon(id, domain)\n\tif checkisbn( id ) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- see if asin value is a 10-digit isbn\n\t\ttable.insert( z.maintenance_cats,\
      \ &quot;CS1 maint: ASIN uses ISBN&quot;);\t\t\t-- add to maint category so a bot or awb script can replace |asin= with |isbn=\n\tend\n\tif not is_set(domain) then \n\t\tdomain = &quot;com&quot;;\n\telseif inArray (domain, {'jp', 'uk'}) then\t\t\t-- Japan,\
      \ United Kingdom\n\t\tdomain = &quot;co.&quot; .. domain;\n\telseif inArray (domain, {'au', 'br', 'mx'}) then\t-- Australia, Brazil, Mexico\n\t\tdomain = &quot;com.&quot; .. domain;\n\tend\n\tlocal handler = cfg.id_handlers['ASIN'];\n\treturn externallinkid({link\
      \ = handler.link,\n\t\tlabel=handler.label , prefix=&quot;//www.amazon.&quot;..domain..&quot;/dp/&quot;,id=id,\n\t\tencode=handler.encode, separator = handler.separator})\nend\n\n--[[\nformat and error check arXiv identifier.  There are two valid forms\
      \ of the identifier:\nthe first form, valid only between date codes 9108 and 0703 is:\n\tarXiv:&lt;archive&gt;.&lt;class&gt;/&lt;date code&gt;&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;archive&gt; is a string of alpha characters - may be hyphenated;\
      \ no other punctuation\n\t&lt;class&gt; is a string of alpha characters - may be hyphenated; no other punctuation\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits of the four-digit year and MM is the month number January\
      \ = 01\n\t\tfirst digit of YY for this form can only 9 and 0\n\t&lt;number&gt; is a three-digit number\n\t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces (undocumented)\n\t\nthe second form, valid from April 2007 is:\n\
      \tarXiv:&lt;date code&gt;.&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits of the four-digit year and MM is the month number January = 01\n\t&lt;number&gt; is a four-digit number\n\
      \t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces\n]]\n\nfunction arxiv (id)\n\tlocal handler = cfg.id_handlers['ARXIV'];\n\tlocal year, month, version;\n\tlocal err_cat = &quot;&quot;\n\t\n\tyear, month, version = id:match(&quot;^%a[%a%.%-]+/([90]%d)([01]%d)%d%d%d([v%d]*)$&quot;);\t\
      \t\t\t-- test for the 9108-0703 format\n\tif not year then\t\t-- arXiv id is not proper 9108-0703 form\n\t\tyear, month, version = id:match(&quot;^(%d%d)([01]%d)%.%d%d%d%d([v%d]*)$&quot;);\t-- test for the 0704- format\n\t\tif not year then\t\n\t\t\terr_cat\
      \ = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t\t\t-- arXiv id doesn't match either format\n\t\telse\t-- id is the 0704- format\n\t\t\tyear = tonumber(year);\n\t\t\tmonth = tonumber(month);\n\t\t\tif ((7 &gt; year) or (1 &gt; month and 12 &lt; month)) or\t\
      \t\t\t\t-- is year invalid or is month invalid? (doesn't test for future years)\n\t\t\t\t((7 == year) and (4 &gt; month)) or\t\t\t\t\t\t\t\t-- when year is 07, is month invalid (before April)?\n\t\t\t\tis_set (version) and nil == version:match(&quot;v%d+&quot;)\
      \ then\t\t\t-- is version proper format of single 'v' followed by digits?\n\t\t\t\t\terr_cat = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t-- set error message\n\t\t\tend\n\t\tend\n\telse\t-- id is the 9108-0703 format; are the date values ok\n\t\tyear =\
      \ tonumber(year);\n\t\tmonth = tonumber(month);\n\t\tif ((91 &gt; year and 7 &lt; year) or (1 &gt; month and 12 &lt; month)) or\t\t\t-- if invalid year or invalid month\n\t\t\t((91 == year and 8 &gt; month) or (7 == year and 3 &lt; month)) or \t\t-- if\
      \ years ok, are starting and ending months ok?\n\t\t\t\tis_set (version) and nil == version:match(&quot;v%d+&quot;) then\t\t\t-- is version proper format of single 'v' followed by digits?\n\t\t\t\t\terr_cat = ' ' .. seterror( 'bad_arxiv' );\t\t\t\t\t--\
      \ set error message\n\t\tend\n\tend\n\n\treturn externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode}) .. err_cat;\nend\n\n--[[\nlccn normalization (http://www.loc.gov/marc/lccn-namespace.html#normalization)\n\
      1. Remove all blanks.\n2. If there is a forward slash (/) in the string, remove it, and remove all characters to the right of the forward slash.\n3. If there is a hyphen in the string:\n\ta. Remove it.\n\tb. Inspect the substring following (to the right\
      \ of) the (removed) hyphen. Then (and assuming that steps 1 and 2 have been carried out):\n\t\t1. All these characters should be digits, and there should be six or less. (not done in this function)\n\t\t2. If the length of the substring is less than 6,\
      \ left-fill the substring with zeroes until the length is six.\n\nReturns a normalized lccn for lccn() to validate.  There is no error checking (step 3.b.1) performed in this function.\n]]\n\nfunction normalize_lccn (lccn)\n\tlccn = lccn:gsub (&quot;%s&quot;,\
      \ &quot;&quot;);\t\t\t\t\t\t\t\t\t-- 1. strip whitespace\n\n\tif nil ~= string.find (lccn,'/') then\n\t\tlccn = lccn:match (&quot;(.-)/&quot;);\t\t\t\t\t\t\t\t-- 2. remove forward slash and all character to the right of it\n\tend\n\n\tlocal prefix\n\t\
      local suffix\n\tprefix, suffix = lccn:match (&quot;(.+)%-(.+)&quot;);\t\t\t\t\t\t-- 3.a remove hyphen by splitting the string into prefix and suffix\n\n\tif nil ~= suffix then\t\t\t\t\t\t\t\t\t\t\t-- if there was a hyphen\n\t\tsuffix=string.rep(&quot;0&quot;,\
      \ 6-string.len (suffix)) .. suffix;\t-- 3.b.2 left fill the suffix with 0s if suffix length less than 6\n\t\tlccn=prefix..suffix;\t\t\t\t\t\t\t\t\t\t-- reassemble the lccn\n\tend\n\t\n\treturn lccn;\n\tend\n\n--[[\nFormat LCCN link and do simple error\
      \ checking.  LCCN is a character string 8-12 characters long. The length of the LCCN dictates the character type of the first 1-3 characters; the\nrightmost eight are always digits. http://info-uri.info/registry/OAIHandler?verb=GetRecord&amp;metadataPrefix=reg&amp;identifier=info:lccn/\n\
      \nlength = 8 then all digits\nlength = 9 then lccn[1] is lower case alpha\nlength = 10 then lccn[1] and lccn[2] are both lower case alpha or both digits\nlength = 11 then lccn[1] is lower case alpha, lccn[2] and lccn[3] are both lower case alpha or both\
      \ digits\nlength = 12 then lccn[1] and lccn[2] are both lower case alpha\n\n]]\nfunction lccn(lccn)\n\tlocal handler = cfg.id_handlers['LCCN'];\n\tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that LCCN is valid\n\tlocal id = lccn;\t\t\t\t\t\t\t\t\t--\
      \ local copy of the lccn\n\n\tid = normalize_lccn (id);\t\t\t\t\t\t\t-- get canonical form (no whitespace, hyphens, forward slashes)\n\tlocal len = id:len();\t\t\t\t\t\t\t\t-- get the length of the lccn\n\n\tif 8 == len then\n\t\tif id:match(&quot;[^%d]&quot;)\
      \ then\t\t\t\t\t\t-- if LCCN has anything but digits (nil if only digits)\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- set an error message\n\t\tend\n\telseif 9 == len then\t\t\t\t\t\t\t\t-- LCCN should be adddddddd\n\t\tif nil == id:match(&quot;%l%d%d%d%d%d%d%d%d&quot;)\
      \ then\t\t\t-- does it match our pattern?\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- set an error message\n\t\tend\n\telseif 10 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddd or dddddddddd\n\t\tif id:match(&quot;[^%d]&quot;) then\t\t\t\
      \t\t\t\t-- if LCCN has anything but digits (nil if only digits) ...\n\t\t\tif nil == id:match(&quot;^%l%l%d%d%d%d%d%d%d%d&quot;) then\t-- ... see if it matches our pattern\n\t\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match, set an error message\n\
      \t\t\tend\n\t\tend\n\telseif 11 == len then\t\t\t\t\t\t\t\t-- LCCN should be aaadddddddd or adddddddddd\n\t\tif not (id:match(&quot;^%l%l%l%d%d%d%d%d%d%d%d&quot;) or id:match(&quot;^%l%d%d%d%d%d%d%d%d%d%d&quot;)) then\t-- see if it matches one of our patterns\n\
      \t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match, set an error message\n\t\tend\n\telseif 12 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddddd\n\t\tif not id:match(&quot;^%l%l%d%d%d%d%d%d%d%d%d%d&quot;) then\t-- see if it matches our\
      \ pattern\n\t\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t-- no match, set an error message\n\t\tend\n\telse\n\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t\t-- wrong length, set an error message\n\tend\n\n\tif not is_set (err_cat) and nil ~= lccn:find\
      \ ('%s') then\n\t\terr_cat = ' ' .. seterror( 'bad_lccn' );\t\t-- lccn contains a space, set an error message\n\tend\n\n\treturn externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=lccn,separator=handler.separator,\
      \ encode=handler.encode}) .. err_cat;\nend\n\n--[[\nFormat PMID and do simple error checking.  PMIDs are sequential numbers beginning at 1 and counting up.  This code checks the PMID to see that it\ncontains only digits and is less than test_limit; the\
      \ value in local variable test_limit will need to be updated periodically as more PMIDs are issued.\n]]\nfunction pmid(id)\n\tlocal test_limit = 30000000;\t\t\t\t\t\t-- update this value as PMIDs approach\n\tlocal handler = cfg.id_handlers['PMID'];\n\t\
      local err_cat =  '';\t\t\t\t\t\t\t\t-- presume that PMID is valid\n\t\n\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMID has anything but digits\n\t\terr_cat = ' ' .. seterror( 'bad_pmid' );\t\t-- set an error message\n\telse\t\t\t\t\t\t\t\t\
      \t\t\t\t-- PMID is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or test_limit &lt; id_num then\t\t-- if PMID is outside test limit boundaries\n\t\t\terr_cat = ' ' .. seterror(\
      \ 'bad_pmid' );\t-- set an error message\n\t\tend\n\tend\n\t\n\treturn externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode}) .. err_cat;\nend\n\n--[[\nDetermines\
      \ if a PMC identifier's online version is embargoed. Compares the date in |embargo= against today's date.  If embargo date is\nin the future, returns true; otherwise, returns false because the embargo has expired or |embargo= not set in this cite.\n]]\n\
      function is_embargoed(embargo)\n\tif is_set(embargo) then\n\t\tlocal lang = mw.getContentLanguage();\n\t\tlocal good1, embargo_date, good2, todays_date;\n\t\tgood1, embargo_date = pcall( lang.formatDate, lang, 'U', embargo );\n\t\tgood2, todays_date =\
      \ pcall( lang.formatDate, lang, 'U' );\n\t\n\t\tif good1 and good2 and tonumber( embargo_date ) &gt;= tonumber( todays_date ) then\t--is embargo date is in the future?\n\t\t\treturn true;\t-- still embargoed\n\t\tend\n\tend\n\treturn false;\t\t\t-- embargo\
      \ expired or |embargo= not set\nend\n\n--[[\nFormat a PMC, do simple error checking, and check for embargoed articles.\n\nThe embargo parameter takes a date for a value. If the embargo date is in the future\nthe PMC identifier will not be linked to the\
      \ article.  If the embargo specifies a date in the past, or if it is empty or omitted, then\nthe PMC identifier is linked to the article through the link at cfg.id_handlers['PMC'].prefix.\n\nPMCs are sequential numbers beginning at 1 and counting up. \
      \ This code checks the PMC to see that it contains only digits and is less\nthan test_limit; the value in local variable test_limit will need to be updated periodically as more PMCs are issued.\n]]\nfunction pmc(id, embargo)\n\tlocal test_limit = 5000000;\t\
      \t\t\t\t\t\t-- update this value as PMCs approach\n\tlocal handler = cfg.id_handlers['PMC'];\n\tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that PMC is valid\n\t\n\tlocal text;\n\n\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMC has anything\
      \ but digits\n\t\terr_cat = ' ' .. seterror( 'bad_pmc' );\t\t\t-- set an error message\n\telse\t\t\t\t\t\t\t\t\t\t\t\t-- PMC is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or\
      \ test_limit &lt; id_num then\t\t-- if PMC is outside test limit boundaries\n\t\t\terr_cat = ' ' .. seterror( 'bad_pmc' );\t\t-- set an error message\n\t\tend\n\tend\n\t\n\tif is_embargoed(embargo) then\n\t\ttext=&quot;[[&quot; .. handler.link .. &quot;|&quot;\
      \ .. handler.label .. &quot;]]:&quot; .. handler.separator .. id .. err_cat;\t--still embargoed so no external link\n\telse\n\t\ttext = externallinkid({link = handler.link, label = handler.label,\t\t\t--no embargo date, ok to link to article\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator,\
      \ encode=handler.encode}) .. err_cat;\n\tend\n\treturn text;\nend\n\n-- Formats a DOI and checks for DOI errors.\n\n-- DOI names contain two parts: prefix and suffix separated by a forward slash.\n--  Prefix: directory indicator '10.' followed by a registrant\
      \ code\n--  Suffix: character string of any length chosen by the registrant\n\n-- This function checks a DOI name for: prefix/suffix.  If the doi name contains spaces or endashes,\n-- or, if it ends with a period or a comma, this function will emit a bad_doi\
      \ error message.\n\n-- DOI names are case-insensitive and can incorporate any printable Unicode characters so the test for spaces, endash,\n-- and terminal punctuation may not be technically correct but it appears, that in practice these characters are\
      \ rarely if ever used in doi names.\n\nfunction doi(id, inactive)\n\tlocal cat = &quot;&quot;\n\tlocal handler = cfg.id_handlers['DOI'];\n\t\n\tlocal text;\n\tif is_set(inactive) then\n\t\tlocal inactive_year = inactive:match(&quot;%d%d%d%d&quot;) or '';\t\
      \t-- try to get the year portion from the inactive date\n\t\ttext = &quot;[[&quot; .. handler.link .. &quot;|&quot; .. handler.label .. &quot;]]:&quot; .. id;\n\t\tif is_set(inactive_year) then\n\t\t\ttable.insert( z.error_categories, &quot;Pages with\
      \ DOIs inactive since &quot; .. inactive_year );\n\t\telse\n\t\t\ttable.insert( z.error_categories, &quot;Pages with inactive DOIs&quot; );\t-- when inactive doesn't contain a recognizable year\n\t\tend\n\t\tinactive = &quot; (&quot; .. cfg.messages['inactive']\
      \ .. &quot; &quot; .. inactive .. &quot;)&quot; \n\telse \n\t\ttext = externallinkid({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n\t\tinactive = &quot;&quot; \n\t\
      end\n\n\tif nil == id:match(&quot;^10%.[^%s–]-/[^%s–]-[^%.,]$&quot;) then\t-- doi must begin with '10.', must contain a fwd slash, must not contain spaces or endashes, and must not end with period or comma\n\t\tcat = ' ' .. seterror( 'bad_doi' );\n\tend\n\
      \treturn text .. inactive .. cat \nend\n\n-- Formats an OpenLibrary link, and checks for associated errors.\nfunction openlibrary(id)\n\tlocal code = id:match(&quot;^%d+([AMW])$&quot;);\t\t\t\t\t-- only digits followed by 'A', 'M', or 'W'\n\tlocal handler\
      \ = cfg.id_handlers['OL'];\n\n\tif ( code == &quot;A&quot; ) then\n\t\treturn externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/authors/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\
      \telseif ( code == &quot;M&quot; ) then\n\t\treturn externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/books/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telseif ( code\
      \ == &quot;W&quot; ) then\n\t\treturn externallinkid({link=handler.link, label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/works/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telse\n\t\treturn externallinkid({link=handler.link,\
      \ label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode}) .. \n\t\t\t' ' .. seterror( 'bad_ol' );\n\tend\nend\n\n--[[\nValidate and format an issn.  This code fixes\
      \ the case where an editor has included an ISSN in the citation but has separated the two groups of four\ndigits with a space.  When that condition occurred, the resulting link looked like this:\n\n\t|issn=0819 4327 gives: [http://www.worldcat.org/issn/0819\
      \ 4327 0819 4327]  -- can't have spaces in an external link\n\t\nThis code now prevents that by inserting a hyphen at the issn midpoint.  It also validates the issn for length and makes sure that the checkdigit agrees\nwith the calculated value.  Incorrect\
      \ length (8 digits), characters other than 0-9 and X, or checkdigit / calculated value mismatch will all cause a check issn\nerror message.  The issn is always displayed with a hyphen, even if the issn was given as a single group of 8 digits.\n]]\nfunction\
      \ issn(id)\n\tlocal issn_copy = id;\t\t-- save a copy of unadulterated issn; use this version for display if issn does not validate\n\tlocal handler = cfg.id_handlers['ISSN'];\n\tlocal text;\n\tlocal valid_issn = true;\n\n\tid=id:gsub( &quot;[%s-–]&quot;,\
      \ &quot;&quot; );\t\t\t\t\t\t\t\t\t-- strip spaces, hyphens, and endashes from the issn\n\n\tif 8 ~= id:len() or nil == id:match( &quot;^%d*X?$&quot; ) then\t\t-- validate the issn: 8 digits long, containing only 0-9 or X in the last position\n\t\tvalid_issn=false;\t\
      \t\t\t\t\t\t\t\t\t-- wrong length or improper character\n\telse\n\t\tvalid_issn=is_valid_isxn(id, 8);\t\t\t\t\t\t-- validate issn\n\tend\n\n\tif true == valid_issn then\n\t\tid = string.sub( id, 1, 4 ) .. &quot;-&quot; .. string.sub( id, 5 );\t-- if valid,\
      \ display correctly formatted version\n\telse\n\t\tid = issn_copy;\t\t\t\t\t\t\t\t\t\t\t-- if not valid, use the show the invalid issn with error message\n\tend\n\t\n\ttext = externallinkid({link = handler.link, label = handler.label,\n\t\tprefix=handler.prefix,id=id,separator=handler.separator,\
      \ encode=handler.encode})\n \n\tif false == valid_issn then\n\t\ttext = text .. ' ' .. seterror( 'bad_issn' )\t\t\t-- add an error message if the issn is invalid\n\tend \n\t\n\treturn text\nend\n\n--[[\nThis function sets default title types (equivalent\
      \ to the citation including |type=&lt;default value&gt;) for those citations that have defaults.\nAlso handles the special case where it is desirable to omit the title type from the rendered citation (|type=none).\n]]\nfunction set_titletype(cite_class,\
      \ title_type)\n\tif is_set(title_type) then\n\t\tif &quot;none&quot; == title_type then\n\t\t\ttitle_type = &quot;&quot;;\t\t\t\t\t-- if |type=none then type parameter not displayed\n\t\tend\n\t\treturn title_type;\t\t\t\t\t\t-- if |type= has been set\
      \ to any other value use that value\n\tend\n\n\tif &quot;AV-media-notes&quot; == cite_class or &quot;DVD-notes&quot; == cite_class then\t\t-- if this citation is cite AV media notes or cite DVD notes\n\t\treturn &quot;Media notes&quot;;\t\t\t\t\t-- display\
      \ AV media notes / DVD media notes annotation\n\n\telseif &quot;podcast&quot; == cite_class then\t\t\t-- if this citation is cite podcast\n\t\treturn &quot;Podcast&quot;;\t\t\t\t\t\t-- display podcast annotation\n\n\telseif &quot;pressrelease&quot; ==\
      \ cite_class then\t-- if this citation is cite press release\n\t\treturn &quot;Press release&quot;;\t\t\t\t\t-- display press release annotation\n\n\telseif &quot;techreport&quot; == cite_class then\t\t-- if this citation is cite techreport\n\t\treturn\
      \ &quot;Technical report&quot;;\t\t\t\t-- display techreport annotation\n\t\n\telseif &quot;thesis&quot; == cite_class then\t\t\t-- if this citation is cite thesis (degree option handled after this function returns)\n\t\t\treturn &quot;Thesis&quot;;\t\t\
      \t\t\t-- display simple thesis annotation (without |degree= modification)\n\tend\nend\n\n--[[\nDetermines whether a URL string is valid\n\nAt present the only check is whether the string appears to \nbe prefixed with a URI scheme.  It is not determined\
      \ whether \nthe URI scheme is valid or whether the URL is otherwise well \nformed.\n]]\nfunction checkurl( url_str )\n\t-- Protocol-relative or URL scheme\n\treturn url_str:sub(1,2) == &quot;//&quot; or url_str:match( &quot;^[^/]*:&quot; ) ~= nil;\nend\n\
      \n-- Removes irrelevant text and dashes from ISBN number\n-- Similar to that used for Special:BookSources\nfunction cleanisbn( isbn_str )\n\treturn isbn_str:gsub( &quot;[^-0-9X]&quot;, &quot;&quot; );\nend\n\n--[[--------------------------&lt; E S C A\
      \ P E _ L U A _ M A G I C _ C H A R S &gt;----------------------------------\n\nReturns a string where all of lua's magic characters have been escaped.  This is important because functions like\nstring.gsub() treat their pattern and replace strings as\
      \ patterns, not literal strings.\n]]\nfunction escape_lua_magic_chars (argument)\n\targument = argument:gsub(&quot;%%&quot;, &quot;%%%%&quot;);\t\t\t\t\t\t\t\t\t\t-- replace % with %%\n\targument = argument:gsub(&quot;([%^%$%(%)%.%[%]%*%+%-%?])&quot;,\
      \ &quot;%%%1&quot;);\t\t\t\t-- replace all other lua magic pattern characters\n\treturn argument;\nend\n\n--[[--------------------------&lt; S T R I P _ A P O S T R O P H E _ M A R K U P &gt;--------------------------------\n\nStrip wiki italic and bold\
      \ markup from argument so that it doesn't contaminate COinS metadata.\nThis function strips common patterns of apostrophe markup.  We presume that editors who have taken the time to\nmarkup a title have, as a result, provided valid markup. When they don't,\
      \ some single apostrophes are left behind.\n\n]]\nfunction strip_apostrophe_markup (argument)\n\tif not is_set (argument) then return argument; end\n\n\twhile true do\n\t\tif argument:match (&quot;%'%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- bold italic\
      \ (5)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'%'&quot;, &quot;&quot;);\t\t\t\t\t\t\t-- remove all instances of it\n\t\telseif argument:match (&quot;%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- italic start and end without content (4)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'&quot;,\
      \ &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- bold (3)\n\t\t\targument=argument:gsub(&quot;%'%'%'&quot;, &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'&quot;) then\t\t\t\t\t\t\t\t\t\t-- italic (2)\n\t\t\
      \targument=argument:gsub(&quot;%'%'&quot;, &quot;&quot;);\n\t\telse\n\t\t\tbreak;\n\t\tend\n\tend\n\treturn argument;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- done\nend\n\n--[[--------------------------&lt; M A K E _ C O I N S _ T I T L E &gt;----------------------------------------------\n\
      \nMakes a title for COinS from Title and / or ScriptTitle (or any other name-script pairs)\n\nApostrophe markup (bold, italics) is stripped from each value so that the COinS metadata isn't correupted with strings\nof %27%27...\n]]\n\nfunction make_coins_title\
      \ (title, script)\n\tif is_set (title) then\n\t\ttitle = strip_apostrophe_markup (title);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\telse\n\t\ttitle='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure title is an empty string\n\tend\n\tif\
      \ is_set (script) then\n\t\tscript = script:gsub ('^%l%l%s*:%s*', '');\t\t\t\t\t\t\t\t-- remove language prefix if present (script value may now be empty string)\n\t\tscript = strip_apostrophe_markup (script);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\
      \telse\n\t\tscript='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure script is an empty string\n\tend\n\tif is_set (title) and is_set (script) then\n\t\tscript = ' ' .. script;\t\t\t\t\t\t\t\t\t\t\t\t\t-- add a space before we concatenate\n\t\
      end\n\treturn title .. script;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- return the concatenation\nend\n\n--[[--------------------------&lt; G E T _ C O I N S _ P A G E S &gt;------------------------------------------------\n\nExtract page numbers from external wikilinks\
      \ in any of the |page=, |pages=, or |at= parameters for use in COinS.\n\n]]\nfunction get_coins_pages (pages)\n\tlocal pattern;\n\tif not is_set (pages) then return pages; end\t\t\t\t\t\t\t\t-- if no page numbers then we're done\n\t\n\twhile true do\n\t\
      \tpattern = pages:match(&quot;%[(%w*:?//[^ ]+%s+)[%w%d].*%]&quot;);\t\t\t\t\t-- pattern is the opening bracket, the url and following space(s): &quot;[url &quot;\n\t\tif nil == pattern then break; end\t\t\t\t\t\t\t\t\t\t-- no more urls\n\t\tpattern = escape_lua_magic_chars\
      \ (pattern);\t\t\t\t\t\t\t\t-- pattern is not a literal string; escape lua's magic pattern characters\n\t\tpages = pages:gsub(pattern, &quot;&quot;);\t\t\t\t\t\t\t\t\t\t-- remove as many instances of pattern as possible\n\tend\n\tpages = pages:gsub(&quot;[%[%]]&quot;,\
      \ &quot;&quot;);\t\t\t\t\t\t\t\t\t\t\t-- remove the brackets\n\tpages = pages:gsub(&quot;–&quot;, &quot;-&quot; );\t\t\t\t\t\t\t-- replace endashes with hyphens\n\tpages = pages:gsub(&quot;&amp;%w+;&quot;, &quot;-&quot; );\t\t\t\t\t\t-- and replace html\
      \ entities (&amp;ndash; etc.) with hyphens; do we need to replace numerical entities like &amp;#32; and the like?\n\treturn pages;\nend\n\n--[[\nISBN-10 and ISSN validator code calculates checksum across all isbn/issn digits including the check digit.\
      \ ISBN-13 is checked in checkisbn().\nIf the number is valid the result will be 0. Before calling this function, issbn/issn must be checked for length and stripped of dashes,\nspaces and other non-isxn characters.\n]]\nfunction is_valid_isxn (isxn_str,\
      \ len)\n\tlocal temp = 0;\n\tisxn_str = { isxn_str:byte(1, len) };\t-- make a table of bytes\n\tlen = len+1;\t\t\t\t\t\t\t-- adjust to be a loop counter\n\tfor i, v in ipairs( isxn_str ) do\t\t-- loop through all of the bytes and calculate the checksum\n\
      \t\tif v == string.byte( &quot;X&quot; ) then\t\t-- if checkdigit is X\n\t\t\ttemp = temp + 10*( len - i );\t-- it represents 10 decimal\n\t\telse\n\t\t\ttemp = temp + tonumber( string.char(v) )*(len-i);\n\t\tend\n\tend\n\treturn temp % 11 == 0;\t\t\t\t\
      \t-- returns true if calculation result is zero\nend\n\n-- Determines whether an ISBN string is valid\nfunction checkisbn( isbn_str )\n\tif nil ~= isbn_str:match(&quot;[^%s-0-9X]&quot;) then return false; end\t\t-- fail if isbn_str contains anything but\
      \ digits, hyphens, or the uppercase X\n\tisbn_str = isbn_str:gsub( &quot;-&quot;, &quot;&quot; ):gsub( &quot; &quot;, &quot;&quot; );\t-- remove hyphens and spaces\n\tlocal len = isbn_str:len();\n \n\tif len ~= 10 and len ~= 13 then\n\t\treturn false;\n\
      \tend\n\n\tif len == 10 then\n\t\tif isbn_str:match( &quot;^%d*X?$&quot; ) == nil then return false; end\n\t\treturn is_valid_isxn(isbn_str, 10);\n\telse\n\t\tlocal temp = 0;\n\t\tif isbn_str:match( &quot;^97[89]%d*$&quot; ) == nil then return false; end\t\
      -- isbn13 begins with 978 or 979\n\t\tisbn_str = { isbn_str:byte(1, len) };\n\t\tfor i, v in ipairs( isbn_str ) do\n\t\t\ttemp = temp + (3 - 2*(i % 2)) * tonumber( string.char(v) );\n\t\tend\n\t\treturn temp % 10 == 0;\n\tend\nend\n\n-- Gets the display\
      \ text for a wikilink like [[A|B]] or [[B]] gives B\nfunction removewikilink( str )\n\treturn (str:gsub( &quot;%[%[([^%[%]]*)%]%]&quot;, function(l)\n\t\treturn l:gsub( &quot;^[^|]*|(.*)$&quot;, &quot;%1&quot; ):gsub(&quot;^%s*(.-)%s*$&quot;, &quot;%1&quot;);\n\
      \tend));\nend\n\n-- Escape sequences for content that will be used for URL descriptions\nfunction safeforurl( str )\n\tif str:match( &quot;%[%[.-%]%]&quot; ) ~= nil then \n\t\ttable.insert( z.message_tail, { seterror( 'wikilink_in_url', {}, true ) } );\n\
      \tend\n\t\n\treturn str:gsub( '[%[%]\\n]', {\t\n\t\t['['] = '&amp;#91;',\n\t\t[']'] = '&amp;#93;',\n\t\t['\\n'] = ' ' } );\nend\n\n-- Converts a hyphen to a dash\nfunction hyphentodash( str )\n\tif not is_set(str) or str:match( &quot;[%[%]{}&lt;&gt;]&quot;\
      \ ) ~= nil then\n\t\treturn str;\n\tend\t\n\treturn str:gsub( '-', '–' );\nend\n\n-- Protects a string that will be wrapped in wiki italic markup '' ... ''\nfunction safeforitalics( str )\n\t--[[ Note: We cannot use &lt;i&gt; for italics, as the expected\
      \ behavior for\n\titalics specified by ''...'' in the title is that they will be inverted\n\t(i.e. unitalicized) in the resulting references.  In addition, &lt;i&gt; and ''\n\ttend to interact poorly under Mediawiki's HTML tidy. ]]\n\t\n\tif not is_set(str)\
      \ then\n\t\treturn str;\n\telse\n\t\tif str:sub(1,1) == &quot;'&quot; then str = &quot;&lt;span /&gt;&quot; .. str; end\n\t\tif str:sub(-1,-1) == &quot;'&quot; then str = str .. &quot;&lt;span /&gt;&quot;; end\n\t\t\n\t\t-- Remove newlines as they break\
      \ italics.\n\t\treturn str:gsub( '\\n', ' ' );\n\tend\nend\n\n--[[\nJoins a sequence of strings together while checking for duplicate separation characters.\n\nTODO: safejoin() has a flaw where it won't remove the duplicate character from a |title= / |url=\
      \ combination.\nThis is because by the time we get here, |title=http://somesite.com and |title=Document Title. have been combined:\n\t[http://somesite.com and ''Document Title.'']\nso that now, the last character is not sepc but is ] (unless sepc == ']'\
      \ which breaks the external link)\n]]\nfunction safejoin( tbl, duplicate_char )\n\t--[[\n\tNote: we use string functions here, rather than ustring functions.\n\t\n\tThis has considerably faster performance and should work correctly as \n\tlong as the duplicate_char\
      \ is strict ASCII.  The strings\n\tin tbl may be ASCII or UTF8.\n\t]]\n\t\n\tlocal str = '';\n\tlocal comp = '';\n\tlocal end_chr = '';\n\tlocal trim;\n\tfor _, value in ipairs( tbl ) do\n\t\tif value == nil then value = ''; end\n\t\t\n\t\tif str == ''\
      \ then\n\t\t\tstr = value;\n\t\telseif value ~= '' then\n\t\t\tif value:sub(1,1) == '&lt;' then\n\t\t\t\t-- Special case of values enclosed in spans and other markup.\n\t\t\t\tcomp = value:gsub( &quot;%b&lt;&gt;&quot;, &quot;&quot; );\n\t\t\telse\n\t\t\
      \t\tcomp = value;\n\t\t\tend\n\t\t\t\n\t\t\tif comp:sub(1,1) == duplicate_char then\n\t\t\t\ttrim = false;\n\t\t\t\tend_chr = str:sub(-1,-1);\n\t\t\t\t-- str = str .. &quot;&lt;HERE(enchr=&quot; .. end_chr.. &quot;)&quot;\n\t\t\t\tif end_chr == duplicate_char\
      \ then\n\t\t\t\t\tstr = str:sub(1,-2);\n\t\t\t\telseif end_chr == &quot;'&quot; then\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char .. &quot;''&quot; then\n\t\t\t\t\t\tstr = str:sub(1, -4) .. &quot;''&quot;;\n\t\t\t\t\telseif str:sub(-5,-1) == duplicate_char\
      \ .. &quot;]]''&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-4,-1) == duplicate_char .. &quot;]''&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\tend\n\t\t\t\telseif end_chr == &quot;]&quot; then\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char\
      \ .. &quot;]]&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-2,-1) == duplicate_char .. &quot;]&quot; then\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\tend\n\t\t\t\telseif end_chr == &quot; &quot; then\n\t\t\t\t\tif str:sub(-2,-1) == duplicate_char\
      \ .. &quot; &quot; then\n\t\t\t\t\t\tstr = str:sub(1,-3);\n\t\t\t\t\tend\n\t\t\t\tend\n\n\t\t\t\tif trim then\n\t\t\t\t\tif value ~= comp then \n\t\t\t\t\t\tlocal dup2 = duplicate_char;\n\t\t\t\t\t\tif dup2:match( &quot;%A&quot; ) then dup2 = &quot;%&quot;\
      \ .. dup2; end\n\t\t\t\t\t\t\n\t\t\t\t\t\tvalue = value:gsub( &quot;(%b&lt;&gt;)&quot; .. dup2, &quot;%1&quot;, 1 )\n\t\t\t\t\telse\n\t\t\t\t\t\tvalue = value:sub( 2, -1 );\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\t\tstr = str .. value;\n\t\tend\n\t\
      end\n\treturn str;\nend  \n\n-- Attempts to convert names to initials.\nfunction reducetoinitials(first)\n\tlocal initials = {}\n\tlocal i = 0;\t\t\t\t\t\t\t\t\t\t-- counter for number of initials\n\tfor word in string.gmatch(first, &quot;%S+&quot;) do\n\
      \t\ttable.insert(initials, string.sub(word,1,1))\t-- Vancouver format does not include full stops.\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t-- bump the counter \n\t\tif 2 &lt;= i then break; end\t\t\t\t\t\t-- only two initials allowed in Vancouver system; if\
      \ 2, quit\n\tend\n\treturn table.concat(initials)\t\t\t\t\t\t-- Vancouver format does not include spaces.\nend\n\n-- Formats a list of people (e.g. authors / editors) \nfunction listpeople(control, people)\n\tlocal sep = control.sep;\n\tlocal namesep =\
      \ control.namesep\n\tlocal format = control.format\n\tlocal maximum = control.maximum\n\tlocal lastauthoramp = control.lastauthoramp;\n\tlocal text = {}\n\tlocal etal = false;\n\t\n\tif sep:sub(-1,-1) ~= &quot; &quot; then sep = sep .. &quot; &quot; end\n\
      \tif maximum ~= nil and maximum &lt; 1 then return &quot;&quot;, 0; end\n\t\n\tfor i,person in ipairs(people) do\n\t\tif is_set(person.last) then\n\t\t\tlocal mask = person.mask\n\t\t\tlocal one\n\t\t\tlocal sep_one = sep;\n\t\t\tif maximum ~= nil and\
      \ i &gt; maximum then\n\t\t\t\tetal = true;\n\t\t\t\tbreak;\n\t\t\telseif (mask ~= nil) then\n\t\t\t\tlocal n = tonumber(mask)\n\t\t\t\tif (n ~= nil) then\n\t\t\t\t\tone = string.rep(&quot;&amp;mdash;&quot;,n)\n\t\t\t\telse\n\t\t\t\t\tone = mask;\n\t\t\
      \t\t\tsep_one = &quot; &quot;;\n\t\t\t\tend\n\t\t\telse\n\t\t\t\tone = person.last\n\t\t\t\tlocal first = person.first\n\t\t\t\tif is_set(first) then \n\t\t\t\t\tif ( &quot;vanc&quot; == format ) then first = reducetoinitials(first) end\n\t\t\t\t\tone\
      \ = one .. namesep .. first \n\t\t\t\tend\n\t\t\t\tif is_set(person.link) and person.link ~= control.page_name then\n\t\t\t\t\tone = &quot;[[&quot; .. person.link .. &quot;|&quot; .. one .. &quot;]]&quot;\t\t-- link author/editor if this page is not the\
      \ author's/editor's page\n\t\t\t\tend\n\n\t\t\t\tif is_set(person.link) and nil ~= person.link:find(&quot;//&quot;) then one = one .. &quot; &quot; .. seterror( 'bad_authorlink' ) end\t-- check for url in author link;\n\t\t\tend\n\t\t\ttable.insert( text,\
      \ one )\n\t\t\ttable.insert( text, sep_one )\n\t\tend\n\tend\n\n\tlocal count = #text / 2;\n\tif count &gt; 0 then \n\t\tif count &gt; 1 and is_set(lastauthoramp) and not etal then\n\t\t\ttext[#text-2] = &quot; &amp; &quot;;\n\t\tend\n\t\ttext[#text] =\
      \ nil; \n\tend\n\t\n\tlocal result = table.concat(text) -- construct list\n\tif etal then \n\t\tlocal etal_text = cfg.messages['et al'];\n\t\tresult = result .. &quot; &quot; .. etal_text;\n\tend\n\t\n\t-- if necessary wrap result in &lt;span&gt; tag to\
      \ format in Small Caps\n\tif ( &quot;scap&quot; == format ) then result = \n\t\t'&lt;span class=&quot;smallcaps&quot; style=&quot;font-variant:small-caps&quot;&gt;' .. result .. '&lt;/span&gt;';\n\tend \n\treturn result, count\nend\n\n-- Generates a CITEREF\
      \ anchor ID.\nfunction anchorid( options )\n\treturn &quot;CITEREF&quot; .. table.concat( options );\nend\n\n--[[\nGets name list from the input arguments\n\nSearches through args in sequential order to find |lastn= and |firstn= parameters (or their aliases),\
      \ and their matching link and mask parameters.\nStops searching when both |lastn= and |firstn= are not found in args after two sequential attempts: found |last1=, |last2=, and |last3= but doesn't\nfind |last4= and |last5= then the search is done.\n\nThis\
      \ function emits an error message when there is a |firstn= without a matching |lastn=.  When there are 'holes' in the list of last names, |last1= and |last3=\nare present but |last2= is missing, an error message is emitted. |lastn= is not required to have\
      \ a matching |firstn=.\n]]\nfunction extractnames(args, list_name)\n\tlocal names = {};\t\t\t-- table of names\n\tlocal last;\t\t\t\t\t-- individual name components\n\tlocal first;\n\tlocal link;\n\tlocal mask;\n\tlocal i = 1;\t\t\t\t-- loop counter/indexer\n\
      \tlocal n = 1;\t\t\t\t-- output table indexer\n\tlocal count = 0;\t\t\t-- used to count the number of times we haven't found a |last= (or alias for authors, |editor-last or alias for editors)\n\t\n\tlocal err_msg_list_name = list_name:match (&quot;(%w+)List&quot;)\
      \ .. 's list';\t\t-- modify AuthorList or EditorList for use in error messages if necessary\n\n\twhile true do\n\t\tlast = selectone( args, cfg.aliases[list_name .. '-Last'], 'redundant_parameters', i );\t\t-- search through args for name components beginning\
      \ at 1\n\t\tfirst = selectone( args, cfg.aliases[list_name .. '-First'], 'redundant_parameters', i );\n\t\tlink = selectone( args, cfg.aliases[list_name .. '-Link'], 'redundant_parameters', i );\n\t\tmask = selectone( args, cfg.aliases[list_name .. '-Mask'],\
      \ 'redundant_parameters', i );\n\n\t\tif first and not last then\t\t\t\t\t\t\t\t\t\t\t\t-- if there is a firstn without a matching lastn\n\t\t\ttable.insert( z.message_tail, { seterror( 'first_missing_last', {err_msg_list_name, i}, true ) } );\t-- add\
      \ this error message\n\t\telseif not first and not last then\t\t\t\t\t\t\t\t\t\t-- if both firstn and lastn aren't found, are we done?\n\t\t\tcount = count + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t-- number of times we haven't found last and first\n\t\t\tif 2 ==\
      \ count then\t\t\t\t\t\t\t\t\t\t\t\t\t-- two missing names and we give up\n\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- normal exit or there is a two-name hole in the list; can't tell which\n\t\t\tend\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- we\
      \ have last with or without a first\n\t\t\tnames[n] = {last = last, first = first, link = link, mask = mask};\t-- add this name to our names list\n\t\t\tn = n + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next location in the names table\n\t\t\tif 1 ==\
      \ count then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if the previous name was missing\n\t\t\t\ttable.insert( z.message_tail, { seterror( 'missing_name', {err_msg_list_name, i-1}, true ) } );\t\t-- add this error message\n\t\t\tend\n\t\t\tcount = 0;\t\t\t\t\t\t\t\t\
      \t\t\t\t\t\t\t-- reset the counter, we're looking for two consecutive missing names\n\t\tend\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next args location\n\tend\n\treturn names;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- all done, return our list\
      \ of names\nend\n\n-- Populates ID table from arguments using configuration settings\nfunction extractids( args )\n\tlocal id_list = {};\n\tfor k, v in pairs( cfg.id_handlers ) do\t\n\t\tv = selectone( args, v.parameters, 'redundant_parameters' );\n\t\t\
      if is_set(v) then id_list[k] = v; end\n\tend\n\treturn id_list;\nend\n\n-- Takes a table of IDs and turns it into a table of formatted ID outputs.\nfunction buildidlist( id_list, options )\n\tlocal new_list, handler = {};\n\t\n\tfunction fallback(k) return\
      \ { __index = function(t,i) return cfg.id_handlers[k][i] end } end;\n\t\n\tfor k, v in pairs( id_list ) do\n\t\t-- fallback to read-only cfg\n\t\thandler = setmetatable( { ['id'] = v }, fallback(k) );\n\t\t\n\t\tif handler.mode == 'external' then\n\t\t\
      \ttable.insert( new_list, {handler.label, externallinkid( handler ) } );\n\t\telseif handler.mode == 'internal' then\n\t\t\ttable.insert( new_list, {handler.label, internallinkid( handler ) } );\n\t\telseif handler.mode ~= 'manual' then\n\t\t\terror( cfg.messages['unknown_ID_mode']\
      \ );\n\t\telseif k == 'DOI' then\n\t\t\ttable.insert( new_list, {handler.label, doi( v, options.DoiBroken ) } );\n\t\telseif k == 'ARXIV' then\n\t\t\ttable.insert( new_list, {handler.label, arxiv( v ) } ); \n\t\telseif k == 'ASIN' then\n\t\t\ttable.insert(\
      \ new_list, {handler.label, amazon( v, options.ASINTLD ) } ); \n\t\telseif k == 'LCCN' then\n\t\t\ttable.insert( new_list, {handler.label, lccn( v ) } );\n\t\telseif k == 'OL' then\n\t\t\ttable.insert( new_list, {handler.label, openlibrary( v ) } );\n\t\
      \telseif k == 'PMC' then\n\t\t\ttable.insert( new_list, {handler.label, pmc( v, options.Embargo ) } );\n\t\telseif k == 'PMID' then\n\t\t\ttable.insert( new_list, {handler.label, pmid( v ) } );\n\t\telseif k == 'ISSN' then\n\t\t\ttable.insert( new_list,\
      \ {handler.label, issn( v ) } );\n\t\telseif k == 'ISBN' then\n\t\t\tlocal ISBN = internallinkid( handler );\n\t\t\tif not checkisbn( v ) and not is_set(options.IgnoreISBN) then\n\t\t\t\tISBN = ISBN .. seterror( 'bad_isbn', {}, false, &quot; &quot;, &quot;&quot;\
      \ );\n\t\t\tend\n\t\t\ttable.insert( new_list, {handler.label, ISBN } );\t\t\t\t\n\t\telse\n\t\t\terror( cfg.messages['unknown_manual_ID'] );\n\t\tend\n\tend\n\t\n\tfunction comp( a, b )\t-- used in following table.sort()\n\t\treturn a[1] &lt; b[1];\n\t\
      end\n\t\n\ttable.sort( new_list, comp );\n\tfor k, v in ipairs( new_list ) do\n\t\tnew_list[k] = v[2];\n\tend\n\t\n\treturn new_list;\nend\n  \n-- Chooses one matching parameter from a list of parameters to consider\n-- Generates an error if more than\
      \ one match is present.\nfunction selectone( args, possible, error_condition, index )\n\tlocal value = nil;\n\tlocal selected = '';\n\tlocal error_list = {};\n\t\n\tif index ~= nil then index = tostring(index); end\n\t\n\t-- Handle special case of &quot;#&quot;\
      \ replaced by empty string\n\tif index == '1' then\n\t\tfor _, v in ipairs( possible ) do\n\t\t\tv = v:gsub( &quot;#&quot;, &quot;&quot; );\n\t\t\tif is_set(args[v]) then\n\t\t\t\tif value ~= nil and selected ~= v then\n\t\t\t\t\ttable.insert( error_list,\
      \ v );\n\t\t\t\telse\n\t\t\t\t\tvalue = args[v];\n\t\t\t\t\tselected = v;\n\t\t\t\tend\n\t\t\tend\n\t\tend\t\t\n\tend\n\t\n\tfor _, v in ipairs( possible ) do\n\t\tif index ~= nil then\n\t\t\tv = v:gsub( &quot;#&quot;, index );\n\t\tend\n\t\tif is_set(args[v])\
      \ then\n\t\t\tif value ~= nil and selected ~=  v then\n\t\t\t\ttable.insert( error_list, v );\n\t\t\telse\n\t\t\t\tvalue = args[v];\n\t\t\t\tselected = v;\n\t\t\tend\n\t\tend\n\tend\n\t\n\tif #error_list &gt; 0 then\n\t\tlocal error_str = &quot;&quot;;\n\
      \t\tfor _, k in ipairs( error_list ) do\n\t\t\tif error_str ~= &quot;&quot; then error_str = error_str .. cfg.messages['parameter-separator'] end\n\t\t\terror_str = error_str .. wrap( 'parameter', k );\n\t\tend\n\t\tif #error_list &gt; 1 then\n\t\t\terror_str\
      \ = error_str .. cfg.messages['parameter-final-separator'];\n\t\telse\n\t\t\terror_str = error_str .. cfg.messages['parameter-pair-separator'];\n\t\tend\n\t\terror_str = error_str .. wrap( 'parameter', selected );\n\t\ttable.insert( z.message_tail, { seterror(\
      \ error_condition, {error_str}, true ) } );\n\tend\n\t\n\treturn value, selected;\nend\n\n-- COinS metadata (see &lt;http://ocoins.info/&gt;) allows automated tools to parse\n-- the citation information.\nfunction COinS(data)\n\tif 'table' ~= type(data)\
      \ or nil == next(data) then\n\t\treturn '';\n\tend\n\t\n\tlocal ctx_ver = &quot;Z39.88-2004&quot;;\n\t\n\t-- treat table strictly as an array with only set values.\n\tlocal OCinSoutput = setmetatable( {}, {\n\t\t__newindex = function(self, key, value)\n\
      \t\t\tif is_set(value) then\n\t\t\t\trawset( self, #self+1, table.concat{ key, '=', mw.uri.encode( removewikilink( value ) ) } );\n\t\t\tend\n\t\tend\n\t});\n\t\n\tif is_set(data.Chapter) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;bookitem&quot;;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Chapter;\n\t\tOCinSoutput[&quot;rft.atitle&quot;] = data.Title;\n\telseif is_set(data.Periodical) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:journal&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;article&quot;;\n\t\tOCinSoutput[&quot;rft.jtitle&quot;] = data.Periodical;\n\t\tOCinSoutput[&quot;rft.atitle&quot;] = data.Title;\n\telse\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\
      \t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;book&quot;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Title;\n\tend\n\t\n\tOCinSoutput[&quot;rft.place&quot;] = data.PublicationPlace;\n\tOCinSoutput[&quot;rft.date&quot;] = data.Date;\n\tOCinSoutput[&quot;rft.series&quot;]\
      \ = data.Series;\n\tOCinSoutput[&quot;rft.volume&quot;] = data.Volume;\n\tOCinSoutput[&quot;rft.issue&quot;] = data.Issue;\n\tOCinSoutput[&quot;rft.pages&quot;] = data.Pages;\n\tOCinSoutput[&quot;rft.edition&quot;] = data.Edition;\n\tOCinSoutput[&quot;rft.pub&quot;]\
      \ = data.PublisherName;\n\t\n\tfor k, v in pairs( data.ID_list ) do\n\t\tlocal id, value = cfg.id_handlers[k].COinS;\n\t\tif k == 'ISBN' then value = cleanisbn( v ); else value = v; end\n\t\tif string.sub( id or &quot;&quot;, 1, 4 ) == 'info' then\n\t\t\
      \tOCinSoutput[&quot;rft_id&quot;] = table.concat{ id, &quot;/&quot;, v };\n\t\telse\n\t\t\tOCinSoutput[ id ] = value;\n\t\tend\n\tend\n\t\n\tlocal last, first;\n\tfor k, v in ipairs( data.Authors ) do\n\t\tlast, first = v.last, v.first;\n\t\tif k == 1\
      \ then\n\t\t\tif is_set(last) then\n\t\t\t\tOCinSoutput[&quot;rft.aulast&quot;] = last;\n\t\t\tend\n\t\t\tif is_set(first) then \n\t\t\t\tOCinSoutput[&quot;rft.aufirst&quot;] = first;\n\t\t\tend\n\t\tend\n\t\tif is_set(last) and is_set(first) then\n\t\t\
      \tOCinSoutput[&quot;rft.au&quot;] = table.concat{ last, &quot;, &quot;, first };\n\t\telseif is_set(last) then\n\t\t\tOCinSoutput[&quot;rft.au&quot;] = last;\n\t\tend\n\tend\n\t\n\tOCinSoutput.rft_id = data.URL;\n\tOCinSoutput.rfr_id = table.concat{ &quot;info:sid/&quot;,\
      \ mw.site.server:match( &quot;[^/]*$&quot; ), &quot;:&quot;, data.RawPage };\n\tOCinSoutput = setmetatable( OCinSoutput, nil );\n\t\n\t-- sort with version string always first, and combine.\n\ttable.sort( OCinSoutput );\n\ttable.insert( OCinSoutput, 1,\
      \ &quot;ctx_ver=&quot; .. ctx_ver );  -- such as &quot;Z39.88-2004&quot;\n\treturn table.concat(OCinSoutput, &quot;&amp;&quot;);\nend\n\n\n--[[--------------------------&lt; G E T _ I S O 6 3 9 _ C O D E &gt;------------------------------------------------\n\
      \nValidates language names provided in |language= parameter if not an ISO639-1 code.  Handles the special case that is Norwegian where\nISO639-1 code 'no' is mapped to language name 'Norwegian Bokmål' by Extention:CLDR.\n\nReturns the language name and\
      \ associated ISO639-1 code.  Because case of the source may be incorrect or different from the case that Wikimedia\nuses, the name comparisons are done in lower case and when a match is found, the Wikimedia version (assumed to be correct) is returned along\n\
      with the code.  When there is no match, we return the original language name string.\n\nmw.language.fetchLanguageNames() will return a list of languages that aren't part of ISO639-1. Names that aren't ISO639-1 but that are included\nin the list will be\
      \ found if that name is provided in the |language= parameter.  For example, if |language=Samaritan Aramaic, that name will be\nfound with the associated code 'sam', not an ISO639-1 code.  When names are found and the associated code is not two characters,\
      \ this function\nreturns only the Wikimedia language name.\n\nAdapted from code taken from Module:Check ISO 639-1.\n]]\n\nfunction get_iso639_code (lang)\n\tif 'Norwegian' == lang then\n\t\treturn lang, 'no';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- special case\
      \ related to Wikimedia remap of code 'no' at Extension:CLDR\n\tend\n\t\n\tlocal languages = mw.language.fetchLanguageNames('en', 'all')\t\t\t\t-- get a list of language names known to Wikimedia\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- ('all' is required\
      \ for North Ndebele, South Ndebele, and Ojibwa)\n\tlocal langlc = mw.ustring.lower(lang);\t\t\t\t\t\t\t\t\t\t-- lower case version for comparisons\n\t\n\tfor code, name in pairs(languages) do\t\t\t\t\t\t\t\t\t\t-- scan the list to see if we can find our\
      \ language\n\t\tif langlc == mw.ustring.lower(name) then\n\t\t\tif 2 ~= code:len() then\t\t\t\t\t\t\t\t\t\t\t\t-- ISO639-1 codes only\n\t\t\t\treturn name;\t\t\t\t\t\t\t\t\t\t\t\t\t-- so return the name but not the code\n\t\t\tend\n\t\t\treturn name, code;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t-- found it, return name to ensure proper capitalization and the ISO639-1 code\n\t\tend\n\tend\n\treturn lang;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not valid language; return language in original case and nil for ISO639-1 code\nend\n\
      \n--[[--------------------------&lt; L A N G U A G E _ P A R A M E T E R &gt;------------------------------------------\n\nGet language name from ISO639-1 code value provided.  If a code is valid use the returned name; if not, then use the value that was\
      \ provided with the language parameter.\n\nThere is an exception.  There are three ISO639-1 codes for Norewegian language variants.  There are two official variants: Norwegian Bokmål (code 'nb') and\nNorwegian Nynorsk (code 'nn').  The third, code 'no',\
      \  is defined by ISO639-1 as 'Norwegian' though in Norway this is pretty much meaningless.  However, it appears\nthat on enwiki, editors are for the most part unaware of the nb and nn variants (compare page counts for these variants at Category:Articles\
      \ with non-English-language external links.\n\nBecause Norwegian Bokmål is the most common language variant, Media wiki has been modified to return Norwegian Bokmål for ISO639-1 code 'no'. Here we undo that and\nreturn 'Norwegian' when editors use |language=no.\
      \  We presume that editors don't know about the variants or can't descriminate between them.\n\nSee Help talk:Citation Style_1#An ISO 639-1 language name test\n\nWhen |language= contains a valid ISO639-1 code, the page is assigned to the category for that\
      \ code: Category:Norwegian-language sources (no) if\nthe page is a mainspace page and the ISO639-1 code is not 'en'.  Similarly, if the  parameter is |language=Norwegian, it will be categorized in the same way.\n\nTODO: Error message when language or language\
      \ code is not ISO639-1?\n]]\n\nfunction language_parameter (lang, namespace)\n\tlocal code;\t\t\t-- the ISO639-1 two character code\n\tlocal name;\t\t\t-- the language name\n\tlocal test='';\n\t\t\n\tif 0 == namespace and (('en' == lang:lower()) or ('english'\
      \ == lang:lower())) then\n\t\ttable.insert (z.maintenance_cats, 'CS1 maint: English language specified');\t\t-- add maintenance category if |language=English or |language=en in article space\n\tend\n\n\tif 2 == lang:len() then\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t-- ISO639-1 language code are 2 characters (fetchLanguageName also supports 3 character codes)\n\t\tname = mw.language.fetchLanguageName( lang:lower(), &quot;en&quot; );\t\t\t\t-- get ISO 639-1 language name if Language is a proper code\n\tend\n\n\t\
      if is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if Language specified a valid ISO639-1 code\n\t\tcode = lang:lower();\t\t\t\t\t\t\t\t\t\t\t\t\t-- save it\n\telse\n\t\tname, code = get_iso639_code (lang);\t\t\t\t\t\t\t\t\t-- attempt to get code from\
      \ name (assign name here so that we are sure of proper capitalization)\n\tend\n\n\tif is_set (code) then\n\t\tif 'no' == code then name = 'Norwegian' end;\t\t\t\t\t\t\t-- override wikimedia when code is 'no'\n\t\t\tif 0 == namespace and 'en' ~= code then\t\
      \t\t\t\t-- is this page main / article space and English not the language?\n\t\t\t\ttable.insert( z.properties_cats, 'CS1 ' .. name .. '-language sources (' .. code .. ')');\t-- in main space and not English: categorize\n\t\t\tend\n\t\tend\n\treturn (&quot;\
      \ &quot; .. wrap( 'language', name));\t\t\t\t\t\t\t\t\t-- wrap with '(in ...)'\nend\n\n\n\n\n--[[--------------------------&lt; C I T A T I O N 0 &gt;------------------------------------------------------------\nThis is the main function doing the majority\
      \ of the citation\nformatting.\n]]\nfunction citation0( config, args)\n\t--[[ \n\tLoad Input Parameters\n\tThe argument_wrapper facilitates the mapping of multiple\n\taliases to single internal variable.\n\t]]\n\tlocal A = argument_wrapper( args );\n\n\
      \tlocal i \n\tlocal PPrefix = A['PPrefix']\n\tlocal PPPrefix = A['PPPrefix']\n\tif is_set( A['NoPP'] ) then PPPrefix = &quot;&quot; PPrefix = &quot;&quot; end\n\t\n\t-- Pick out the relevant fields from the arguments.  Different citation templates\n\t\
      -- define different field names for the same underlying things.\t\n\tlocal Authors = A['Authors'];\n\tlocal a = extractnames( args, 'AuthorList' );\n\n\tlocal Coauthors = A['Coauthors'];\n\tlocal Others = A['Others'];\n\tlocal Editors = A['Editors'];\n\
      \tlocal e = extractnames( args, 'EditorList' );\n\n\tlocal Year = A['Year'];\n\tlocal PublicationDate = A['PublicationDate'];\n\tlocal OrigYear = A['OrigYear'];\n\tlocal Date = A['Date'];\n\tlocal LayDate = A['LayDate'];\n\t-------------------------------------------------\
      \ Get title data\n\tlocal Title = A['Title'];\n\tlocal ScriptTitle = A['ScriptTitle'];\n\tlocal BookTitle = A['BookTitle'];\n\tlocal Conference = A['Conference'];\n\tlocal TransTitle = A['TransTitle'];\n\tlocal TitleNote = A['TitleNote'];\n\tlocal TitleLink\
      \ = A['TitleLink'];\n\tlocal Chapter = A['Chapter'];\n\tlocal ChapterLink = A['ChapterLink'];\n\tlocal TransChapter = A['TransChapter'];\n\tlocal TitleType = A['TitleType'];\n\tlocal Degree = A['Degree'];\n\tlocal Docket = A['Docket'];\n\tlocal ArchiveURL\
      \ = A['ArchiveURL'];\n\tlocal URL = A['URL']\n\tlocal URLorigin = A:ORIGIN('URL');\t\t\t\t\t\t\t\t\t\t\t-- get name of parameter that holds URL\n\tlocal ChapterURL = A['ChapterURL'];\n\tlocal ChapterURLorigin = A:ORIGIN('ChapterURL');\t\t\t\t\t\t\t-- get\
      \ name of parameter that holds ChapterURL\n\tlocal ConferenceURL = A['ConferenceURL'];\n\tlocal ConferenceURLorigin = A:ORIGIN('ConferenceURL');\t\t\t\t\t\t-- get name of parameter that holds ConferenceURL\n\tlocal Periodical = A['Periodical'];\n\n\tlocal\
      \ Series = A['Series'];\n\tlocal Volume = A['Volume'];\n\tlocal Issue = A['Issue'];\n\tlocal Position = '';\n\tlocal Page = A['Page'];\n\tlocal Pages = hyphentodash( A['Pages'] );\t\n\tlocal At = A['At'];\n\n\tlocal Edition = A['Edition'];\n\tlocal PublicationPlace\
      \ = A['PublicationPlace']\n\tlocal Place = A['Place'];\n\t\n\tlocal PublisherName = A['PublisherName'];\n\tlocal RegistrationRequired = A['RegistrationRequired'];\n\tlocal SubscriptionRequired = A['SubscriptionRequired'];\n\tlocal Via = A['Via'];\n\tlocal\
      \ AccessDate = A['AccessDate'];\n\tlocal ArchiveDate = A['ArchiveDate'];\n\tlocal Agency = A['Agency'];\n\tlocal DeadURL = A['DeadURL']\n\tlocal Language = A['Language'];\n\tlocal Format = A['Format'];\n\tlocal Ref = A['Ref'];\n\tlocal DoiBroken = A['DoiBroken'];\n\
      \tlocal ID = A['ID'];\n\tlocal ASINTLD = A['ASINTLD'];\n\tlocal IgnoreISBN = A['IgnoreISBN'];\n\tlocal Embargo = A['Embargo'];\n\n\tlocal ID_list = extractids( args );\n--[[ Hide unfinished cite newsgroup code so that long delayed update can take place\n\
      \t-- special case for cite newsgroup which uses |id= for a usenet article or post id\n\t-- |id= is not included in COinS so here we convert it to an ID that will be included in COinS\n\tif ('newsgroup' == config.CitationClass) and (is_set (ID)) then\n\t\
      \tID_list['USENETID']=ID;\t\t\t-- add this new 'id' to the list of IDs\n\t\tID = '';\t\t\t\t\t\t-- and unset\n\tend\n]]\t\n\tlocal Quote = A['Quote'];\n\tlocal PostScript = A['PostScript'];\n\n\tlocal LayURL = A['LayURL'];\n\tlocal LaySource = A['LaySource'];\n\
      \tlocal Transcript = A['Transcript'];\n\tlocal TranscriptURL = A['TranscriptURL'] \n\tlocal TranscriptURLorigin = A:ORIGIN('TranscriptURL');\t\t\t\t\t\t-- get name of parameter that holds TranscriptURL\n\tlocal sepc = A['Separator'];\n\n\tlocal LastAuthorAmp\
      \ = A['LastAuthorAmp'];\n\tlocal no_tracking_cats = A['NoTracking'];\n\n--these are used by cite interview\n\tlocal Callsign = A['Callsign'];\n\tlocal City = A['City'];\n\tlocal Cointerviewers = A['Cointerviewers'];\t\t\t-- deprecated\n\tlocal Interviewer\
      \ = A['Interviewer'];\t\t\t\t-- deprecated\n\tlocal Program = A['Program'];\n\n--local variables that are not cs1 parameters\n\tlocal page_type;\t\t\t\t\t\t\t\t\t-- is this needed?  Doesn't appear to be used anywhere;\n\tlocal use_lowercase = ( sepc ~=\
      \ '.' );\n\tlocal this_page = mw.title.getCurrentTitle();\t\t--Also used for COinS and for language\n\tlocal anchor_year;\t\t\t\t\t\t\t\t\t-- used in the CITEREF identifier\n\tlocal COinS_date;\t\t\t\t\t\t\t\t\t-- used in the COinS metadata\n\n-- Set postscript\
      \ default.\n\tif not is_set (PostScript) then\t\t\t\t\t\t-- if |postscript= has not been set (Postscript is nil which is the default for {{citation}}) and\n\t\tif (config.CitationClass ~= &quot;citation&quot;) then\t-- this template is not a citation template\n\
      \t\t\tPostScript = '.';\t\t\t\t\t\t\t-- must be a cite xxx template so set postscript to default (period)\n\t\tend\n\telse\n\t\tif PostScript:lower() == 'none' then\t\t\t-- if |postscript=none then\n\t\t\tPostScript = '';\t\t\t\t\t\t\t-- no postscript\n\
      \t\tend\n\tend\n\n--check this page to see if it is in one of the namespaces that cs1 is not supposed to add to the error categories.\n\tif not is_set(no_tracking_cats) then\t\t\t\t-- ignore if we are already not going to categorize this page\n\t\tif inArray\
      \ (this_page.nsText, cfg.uncategorized_namespaces) then\n\t\t\tno_tracking_cats = &quot;true&quot;;\t\t\t\t\t-- set no_tracking_cats\n\t\tend\n\tend\n\n-- check for extra |page=, |pages= or |at= parameters. \n\tif is_set(Page) then\n\t\tif is_set(Pages)\
      \ or is_set(At) then\n\t\t\tPage = Page .. &quot; &quot; .. seterror('extra_pages');\t-- add error message\n\t\t\tPages = '';\t\t\t\t\t\t\t\t\t\t-- unset the others\n\t\t\tAt = '';\n\t\tend\n\telseif is_set(Pages) then\n\t\tif is_set(At) then\n\t\t\tPages\
      \ = Pages .. &quot; &quot; .. seterror('extra_pages');\t-- add error messages\n\t\t\tAt = '';\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\tend\n\tend\t\n\n-- both |publication-place= and |place= (|location=) allowed if different\n\tif not is_set(PublicationPlace)\
      \ and is_set(Place) then\n\t\tPublicationPlace = Place;\t\t\t\t\t\t\t-- promote |place= (|location=) to |publication-place\n\tend\n\t\n\tif PublicationPlace == Place then Place = ''; end\t\t-- don't need both if they are the same\n\t\n--[[\nParameter remapping\
      \ for cite encyclopedia:\nWhen the citation has these parameters:\n\t|encyclopedia and |title then map |title to |article and |encyclopedia to |title\n\t|encyclopedia and |article then map |encyclopedia to |title\n\t|encyclopedia then map |encyclopedia\
      \ to |title\n\n\t|trans_title maps to |trans_chapter when |title is re-mapped\n\nAll other combinations of |encyclopedia, |title, and |article are not modified\n]]\n\tif ( config.CitationClass == &quot;encyclopaedia&quot; ) then\n\t\tif is_set(Periodical)\
      \ then\t\t\t\t\t-- Periodical is set when |encyclopedia is set\n\t\t\tif is_set(Title) then\n\t\t\t\tif not is_set(Chapter) then\n\t\t\t\t\tChapter = Title;\t\t\t\t-- |encyclopedia and |title are set so map |title to |article and |encyclopedia to |title\n\
      \t\t\t\t\tTransChapter = TransTitle;\n\t\t\t\t\tTitle = Periodical;\n\t\t\t\t\tPeriodical = '';\t\t\t\t-- redundant so unset\n\t\t\t\t\tTransTitle = '';\t\t\t\t-- redundant so unset\n\t\t\t\tend\n\t\t\telse\t\t\t\t\t\t\t\t\t-- |title not set\n\t\t\t\t\
      Title = Periodical;\t\t\t\t\t-- |encyclopedia set and |article set or not set so map |encyclopedia to |title\n\t\t\t\tPeriodical = '';\t\t\t\t\t-- redundant so unset\n\t\t\tend\n\t\tend\n\tend\n\n--special cases for citation.\n\tif (config.CitationClass\
      \ == &quot;citation&quot;) then\t\t-- for citation templates\n\t\tif not is_set (Ref) then\t\t\t\t\t\t-- if |ref= is not set\n\t\t\tRef = &quot;harv&quot;;\t\t\t\t\t\t\t\t-- set default |ref=harv\n\t\tend\n\t\tif not is_set (sepc) then\t\t\t\t\t\t-- if\
      \ |separator= is not set\n\t\t\tsepc = ',';\t\t\t\t\t\t\t\t\t-- set citation separator to its default (comma)\n\t\tend\n\telse\t\t\t\t\t\t\t\t\t\t\t\t-- not a citation template\n\t\tif not is_set (sepc) then\t\t\t\t\t\t-- if |separator= has not been set\n\
      \t\t\tsepc = '.';\t\t\t\t\t\t\t\t\t-- set cite xxx separator to its default (period)\n\t\tend\n\tend\n\n-- check for special case where |separator=none\n\tif 'none' == sepc:lower() then\t\t\t\t\t\t-- if |separator=none\n\t\tsepc = '';\t\t\t\t\t\t\t\t\t\
      \t-- then set it to an empty string\n\tend\n\n-- Special case for cite techreport.\n\tif (config.CitationClass == &quot;techreport&quot;) then\t-- special case for cite techreport\n\t\tif is_set(Issue) then\t\t\t\t\t\t-- cite techreport uses 'number',\
      \ which other citations aliase to 'issue'\n\t\t\tif not is_set(ID) then\t\t\t\t\t-- can we use ID for the &quot;number&quot;?\n\t\t\t\tID = Issue;\t\t\t\t\t\t\t-- yes, use it\n\t\t\t\tIssue = &quot;&quot;;\t\t\t\t\t\t\t-- unset Issue so that &quot;number&quot;\
      \ isn't duplicated in the rendered citation or COinS metadata\n\t\t\telse\t\t\t\t\t\t\t\t\t-- can't use ID so emit error message\n\t\t\t\tID = ID .. &quot; &quot; .. seterror('redundant_parameters', '&lt;code&gt;&amp;#124;id=&lt;/code&gt; and &lt;code&gt;&amp;#124;number=&lt;/code&gt;');\n\
      \t\t\tend\n\t\tend\t\n\tend\n\n-- special case for cite interview\n\tif (config.CitationClass == &quot;interview&quot;) then\n\t\tif is_set(Program) then\n\t\t\tID = ' ' .. Program;\n\t\tend\n\t\tif is_set(Callsign) then\n\t\t\tif is_set(ID) then\n\t\t\
      \t\tID = ID .. sepc .. ' ' .. Callsign;\n\t\t\telse\n\t\t\t\tID = ' ' .. Callsign;\n\t\t\tend\n\t\tend\n\t\tif is_set(City) then\n\t\t\tif is_set(ID) then\n\t\t\t\tID = ID .. sepc .. ' ' .. City;\n\t\t\telse\n\t\t\t\tID = ' ' .. City;\n\t\t\tend\n\t\t\
      end\n\n\t\tif is_set(Interviewer) then\n\t\t\tif is_set(TitleType) then\n\t\t\t\tOthers = ' ' .. TitleType .. ' with ' .. Interviewer;\n\t\t\t\tTitleType = '';\n\t\t\telse\n\t\t\t\tOthers = ' ' .. 'Interview with ' .. Interviewer;\n\t\t\tend\n\t\t\tif\
      \ is_set(Cointerviewers) then\n\t\t\t\tOthers = Others .. sepc .. ' ' .. Cointerviewers;\n\t\t\tend\n\t\telse\n\t\t\tOthers = '(Interview)';\n\t\tend\n\tend\n\n--Account for the oddity that is {{cite journal}} with |pmc= set and |url= not set\n\tif config.CitationClass\
      \ == &quot;journal&quot; and not is_set(URL) and is_set(ID_list['PMC']) then\n\t\tif not is_embargoed(Embargo) then\n\t\t\tURL=cfg.id_handlers['PMC'].prefix .. ID_list['PMC'];\t-- set url to be the same as the PMC external link if not embargoed\n\t\t\t\
      URLorigin = cfg.id_handlers['PMC'].parameters[1];\t\t-- set URLorigin to parameter name for use in error message if citation is missing a |title=\n\t\tend\n\tend\n\n-- Account for the oddity that is {{cite conference}}, before generation of COinS data.\n\
      --TODO: if this is only for {{cite conference}}, shouldn't we be checking? (if config.CitationClass=='conference' then ...)\n\tif is_set(BookTitle) then\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = BookTitle;\n\
      \t\tTitleLink = '';\n\t\tTransTitle = '';\n\tend\n\n-- Account for the oddity that is {{cite episode}}, before generation of COinS data.\n--[[\t-- {{cite episode}} is not currently supported by this module\n\tif config.CitationClass == &quot;episode&quot;\
      \ then\n\t\tlocal AirDate = A['AirDate'];\n\t\tlocal SeriesLink = A['SeriesLink'];\n\t\tlocal Season = A['Season'];\n\t\tlocal SeriesNumber = A['SeriesNumber'];\n\t\tlocal Network = A['Network'];\n\t\tlocal Station = A['Station'];\n\t\tlocal s, n = {},\
      \ {};\n\t\tlocal Sep = (first_set(A[&quot;SeriesSeparator&quot;], A[&quot;Separator&quot;]) or &quot;&quot;) .. &quot; &quot;;\n\t\t\n\t\tif is_set(Issue) then table.insert(s, cfg.messages[&quot;episode&quot;] .. &quot; &quot; .. Issue); Issue = ''; end\n\
      \t\tif is_set(Season) then table.insert(s, cfg.messages[&quot;season&quot;] .. &quot; &quot; .. Season); end\n\t\tif is_set(SeriesNumber) then table.insert(s, cfg.messages[&quot;series&quot;] .. &quot; &quot; .. SeriesNumber); end\n\t\tif is_set(Network)\
      \ then table.insert(n, Network); end\n\t\tif is_set(Station) then table.insert(n, Station); end\n\t\t\n\t\tDate = Date or AirDate;\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = Series;\n\t\tTitleLink =\
      \ SeriesLink;\n\t\tTransTitle = '';\n\t\t\n\t\tSeries = table.concat(s, Sep);\n\t\tID = table.concat(n, Sep);\n\tend\n-- end of {{cite episode}} stuff]]\n\n-- legacy: promote concatenation of |day=, |month=, and |year= to Date if Date not set; or, promote\
      \ PublicationDate to Date if neither Date nor Year are set.\n\tif not is_set(Date) then\n\t\tDate = Year;\t\t\t\t\t\t-- promote Year to Date\n\t\tYear = nil;\t\t\t\t\t\t\t-- make nil so Year as empty string isn't used for CITEREF\n\t\tif is_set(Date) then\n\
      \t\t\tlocal Month = A['Month'];\n\t\t\tif is_set(Month) then\n\t\t\t\tDate = Month .. &quot; &quot; .. Date;\n\t\t\t\tlocal Day = A['Day']\n\t\t\t\tif is_set(Day) then Date = Day .. &quot; &quot; .. Date end\n\t\t\tend\n\t\telseif is_set(PublicationDate)\
      \ then\t-- use PublicationDate when |date= and |year= are not set\n\t\t\tDate = PublicationDate;\t\t\t-- promote PublicationDate to Date\n\t\t\tPublicationDate = '';\t\t\t-- unset, no longer needed\n\t\tend\n\tend\n\n\tif PublicationDate == Date then PublicationDate\
      \ = ''; end\t-- if PublicationDate is same as Date, don't display in rendered citation\n\n\n--[[\nGo test all of the date-holding parameters for valid MOS:DATE format and make sure that dates are real dates. This must be done before we do COinS because\
      \ here is where\nwe get the date used in the metadata.\n\nDate validation supporting code is in Module:Citation/CS1/Date_validation\n]]\n\tanchor_year, COinS_date, error_message = dates({['accessdate']=AccessDate, ['airdate']=AirDate, ['archivedate']=ArchiveDate,\
      \ ['date']=Date, ['doi_brokendate']=DoiBroken,\n\t\t['embargo']=Embargo, ['laydate']=LayDate, ['publicationdate']=PublicationDate, ['year']=Year});\n\tif is_set(error_message) then\n\t\ttable.insert( z.message_tail, { seterror( 'bad_date', {error_message},\
      \ true ) } );\t-- add this error message\n\tend\n\n-- At this point fields may be nil if they weren't specified in the template use.  We can use that fact.\n\n\t-- COinS metadata (see &lt;http://ocoins.info/&gt;) for\n\t-- automated parsing of citation\
      \ information.\n\t-- this is the function call to COinS()\n\tlocal OCinSoutput = COinS{\n\t\t['Periodical'] = Periodical,\n\t\t['Chapter'] = strip_apostrophe_markup (Chapter),\t\t\t\t\t\t-- Chapter stripped of bold / italic wikimarkup\n\t\t['Title'] =\
      \ make_coins_title (Title, ScriptTitle),\t\t\t\t\t\t-- Title and ScriptTitle stripped of bold / italic wikimarkup\n\t\t['PublicationPlace'] = PublicationPlace,\n\t\t['Date'] = first_set(COinS_date, Date),\t\t-- COinS_date has correctly formatted date if\
      \ Date is valid; any reason to keep Date here?  Should we be including invalid dates in metadata?\n\t\t['Series'] = Series,\n\t\t['Volume'] = Volume,\n\t\t['Issue'] = Issue,\n\t\t['Pages'] = get_coins_pages (first_set(Page, Pages, At)),\t\t\t\t-- pages\
      \ stripped of external links\n\t\t['Edition'] = Edition,\n\t\t['PublisherName'] = PublisherName,\n\t\t['URL'] = first_set( URL, ChapterURL ),\n\t\t['Authors'] = a,\n\t\t['ID_list'] = ID_list,\n\t\t['RawPage'] = this_page.prefixedText,\n\t};\n--[[Why is\
      \ this here?  Why are we mapping Title to Chapter when Periodical is set?\n\tif is_set(Periodical) and not is_set(Chapter) and is_set(Title) then\n\t\tChapter = Title;\n\t\tChapterLink = TitleLink;\n\t\tTransChapter = TransTitle;\n\t\tTitle = '';\n\t\t\
      TitleLink = '';\n\t\tTransTitle = '';\n\tend\n]]\n--[[ Hide unfinished cite newsgroup code so that long delayed update can take place\n-- special case for cite newsgroup.  Do this after COinS because we are modifying Publishername and ID\n\tif 'newsgroup'\
      \ == config.CitationClass then\n\t\tif is_set (PublisherName) then\n\t\t\tPublisherName = '[Newsgroup]:&amp;nbsp;' ..  externallink( 'news:' .. PublisherName, PublisherName );\n\t\tend\n\tend\n]]\n\n\n\t-- Now perform various field substitutions.\n\t--\
      \ We also add leading spaces and surrounding markup and punctuation to the\n\t-- various parts of the citation, but only when they are non-nil.\n\tif not is_set(Authors) then\n\t\tlocal Maximum = tonumber( A['DisplayAuthors'] );\n\t\t\n\t\t-- Preserve\
      \ old-style implicit et al.\n\t\tif not is_set(Maximum) and #a == 9 then \n\t\t\tMaximum = 8;\n\t\t\ttable.insert( z.message_tail, { seterror('implict_etal_author', {}, true ) } );\n\t\telseif not is_set(Maximum) then\n\t\t\tMaximum = #a + 1;\n\t\tend\n\
      \t\t\t\n\t\tlocal control = { \n\t\t\tsep = A[&quot;AuthorSeparator&quot;] .. &quot; &quot;,\n\t\t\tnamesep = (first_set(A[&quot;AuthorNameSeparator&quot;], A[&quot;NameSeparator&quot;]) or &quot;&quot;) .. &quot; &quot;,\n\t\t\tformat = A[&quot;AuthorFormat&quot;],\n\
      \t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via authorlinkn\n\t\t};\n\t\t\n\t\t-- If the coauthor field is also used, prevent ampersand\
      \ and et al. formatting.\n\t\tif is_set(Coauthors) then\n\t\t\tcontrol.lastauthoramp = nil;\n\t\t\tcontrol.maximum = #a + 1;\n\t\tend\n\t\t\n\t\tAuthors = listpeople(control, a) \n\tend\n\n\tif not is_set(Authors) and is_set(Coauthors) then\t-- coauthors\
      \ aren't displayed if one of authors=, authorn=, or lastn= isn't specified\n\t\ttable.insert( z.message_tail, { seterror('coauthors_missing_author', {}, true) } );\t-- emit error message\n\tend\n\n\tlocal EditorCount\n\tif not is_set(Editors) then\n\t\t\
      local Maximum = tonumber( A['DisplayEditors'] );\n\t\t-- Preserve old-style implicit et al.\n\t\tif not is_set(Maximum) and #e == 4 then \n\t\t\tMaximum = 3;\n\t\t\ttable.insert( z.message_tail, { seterror('implict_etal_editor', {}, true) } );\n\t\telseif\
      \ not is_set(Maximum) then\n\t\t\tMaximum = #e + 1;\n\t\tend\n\n\t\tlocal control = { \n\t\t\tsep = A[&quot;EditorSeparator&quot;] .. &quot; &quot;,\n\t\t\tnamesep = (first_set(A[&quot;EditorNameSeparator&quot;], A[&quot;NameSeparator&quot;]) or &quot;&quot;)\
      \ .. &quot; &quot;,\n\t\t\tformat = A['EditorFormat'],\n\t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via authorlinkn\n\t\t};\n\n\t\tEditors,\
      \ EditorCount = listpeople(control, e);\n\telse\n\t\tEditorCount = 1;\n\tend\n\n\tlocal Cartography = &quot;&quot;;\n\tlocal Scale = &quot;&quot;;\n\tif config.CitationClass == &quot;map&quot; then\n\t\tif not is_set( Authors ) and is_set( PublisherName\
      \ ) then\n\t\t\tAuthors = PublisherName;\n\t\t\tPublisherName = &quot;&quot;;\n\t\tend\n\t\tCartography = A['Cartography'];\n\t\tif is_set( Cartography ) then\n\t\t\tCartography = sepc .. &quot; &quot; .. wrap( 'cartography', Cartography, use_lowercase\
      \ );\n\t\tend\t\t\n\t\tScale = A['Scale'];\n\t\tif is_set( Scale ) then\n\t\t\tScale = sepc .. &quot; &quot; .. Scale;\n\t\tend\t\t\n\tend\n\t\n\tif  not is_set(URL) and\n\t\tnot is_set(ChapterURL) and\n\t\tnot is_set(ArchiveURL) and\n\t\tnot is_set(ConferenceURL)\
      \ and\n\t\tnot is_set(TranscriptURL) then\n\t\t\n\t\t-- Test if cite web or cite podcast |url= is missing or empty \n\t\tif inArray(config.CitationClass, {&quot;web&quot;,&quot;podcast&quot;}) then\t\n\t\t\ttable.insert( z.message_tail, { seterror( 'cite_web_url',\
      \ {}, true ) } );\n\t\tend\n\t\t\n\t\t-- Test if accessdate is given without giving a URL\n\t\tif is_set(AccessDate) then\n\t\t\ttable.insert( z.message_tail, { seterror( 'accessdate_missing_url', {}, true ) } );\n\t\t\tAccessDate = '';\n\t\tend\n\t\t\n\
      \t\t-- Test if format is given without giving a URL\n\t\tif is_set(Format) then\n\t\t\tFormat = Format .. seterror( 'format_missing_url' );\n\t\tend\n\tend\n\t\n\t-- Test if citation has no title\n\tif\tnot is_set(Title) and\n\t\tnot is_set(Periodical)\
      \ and\n\t\tnot is_set(Conference) and\n\t\tnot is_set(TransTitle) and\n\t\tnot is_set(ScriptTitle) then\n\t\ttable.insert( z.message_tail, { seterror( 'citation_missing_title', {}, true ) } );\n\tend\n\t\n\tFormat = is_set(Format) and &quot; (&quot; ..\
      \ Format .. &quot;)&quot; or &quot;&quot;;\n\t\n\tlocal OriginalURL = URL\n\tDeadURL = DeadURL:lower();\n\tif is_set( ArchiveURL ) then\n\t\tif ( DeadURL ~= &quot;no&quot; ) then\n\t\t\tURL = ArchiveURL\n\t\t\tURLorigin = A:ORIGIN('ArchiveURL')\n\t\tend\n\
      \tend\n\t\n\t-- Format chapter / article title\n\tif is_set(Chapter) and is_set(ChapterLink) then \n\t\tChapter = &quot;[[&quot; .. ChapterLink .. &quot;|&quot; .. Chapter .. &quot;]]&quot;;\n\tend\n\n\tChapter = kern_quotes (Chapter);\t\t\t\t-- if necessary,\
      \ separate chapter title's leading and trailing quote marks from Module provided quote marks\n\tChapter = wrap( 'quoted-title', Chapter );\n\tTransChapter = wrap( 'trans-quoted-title', TransChapter );\n\n\tlocal TransError = &quot;&quot;\n\tif is_set(TransChapter)\
      \ then\n\t\tif not is_set(Chapter) then\n\t\t\tTransError = &quot; &quot; .. seterror( 'trans_missing_chapter' );\t\t-- add error message\n\t\telse\n\t\t\tTransChapter = &quot; &quot; .. TransChapter;\n\t\tend\n\tend\n\t\n\tChapter = Chapter .. TransChapter;\n\
      \t\n\tif is_set(Chapter) then\n\t\tif not is_set(ChapterLink) then\n\t\t\tif is_set(ChapterURL) then\n\t\t\t\tChapter = externallink( ChapterURL, Chapter ) .. TransError;\n\t\t\t\tif not is_set(URL) then\n\t\t\t\t\tChapter = Chapter .. Format;\n\t\t\t\t\
      \tFormat = &quot;&quot;;\n\t\t\t\tend\n\t\t\telseif is_set(URL) then \n\t\t\t\tChapter = externallink( URL, Chapter ) .. TransError .. Format;\n\t\t\t\tURL = &quot;&quot;;\n\t\t\t\tFormat = &quot;&quot;;\n\t\t\telse\n\t\t\t\tChapter = Chapter .. TransError;\n\
      \t\t\tend\t\t\t\n\t\telseif is_set(ChapterURL) then\n\t\t\tChapter = Chapter .. &quot; &quot; .. externallink( ChapterURL, nil, ChapterURLorigin ) .. TransError;\t-- ChapterURLorigin holds the name of parameter\n\t\telse\n\t\t\tChapter = Chapter .. TransError;\n\
      \t\tend\n\t\tChapter = Chapter .. sepc .. &quot; &quot; -- with end-space\n\telseif is_set(ChapterURL) then\n\t\tChapter = &quot; &quot; .. externallink( ChapterURL, nil, ChapterURLorigin ) .. sepc .. &quot; &quot;;\n\tend\t\t\n\t\n\t-- Format main title.\n\
      \tif is_set(TitleLink) and is_set(Title) then\n\t\tTitle = &quot;[[&quot; .. TitleLink .. &quot;|&quot; .. Title .. &quot;]]&quot;\n\tend\n\n\tif inArray(config.CitationClass, {&quot;web&quot;,&quot;news&quot;,&quot;journal&quot;,&quot;pressrelease&quot;,&quot;conference&quot;,&quot;podcast&quot;})\
      \ then\n\t\tTitle = kern_quotes (Title);\t\t\t\t\t\t\t\t\t\t\t-- if necessary, separate title's leading and trailing quote marks from Module provided quote marks\n\t\tTitle = wrap( 'quoted-title', Title );\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\
      \t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title is wrapped\n\t\tTransTitle = wrap( 'trans-quoted-title', TransTitle );\n--\t\tChapter = '';\t\t\t\t\t\t\t\t-- chapter not allowed - disabled because doing this\
      \ here doesn't display error msg and promoted url is lost\n\telse\n\t\tTitle = wrap( 'italic-title', Title );\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title\
      \ is wrapped\n\t\tTransTitle = wrap( 'trans-italic-title', TransTitle );\n\tend\n\n\tTransError = &quot;&quot;;\n\tif is_set(TransTitle) then\n\t\tif is_set(Title) then\n\t\t\tTransTitle = &quot; &quot; .. TransTitle;\n\t\telse\n\t\t\tTransError = &quot;\
      \ &quot; .. seterror( 'trans_missing_title' );\n\t\tend\n\tend\n\t\n\tTitle = Title .. TransTitle;\n\t\n\tif is_set(Title) then\n\t\tif not is_set(TitleLink) and is_set(URL) then \n\t\t\tTitle = externallink( URL, Title ) .. TransError .. Format\t   \n\
      \t\t\tURL = &quot;&quot;;\n\t\t\tFormat = &quot;&quot;;\n\t\telse\n\t\t\tTitle = Title .. TransError;\n\t\tend\n\tend\n\n\tif is_set(Place) then\n\t\tPlace = &quot; &quot; .. wrap( 'written', Place, use_lowercase ) .. sepc .. &quot; &quot;;\n\tend\n\t\n\
      \tif is_set(Conference) then\n\t\tif is_set(ConferenceURL) then\n\t\t\tConference = externallink( ConferenceURL, Conference );\n\t\tend\n\t\tConference = sepc .. &quot; &quot; .. Conference\n\telseif is_set(ConferenceURL) then\n\t\tConference = sepc ..\
      \ &quot; &quot; .. externallink( ConferenceURL, nil, ConferenceURLorigin );\n\tend\n\t\n\tif not is_set(Position) then\n\t\tlocal Minutes = A['Minutes'];\n\t\tif is_set(Minutes) then\n\t\t\tPosition = &quot; &quot; .. Minutes .. &quot; &quot; .. cfg.messages['minutes'];\n\
      \t\telse\n\t\t\tlocal Time = A['Time'];\n\t\t\tif is_set(Time) then\n\t\t\t\tlocal TimeCaption = A['TimeCaption']\n\t\t\t\tif not is_set(TimeCaption) then\n\t\t\t\t\tTimeCaption = cfg.messages['event'];\n\t\t\t\t\tif sepc ~= '.' then\n\t\t\t\t\t\tTimeCaption\
      \ = TimeCaption:lower();\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\tPosition = &quot; &quot; .. TimeCaption .. &quot; &quot; .. Time;\n\t\t\tend\n\t\tend\n\telse\n\t\tPosition = &quot; &quot; .. Position;\n\t\tAt = '';\n\tend\n\t\n\tif not is_set(Page) then\n\
      \t\tif is_set(Pages) then\n\t\t\tif is_set(Periodical) and\n\t\t\t\tnot inArray(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;}) then\n\t\t\t\tPages = &quot;: &quot; .. Pages;\n\t\t\
      \telseif tonumber(Pages) ~= nil then\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPrefix .. Pages;\n\t\t\telse\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPPrefix .. Pages;\n\t\t\tend\n\t\tend\n\telse\n\t\tif is_set(Periodical) and\n\t\t\tnot inArray(config.CitationClass,\
      \ {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;}) then\n\t\t\tPage = &quot;: &quot; .. Page;\n\t\telse\n\t\t\tPage = sepc ..&quot; &quot; .. PPrefix .. Page;\n\t\tend\n\tend\n\t\n\tAt = is_set(At) and\
      \ (sepc .. &quot; &quot; .. At) or &quot;&quot;;\n\tPosition = is_set(Position) and (sepc .. &quot; &quot; .. Position) or &quot;&quot;;\n\tif config.CitationClass == 'map' then\n\t\tlocal Section = A['Section'];\n\t\tlocal Inset = A['Inset'];\n\t\tif\
      \ first_set( Pages, Page, At ) ~= nil or sepc ~= '.' then\n\t\t\tif is_set( Section ) then\n\t\t\t\tSection = &quot;, &quot; .. wrap( 'section', Section, true );\n\t\t\tend\n\t\t\tif is_set( Inset ) then\n\t\t\t\tInset = &quot;, &quot; .. wrap( 'inset',\
      \ Inset, true );\n\t\t\tend\n\t\telse\n\t\t\tif is_set( Section ) then\n\t\t\t\tSection = sepc .. &quot; &quot; .. wrap( 'section', Section, use_lowercase );\n\t\t\t\tif is_set( Inset ) then\n\t\t\t\t\tInset = &quot;, &quot; .. wrap( 'inset', Inset, true\
      \ );\n\t\t\t\tend\n\t\t\telseif is_set( Inset ) then\n\t\t\t\tInset = sepc .. &quot; &quot; .. wrap( 'inset', Inset, use_lowercase );\n\t\t\tend\t\t\t\n\t\tend\t\t\t\n\t\tAt = At .. Section .. Inset;\t\t\n\tend\t\n\n\tif is_set (Language) then\n\t\tLanguage\
      \ = language_parameter (Language, this_page.namespace);\t\t\t-- format, categories (article namespace only), name from ISO639-1, etc\n\telse\n\t\tLanguage=&quot;&quot;;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- language not specified so make sure this is an empty\
      \ string;\n\tend\n\n\tOthers = is_set(Others) and (sepc .. &quot; &quot; .. Others) or &quot;&quot;;\n\n-- handle type parameter for those CS1 citations that have default values\n\n\tif inArray(config.CitationClass, {&quot;AV-media-notes&quot;, &quot;DVD-notes&quot;,\
      \ &quot;podcast&quot;, &quot;pressrelease&quot;, &quot;techreport&quot;, &quot;thesis&quot;}) then\n\t\tTitleType = set_titletype (config.CitationClass, TitleType);\n\t\tif is_set(Degree) and &quot;Thesis&quot; == TitleType then\t-- special case for cite\
      \ thesis\n\t\t\tTitleType = Degree .. &quot; thesis&quot;;\n\t\tend\n\tend\n\n\tif is_set(TitleType) then\t\t\t\t\t-- if type parameter is specified\n\t\tTitleType = &quot; (&quot; .. TitleType .. &quot;)&quot;;\t-- display it in parentheses\n\tend\n\n\
      \tTitleNote = is_set(TitleNote) and (sepc .. &quot; &quot; .. TitleNote) or &quot;&quot;;\n\tEdition = is_set(Edition) and (&quot; &quot; .. wrap( 'edition', Edition )) or &quot;&quot;;\n\tIssue = is_set(Issue) and (&quot; (&quot; .. Issue .. &quot;)&quot;)\
      \ or &quot;&quot;;\n\tSeries = is_set(Series) and (sepc .. &quot; &quot; .. Series) or &quot;&quot;;\n\tOrigYear = is_set(OrigYear) and (&quot; [&quot; .. OrigYear .. &quot;]&quot;) or &quot;&quot;;\n\tAgency = is_set(Agency) and (sepc .. &quot; &quot;\
      \ .. Agency) or &quot;&quot;;\n\n\tif is_set(Volume) then\n\t\tif ( mw.ustring.len(Volume) &gt; 4 )\n\t\t  then Volume = sepc ..&quot; &quot; .. Volume;\n\t\t  else Volume = &quot; &lt;b&gt;&quot; .. hyphentodash(Volume) .. &quot;&lt;/b&gt;&quot;;\n\t\t\
      end\n\tend\n\n--[[ This code commented out while discussion continues until after week of 2014-03-23 live module update;\n\tif is_set(Volume) then\n\t\tif ( mw.ustring.len(Volume) &gt; 4 )\n\t\t  then Volume = sepc .. &quot; &quot; .. Volume;\n\t\t  else\n\
      \t\t\t  Volume = &quot; &lt;b&gt;&quot; .. hyphentodash(Volume) .. &quot;&lt;/b&gt;&quot;;\n\t\t\t  if is_set(Series) then Volume = sepc .. Volume;\n\t\t\t  end\n\t\tend\n\tend\n]]\t\n\t------------------------------------ totally unrelated data\n\t--[[\
      \ Loosely mimic {{subscription required}} template; Via parameter identifies a delivery source that is not the publisher; these sources often, but not always, exist\n\tbehind a registration or paywall.  So here, we've chosen to decouple via from subscription\
      \ (via has never been part of the registration required template).\n\t\n\tSubscription implies paywall; Registration does not.  If both are used in a citation, the subscription required link note is displayed. There are no error messages for this condition.\n\
      \t]]\n\tif is_set(Via) then\n\t\tVia = &quot; &quot; .. wrap( 'via', Via );\n\tend\n\n\tif is_set(SubscriptionRequired) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot; .. cfg.messages['subscription']; --here when 'via' parameter not used but 'subscription'\
      \ is\n\telseif is_set(RegistrationRequired) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot; .. cfg.messages['registration']; --here when 'via' and 'subscription' parameters not used but 'registration' is\n\tend\n\n\tif is_set(AccessDate) then\n\t\
      \tlocal retrv_text = &quot; &quot; .. cfg.messages['retrieved']\n\t\tif (sepc ~= &quot;.&quot;) then retrv_text = retrv_text:lower() end\n\t\tAccessDate = '&lt;span class=&quot;reference-accessdate&quot;&gt;' .. sepc\n\t\t\t.. substitute( retrv_text, {AccessDate}\
      \ ) .. '&lt;/span&gt;'\n\tend\n\t\n\tif is_set(ID) then ID = sepc ..&quot; &quot;.. ID; end\n   \tif &quot;thesis&quot; == config.CitationClass and is_set(Docket) then\n\t\tID = sepc ..&quot; Docket &quot;.. Docket .. ID;\n\tend\n\n\t\n\tID_list = buildidlist(\
      \ ID_list, {DoiBroken = DoiBroken, ASINTLD = ASINTLD, IgnoreISBN = IgnoreISBN, Embargo=Embargo} );\n\n\tif is_set(URL) then\n\t\tURL = &quot; &quot; .. externallink( URL, nil, URLorigin );\n\tend\n\n\tif is_set(Quote) then\n\t\tif Quote:sub(1,1) == '&quot;'\
      \ and Quote:sub(-1,-1) == '&quot;' then\n\t\t\tQuote = Quote:sub(2,-2);\n\t\tend\n\t\tQuote = sepc ..&quot; &quot; .. wrap( 'quoted-text', Quote ); \n\t\tPostScript = &quot;&quot;;\t\t\t\t\t\t\t-- CS1 does not supply terminal punctuation when |quote= is\
      \ set\n\tend\n\t\n\tlocal Archived\n\tif is_set(ArchiveURL) then\n\t\tif not is_set(ArchiveDate) then\n\t\t\tArchiveDate = seterror('archive_missing_date');\n\t\tend\n\t\tif &quot;no&quot; == DeadURL then\n\t\t\tlocal arch_text = cfg.messages['archived'];\n\
      \t\t\tif sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( cfg.messages['archived-not-dead'],\n\t\t\t\t{ externallink( ArchiveURL, arch_text ), ArchiveDate } );\n\t\t\tif not is_set(OriginalURL)\
      \ then\n\t\t\t\tArchived = Archived .. &quot; &quot; .. seterror('archive_missing_url');\t\t\t\t\t\t\t   \n\t\t\tend\n\t\telseif is_set(OriginalURL) then\n\t\t\tlocal arch_text = cfg.messages['archived-dead'];\n\t\t\tif sepc ~= &quot;.&quot; then arch_text\
      \ = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( arch_text,\n\t\t\t\t{ externallink( OriginalURL, cfg.messages['original'] ), ArchiveDate } );\n\t\telse\n\t\t\tlocal arch_text = cfg.messages['archived-missing'];\n\t\t\t\
      if sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( arch_text, \n\t\t\t\t{ seterror('archive_missing_url'), ArchiveDate } );\n\t\tend\n\telse\n\t\tArchived = &quot;&quot;\n\tend\n\t\n\t\
      local Lay\n\tif is_set(LayURL) then\n\t\tif is_set(LayDate) then LayDate = &quot; (&quot; .. LayDate .. &quot;)&quot; end\n\t\tif is_set(LaySource) then \n\t\t\tLaySource = &quot; &amp;ndash; ''&quot; .. safeforitalics(LaySource) .. &quot;''&quot;;\n\t\
      \telse\n\t\t\tLaySource = &quot;&quot;;\n\t\tend\n\t\tif sepc == '.' then\n\t\t\tLay = sepc .. &quot; &quot; .. externallink( LayURL, cfg.messages['lay summary'] ) .. LaySource .. LayDate\n\t\telse\n\t\t\tLay = sepc .. &quot; &quot; .. externallink( LayURL,\
      \ cfg.messages['lay summary']:lower() ) .. LaySource .. LayDate\n\t\tend\t\t\t\n\telse\n\t\tLay = &quot;&quot;;\n\tend\n\t\n\tif is_set(Transcript) then\n\t\tif is_set(TranscriptURL) then Transcript = externallink( TranscriptURL, Transcript ); end\n\t\
      elseif is_set(TranscriptURL) then\n\t\tTranscript = externallink( TranscriptURL, nil, TranscriptURLorigin );\n\tend\n\t\n\tlocal Publisher;\n\tif is_set(Periodical) and\n\t\tnot inArray(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;pressrelease&quot;,&quot;podcast&quot;})\
      \ then\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace) then\n\t\t\t\tPublisher = PublicationPlace .. &quot;: &quot; .. PublisherName;\n\t\t\telse\n\t\t\t\tPublisher = PublisherName;  \n\t\t\tend\n\t\telseif is_set(PublicationPlace)\
      \ then\n\t\t\tPublisher= PublicationPlace;\n\t\telse \n\t\t\tPublisher = &quot;&quot;;\n\t\tend\n\t\tif is_set(PublicationDate) then\n\t\t\tif is_set(Publisher) then\n\t\t\t\tPublisher = Publisher .. &quot;, &quot; .. wrap( 'published', PublicationDate\
      \ );\n\t\t\telse\n\t\t\t\tPublisher = PublicationDate;\n\t\t\tend\n\t\tend\n\t\tif is_set(Publisher) then\n\t\t\tPublisher = &quot; (&quot; .. Publisher .. &quot;)&quot;;\n\t\tend\n\telse\n\t\tif is_set(PublicationDate) then\n\t\t\tPublicationDate = &quot;\
      \ (&quot; .. wrap( 'published', PublicationDate ) .. &quot;)&quot;;\n\t\tend\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace) then\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublicationPlace .. &quot;: &quot; .. PublisherName ..\
      \ PublicationDate;\n\t\t\telse\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublisherName .. PublicationDate;  \n\t\t\tend\t\t\t\n\t\telseif is_set(PublicationPlace) then \n\t\t\tPublisher= sepc .. &quot; &quot; .. PublicationPlace .. PublicationDate;\n\
      \t\telse \n\t\t\tPublisher = PublicationDate;\n\t\tend\n\tend\n\t\n\t-- Several of the above rely upon detecting this as nil, so do it last.\n\tif is_set(Periodical) then\n\t\tif is_set(Title) or is_set(TitleNote) then \n\t\t\tPeriodical = sepc .. &quot;\
      \ &quot; .. wrap( 'italic-title', Periodical ) \n\t\telse \n\t\t\tPeriodical = wrap( 'italic-title', Periodical )\n\t\tend\n\tend\n\n--[[\nHandle the oddity that is cite speech.  This code overrides whatever may be the value assigned to TitleNote (through\
      \ |department=) and forces it to be &quot; (Speech)&quot; so that\nthe annotation directly follows the |title= parameter value in the citation rather than the |event= parameter value (if provided).\n]]\n\tif &quot;speech&quot; == config.CitationClass then\t\
      \t\t\t-- cite speech only\n\t\tTitleNote = &quot; (Speech)&quot;;\t\t\t\t\t\t\t-- annotate the citation\n\t\tif is_set (Periodical) then\t\t\t\t\t\t\t-- if Periodical, perhaps because of an included |website= or |journal= parameter \n\t\t\tif is_set (Conference)\
      \ then\t\t\t\t\t\t-- and if |event= is set\n\t\t\t\tConference = Conference .. sepc .. &quot; &quot;;\t\t-- then add appropriate punctuation to the end of the Conference variable before rendering\n\t\t\tend\n\t\tend\n\tend\n\n\t-- Piece all bits together\
      \ at last.  Here, all should be non-nil.\n\t-- We build things this way because it is more efficient in LUA\n\t-- not to keep reassigning to the same string variable over and over.\n\n\tlocal tcommon\n\tif inArray(config.CitationClass, {&quot;journal&quot;,&quot;citation&quot;})\
      \ and is_set(Periodical) then\n\t\tif is_set(Others) then Others = Others .. sepc .. &quot; &quot; end\n\t\ttcommon = safejoin( {Others, Title, TitleNote, Conference, Periodical, Format, TitleType, Scale, Series, \n\t\t\tLanguage, Cartography, Edition,\
      \ Publisher, Agency, Volume, Issue}, sepc );\n\telse \n\t\ttcommon = safejoin( {Title, TitleNote, Conference, Periodical, Format, TitleType, Scale, Series, Language, \n\t\t\tVolume, Issue, Others, Cartography, Edition, Publisher, Agency}, sepc );\n\tend\n\
      \t\n\tif #ID_list &gt; 0 then\n\t\tID_list = safejoin( { sepc .. &quot; &quot;,  table.concat( ID_list, sepc .. &quot; &quot; ), ID }, sepc );\n\telse\n\t\tID_list = ID;\n\tend\n\t\n\tlocal idcommon = safejoin( { ID_list, URL, Archived, AccessDate, Via,\
      \ SubscriptionRequired, Lay, Quote }, sepc );\n\tlocal text;\n\tlocal pgtext = Position .. Page .. Pages .. At;\n\t\n\tif is_set(Authors) then\n\t\tif is_set(Coauthors) then\n\t\t\tAuthors = Authors .. A['AuthorSeparator'] .. &quot; &quot; .. Coauthors\n\
      \t\tend\n\t\tif is_set(Date) then\n\t\t\tDate = &quot; (&quot;..Date..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telseif string.sub(Authors,-1,-1) == sepc then\n\t\t\tAuthors = Authors .. &quot; &quot;\n\t\telse\n\t\t\tAuthors = Authors ..\
      \ sepc .. &quot; &quot;\n\t\tend\n\t\tif is_set(Editors) then\n\t\t\tlocal in_text = &quot; &quot;;\n\t\t\tlocal post_text = &quot;&quot;;\n\t\t\tif is_set(Chapter) then\n\t\t\t\tin_text = in_text .. cfg.messages['in'] .. &quot; &quot;\n\t\t\telse\n\t\t\
      \t\tif EditorCount &lt;= 1 then\n\t\t\t\t\tpost_text = &quot;, &quot; .. cfg.messages['editor'];\n\t\t\t\telse\n\t\t\t\t\tpost_text = &quot;, &quot; .. cfg.messages['editors'];\n\t\t\t\tend\n\t\t\tend \n\t\t\tif (sepc ~= '.') then in_text = in_text:lower()\
      \ end\n\t\t\tEditors = in_text .. Editors .. post_text;\n\t\t\tif (string.sub(Editors,-1,-1) == sepc)\n\t\t\t\tthen Editors = Editors .. &quot; &quot;\n\t\t\t\telse Editors = Editors .. sepc .. &quot; &quot;\n\t\t\tend\n\t\tend\n\t\ttext = safejoin( {Authors,\
      \ Date, Chapter, Place, Editors, tcommon }, sepc );\n\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\telseif is_set(Editors) then\n\t\tif is_set(Date) then\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editor'];\n\
      \t\t\telse\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editors'];\n\t\t\tend\n\t\t\tDate = &quot; (&quot; .. Date ..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telse\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors\
      \ .. &quot; (&quot; .. cfg.messages['editor'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\t\t\telse\n\t\t\t\tEditors = Editors .. &quot; (&quot; .. cfg.messages['editors'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\t\t\tend\n\t\tend\n\t\ttext = safejoin(\
      \ {Editors, Date, Chapter, Place, tcommon}, sepc );\n\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\telse\n\t\tif is_set(Date) then\n\t\t\tif ( string.sub(tcommon,-1,-1) ~= sepc )\n\t\t\t  then Date = sepc ..&quot; &quot; .. Date .. OrigYear\n\
      \t\t\t  else Date = &quot; &quot; .. Date .. OrigYear\n\t\t\tend\n\t\tend\n\t\tif config.CitationClass==&quot;journal&quot; and is_set(Periodical) then\n\t\t\ttext = safejoin( {Chapter, Place, tcommon}, sepc );\n\t\t\ttext = safejoin( {text, pgtext, Date,\
      \ idcommon}, sepc );\n\t\telse\n\t\t\ttext = safejoin( {Chapter, Place, tcommon, Date}, sepc );\n\t\t\ttext = safejoin( {text, pgtext, idcommon}, sepc );\n\t\tend\n\tend\n\t\n\tif is_set(PostScript) and PostScript ~= sepc then\n\t\ttext = safejoin( {text,\
      \ sepc}, sepc );  --Deals with italics, spaces, etc.\n\t\ttext = text:sub(1,-sepc:len()-1);\n--\t\ttext = text:sub(1,-2);\t--Remove final separator (assumes that sepc is only one character)\n\tend\t\n\t\n\ttext = safejoin( {text, PostScript}, sepc );\n\
      \n\t-- Now enclose the whole thing in a &lt;span/&gt; element\n\tlocal options = {};\n\t\n\tif is_set(config.CitationClass) and config.CitationClass ~= &quot;citation&quot; then\n\t\toptions.class = &quot;citation &quot; .. config.CitationClass;\n\telse\n\
      \t\toptions.class = &quot;citation&quot;;\n\tend\n\t\n\tif is_set(Ref) and Ref:lower() ~= &quot;none&quot; then\n\t\tlocal id = Ref\n\t\tif ( &quot;harv&quot; == Ref ) then\n\t\t\tlocal names = {} --table of last names &amp; year\n\t\t\tif #a &gt; 0 then\n\
      \t\t\t\tfor i,v in ipairs(a) do \n\t\t\t\t\tnames[i] = v.last \n\t\t\t\t\tif i == 4 then break end\n\t\t\t\tend\n\t\t\telseif #e &gt; 0 then\n\t\t\t\tfor i,v in ipairs(e) do \n\t\t\t\t\tnames[i] = v.last \n\t\t\t\t\tif i == 4 then break end\t\t\t\t\n\t\
      \t\t\tend\n\t\t\tend\n\t\t\tnames[ #names + 1 ] = first_set(Year, anchor_year);\t-- Year first for legacy citations\n\t\t\tid = anchorid(names)\n\t\tend\n\t\toptions.id = id;\n\tend\n\t\n\tif string.len(text:gsub(&quot;&lt;span[^&gt;/]*&gt;.-&lt;/span&gt;&quot;,\
      \ &quot;&quot;):gsub(&quot;%b&lt;&gt;&quot;,&quot;&quot;)) &lt;= 2 then\n\t\tz.error_categories = {};\n\t\ttext = seterror('empty_citation');\n\t\tz.message_tail = {};\n\tend\n\t\n\tif is_set(options.id) then \n\t\ttext = '&lt;span id=&quot;' .. mw.uri.anchorEncode(options.id)\
      \ ..'&quot; class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\telse\n\t\ttext = '&lt;span class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\tend\t\
      \t\n\n\tlocal empty_span = '&lt;span style=&quot;display:none;&quot;&gt;&amp;nbsp;&lt;/span&gt;';\n\t\n\t-- Note: Using display: none on then COinS span breaks some clients.\n\tlocal OCinS = '&lt;span title=&quot;' .. OCinSoutput .. '&quot; class=&quot;Z3988&quot;&gt;'\
      \ .. empty_span .. '&lt;/span&gt;';\n\ttext = text .. OCinS;\n\t\n\tif #z.message_tail ~= 0 then\n\t\ttext = text .. &quot; &quot;;\n\t\tfor i,v in ipairs( z.message_tail ) do\n\t\t\tif is_set(v[1]) then\n\t\t\t\tif i == #z.message_tail then\n\t\t\t\t\t\
      text = text .. errorcomment( v[1], v[2] );\n\t\t\t\telse\n\t\t\t\t\ttext = text .. errorcomment( v[1] .. &quot;; &quot;, v[2] );\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\t\n\tno_tracking_cats = no_tracking_cats:lower();\n\tif inArray(no_tracking_cats,\
      \ {&quot;&quot;, &quot;no&quot;, &quot;false&quot;, &quot;n&quot;}) then\n\t\tfor _, v in ipairs( z.error_categories ) do\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _, v in ipairs( z.maintenance_cats ) do\t\t\t\t\t\t\t\t-- append\
      \ maintenance categories\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _, v in ipairs( z.properties_cats ) do\t\t\t\t\t\t\t\t-- append maintenance categories\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\tend\n\t\n\t\
      return text\nend\n\n-- This is used by templates such as {{cite book}} to create the actual citation text.\nfunction z.citation(frame)\n\tlocal pframe = frame:getParent()\n\t\n\tif nil ~= string.find( frame:getTitle(), 'sandbox', 1, true ) then\t\t\t\t\
      -- did the {{#invoke:}} use sandbox version?\n\t\tcfg = mw.loadData( 'Module:Citation/CS1/Configuration/sandbox' );\t-- load sandbox versions of Configuration and Whitelist and ...\n\t\twhitelist = mw.loadData( 'Module:Citation/CS1/Whitelist/sandbox' );\n\
      \t\tdates = require('Module:Citation/CS1/Date_validation/sandbox').dates\t-- ... sandbox version of date validation code\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- otherwise\n\t\tcfg = mw.loadData( 'Module:Citation/CS1/Configuration' );\t\t\t-- load live\
      \ versions of Configuration and Whitelist and ...\n\t\twhitelist = mw.loadData( 'Module:Citation/CS1/Whitelist' );\n\t\tdates = require('Module:Citation/CS1/Date_validation').dates\t\t-- ... live version of date validation code\n\tend\n\t\n\tlocal args\
      \ = {};\n\tlocal suggestions = {};\n\tlocal error_text, error_state;\n\n\tlocal config = {};\n\tfor k, v in pairs( frame.args ) do\n\t\tconfig[k] = v;\n\t\targs[k] = v;\t   \n\tend\t\n\n\tfor k, v in pairs( pframe.args ) do\n\t\tif v ~= '' then\n\t\t\t\
      if not validate( k ) then\t\t\t\n\t\t\t\terror_text = &quot;&quot;;\n\t\t\t\tif type( k ) ~= 'string' then\n\t\t\t\t\t-- Exclude empty numbered parameters\n\t\t\t\t\tif v:match(&quot;%S+&quot;) ~= nil then\n\t\t\t\t\t\terror_text, error_state = seterror(\
      \ 'text_ignored', {v}, true );\n\t\t\t\t\tend\n\t\t\t\telseif validate( k:lower() ) then \n\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored_suggest', {k, k:lower()}, true );\n\t\t\t\telse\n\t\t\t\t\tif #suggestions == 0 then\n\t\t\t\t\t\
      \tsuggestions = mw.loadData( 'Module:Citation/CS1/Suggestions' );\n\t\t\t\t\tend\n\t\t\t\t\tif suggestions[ k:lower() ] ~= nil then\n\t\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored_suggest', {k, suggestions[ k:lower() ]}, true );\n\t\
      \t\t\t\telse\n\t\t\t\t\t\terror_text, error_state = seterror( 'parameter_ignored', {k}, true );\n\t\t\t\t\tend\n\t\t\t\tend\t\t\t\t  \n\t\t\t\tif error_text ~= '' then\n\t\t\t\t\ttable.insert( z.message_tail, {error_text, error_state} );\n\t\t\t\tend\t\
      \t\t\t\n\t\t\tend\n\t\t\targs[k] = v;\n\t\telseif args[k] ~= nil or (k == 'postscript') then\n\t\t\targs[k] = v;\n\t\tend\t\t\n\tend\t\n\t\n\treturn citation0( config, args)\nend\n\nreturn z</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:47.145Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acn&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:47 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq38 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025921308, 176728936, 4115586877
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cn" to="Template:Cn" /></normalized><pages><page pageid="4626496" ns="10" title="Template:Cn"><revisions><rev user="Mr. Stradivarius" timestamp="2012-11-15T10:38:37Z" comment="Add redirect category per edit protected request" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Citation needed]]

      {{This is a redirect|from template shortcut|protected}}</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:47.759Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACitation+needed&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:47 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404136992, 3156591920, 4115587477
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="2048472" ns="10" title="Template:Citation needed"><revisions><rev user="HJ Mitchell" timestamp="2014-03-29T13:47:10Z" comment="Changed protection level of Template:Citation needed: listed on [[WP:CASC]], and probably needs to stay at full prot; cf. https://en.wikipedia.org/w/index.php?title=Wikipedia:Requests_for_page_protection&amp;diff=601804535&amp;oldid=601804352 ([Edit=Allow only ad" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||$N=Citation needed |date=__DATE__ |$B=
      {{Fix
      |name={{{name|Citation needed}}}
      |link=Wikipedia:Citation needed
      |text=citation needed
      |class=Template-Fact
      |title={{{reason|This claim needs references to reliable sources.}}}
      |date={{{date|}}}
      |cat=[[Category:All articles with unsourced statements]]
      |cat-date=Category:Articles with unsourced statements
      }}{{#if:{{{1|}}}|[[Category:Pages containing citation needed template with deprecated parameters]]}}
      }}&lt;noinclude&gt;

      {{Documentation}}

      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:48.051Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFix&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:48 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404137787, 3298517320, 4115588155
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"5632010\" ns=\"10\" title=\"Template:Fix\"><revisions><rev user=\"Waldir\" timestamp=\"2014-05-11T01:03:11Z\" comment=\"if the noprint and inline-template classes need to\
      \ be preserved, according to the docs, then why not enforcing in the code rather than asking people to do it (and relying on them reading the docs attentively enough not to miss that)?\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"\
      preserve\">{{#switch:{{{subst|¬}}}\n |¬={{category handler\n  |template=[[Category:Templates needing substitution checking]]\n  |nocat={{{nocat|&lt;noinclude&gt;true&lt;/noinclude&gt;}}}\n }}\n |SUBST=[[Category:Pages with incorrectly substituted templates]]\n\
      }}{{Category handler\n |main={{Fix/category\n  |cat-date={{{cat-date|}}} \n  |cat={{{cat|}}} \n  |cat-date2={{{cat-date2|}}} \n  |cat2={{{cat2|}}} \n  |cat-date3={{{cat-date3|}}} \n  |cat3={{{cat3|}}} \n  |date={{{date|}}}\n }}\n |template={{#if:{{{name|}}}|{{#ifeq:{{{name}}}|{{ROOTPAGENAME}}||{{#if:{{{date|}}}||[[Category:Templates\
      \ including undated clean-up tags]]}}}}}} \n |subpage=no\n}}{{#if:{{{text|}}}\n |&lt;sup class=&quot;noprint Inline-Template {{{class|}}}&quot; style=&quot;white-space:nowrap;&quot;&gt;&amp;#91;&lt;i&gt;{{#if:{{{pre-text|}}}\n  |{{{pre-text}}}&amp;#32;\n\
      \ }}[[{{{link|Wikipedia:Cleanup}}}|&lt;span title=&quot;{{{title|{{{link|Wikipedia:Cleanup}}}}}}{{#if:{{{date|}}}|&lt;nowiki/&gt; ({{{date}}})}}&quot;&gt;{{{text|}}}&lt;/span&gt;]]{{#if:{{{post-text|}}}\n  |&amp;#32;{{{post-text}}}\n }}&lt;/i&gt;&amp;#93;&lt;/sup&gt;|{{{special|}}}\n\
      }}&lt;noinclude&gt;\n{{Documentation}}\n&lt;!-- Add cats and interwikis to the /doc subpage, not here! --&gt;\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:48.330Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFix%2Fcategory&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:48 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq60 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025923264, 361884838, 4115588320
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="34017846" ns="10" title="Template:Fix/category"><revisions><rev user="TheDJ" timestamp="2012-01-17T21:00:05Z" comment="Adding {{pp-template}} ([[WP:TW|TW]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;noinclude&gt;{{pp-template|small=yes}}&lt;/noinclude&gt;{{{cat|[[Category:All pages needing cleanup]]}}}{{#if:{{{cat-date|}}}
        |[[{{{cat-date}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}{{#if:{{{cat2|}}}|{{{cat2}}}}}{{#if:{{{cat-date2|}}}
        |[[{{{cat-date2}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date2}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}{{#if:{{{cat3|}}}|{{{cat3}}}}}{{#if:{{{cat-date3|}}}
        |[[{{{cat-date3}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date3}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:48.597Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AROOTPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:48 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103558123, 1470644488, 4115588450
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="22351615" ns="10" title="Template:ROOTPAGENAME"><revisions><rev user="Amalthea" timestamp="2010-05-03T11:31:08Z" comment="Allow substitution using safesubst: ([[meta:Help:Safesubst]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}PAGENAME:{{ {{{|safesubst:}}}FULLROOTPAGENAME|{{{1|}}}}}}}&lt;noinclude&gt;

      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:48.873Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3AFULLROOTPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:48 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103558652, 1470644742, 4115588750
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:safesubst:FULLROOTPAGENAME" to="Template:Safesubst:FULLROOTPAGENAME" /></normalized><pages><page ns="10" title="Template:Safesubst:FULLROOTPAGENAME" missing="" /></pages></query></api>
- recorded: 2014-11-04T23:11:49.295Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asafesubst%3APAGENAME%3A%5B%5B%3ATemplate%3Asafesubst%3AFULLROOTPAGENAME%5D%5D&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:49 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq51 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227052241, 571393041, 4115588908
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page title="Template:safesubst:PAGENAME:[[:Template:safesubst:FULLROOTPAGENAME]]" invalid="" /></pages></query></api>
- recorded: 2014-11-04T23:11:49.557Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:49 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349012215, 3298518130, 4115589300
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="25084818" ns="10" title="Template:Category handler"><revisions><rev user="Mr. Stradivarius" timestamp="2013-10-20T10:48:53Z" comment="Changed protection level of Template:Category handler: [[WP:High-risk templates|Highly visible template]]: allow template editors to edit ([Edit=Protected template] (indefinite) [Move=Protected template] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Category handler|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Add categories to the /doc subpage, and interwikis to Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:49.867Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+book&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:49 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349012449, 3298518270, 4115589519
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite book" to="Template:Cite book" /></normalized><pages><page pageid="4086375" ns="10" title="Template:Cite book"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:57:54Z" comment="Changed protection level of Template:Cite book: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=book
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:50.157Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACite+book&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:50 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404140479, 2402517228, 4115589668
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="4086375" ns="10" title="Template:Cite book"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:57:54Z" comment="Changed protection level of Template:Cite book: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=book
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:50.830Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3A%27&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:50 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq41 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530337770, 655026367, 4115590311
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="5593936" ns="10" title="Template:&#039;"><revisions><rev user="Mr. Stradivarius" timestamp="2014-10-20T22:04:00Z" comment="use a normal apostrophe surrounded by a hair width space and a zero width space to simplify the code and reduce the post-expand include size, per protected edit request by [[User:Rich Farmbrough]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve"> '​&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:51.444Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aciteweb&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:51 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530339365, 290981501, 4115591646
    body: '<?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:citeweb" to="Template:Citeweb" /></normalized><pages><page pageid="7105693" ns="10" title="Template:Citeweb"><revisions><rev user="Tariqabjotu" timestamp="2007-02-07T22:33:06Z"
      comment="Protected Template:Citeweb: high-profile redirect [edit=sysop:move=sysop]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#redirect [[Template:Cite web]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:11:52.448Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACite+web&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:51 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq48 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025929156, 296402615, 4115592513
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="4148498" ns="10" title="Template:Cite web"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:56:36Z" comment="Changed protection level of Template:Cite web: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=web
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:52.981Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Arotten-tomatoes&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:52 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq61 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103567142, 3811682032, 4115594072
    body: '<?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:rotten-tomatoes" to="Template:Rotten-tomatoes" /></normalized><pages><page pageid="4641212" ns="10" title="Template:Rotten-tomatoes"><revisions><rev user="AGK" timestamp="2012-04-23T11:09:23Z"
      comment="Protected Template:Rotten-tomatoes: [[Wikipedia:High-risk templates|Highly-visible template]] (thousands of transclusions) (‎[edit=autoconfirmed] (indefinite) ‎[move=sysop] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT
      [[Template:Rotten Tomatoes]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:11:53.260Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ARotten+Tomatoes&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:53 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055725069, 343418502, 4115594466
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="1620440" ns="10" title="Template:Rotten Tomatoes"><revisions><rev user="Zyxw" timestamp="2014-09-13T09:11:19Z" comment="Trim any leading or trailing spaces from 1st unnamed parameter to prevent breaking link. Tested first at [[Template:Rotten Tomatoes/sandbox]] and [[Template:Rotten Tomatoes/testcases]]." contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">[http://www.rottentomatoes.com/m/{{Trim|{{{1|{{{id|{{PAGENAMEE}}}}}}}}}}/ ''{{{2|{{{title|{{Title without disambig|{{PAGENAME}}}}}}}}}}''] at [[Rotten Tomatoes]]&lt;noinclude&gt;
      {{Documentation}} &lt;!-- Add categories to the /doc subpage. Add interwiki links to Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:53.902Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ATrim&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:53 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227060663, 1470649716, 4115594616
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="21815705" ns="10" title="Template:Trim"><revisions><rev user="MSGJ" timestamp="2011-02-09T15:02:43Z" comment="moved [[Template:Str trim]] to [[Template:Trim]]: merge duplicate templates" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{ {{{|safesubst:}}}#if:1|{{{1|}}}}}&lt;/includeonly&gt;&lt;noinclude&gt;

      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:54.258Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Adead+link&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:54 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq51 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055726546, 571398188, 4115594920
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:dead link" to="Template:Dead link" /></normalized><pages><page pageid="9172159" ns="10" title="Template:Dead link"><revisions><rev user="Jackmcbarn" timestamp="2014-08-22T22:46:28Z" comment="rm deprecated and unnecessary things" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||date=__DATE__ |$B=
      &lt;!--{{Dead link}} begin--&gt;{{Fix
      | special  = &lt;sup class=&quot;noprint Inline-Template&quot;&gt;&lt;span style=&quot;white-space: nowrap;&quot;&gt;&amp;#91;&lt;i&gt;{{#if: {{{url|}}}|[http://web.archive.org/web/*/{{{url|}}} &lt;span title=&quot;{{{title|}}}{{#if:{{{date|}}}|&amp;nbsp;since {{{date}}}}}&quot;&gt;dead link&lt;/span&gt;]|[[Wikipedia:Link rot|&lt;span title=&quot;{{{title|}}}{{#if:{{{date|}}}|&amp;nbsp;since {{{date}}}}}&quot;&gt;dead link&lt;/span&gt;]]}}&lt;/i&gt;&amp;#93;&lt;/span&gt;&lt;/sup&gt;
      | date     = {{{date|}}}
      | cat      = [[Category:All articles with dead external links]]
      | cat-date = Category:Articles with dead external links}}&lt;!--{{Dead link}} end--&gt;
      }}&lt;noinclude&gt;
      {{Documentation}}
      &lt;!-- PLEASE ADD CATEGORIES AND INTERWIKIS TO THE /doc SUBPAGE, THANKS --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:54.806Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ADead+link&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:54 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq40 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404148614, 269562467, 4115595247
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="9172159" ns="10" title="Template:Dead link"><revisions><rev user="Jackmcbarn" timestamp="2014-08-22T22:46:28Z" comment="rm deprecated and unnecessary things" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||date=__DATE__ |$B=
      &lt;!--{{Dead link}} begin--&gt;{{Fix
      | special  = &lt;sup class=&quot;noprint Inline-Template&quot;&gt;&lt;span style=&quot;white-space: nowrap;&quot;&gt;&amp;#91;&lt;i&gt;{{#if: {{{url|}}}|[http://web.archive.org/web/*/{{{url|}}} &lt;span title=&quot;{{{title|}}}{{#if:{{{date|}}}|&amp;nbsp;since {{{date}}}}}&quot;&gt;dead link&lt;/span&gt;]|[[Wikipedia:Link rot|&lt;span title=&quot;{{{title|}}}{{#if:{{{date|}}}|&amp;nbsp;since {{{date}}}}}&quot;&gt;dead link&lt;/span&gt;]]}}&lt;/i&gt;&amp;#93;&lt;/span&gt;&lt;/sup&gt;
      | date     = {{{date|}}}
      | cat      = [[Category:All articles with dead external links]]
      | cat-date = Category:Articles with dead external links}}&lt;!--{{Dead link}} end--&gt;
      }}&lt;noinclude&gt;
      {{Documentation}}
      &lt;!-- PLEASE ADD CATEGORIES AND INTERWIKIS TO THE /doc SUBPAGE, THANKS --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:55.191Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3APortal+bar&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:55 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055727919, 2402521979, 4115595444
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="30675152" ns="10" title="Template:Portal bar"><revisions><rev user="Mr. Stradivarius" timestamp="2013-09-16T05:21:48Z" comment="switch to use [[Module:Portal bar]] - see [[Wikipedia:Templates for discussion/Log/2013 September 5#Template:Portal bar]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Portal bar|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:55.749Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal_bar&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:55 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq43 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055728303, 2801637311, 4115595575
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Module:Portal_bar" to="Module:Portal bar" /></normalized><pages><page pageid="40526099" ns="828" title="Module:Portal bar"><revisions><rev user="Prhartcom" timestamp="2014-06-02T12:07:52Z" comment="Undid revision" contentformat="text/plain" contentmodel="Scribunto" xml:space="preserve">-- This module implements {{portal bar}}.

      local p = {}

      local htmlBuilder = require( 'Module:HtmlBuilder' )
      local buildNavbox = require( 'Module:Navbox' )._navbox
      local getImageName = require( 'Module:Portal' ).image
      local yesno = require( 'Module:Yesno' )

      -- Builds the portal bar used by {{portal bar}}.
      function p._main( portals, args )
          if #portals &lt; 1 then return '' end -- Don't display a blank navbox if no portals were specified.
          local list = htmlBuilder.create( 'ul' )
          for i, portal in ipairs( portals ) do
              list
                  .tag( 'li' )
                      .css( 'display', 'inline' )
                      .css( 'white-space', 'nowrap' )
                      .tag( 'span' )
                          .css( 'margin', 'auto 0.5em' )
                          .wikitext( mw.ustring.format( '[[File:%s|24x21px]]', getImageName{ portal } ) )
                          .done()
                      .tag( 'span' )
                          .css( 'font-weight', 'bold' )
                          .wikitext( mw.ustring.format( '[[Portal:%s|%s portal]]', portal, portal ) )
          end
          if yesno( args.border ) == false then -- Don't display a border if args.border is &quot;no&quot;, &quot;n&quot;, &quot;false&quot;, 0 or false.
              local root = htmlBuilder.create( 'div' )
              root
                  .addClass( 'noprint' )
                  .css( 'width', '100%' )
                  .css( 'text-align', 'center' )
                  .css( 'padding', '1px' )
                  .css( 'font-size', '88%' )
                  .wikitext( tostring( list ) )
              return tostring( root )
          else
              return buildNavbox{
                  name = 'Portal bar',
                  bodyclass = 'noprint',
                  list1 = tostring( list )
              }
          end
      end

      -- Processes external arguments and sends them to the other functions.
      function p.main( frame )
          -- If called via #invoke, use the args passed into the invoking
          -- template, or the args passed to #invoke if any exist. Otherwise
          -- assume args are being passed directly in from the debug console
          -- or from another Lua module.
          local origArgs
          if frame == mw.getCurrentFrame() then
              origArgs = frame:getParent().args
              for k, v in pairs( frame.args ) do
                  origArgs = frame.args
                  break
              end
          else
              origArgs = frame
          end
          -- Process the args to make an array of portal names that can be used with ipairs. We need to use ipairs because we want to list
          -- all the portals in the order they were passed to the template, but we also want to be able to deal with positional arguments
          -- passed explicitly, for example {{portal|2=Politics}}. The behaviour of ipairs is undefined if nil values are present, so we
          -- need to make sure they are all removed.
          local portals, args = {}, {}
          for k, v in pairs( origArgs ) do
              if type( k ) == 'number' and type( v ) == 'string' then -- Make sure we have no non-string portal names.
                  if mw.ustring.find( v, '%S' ) then -- Remove blank values.
                      table.insert( portals, k )
                  end
              elseif type( k ) ~= 'number' then -- Separate named arguments from portals.
                  if type( v ) == 'string' then
                      v = mw.text.trim( v )
                  end
                  args[ k ] = v
              end
          end
          table.sort( portals )
          for i, v in ipairs( portals ) do
              portals[ i ] = mw.text.trim( origArgs[ v ] ) -- Swap keys with values, trimming whitespace.
          end
          return p._main( portals, args )
      end

      return p</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:56.161Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANavbox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:56 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123532269, 290984878, 4115596029
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38634746\" ns=\"828\" title=\"Module:Navbox\"><revisions><rev user=\"WOSlinker\" timestamp=\"2014-06-15T16:56:01Z\" comment=\"change hasBackgroundColors to check titlestyle/groupstyle/basestyle\
      \ contains the word background\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--\n-- This module will implement {{Navbox}}\n--\n \nlocal p = {}\n \nlocal HtmlBuilder = require('Module:HtmlBuilder')\nlocal navbar = require('Module:Navbar')._navbar\n\
      local getArgs -- lazily initialized\n\nlocal args\nlocal tableRowAdded = false\nlocal border\nlocal listnums = {}\n \nlocal function trim(s)\n    return (mw.ustring.gsub(s, &quot;^%s*(.-)%s*$&quot;, &quot;%1&quot;))\nend\n\nlocal function addNewline(s)\n\
      \    if s:match('^[*:;#]') or s:match('^{|') then\n        return '\\n' .. s ..'\\n'\n    else\n        return s\n    end\nend\n\nlocal function addTableRow(tbl)\n    -- If any other rows have already been added, then we add a 2px gutter row.\n    if tableRowAdded\
      \ then\n        tbl\n            .tag('tr')\n                .css('height', '2px')\n                .tag('td')\n                \t.attr('colspan',2)\n    end\n    \n    tableRowAdded = true\n    \n    return tbl.tag('tr')\nend\n\nlocal function renderNavBar(titleCell)\n\
      \    -- Depending on the presence of the navbar and/or show/hide link, we may need to add a spacer div on the left\n    -- or right to keep the title centered.\n    local spacerSide = nil\n\n    if args.navbar == 'off' then\n        -- No navbar, and client\
      \ wants no spacer, i.e. wants the title to be shifted to the left. If there's\n        -- also no show/hide link, then we need a spacer on the right to achieve the left shift.\n        if args.state == 'plain' then spacerSide = 'right' end\n    elseif\
      \ args.navbar == 'plain' or (not args.name and mw.getCurrentFrame():getParent():getTitle() == 'Template:Navbox' and (border == 'subgroup' or border == 'child' or border == 'none')) then\n        -- No navbar. Need a spacer on the left to balance out the\
      \ width of the show/hide link.\n        if args.state ~= 'plain' then spacerSide = 'left' end\n    else\n        -- Will render navbar (or error message). If there's no show/hide link, need a spacer on the right\n        -- to balance out the width of\
      \ the navbar.\n        if args.state == 'plain' then spacerSide = 'right' end\n\n        titleCell.wikitext(navbar{ \n            args.name, \n            mini = 1, \n            fontstyle = (args.basestyle or '') .. ';' .. (args.titlestyle or '') .. \
      \ ';background:none transparent;border:none;'\n        })\n    end\n    \n    -- Render the spacer div.\n    if spacerSide then\n        titleCell\n            .tag('span')\n                .css('float', spacerSide)\n                .css('width', '6em')\n\
      \                .wikitext('&amp;nbsp;')\n    end\nend\n\n--\n--   Title row\n--\nlocal function renderTitleRow(tbl)\n    if not args.title then return end\n \n    local titleRow = addTableRow(tbl)\n     \n    if args.titlegroup then\n        titleRow\n\
      \            .tag('th')\n                .attr('scope', 'row')\n                .addClass('navbox-group')\n                .addClass(args.titlegroupclass)\n                .cssText(args.basestyle)\n                .cssText(args.groupstyle)\n          \
      \      .cssText(args.titlegroupstyle)\n                .wikitext(args.titlegroup)\n    end\n    \n    local titleCell = titleRow.tag('th').attr('scope', 'col')\n            \n    if args.titlegroup then\n        titleCell\n            .css('border-left',\
      \ '2px solid #fdfdfd')\n            .css('width', '100%')\n    end\n    \n    local titleColspan = 2\n    if args.imageleft then titleColspan = titleColspan + 1 end\n    if args.image then titleColspan = titleColspan + 1 end\n    if args.titlegroup then\
      \ titleColspan = titleColspan - 1 end\n    \n    titleCell\n        .cssText(args.basestyle)\n        .cssText(args.titlestyle)\n        .addClass('navbox-title')\n        .attr('colspan', titleColspan)\n \n    renderNavBar(titleCell)\n\n    titleCell\n\
      \         .tag('div')\n             .addClass(args.titleclass)\n             .css('font-size', '110%')\n             .wikitext(addNewline(args.title))\nend\n\n--\n--   Above/Below rows\n--\n\nlocal function getAboveBelowColspan()\n    local ret = 2\n \
      \   if args.imageleft then ret = ret + 1 end\n    if args.image then ret = ret + 1 end\n    return ret\nend\n\nlocal function renderAboveRow(tbl)\n    if not args.above then return end\n\n    addTableRow(tbl)\n        .tag('td')\n            .addClass('navbox-abovebelow')\n\
      \            .addClass(args.aboveclass)\n            .cssText(args.basestyle)\n            .cssText(args.abovestyle)\n            .attr('colspan', getAboveBelowColspan())\n            .tag('div')\n                .wikitext(addNewline(args.above))\nend\n\
      \nlocal function renderBelowRow(tbl)\n    if not args.below then return end\n\n    addTableRow(tbl)\n        .tag('td')\n            .addClass('navbox-abovebelow')\n            .addClass(args.belowclass)\n            .cssText(args.basestyle)\n        \
      \    .cssText(args.belowstyle)\n            .attr('colspan', getAboveBelowColspan())\n            .tag('div')\n                .wikitext(addNewline(args.below))\nend\n \n--\n--   List rows\n--\nlocal function renderListRow(tbl, listnum)\n    local row\
      \ = addTableRow(tbl)\n    \n    if listnum == 1 and args.imageleft then\n        row\n            .tag('td')\n                .addClass('navbox-image')\n                .addClass(args.imageclass)\n                .css('width', '0%')\n                .css('padding',\
      \ '0px 2px 0px 0px')\n                .cssText(args.imageleftstyle)\n                .attr('rowspan', 2 * #listnums - 1)\n                .tag('div')\n                    .wikitext(addNewline(args.imageleft))\n    end\n \n    if args['group' .. listnum]\
      \ then\n        local groupCell = row.tag('th')\n        \n        groupCell\n               .attr('scope', 'row')\n               .addClass('navbox-group')\n               .addClass(args.groupclass)\n               .cssText(args.basestyle)\n         \
      \      \n        if args.groupwidth then\n            groupCell.css('width', args.groupwidth)\n        end\n           \n        groupCell\n            .cssText(args.groupstyle)\n            .cssText(args['group' .. listnum .. 'style'])\n            .wikitext(args['group'\
      \ .. listnum])\n    end\n    \n    local listCell = row.tag('td')\n\n    if args['group' .. listnum] then\n        listCell\n            .css('text-align', 'left')\n            .css('border-left-width', '2px')\n            .css('border-left-style', 'solid')\n\
      \    else\n        listCell.attr('colspan', 2)\n    end\n    \n    if not args.groupwidth then \n        listCell.css('width', '100%')\n    end\n    \n    local isOdd = (listnum % 2) == 1\n    local rowstyle = args.evenstyle\n    if isOdd then rowstyle\
      \ = args.oddstyle end\n \n    local evenOdd\n    if args.evenodd == 'swap' then\n        if isOdd then evenOdd = 'even' else evenOdd = 'odd' end\n    else\n        if isOdd then evenOdd = args.evenodd or 'odd' else evenOdd = args.evenodd or 'even' end\n\
      \    end\n\n    listCell\n        .css('padding', '0px')\n        .cssText(args.liststyle)\n        .cssText(rowstyle)\n        .cssText(args['list' .. listnum .. 'style'])\n        .addClass('navbox-list')\n        .addClass('navbox-' .. evenOdd)\n  \
      \      .addClass(args.listclass)\n        .tag('div')\n            .css('padding', (listnum == 1 and args.list1padding) or args.listpadding or '0em 0.25em')\n            .wikitext(addNewline(args['list' .. listnum]))\n\n    if listnum == 1 and args.image\
      \ then\n        row\n            .tag('td')\n                .addClass('navbox-image')\n                .addClass(args.imageclass)\n                .css('width', '0%')\n                .css('padding', '0px 0px 0px 2px')\n                .cssText(args.imagestyle)\n\
      \                .attr('rowspan', 2 * #listnums - 1)\n                .tag('div')\n                    .wikitext(addNewline(args.image))\n    end\nend\n\n\n--\n--   Tracking categories\n--\n\nlocal function needsHorizontalLists()\n    if border == 'child'\
      \ or border == 'subgroup'  or args.tracking == 'no' then return false end\n    \n    local listClasses = {'plainlist', 'hlist', 'hlist hnum', 'hlist hwrap', 'hlist vcard', 'vcard hlist', 'hlist vevent'}\n    for i, cls in ipairs(listClasses) do\n     \
      \   if args.listclass == cls or args.bodyclass == cls then\n            return false\n        end\n    end\n\n    return true\nend\n\nlocal function hasBackgroundColors()\n    return mw.ustring.match(args.titlestyle or '','background') or mw.ustring.match(args.groupstyle\
      \ or '','background') or mw.ustring.match(args.basestyle or '','background')\nend\n\nlocal function getTrackingCategories()\n    local cats = {}\n    if needsHorizontalLists() then table.insert(cats, 'Navigational boxes without horizontal lists') end\n\
      \    if hasBackgroundColors() then table.insert(cats, 'Navboxes using background colours') end\n    return cats\nend\n\nlocal function renderTrackingCategories(builder)\n    local title = mw.title.getCurrentTitle()\n    if title.namespace ~= 10 then return\
      \ end -- not in template space\n    local subpage = title.subpageText\n    if subpage == 'doc' or subpage == 'sandbox' or subpage == 'testcases' then return end\n    \n    for i, cat in ipairs(getTrackingCategories()) do\n        builder.wikitext('[[Category:'\
      \ .. cat .. ']]') \n    end\nend\n\n--\n--   Main navbox tables\n--\nlocal function renderMainTable()\n    local tbl = HtmlBuilder.create('table')\n        .attr('cellspacing', 0)\n        .addClass('nowraplinks')\n        .addClass(args.bodyclass)\n \
      \            \n    if args.title and (args.state ~= 'plain' and args.state ~= 'off') then\n        tbl\n            .addClass('collapsible')\n            .addClass(args.state or 'autocollapse')\n    end\n \n    tbl.css('border-spacing', 0)\n    if border\
      \ == 'subgroup' or border == 'child' or border == 'none' then\n        tbl\n            .addClass('navbox-subgroup')\n            .cssText(args.bodystyle)\n            .cssText(args.style)\n    else -- regular navobx - bodystyle and style will be applied\
      \ to the wrapper table\n        tbl\n            .addClass('navbox-inner')\n            .css('background', 'transparent')\n            .css('color', 'inherit')\n    end\n    tbl.cssText(args.innerstyle)\n \n    renderTitleRow(tbl)\n    renderAboveRow(tbl)\n\
      \    for i, listnum in ipairs(listnums) do\n        renderListRow(tbl, listnum) \n    end\n    renderBelowRow(tbl)\n    \n    return tbl\nend\n\nfunction p._navbox(navboxArgs)\n    args = navboxArgs\n    \n    for k, v in pairs(args) do\n        local\
      \ listnum = ('' .. k):match('^list(%d+)$')\n        if listnum then table.insert(listnums, tonumber(listnum)) end\n    end\n    table.sort(listnums)\n \n    border = trim(args.border or args[1] or '')\n\n    -- render the main body of the navbox\n    local\
      \ tbl = renderMainTable()\n\n    -- render the appropriate wrapper around the navbox, depending on the border param\n    local res = HtmlBuilder.create()\n    if border == 'none' then\n        res.node(tbl)\n    elseif border == 'subgroup' or border ==\
      \ 'child' then\n        -- We assume that this navbox is being rendered in a list cell of a parent navbox, and is\n        -- therefore inside a div with padding:0em 0.25em. We start with a &lt;/div&gt; to avoid the\n        -- padding being applied, and\
      \ at the end add a &lt;div&gt; to balance out the parent's &lt;/div&gt;\n        res\n            .tag('/div', {unclosed = true})\n                .done()\n            .node(tbl)\n            .tag('div', {unclosed = true})\n    else\n        res\n    \
      \        .tag('table')\n                .attr('cellspacing', 0)\n                .addClass('navbox')\n                .css('border-spacing', 0)\n                .cssText(args.bodystyle)\n                .cssText(args.style)\n                .tag('tr')\n\
      \                    .tag('td')\n                        .css('padding', '2px')\n                        .node(tbl)\n    end\n \n    renderTrackingCategories(res)\n \n    return tostring(res)\nend\n \nfunction p.navbox(frame)\n    if not getArgs then\n\
      \    \tgetArgs = require('Module:Arguments').getArgs\n    end\n    args = getArgs(frame, {wrappers = 'Template:Navbox'})\n\n    -- Read the arguments in the order they'll be output in, to make references number in the right order.\n    local _\n    _ =\
      \ args.title\n    _ = args.above\n    for i = 1, 20 do\n        _ = args[&quot;group&quot; .. tostring(i)]\n        _ = args[&quot;list&quot; .. tostring(i)]\n    end    \n    _ = args.below\n\n    return p._navbox(args)\nend\n \nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:56.597Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANavbar&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:56 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=hhvm
      X-Cache: cp1055 miss (0), amssq61 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.3.1
      X-Varnish: 2055730065, 3811683475, 4115596335
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38827227\" ns=\"828\" title=\"Module:Navbar\"><revisions><rev user=\"Edokter\" timestamp=\"2014-10-10T07:31:12Z\" comment=\"No longer needed; moved fix to Common.css.\" contentformat=\"\
      text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">local p = {}\n\nlocal getArgs\nlocal HtmlBuilder = require('Module:HtmlBuilder')\n\nlocal function trim(s)\n\treturn mw.ustring.match(s, &quot;^%s*(.-)%s*$&quot;)\nend\n\nlocal function htmlError(s)\n\
      \tlocal span = HtmlBuilder.create('span')\n\n\tspan\n\t\t.addClass('error')\n\t\t.css('float', 'left')\n\t\t.css('white-space', 'nowrap')\n\t\t.wikitext('Error: ' .. s)\n\n\treturn tostring(span)\nend\n\nlocal function getTitle(pageName)\n\tpageName =\
      \ trim(pageName);\n\tlocal page_title, talk_page_title;\n\n\tif mw.ustring.sub(pageName, 1, 1) == ':' then\n\t\tpage_title = mw.title.new( mw.ustring.sub(pageName, 2));\n\telse\n\t\tpage_title = mw.title.new(pageName, 'Template');\n\tend\n\n\tif page_title\
      \ then\n\t\ttalk_page_title = page_title.talkPageTitle;\n\telse\n\t\ttalk_page_title = nil;\n\tend\n\n\treturn page_title, talk_page_title;\nend\n\nfunction p._navbar(args)\n\tlocal good, title, talk_title;\n\tlocal titleArg = 1\n\t\n\tif args.collapsible\
      \ then\n\t\ttitleArg = 2\n\t\tif not args.plain then\n\t\t\targs.mini = 1\n\t\tend\n\t\tif args.fontcolor then\n\t\t\targs.fontstyle = 'color:' .. args.fontcolor .. ';'\n\t\tend\n\t\targs.style = 'float:left; text-align:left; width:6em;'\n\tend\n\t\n\t\
      good, title, talk_title = pcall(getTitle, args[titleArg] or (':' .. mw.getCurrentFrame():getParent():getTitle()));\n\tif not good then\n\t\treturn htmlError(title);\n\tend\n\n\tif not title then\n\t\treturn htmlError('Page does not exist')\n\tend\n\n\t\
      local mainpage = title.fullText;\n\tlocal talkpage = talk_title and talk_title.fullText or ''\n\tlocal editurl = title:fullUrl('action=edit');\n\n\tlocal viewLink, talkLink, editLink = 'view', 'talk', 'edit'\n\tif args.mini then\n\t\tviewLink, talkLink,\
      \ editLink = 'v', 't', 'e'\n\tend\n\n\tlocal div = HtmlBuilder.create().tag('div')\n\tdiv\n\t\t.addClass('plainlinks')\n\t\t.addClass('hlist')\n\t\t.addClass('navbar')\n\t\t.cssText(args.style)\n\n\tif args.mini then div.addClass('mini') end\n\n\tif not\
      \ (args.mini or args.plain) then\n\t\tdiv\n\t\t\t.tag('span')\n\t\t\t\t.css('word-spacing', 0)\n\t\t\t\t.cssText(args.fontstyle)\n\t\t\t\t.wikitext(args.text or 'This box:')\n\t\t\t\t.wikitext(' ')\n\tend\n\n\tif args.brackets then\n\t\tdiv\n\t\t\t.tag('span')\n\
      \t\t\t\t.css('margin-right', '-0.125em')\n\t\t\t\t.cssText(args.fontstyle)\n\t\t\t\t.wikitext('&amp;#91;')\n\t\t\t\t.newline();\n\tend\n\n\tlocal ul = div.tag('ul');\n\n\tul\n\t\t.tag('li')\n\t\t\t.addClass('nv-view')\n\t\t\t.wikitext('[[' .. mainpage\
      \ .. '|')\n\t\t\t.tag('span')\n\t\t\t\t.attr('title', 'View this template')\n\t\t\t\t.cssText(args.fontstyle or '')\n\t\t\t\t.wikitext(viewLink)\n\t\t\t\t.done()\n\t\t\t.wikitext(']]')\n\t\t\t.done()\n\t\t.tag('li')\n\t\t\t.addClass('nv-talk')\n\t\t\t\
      .wikitext('[[' .. talkpage .. '|')\n\t\t\t.tag('span')\n\t\t\t\t.attr('title', 'Discuss this template')\n\t\t\t\t.cssText(args.fontstyle or '')\n\t\t\t\t.wikitext(talkLink)\n\t\t\t\t.done()\n\t\t\t.wikitext(']]');\n\n\tif not args.noedit then\n\t\tul\n\
      \t\t\t.tag('li')\n\t\t\t\t.addClass('nv-edit')\n\t\t\t\t.wikitext('[' .. editurl .. ' ')\n\t\t\t\t.tag('span')\n\t\t\t\t\t.attr('title', 'Edit this template')\n\t\t\t\t\t.cssText(args.fontstyle or '')\n\t\t\t\t\t.wikitext(editLink)\n\t\t\t\t\t.done()\n\
      \t\t\t\t.wikitext(']');\n\tend\n\n\tif args.brackets then\n\t\tdiv\n\t\t\t.tag('span')\n\t\t\t\t.css('margin-left', '-0.125em')\n\t\t\t\t.cssText( args.fontstyle or '')\n\t\t\t\t.wikitext('&amp;#93;')\n\t\t\t\t.newline();\n\tend\n\t\n\tif args.collapsible\
      \ then\n\t\tdiv\n\t\t\t.done()\n\t\t.tag('span')\n\t\t\t.css('font-size', '110%')\n\t\t\t.cssText(args.fontstyle or '')\n\t\t\t.wikitext(args[1])\n\tend\n\n\treturn tostring(div.allDone())\nend\n\nfunction p.navbar(frame)\n\tif not getArgs then\n\t\tgetArgs\
      \ = require('Module:Arguments').getArgs\n\tend\n\treturn p._navbar(getArgs(frame))\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:57.063Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:56 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq35 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349023277, 4156188544, 4115596680
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38965350\" ns=\"828\" title=\"Module:Portal\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2013-11-24T05:28:16Z\" comment=\"Changed protection level of Module:Portal:\
      \ [[Wikipedia:Lua/Modules|High-risk Lua module]]: allow template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"\
      preserve\">--[==[ This module is a Lua implementation of the old {{Portal}} template. As of August 2013 it is used on nearly 5,000,000 articles.\n-- Please take care when updating it! It outputs two functions: p.portal, which generates a table of portals,\
      \ and p.image, which\n-- produces the image name for an individual portal.\n\n-- The portal image data is kept in submodules of [[Module:Portal/images]], listed below:\n-- [[Module:Portal/images/a]]       - for portal names beginning with &quot;A&quot;.\n\
      -- [[Module:Portal/images/b]]       - for portal names beginning with &quot;B&quot;.\n-- [[Module:Portal/images/c]]       - for portal names beginning with &quot;C&quot;.\n-- [[Module:Portal/images/d]]       - for portal names beginning with &quot;D&quot;.\n\
      -- [[Module:Portal/images/e]]       - for portal names beginning with &quot;E&quot;.\n-- [[Module:Portal/images/f]]       - for portal names beginning with &quot;F&quot;.\n-- [[Module:Portal/images/g]]       - for portal names beginning with &quot;G&quot;.\n\
      -- [[Module:Portal/images/h]]       - for portal names beginning with &quot;H&quot;.\n-- [[Module:Portal/images/i]]       - for portal names beginning with &quot;I&quot;.\n-- [[Module:Portal/images/j]]       - for portal names beginning with &quot;J&quot;.\n\
      -- [[Module:Portal/images/k]]       - for portal names beginning with &quot;K&quot;.\n-- [[Module:Portal/images/l]]       - for portal names beginning with &quot;L&quot;.\n-- [[Module:Portal/images/m]]       - for portal names beginning with &quot;M&quot;.\n\
      -- [[Module:Portal/images/n]]       - for portal names beginning with &quot;N&quot;.\n-- [[Module:Portal/images/o]]       - for portal names beginning with &quot;O&quot;.\n-- [[Module:Portal/images/p]]       - for portal names beginning with &quot;P&quot;.\n\
      -- [[Module:Portal/images/q]]       - for portal names beginning with &quot;Q&quot;.\n-- [[Module:Portal/images/r]]       - for portal names beginning with &quot;R&quot;.\n-- [[Module:Portal/images/s]]       - for portal names beginning with &quot;S&quot;.\n\
      -- [[Module:Portal/images/t]]       - for portal names beginning with &quot;T&quot;.\n-- [[Module:Portal/images/u]]       - for portal names beginning with &quot;U&quot;.\n-- [[Module:Portal/images/v]]       - for portal names beginning with &quot;V&quot;.\n\
      -- [[Module:Portal/images/w]]       - for portal names beginning with &quot;W&quot;.\n-- [[Module:Portal/images/x]]       - for portal names beginning with &quot;X&quot;.\n-- [[Module:Portal/images/y]]       - for portal names beginning with &quot;Y&quot;.\n\
      -- [[Module:Portal/images/z]]       - for portal names beginning with &quot;Z&quot;.\n-- [[Module:Portal/images/other]]   - for portal names beginning with any other letters. This includes numbers,\n--                                    letters with diacritics,\
      \ and letters in non-Latin alphabets.\n-- [[Module:Portal/images/aliases]] - for adding aliases for existing portal names. Use this page for variations\n--                                    in spelling and diacritics, etc., no matter what letter the portal\
      \ begins with.\n--\n-- The images data pages are separated by the first letter to reduce server load when images are added, changed, or removed.\n-- Previously all the images were on one data page at [[Module:Portal/images]], but this had the disadvantage\
      \ that all\n-- 5,000,000 pages using this module needed to be refreshed every time an image was added or removed.\n]==]\n\nlocal htmlBuilder = require('Module:HtmlBuilder')\n\nlocal p = {}\n\nlocal function matchImagePage(s)\n\t-- Finds the appropriate\
      \ image subpage given a lower-case\n\t-- portal name plus the first letter of that portal name.\n\tif type(s) ~= 'string' or #s &lt; 1 then return end\n\tlocal firstLetter = mw.ustring.sub(s, 1, 1)\n\tlocal imagePage\n\tif mw.ustring.find(firstLetter,\
      \ '^[a-z]') then\n\t\timagePage = 'Module:Portal/images/' .. firstLetter\n\telse\n\t\timagePage= 'Module:Portal/images/other'\n\tend\n\tlocal images = mw.loadData(imagePage)\n\tlocal image = images[s]\n\tif image then\n\t\treturn image\n\tend\nend\n\n\
      local function getAlias(s)\n\t-- Gets an alias from the image alias data page.\n\tlocal aliasData = mw.loadData('Module:Portal/images/aliases')\n\tfor portal, aliases in pairs(aliasData) do\n\t\tfor _, alias in ipairs(aliases) do\n\t\t\tif alias == s then\n\
      \t\t\t\treturn portal\n\t\t\tend\n\t\tend\n\tend\nend\n\nlocal function getImageName(s)\n\t-- Gets the image name for a given string.\n\tif type(s) ~= 'string' or #s &lt; 1 then\n\t\treturn 'Portal-puzzle.svg'\n\tend\n\ts = mw.ustring.lower(s)\n\tlocal\
      \ image = matchImagePage(s)\n\tif image then\n\t\treturn image\n\telse\n\t\tlocal alias = getAlias(s)\n\t\timage = matchImagePage(alias) -- If no alias was found this returns nil.\n\t\tif image then\n\t\t\treturn image\n\t\telse\n\t\t\treturn 'Portal-puzzle.svg'\n\
      \t\tend\n\tend\nend\n\nfunction p._portal(portals, args)\n\t-- This function builds the portal box used by the {{portal}} template.\n\tlocal root = htmlBuilder.create('div')\n\troot\n\t\t.addClass('noprint')\n\t\t.addClass(args.left and 'tleft' or 'tright')\n\
      \t\t.addClass('portal')\n\t\t.css('border', 'solid #aaa 1px')\n\t\t.css('margin', args.margin or (args.left == 'yes' and '0.5em 1em 0.5em 0') or '0.5em 0 0.5em 1em')\n\t\t.newline()\n\n\t-- Start the table. This corresponds to the start of the wikitext\
      \ table in the old [[Template:Portal]].\n\tlocal tableroot = root.tag('table')\n\t\t.css('background', '#f9f9f9')\n\t\t.css('font-size', '85%')\n\t\t.css('line-height', '110%')\n\t\t.css('max-width', '175px')\n\t\t.css('width', type(args.boxsize) == 'string'\
      \ and (args.boxsize .. 'px'))\n\t\n\t-- If no portals have been specified, display an error and add the page to a tracking category.\n\tif not portals[1] then\n\t\ttableroot.wikitext('&lt;strong class=&quot;error&quot;&gt;No portals specified: please specify\
      \ at least one portal&lt;/strong&gt;[[Category:Portal templates without a parameter]]')\n\tend\n\n\t-- Display the portals specified in the positional arguments.\n\tfor i, portal in ipairs(portals) do\n\t\tlocal image = getImageName(portal)\n\t\t\n\t\t\
      -- Generate the html for the image and the portal name.\n\t\ttableroot\n\t\t\t.newline()\n\t\t\t.tag('tr')\n\t\t\t\t.attr('valign', 'middle')\n\t\t\t\t.tag('td')\n\t\t\t\t\t.css('text-align', 'center')\n\t\t\t\t\t.wikitext(mw.ustring.format('[[File:%s|32x28px|alt=Portal\
      \ icon]]', image))\n\t\t\t\t\t.done()\n\t\t\t\t.tag('td')\n\t\t\t\t\t.css('padding', '0 0.2em')\n\t\t\t\t\t.css('vertical-align', 'middle')\n\t\t\t\t\t.css('font-style', 'italic')\n\t\t\t\t\t.css('font-weight', 'bold')\n\t\t\t\t\t.wikitext(mw.ustring.format('[[Portal:%s|%s%sportal]]',\
      \ portal, portal, args['break'] and '&lt;br /&gt;' or ' '))\n\tend\n\treturn tostring(root)\nend\n\nfunction p._image(portals)\n\n\t-- Wrapper function to allow getImageName() to be accessed through #invoke.\n\treturn getImageName(portals[1])\nend\n\n\
      local function getAllImageTables()\n\t-- Returns an array containing all image subpages (minus aliases) as loaded by mw.loadData.\n\tlocal images = {}\n\tlocal subpages = {'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p',\
      \ 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'other'}\n\tfor i, subpage in ipairs(subpages) do\n\t\ttable.insert(images, mw.loadData('Module:Portal/images/' .. subpage))\n\tend\n\treturn images\nend\n\nfunction p._displayAll(portals, args)\n\t--\
      \ This function displays all portals that have portal images. This function is for maintenance purposes and should not be used in\n\t-- articles, for two reasons: 1) there are over 1500 portals with portal images, and 2) the module doesn't record how the\
      \ portal\n\t-- names are capitalized, so the portal links may be broken.\n\tlocal lang = mw.language.getContentLanguage()\n\tlocal images = getAllImageTables()\n\tlocal count = 1\n\tfor i, imageTable in ipairs(images) do\n\t\tfor portal in pairs(imageTable)\
      \ do\n\t\t\tportals[count] = lang:ucfirst(portal)\n\t\t\tcount = count + 1\n\t\tend\n\tend\n\treturn p._portal(portals, args)\nend\n\nfunction p._imageDupes()\n\t-- This function searches the image subpages to find duplicate images. If duplicate images\
      \ exist, it is not necessarily a bad thing,\n\t-- as different portals might just happen to choose the same image. However, this function is helpful in identifying images that\n\t-- should be moved to a portal alias for ease of maintenance.\n\tlocal exists,\
      \ dupes = {}, {}\n\tlocal images = getAllImageTables()\n\tfor i, imageTable in ipairs(images) do\n\t\tfor portal, image in pairs(imageTable) do\n\t\t\tif not exists[image] then\n\t\t\t\texists[image] = portal\n\t\t\telse\n\t\t\t\ttable.insert(dupes, mw.ustring.format('The\
      \ image &quot;[[:File:%s|%s]]&quot; is used for both portals &quot;%s&quot; and &quot;%s&quot;.', image, image, exists[image], portal))\n\t\t\tend\n\t\tend\n\tend\n\tif #dupes &lt; 1 then\n\t\treturn 'No duplicate images found.'\n\telse\n\t\treturn 'The\
      \ following duplicate images were found:\\n* ' .. table.concat(dupes, '\\n* ')\n\tend\nend\n\t\nlocal function processPortalArgs(args)\n\t-- This function processes a table of arguments and returns two tables: an array of portal names for processing by\
      \ ipairs, and a table of\n\t-- the named arguments that specify style options, etc. We need to use ipairs because we want to list all the portals in the order\n\t-- they were passed to the template, but we also want to be able to deal with positional arguments\
      \ passed explicitly, for example\n\t-- {{portal|2=Politics}}. The behaviour of ipairs is undefined if nil values are present, so we need to make sure they are all removed.\n\targs = type(args) == 'table' and args or {}\n\tlocal portals = {}\n\tlocal namedArgs\
      \ = {}\n\tfor k, v in pairs(args) do\n\t\tif type(k) == 'number' and type(v) == 'string' then -- Make sure we have no non-string portal names.\n\t\t\ttable.insert(portals, k)\n\t\telseif type(k) ~= 'number' then\n\t\t\tnamedArgs[k] = v\n\t\tend\n\tend\n\
      \ttable.sort(portals)\n\tfor i, v in ipairs(portals) do\n\t\tportals[i] = args[v]\n\tend\n\treturn portals, namedArgs\nend\n\nlocal function makeWrapper(funcName)\n\t-- Processes external arguments and sends them to the other functions.\n\treturn function\
      \ (frame)\n\t\t-- If called via #invoke, use the args passed into the invoking\n\t\t-- template, or the args passed to #invoke if any exist. Otherwise\n\t\t-- assume args are being passed directly in from the debug console\n\t\t-- or from another Lua module.\n\
      \t\tlocal origArgs\n\t\tif frame == mw.getCurrentFrame() then\n\t\t\torigArgs = frame:getParent().args\n\t\t\tfor k, v in pairs(frame.args) do\n\t\t\t\torigArgs = frame.args\n\t\t\t\tbreak\n\t\t\tend\n\t\telse\n\t\t\torigArgs = frame\n\t\tend\n\t\t-- Trim\
      \ whitespace and remove blank arguments.\n\t\tlocal args = {}\n\t\tfor k, v in pairs(origArgs) do\n\t\t\tif type(v) == 'string' then\n\t\t\t\tv = mw.text.trim(v)\n\t\t\tend\n\t\t\tif v ~= '' then\n\t\t\t\targs[k] = v\n\t\t\tend\n\t\tend\n\t\treturn p[funcName](processPortalArgs(args))\
      \ -- passes two tables to func: an array of portal names, and a table of named arguments.\n\tend\nend\n\nlocal funcNames = {'portal', 'image', 'imageDupes', 'displayAll'}\n\nfor _, funcName in ipairs(funcNames) do\n\tp[funcName] = makeWrapper('_' .. funcName)\n\
      end\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:57.589Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal%2Fimages%2Fb&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:57 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123533823, 290985418, 4115596879
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"40416112\" ns=\"828\" title=\"Module:Portal/images/b\"><revisions><rev user=\"John of Reading\" timestamp=\"2014-10-10T06:44:24Z\" comment=\"[&quot;briarcliff manor, new york&quot;]\
      \ = &quot;BriarcliffOutlook4-crop.jpg&quot; per edit request\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[==[ This is the &quot;B&quot; list of portal image names. It contains a list of portal images for use with\
      \ [[Module:Portal]]\n-- for portal names that start with the letter &quot;B&quot;. For aliases to existing portal names, and for portal names that\n-- start with other letters, please use the appropriate page from the following list:\n \n-- [[Module:Portal/images/a]]\
      \       - for portal names beginning with &quot;A&quot;.\n-- [[Module:Portal/images/c]]       - for portal names beginning with &quot;C&quot;.\n-- [[Module:Portal/images/d]]       - for portal names beginning with &quot;D&quot;.\n-- [[Module:Portal/images/e]]\
      \       - for portal names beginning with &quot;E&quot;.\n-- [[Module:Portal/images/f]]       - for portal names beginning with &quot;F&quot;.\n-- [[Module:Portal/images/g]]       - for portal names beginning with &quot;G&quot;.\n-- [[Module:Portal/images/h]]\
      \       - for portal names beginning with &quot;H&quot;.\n-- [[Module:Portal/images/i]]       - for portal names beginning with &quot;I&quot;.\n-- [[Module:Portal/images/j]]       - for portal names beginning with &quot;J&quot;.\n-- [[Module:Portal/images/k]]\
      \       - for portal names beginning with &quot;K&quot;.\n-- [[Module:Portal/images/l]]       - for portal names beginning with &quot;L&quot;.\n-- [[Module:Portal/images/m]]       - for portal names beginning with &quot;M&quot;.\n-- [[Module:Portal/images/n]]\
      \       - for portal names beginning with &quot;N&quot;.\n-- [[Module:Portal/images/o]]       - for portal names beginning with &quot;O&quot;.\n-- [[Module:Portal/images/p]]       - for portal names beginning with &quot;P&quot;.\n-- [[Module:Portal/images/q]]\
      \       - for portal names beginning with &quot;Q&quot;.\n-- [[Module:Portal/images/r]]       - for portal names beginning with &quot;R&quot;.\n-- [[Module:Portal/images/s]]       - for portal names beginning with &quot;S&quot;.\n-- [[Module:Portal/images/t]]\
      \       - for portal names beginning with &quot;T&quot;.\n-- [[Module:Portal/images/u]]       - for portal names beginning with &quot;U&quot;.\n-- [[Module:Portal/images/v]]       - for portal names beginning with &quot;V&quot;.\n-- [[Module:Portal/images/w]]\
      \       - for portal names beginning with &quot;W&quot;.\n-- [[Module:Portal/images/x]]       - for portal names beginning with &quot;X&quot;.\n-- [[Module:Portal/images/y]]       - for portal names beginning with &quot;Y&quot;.\n-- [[Module:Portal/images/z]]\
      \       - for portal names beginning with &quot;Z&quot;.\n-- [[Module:Portal/images/other]]   - for portal names beginning with any other letters. This includes numbers,\n--                                    letters with diacritics, and letters in non-Latin\
      \ alphabets.\n-- [[Module:Portal/images/aliases]] - for adding aliases for existing portal names. Use this page for variations\n--                                    in spelling and diacritics, etc., no matter what letter the portal begins with.\n \n--\
      \ When adding entries, please use alphabetical order. The format of the images table entries is as follows:\n--          [&quot;portal name&quot;] = &quot;image.svg&quot;,\n-- The portal name should be the name of your portal, in lower case. For example,\
      \ the portal name for \n-- &quot;Portal:United Kingdom&quot; would be &quot;united kingdom&quot;. The image name should be capitalised normally, and the &quot;File:&quot;\n-- namespace prefix should be\n-- omitted.\n]==]\n\nreturn {\n\t[&quot;babism&quot;]\
      \ = &quot;Haykal2.gif&quot;,\n\t[&quot;bacon&quot;] = &quot;NCI bacon.jpg&quot;,\n\t[&quot;badminton&quot;] = &quot;Badminton racquet.svg&quot;,\n\t[&quot;bahamas&quot;] = &quot;Flag of the Bahamas.svg&quot;,\n\t[&quot;bahrain&quot;] = &quot;Flag of Bahrain.svg&quot;,\n\
      \t[&quot;bahá'í faith&quot;] = &quot;Bahai star.svg&quot;,\n\t[&quot;ballet&quot;] = &quot;Ballerina-icon.jpg&quot;,\n\t[&quot;balochistan, pakistan&quot;] = &quot;Flag of Balochistan, PK.gif|border&quot;,\n\t[&quot;bangalore&quot;] = &quot;Bangalore_Palace.jpg&quot;,\n\
      \t[&quot;bangladesh&quot;] = &quot;Flag of Bangladesh.svg&quot;,\n\t[&quot;bangladesh premier league&quot;] = &quot;BPL.svg&quot;,\n\t[&quot;baptist&quot;] = &quot;Baptism logo.jpg&quot;,\n\t[&quot;barack obama&quot;] = &quot;Obama.svg&quot;,\n\t[&quot;barbados&quot;]\
      \ = &quot;Nuvola Barbados flag.svg&quot;,\n\t[&quot;baseball&quot;] = &quot;Baseball (crop).jpg&quot;,\n\t[&quot;basketball&quot;] = &quot;Basketball.png&quot;,\n\t[&quot;basque&quot;] = &quot;Lauburu.svg&quot;,\n\t[&quot;battleships&quot;] = &quot;BS\
      \ Bismarck.png&quot;,\n\t[&quot;battlestar galactica&quot;] = &quot;BattlestarMandala.svg&quot;,\n\t[&quot;bavaria&quot;] = &quot;Flag of Bavaria (lozengy).svg&quot;,\n\t[&quot;bbc&quot;] = &quot;BBC.svg&quot;,\n\t[&quot;beer&quot;] = &quot;Projet biè\
      re logo v2.png&quot;,\n\t[&quot;beijing&quot;] = &quot;Beijing-name.svg&quot;,\n\t[&quot;belarus&quot;] = &quot;Flag of Belarus.svg|border&quot;,\n\t[&quot;belgium&quot;] = &quot;Flag of Belgium.svg&quot;,\n\t[&quot;belize&quot;] = &quot;Flag of Belize.svg&quot;,\n\
      \t[&quot;bengal&quot;] = &quot;BengaliScriptKo.svg&quot;,\n\t[&quot;benin&quot;] = &quot;Flag of Benin.svg&quot;,\n\t[&quot;berbers&quot;] = &quot;Berber flag.svg&quot;,\n\t[&quot;berkshire&quot;] = &quot;Berkshire Flag.gif&quot;,\n\t[&quot;berlin&quot;]\
      \ = &quot;Coat of arms of Berlin.svg&quot;,\n\t[&quot;bermuda&quot;] = &quot;Flag of Bermuda.svg|border&quot;,\n\t[&quot;beyoncé knowles&quot;] = &quot;Beyonce cropped2.jpg&quot;,\n\t[&quot;bhutan&quot;] = &quot;Flag of Bhutan.svg&quot;,\n\t[&quot;bible&quot;]\
      \ = &quot;Bible.malmesbury.arp.jpg&quot;,\n\t[&quot;bihar&quot;] = &quot;Seal of Bihar.jpg&quot;,\n\t[&quot;biography&quot;] = &quot;P vip.svg&quot;,\n\t[&quot;biological warfare&quot;] = &quot;Anthrax culture.jpg&quot;,\n\t[&quot;biology&quot;] = &quot;Issoria\
      \ lathonia.jpg&quot;,\n\t[&quot;biotechnology&quot;] = &quot;3d tRNA.png&quot;,\n\t[&quot;birds&quot;] = &quot;Eagle 01.svg&quot;,\n\t[&quot;björk&quot;] = &quot;Bjork Hurricane.jpg&quot;,\n\t[&quot;blu-ray&quot;] = &quot;Blu-ray disc2.png&quot;,\n\t[&quot;bob\
      \ dylan&quot;] = &quot;Bob dylan.jpg&quot;,\n\t[&quot;bohol&quot;] = &quot;Chocolate_Hills.jpg&quot;,\n\t[&quot;bolivia&quot;] = &quot;Flag of Bolivia.svg|border&quot;,\n\t[&quot;bollywood&quot;] = &quot;Indiafilm.svg&quot;,\n\t[&quot;book of mormon&quot;]\
      \ = &quot;Book of Mormon English Missionary Edition Soft Cover.jpg&quot;,\n\t[&quot;books&quot;] = &quot;Nuvola apps bookcase.svg&quot;,\n\t[&quot;bosnia and herzegovina&quot;] = &quot;Flag of Bosnia and Herzegovina.svg|border&quot;,\n\t[&quot;boston&quot;]\
      \ = &quot;Flag of Boston.svg|border&quot;,\n\t[&quot;botany&quot;] = &quot;Rosa villosa.jpg&quot;,\n\t[&quot;botswana&quot;] = &quot;Flag of Botswana.svg|border&quot;,\n\t[&quot;brandy norwood&quot;] = &quot;BrandyNorwoodJuly04.jpg&quot;,\n\t[&quot;brazil&quot;]\
      \ = &quot;Flag of Brazil.svg|border&quot;,\n\t[&quot;briarcliff manor, new york&quot;] = &quot;BriarcliffOutlook4-crop.jpg&quot;,\n\t[&quot;bridges&quot;] = &quot;Pont-type-4-haubans.svg&quot;,\n\t[&quot;brighton&quot;] = &quot;Brighton Royal Pavilion.jpg&quot;,\n\
      \t[&quot;bristol&quot;] = &quot;Bristol arms cropped.jpg&quot;,\n\t[&quot;british army&quot;] = &quot;Flag of the British Army.svg&quot;,\n\t[&quot;british columbia&quot;] = &quot;Flag of British Columbia.svg&quot;,\n\t[&quot;british empire&quot;] = &quot;British\
      \ Empire 1897.jpg&quot;,\n\t[&quot;british library&quot;] = &quot;British library london.jpg&quot;,\n\t[&quot;british politics&quot;] = &quot;Royal Coat of Arms of the United Kingdom.svg&quot;,\n\t[&quot;british virgin islands&quot;] = &quot;Flag of the\
      \ British Virgin Islands.svg&quot;,\n\t[&quot;britney spears&quot;] = &quot;Baby One More Time 2009.jpg&quot;,\n\t[&quot;brittany&quot;] = &quot;Flag of Brittany.svg&quot;,\n\t[&quot;brussels&quot;] = &quot;Flag Belgium brussels.svg&quot;,\n\t[&quot;bryan\
      \ adams&quot;] = &quot;Bryan Adams Hamburg MG 0631 flickr.jpg&quot;,\n\t[&quot;bucharest&quot;] = &quot;Bucharest-Coat-of-Arms.png&quot;,\n\t[&quot;buckinghamshire&quot;] = &quot;EnglandBuckinghamshire.png&quot;,\n\t[&quot;budapest&quot;] = &quot;Coat_of_arms_of_Budapest.svg&quot;,\n\
      \t[&quot;buddhism&quot;] = &quot;Dharma Wheel.svg&quot;,\n\t[&quot;buenos aires&quot;] = &quot;Flag of Buenos Aires City.png&quot;,\n\t[&quot;buffy the vampire slayer&quot;] = &quot;Buffya.jpg&quot;,\n\t[&quot;bulgaria&quot;] = &quot;Flag of Bulgaria.svg|border&quot;,\n\
      \t[&quot;bulgarian empire&quot;] = &quot;Coat of arms of the Second Bulgarian Empire.svg&quot;,\n\t[&quot;burkina faso&quot;] = &quot;Flag of Burkina Faso.svg&quot;,\n\t[&quot;burma&quot;] = &quot;Flag of Myanmar.svg&quot;,\n\t[&quot;burundi&quot;] = &quot;Flag\
      \ of Burundi.svg&quot;,\n\t[&quot;buses&quot;] = &quot;BSicon BUS.svg&quot;,\n\t[&quot;business and economics&quot;] = &quot;Emblem-money.svg&quot;,\n\t[&quot;byzantine empire&quot;] = &quot;Flag of Palaeologus Dynasty.svg&quot;\n}</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:57.845Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal%2Fimages%2Ff&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:57 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=hhvm
      X-Cache: cp1054 miss (0), amssq62 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.3.1
      X-Varnish: 1404152262, 3622031650, 4115597215
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"40416149\" ns=\"828\" title=\"Module:Portal/images/f\"><revisions><rev user=\"Illegitimate Barrister\" timestamp=\"2014-10-30T15:17:48Z\" comment=\"ce\" contentformat=\"text/plain\"\
      \ contentmodel=\"Scribunto\" xml:space=\"preserve\">--[==[ This is the &quot;F&quot; list of portal image names. It contains a list of portal images for use with [[Module:Portal]]\n-- for portal names that start with the letter &quot;F&quot;. For aliases\
      \ to existing portal names, and for portal names that\n-- start with other letters, please use the appropriate page from the following list:\n \n-- [[Module:Portal/images/a]]       - for portal names beginning with &quot;A&quot;.\n-- [[Module:Portal/images/b]]\
      \       - for portal names beginning with &quot;B&quot;.\n-- [[Module:Portal/images/c]]       - for portal names beginning with &quot;C&quot;.\n-- [[Module:Portal/images/d]]       - for portal names beginning with &quot;D&quot;.\n-- [[Module:Portal/images/e]]\
      \       - for portal names beginning with &quot;E&quot;.\n-- [[Module:Portal/images/g]]       - for portal names beginning with &quot;G&quot;.\n-- [[Module:Portal/images/h]]       - for portal names beginning with &quot;H&quot;.\n-- [[Module:Portal/images/i]]\
      \       - for portal names beginning with &quot;I&quot;.\n-- [[Module:Portal/images/j]]       - for portal names beginning with &quot;J&quot;.\n-- [[Module:Portal/images/k]]       - for portal names beginning with &quot;K&quot;.\n-- [[Module:Portal/images/l]]\
      \       - for portal names beginning with &quot;L&quot;.\n-- [[Module:Portal/images/m]]       - for portal names beginning with &quot;M&quot;.\n-- [[Module:Portal/images/n]]       - for portal names beginning with &quot;N&quot;.\n-- [[Module:Portal/images/o]]\
      \       - for portal names beginning with &quot;O&quot;.\n-- [[Module:Portal/images/p]]       - for portal names beginning with &quot;P&quot;.\n-- [[Module:Portal/images/q]]       - for portal names beginning with &quot;Q&quot;.\n-- [[Module:Portal/images/r]]\
      \       - for portal names beginning with &quot;R&quot;.\n-- [[Module:Portal/images/s]]       - for portal names beginning with &quot;S&quot;.\n-- [[Module:Portal/images/t]]       - for portal names beginning with &quot;T&quot;.\n-- [[Module:Portal/images/u]]\
      \       - for portal names beginning with &quot;U&quot;.\n-- [[Module:Portal/images/v]]       - for portal names beginning with &quot;V&quot;.\n-- [[Module:Portal/images/w]]       - for portal names beginning with &quot;W&quot;.\n-- [[Module:Portal/images/x]]\
      \       - for portal names beginning with &quot;X&quot;.\n-- [[Module:Portal/images/y]]       - for portal names beginning with &quot;Y&quot;.\n-- [[Module:Portal/images/z]]       - for portal names beginning with &quot;Z&quot;.\n-- [[Module:Portal/images/other]]\
      \   - for portal names beginning with any other letters. This includes numbers,\n--                                    letters with diacritics, and letters in non-Latin alphabets.\n-- [[Module:Portal/images/aliases]] - for adding aliases for existing portal\
      \ names. Use this page for variations\n--                                    in spelling and diacritics, etc., no matter what letter the portal begins with.\n \n-- When adding entries, please use alphabetical order. The format of the images table entries\
      \ is as follows:\n--          [&quot;portal name&quot;] = &quot;image.svg&quot;,\n-- The portal name should be the name of your portal, in lower case. For example, the portal name for \n-- &quot;Portal:United Kingdom&quot; would be &quot;united kingdom&quot;.\
      \ The image name should be capitalised normally, and the &quot;File:&quot;\n-- namespace prefix should be omitted.\n]==]\n \nreturn {\n\t[&quot;faisalabad&quot;] = &quot;Flag of Punjab.svg&quot;,\n\t[&quot;falun gong&quot;] = &quot;Falun Gong Logo.svg&quot;,\n\
      \t[&quot;family guy&quot;] = &quot;Family Guy television set.svg&quot;,\n\t[&quot;faroe islands&quot;] = &quot;Flag of the Faroe Islands.svg|border&quot;,\n\t[&quot;fascism&quot;] = &quot;Fasces lictoriae.svg&quot;,\n\t[&quot;fashion&quot;] = &quot;BathingSuit1920s.jpg&quot;,\n\
      \t[&quot;feminism&quot;] = &quot;Woman-power emblem.svg&quot;,\n\t[&quot;fencing&quot;] = &quot;Fencing pictogram.svg&quot;,\n\t[&quot;fictional characters&quot;] = &quot;Friendly stickman.svg&quot;,\n\t[&quot;figure skating&quot;] = &quot;Figure-skates-1.jpg&quot;,\n\
      \t[&quot;film&quot;] = &quot;Video-x-generic.svg&quot;,\n\t[&quot;film/canadian cinema task force&quot;] = &quot;Canadafilm.svg&quot;,\n\t[&quot;film in the united states&quot;] = &quot;United States film.svg&quot;,\n\t[&quot;final fantasy&quot;] = &quot;Final\
      \ Fantasy wordmark.svg&quot;,\n\t[&quot;finger lakes&quot;] = &quot;Fingerlakesmap2.PNG&quot;,\n\t[&quot;finland&quot;] = &quot;Flag of Finland.svg|border&quot;,\n\t[&quot;fire&quot;] = &quot;Large bonfire.jpg&quot;,\n\t[&quot;fish&quot;] = &quot;Antennarius\
      \ striatus.jpg&quot;,\n\t[&quot;fishing&quot;] = &quot;Fish icon.svg&quot;,\n\t[&quot;florida&quot;] = &quot;Flag of Florida.svg|border&quot;,\n\t[&quot;folklore&quot;] = &quot;Horseshoe and devil.svg&quot;,\n\t[&quot;food&quot;] = &quot;Foodlogo2.svg&quot;,\n\
      \t[&quot;football in africa&quot;] = &quot;Africa Football 3.svg&quot;,\n\t[&quot;football in argentina&quot;] = &quot;ArgentinaFootball.png&quot;,\n\t[&quot;football in germany&quot;] = &quot;Football Germany.png&quot;,\n\t[&quot;forestry&quot;] = &quot;Pine\
      \ forest in Sweden.jpg&quot;,\n\t[&quot;formula one&quot;] = &quot;Motorsport current event.svg&quot;,\n\t[&quot;france&quot;] = &quot;Flag of France.svg|border&quot;,\n\t[&quot;franco-americans&quot;] = &quot;Drapeau Franco-Américain.svg|border&quot;,\n\
      \t[&quot;frank zappa&quot;] = &quot;Zappa.jpg&quot;,\n\t[&quot;freedom of speech&quot;] = &quot;Free-speech-flag.svg&quot;,\n\t[&quot;freemasonry&quot;] = &quot;Square compasses.svg&quot;,\n\t[&quot;free software&quot;] = &quot;Free Software Portal Logo.svg&quot;,\n\
      \t[&quot;french and francophone literature&quot;] = &quot;Open book nae French flag.png&quot;,\n\t[&quot;french guiana&quot;] = &quot;Flag of French Guiana.svg&quot;,\n\t[&quot;french language and french-speaking world&quot;] = &quot;New-Map-Francophone\
      \ World.PNG&quot;,\n\t[&quot;french military history&quot;] = &quot;Flag of France.svg&quot;,\n\t[&quot;french politics&quot;] = &quot;Hémicycle 2 Palais Bourbon scropped and smaller.jpg&quot;,\n\t[&quot;french polynesia&quot;] = &quot;Flag of French Polynesia.svg&quot;,\n\
      \t[&quot;friends&quot;] = &quot;Friends logo.svg&quot;,\n\t[&quot;fungi&quot;] = &quot;Karl Johanssvamp, Iduns kokbok.png&quot;,\n\t[&quot;furry&quot;] = &quot;Furry blue paw logo.png&quot;,\n\t[&quot;futurama&quot;] = &quot;Earth Flag.svg&quot;\n}</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:58.114Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AReflist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:58 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq38 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404152519, 176737328, 4115597321
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"7585648\" ns=\"10\" title=\"Template:Reflist\"><revisions><rev user=\"Edokter\" timestamp=\"2014-07-19T16:16:30Z\" comment=\"Undid revision 617584734 by [[Special:Contributions/Nikkimaria|Nikkimaria]]\
      \ ([[User talk:Nikkimaria|talk]]) Undo; we know the number (&gt;250,000)\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">&lt;div class=&quot;reflist &lt;!--\n --&gt;{{#if: {{{1|}}}\n    | columns {{#iferror: {{#ifexpr:\
      \ {{{1|1}}} &gt; 1 }}\n      | references-column-width \n      | references-column-count references-column-count-{{#if:1|{{{1}}}}} }}\n    | {{#if: {{{colwidth|}}}\n      | references-column-width }} }}&quot; style=&quot;&lt;!--\n --&gt;{{#if: {{{1|}}}\n\
      \    | {{#iferror: {{#ifexpr: {{{1|1}}} &gt; 1 }}\n      | {{column-width|{{#if:1|{{{1}}}}}}}\n      | {{column-count|{{#if:1|{{{1}}}}}}} }}\n    | {{#if: {{{colwidth|}}}\n      | {{column-width|{{{colwidth}}}}} }} }} list-style-type: &lt;!--\n --&gt;{{{liststyle|{{#switch:\
      \ {{{group|}}}\n    | upper-alpha\n    | upper-roman\n    | lower-alpha\n    | lower-greek\n    | lower-roman = {{{group}}}\n    | #default = decimal}}}}};&quot;&gt;\n{{#tag:references|{{{refs|}}}|group={{{group|}}}}}&lt;/div&gt;&lt;noinclude&gt;\n{{Documentation}}\n\
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:58.400Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acolumn-count&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:58 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq60 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530349629, 361891697, 4115597433
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:column-count" to="Template:Column-count" /></normalized><pages><page pageid="29216387" ns="10" title="Template:Column-count"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T05:06:56Z" comment="Changed protection level of Template:Column-count: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;-moz-column-count: {{{1|2}}}; -webkit-column-count: {{{1|2}}}; column-count: {{{1|2}}};&lt;/includeonly&gt;&lt;noinclude&gt;

      &lt;!-- ADD CATEGORIES AND INTERWIKIS TO THE /doc PAGE, NOT HERE, THANKS --&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:58.724Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACommons+category&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:58 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=hhvm
      X-Cache: cp1068 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.3.1
      X-Varnish: 1530350072, 343420460, 4115597668
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"1275099\" ns=\"10\" title=\"Template:Commons category\"><revisions><rev user=\"Fuhghettaboutit\" timestamp=\"2013-11-02T05:06:20Z\" comment=\"Changed protection level of Template:Commons\
      \ category ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Commons\n| position = {{{position|}}}\n\
      \  &lt;!-- {{#if:x|}} strips whitespace from parameter 1, \n       in case it is fed like this: {{Commons category| Some cat }}. --&gt;\n|Category:{{#if:x| {{{1| {{PAGENAME}} }}} }}&lt;!--\n--&gt;|{{{2|{{{1|{{PAGENAME}}}}}}}}&lt;!--\n--&gt;}}&lt;includeonly&gt;{{#if:{{{1|}}}||[[Category:Commons\
      \ category template with no category set]]}}&lt;/includeonly&gt;&lt;noinclude&gt;\n\n{{Documentation}}\n&lt;!-- Add categories and interwikis to the /doc subpage, not here! --&gt;\n&lt;/noinclude&gt;&lt;includeonly&gt;&lt;!-- Some tracking categories to\
      \ see if we're ready to switch to Wikidata --&gt;\n{{#switch:{{NAMESPACE}}||{{ns:14}}=&lt;!-- Only articles and categories. --&gt;\n {{#if:{{#property:P373}}\n | {{#if:{{{1|}}}\n  | {{#ifeq:{{#property:P373}}|{{#invoke:StringReplace|encode wiki page name|{{{1|}}}}}\n\
      \   | [[Category:Commons category with local link same as on Wikidata]] &lt;!-- We want to end up here --&gt;\n   | [[Category:Commons category with local link different than on Wikidata]] &lt;!-- Figure out the best link --&gt;\n   }}\n  | {{#ifeq:{{#property:P373}}|{{PAGENAME}}\n\
      \   | [[Category:Commons category with page title same as on Wikidata]] &lt;!-- Ending up here is just fine --&gt;\n   | [[Category:Commons category with page title different than on Wikidata]] &lt;!-- Figure out the best link here too --&gt;\n   }}\n\
      \  }}\n | [[Category:Commons category without a link on Wikidata]] &lt;!-- These we still need to import --&gt;\n }}\n}}&lt;/includeonly&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:59.054Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACommons&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:59 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq36 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103576157, 4276370421, 4115597892
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"1142901\" ns=\"10\" title=\"Template:Commons\"><revisions><rev user=\"Fuhghettaboutit\" timestamp=\"2013-11-02T05:06:24Z\" comment=\"Changed protection level of Template:Commons\
      \ ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{ sister\n| position = {{{position|}}}\n| project\
      \  = commons\n| text     = Wikimedia Commons has {{{alt-term|media related to}}} '''''[[commons:{{{1|Special:Search/{{PAGENAME}}}}}|{{{2|{{{1|{{PAGENAME}}}}}}}}]]'''''. \n}}&lt;noinclude&gt;\n{{documentation}}\n&lt;!-- Add categories to the /doc sub-page\
      \ and interwikis to Wikidata. --&gt;\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:11:59.321Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asister&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:59 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq48 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055734680, 296406769, 4115598096
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:sister" to="Template:Sister" /></normalized><pages><page pageid="44221346" ns="10" title="Template:Sister"><revisions><rev user="Dekimasu" timestamp="2014-10-27T01:35:02Z" comment="Dekimasu moved page [[Template:Sister]] to [[Template:Sister project]] over redirect: per request on the talk page and listing at [[WP:RM]]; please revert if this breaks anything" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Sister project]]
      {{R from move}}</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:11:59.739Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASister+project&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:11:59 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq31 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404154466, 882898407, 4115598437
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"20505184\" ns=\"10\" title=\"Template:Sister project\"><revisions><rev user=\"Dekimasu\" timestamp=\"2014-10-27T01:35:01Z\" comment=\"Dekimasu moved page [[Template:Sister]]\
      \ to [[Template:Sister project]] over redirect: per request on the talk page and listing at [[WP:RM]]; please revert if this breaks anything\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Side box\n| metadata=no\n| position\
      \ = {{{position|}}}\n| image    = \n  {{#switch: {{{image|}}}\n  | none =    &lt;!-- &quot;image=none&quot;, do nothing --&gt;\n  |      =    &lt;!-- No image fed, select an image --&gt;\n    [[Image:{{#switch: {{lc: {{{project|}}} }}\n    | commons  \
      \              = Commons-logo.svg\n    | meta|metawiki|m        = Wikimedia Community Logo.svg\n    | wikibooks|wbk|wb|b     = Wikibooks-logo-en-noslogan.svg\n    | wikidata|data          = Wikidata-logo.svg\n    | wikiquote|quote|wqt|q  = Wikiquote-logo.svg\n\
      \    | wikipedia|wp|w         = Wikipedia-logo-v2.svg\n    | wikisource|source|ws|s = Wikisource-logo.svg\n    | wiktionary|wkt|wdy|d   = Wiktionary-logo-en.svg\n    | wikinews|news|wnw|n    = Wikinews-logo.svg\n    | wikispecies|species    = Wikispecies-logo.svg\n\
      \    | wikiversity|wvy|v      = Wikiversity-logo.svg\n    | wikivoyage|voyage|voy  = Wikivoyage-Logo-v3-icon.svg\n    | mediawiki|mw           = Mediawiki.png\n    | outreachwiki|outreach  = Wikimedia Outreach.png\n    | incubator              = Incubator-notext.svg\n\
      \    | #default               = Wikimedia-logo.svg\n    }}|40x40px|link=|alt=\n    ]]\n  | #default = {{{image|}}}\n  }}\n| text       = {{{text}}}\n| below      = {{{below|}}}\n| imageright = {{{imageright|}}}\n| class      = plainlinks\n}}&lt;noinclude&gt;{{Documentation}}&lt;!--\
      \ Add categories and interwikis to the /doc subpage, not here! --&gt;&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:00.353Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASide+box&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:00 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq38 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103577825, 176738335, 4115598617
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="20504849" ns="10" title="Template:Side box"><revisions><rev user="Mr. Stradivarius" timestamp="2014-06-03T04:58:23Z" comment="convert to [[Module:Side box]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Side box|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:00.620Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ASide_box&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:00 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025940084, 2402524981, 4115599541
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Side_box\" to=\"Module:Side box\" /></normalized><pages><page pageid=\"42926982\" ns=\"828\" title=\"Module:Side box\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"\
      2014-06-03T04:58:46Z\" comment=\"Protected Module:Side box: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\"\
      \ contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module implements {{side box}}.\n\nlocal yesno = require('Module:Yesno')\n\nlocal p = {}\n\nfunction p.main(frame)\n\tlocal origArgs = frame:getParent().args\n\tlocal args = {}\n\tfor k, v in\
      \ pairs(origArgs) do\n\t\tv = v:match('%s*(.-)%s*$')\n\t\tif v ~= '' then\n\t\t\targs[k] = v\n\t\tend\n\tend\n\treturn p._main(args)\nend\n\nfunction p._main(args)\n\tlocal data = p.makeData(args)\n\treturn p.renderSidebox(data)\nend\n\nfunction p.makeData(args)\n\
      \tlocal data = {}\n\n\t-- Main table classes\n\tdata.classes = {}\n\tif yesno(args.metadata) ~= false then\n\t\ttable.insert(data.classes, 'metadata')\n\tend\n\tif args.position and args.position:lower() == 'left' then\n\t\ttable.insert(data.classes, 'mbox-small-left')\n\
      \telse\n\t\ttable.insert(data.classes, 'mbox-small')\n\tend\n\ttable.insert(data.classes, args.class)\n\t\n\t-- Image\n\tif args.image and args.image ~= 'none' then\n\t\tdata.image = args.image\n\tend\n\n\t-- Copy over data that doesn't need adjusting\n\
      \tlocal argsToCopy = {\n\t\t-- Styles\n\t\t'style',\n\t\t'textstyle',\n\n\t\t-- Above row\n\t\t'above',\n\t\t'abovestyle',\n\n\t\t-- Body row\n\t\t'text',\n\t\t'imageright',\n\n\t\t-- Below row\n\t\t'below',\n\t}\n\tfor i, key in ipairs(argsToCopy) do\n\
      \t\tdata[key] = args[key]\n\tend\n\n\treturn data\nend\n\nfunction p.renderSidebox(data)\n\t-- Renders the sidebox HTML.\n\n\t-- Table root\n\tlocal root = mw.html.create('table')\n\tfor i, class in ipairs(data.classes or {}) do\n\t\troot:addClass(class)\n\
      \tend\n\troot:css{border = '1px solid #aaa', ['background-color'] = '#f9f9f9'}\n\tif data.style then\n\t\troot:cssText(data.style)\n\tend\n\n\t-- The &quot;above&quot; row\n\tif data.above then\n\t\tlocal aboveCell = root:newline():tag('tr'):tag('td')\n\
      \t\taboveCell\n\t\t\t:attr('colspan', data.imageright and 3 or 2)\n\t\t\t:addClass('mbox-text')\n\t\tif data.textstyle then\n\t\t\taboveCell:cssText(data.textstyle)\n\t\tend\n\t\tif data.abovestyle then\n\t\t\taboveCell:cssText(data.abovestyle)\n\t\tend\n\
      \t\taboveCell\n\t\t\t:newline()\n\t\t\t:wikitext(data.above)\n\tend\n\n\t-- The body row\n\tlocal bodyRow = root:newline():tag('tr'):newline()\n\tif data.image then\n\t\tbodyRow:tag('td')\n\t\t\t:addClass('mbox-image')\n\t\t\t:wikitext(data.image)\n\t\
      else\n\t\tbodyRow:tag('td'):css('width', '1px')\n\tend\n\tlocal textCell = bodyRow:newline():tag('td')\n\ttextCell:addClass('mbox-text plainlist')\n\tif data.textstyle then\n\t\ttextCell:cssText(data.textstyle)\n\tend\n\ttextCell:wikitext(data.text)\n\t\
      if data.imageright then\n\t\tbodyRow:newline():tag('td')\n\t\t\t:addClass('mbox-imageright')\n\t\t\t:wikitext(data.imageright)\n\tend\n\n\t-- The below row\n\tif data.below then\n\t\tlocal belowCell = root:newline():tag('tr'):tag('td')\n\t\tbelowCell\n\
      \t\t\t:attr('colspan', data.imageright and 3 or 2)\n\t\t\t:addClass('mbox-text')\n\t\tif data.textstyle then\n\t\t\tbelowCell:cssText(data.textstyle)\n\t\tend\n\t\tbelowCell:wikitext(data.below)\n\tend\n\n\treturn tostring(root)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:01.276Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3A&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:01 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq47 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123538954, 319103755, 4115599948
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page title="Template:" invalid="" /></pages></query></api>
- recorded: 2014-11-04T23:12:01.689Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AStringReplace&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:01 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025941258, 1470653882, 4115600318
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38625391\" ns=\"828\" title=\"Module:StringReplace\"><revisions><rev user=\"קיפודנחש\" timestamp=\"2014-02-20T16:08:43Z\" comment=\"typos (&quot;occurence&quot; =&gt; &quot;occurrence&quot;)\"\
      \ contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- Module for different search and replace operations on strings.\nlocal p = {}\n\n-- Takes one string parameter, and returns the string with all characters with special meaning\
      \ for Lua patterns escaped with a preceding `%`.\nfunction p.escape_pattern(text)\n    -- Replaces each occurrence of any of ().%+-*?[^$ with a `%` and then the character.\n    local r = string.gsub(text, &quot;[%(%)%.%%%+%-%*%?%[%^%$]&quot;, &quot;%%%1&quot;)\n\
      \    return r\nend\n\n-- Returns the first parameter, with all occurrences of the second parameter replaced with the third parameter.\n-- All special characters are ignored: {{#invoke:StringReplace|replace_all|test.a%1$foo|%1|bar}} results in `test.abarfoo`.\n\
      function p.replace_all(frame)\n    local str = frame.args[1]\n    local strToFind = frame.args[2]\n    local strToreplaceWith = frame.args[3]\n    local r = string.gsub(str, p.escape_pattern(strToFind), p.escape_pattern(strToreplaceWith))\n    return r\n\
      end\n\np['encode wiki page name'] = function( frame )\n\tlocal x = mw.ustring.gsub( \n\t\tframe.args[1] or '', \n\t\t'[\\'&quot;&amp;_]', \n\t\t{ \n\t\t\t[&quot;'&quot;] = '&amp;#39;', \n\t\t\t['&quot;'] = '&amp;#34;', \n\t\t\t['&amp;'] = '&amp;#38;',\
      \ \n\t\t\t['_'] = ' ', \n\t\t} \n\t)\n\treturn mw.text.trim( x )\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:02.172Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AIMDb+name&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:01 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055739713, 952171323, 4115600501
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="942370" ns="10" title="Template:IMDb name"><revisions><rev user="Zyxw" timestamp="2014-09-10T10:31:22Z" comment="Trim any leading spaces from 1st unnamed parameter to prevent it from breaking the link. Tested first with [[Template:IMDb name/sandbox]] and [[Template:IMDb name/testcases]]." contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">[http://www.imdb.com/{{#if:{{{1|{{{id|}}}}}}|name/{{#ifeq:{{Str left|{{{1|{{{id}}}}}}|2}}|nm||nm}}{{Trim|{{{1|{{{id}}}}}}}}|{{#if:{{#property:P345}}|name/{{#property:P345}}|Name?{{urlencode:{{PAGENAME}}}}}}}}/{{#switch:{{lc:{{{section|}}} }}
      |award|awards=awards Awards for
      |biography|bio=bio Biography for
      }} {{{2|{{{name|{{Title without disambig|{{PAGENAME}}}}}}}}}}] at the [[Internet Movie Database]]&lt;includeonly&gt;{{#if:{{{1|{{{id|}}}}}}{{#property:P345}}||[[Category:IMDb template with no id set]]}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:02.454Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AStr+left&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:02 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123541138, 290988585, 4115601136
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="21696393" ns="10" title="Template:Str left"><revisions><rev user="Mr. Stradivarius" timestamp="2014-04-21T08:46:40Z" comment="don&#039;t expand a parameter around safesubst, as the includeonly tags already prevent this template from being substituted onto the template page" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{safesubst:padleft:|{{{2|1}}}|{{{1}}}}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:02.811Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ATitle+without+disambig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:02 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq46 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404159149, 2973983253, 4115601377
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="24755203" ns="10" title="Template:Title without disambig"><revisions><rev user="Mr. Stradivarius" timestamp="2013-06-08T11:23:52Z" comment="Protected Template:Title without disambig: [[WP:High-risk templates|Highly visible template]]: 120,000 transclusions ([Edit=Block all non-admin users] (indefinite) [Move=Block all non-admin users] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#Invoke:String|replace|{{{1|}}}|%s%(.*%)||plain=false}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:03.513Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AString&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:03 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530356912, 3298527581, 4115601660
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"38569505\" ns=\"828\" title=\"Module:String\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2013-04-26T10:52:01Z\" comment=\"Add &quot;rep&quot; function per request\
      \ by [[User:קיפודנחש]] at [[Wikipedia:Lua requests#Template:Loop and Template:Loop15]]. Copied from sandbox.\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[[  \n\nThis module is intended to provide access to basic string\
      \ functions.\n\nMost of the functions provided here can be invoked with named parameters, \nunnamed parameters, or a mixture.  If named parameters are used, Mediawiki will \nautomatically remove any leading or trailing whitespace from the parameter.  \n\
      Depending on the intended use, it may be advantageous to either preserve or\nremove such whitespace.\n\nGlobal options\n    ignore_errors: If set to 'true' or 1, any error condition will result in \n        an empty string being returned rather than an\
      \ error message.  \n        \n    error_category: If an error occurs, specifies the name of a category to \n        include with the error message.  The default category is  \n        [Category:Errors reported by Module String].\n        \n    no_category:\
      \ If set to 'true' or 1, no category will be added if an error\n        is generated.\n        \nUnit tests for this module are available at Module:String/tests.\n]]\n\nlocal str = {}\n\n--[[\nlen\n\nThis function returns the length of the target string.\n\
      \nUsage:\n{{#invoke:String|len|target_string|}}\nOR\n{{#invoke:String|len|s=target_string}}\n\nParameters\n    s: The string whose length to report\n\nIf invoked using named parameters, Mediawiki will automatically remove any leading or\ntrailing whitespace\
      \ from the target string.  \n]]\nfunction str.len( frame )\n    local new_args = str._getParameters( frame.args, {'s'} );\n    local s = new_args['s'] or '';\n    return mw.ustring.len( s )\nend\n\n--[[\nsub\n\nThis function returns a substring of the\
      \ target string at specified indices.\n\nUsage:\n{{#invoke:String|sub|target_string|start_index|end_index}}\nOR\n{{#invoke:String|sub|s=target_string|i=start_index|j=end_index}}\n\nParameters\n    s: The string to return a subset of\n    i: The fist index\
      \ of the substring to return, defaults to 1.\n    j: The last index of the string to return, defaults to the last character.\n    \nThe first character of the string is assigned an index of 1.  If either i or j\nis a negative value, it is interpreted the\
      \ same as selecting a character by \ncounting from the end of the string.  Hence, a value of -1 is the same as \nselecting the last character of the string.\n\nIf the requested indices are out of range for the given string, an error is \nreported.\n]]\n\
      function str.sub( frame )\n    local new_args = str._getParameters( frame.args, { 's', 'i', 'j' } );\n    local s = new_args['s'] or '';\n    local i = tonumber( new_args['i'] ) or 1;\n    local j = tonumber( new_args['j'] ) or -1;\n    \n    local len\
      \ = mw.ustring.len( s );\n\n    -- Convert negatives for range checking\n    if i &lt; 0 then\n        i = len + i + 1;\n    end\n    if j &lt; 0 then\n        j = len + j + 1;\n    end\n    \n    if i &gt; len or j &gt; len or i &lt; 1 or j &lt; 1 then\n\
      \        return str._error( 'String subset index out of range' );\n    end\n    if j &lt; i then\n        return str._error( 'String subset indices out of order' );\n    end\n    \n    return mw.ustring.sub( s, i, j )\nend\n\n--[[\nThis function implements\
      \ that features of {{str sub old}} and is kept in order\nto maintain these older templates.\n]]\nfunction str.sublength( frame )\n    local i = tonumber( frame.args.i ) or 0\n    local len = tonumber( frame.args.len )\n    return mw.ustring.sub( frame.args.s,\
      \ i + 1, len and ( i + len ) )\nend\n\n--[[\nmatch\n\nThis function returns a substring from the source string that matches a \nspecified pattern.\n\nUsage:\n{{#invoke:String|match|source_string|pattern_string|start_index|match_number|plain_flag|nomatch_output}}\n\
      OR\n{{#invoke:String|pos|s=source_string|pattern=pattern_string|start=start_index\n    |match=match_number|plain=plain_flag|nomatch=nomatch_output}}\n\nParameters\n    s: The string to search\n    pattern: The pattern or string to find within the string\n\
      \    start: The index within the source string to start the search.  The first\n        character of the string has index 1.  Defaults to 1.\n    match: In some cases it may be possible to make multiple matches on a single \n        string.  This specifies\
      \ which match to return, where the first match is \n        match= 1.  If a negative number is specified then a match is returned \n        counting from the last match.  Hence match = -1 is the same as requesting\n        the last match.  Defaults to\
      \ 1.\n    plain: A flag indicating that the pattern should be understood as plain\n        text.  Defaults to false.\n    nomatch: If no match is found, output the &quot;nomatch&quot; value rather than an error.\n\nIf invoked using named parameters, Mediawiki\
      \ will automatically remove any leading or\ntrailing whitespace from each string.  In some circumstances this is desirable, in \nother cases one may want to preserve the whitespace.\n\nIf the match_number or start_index are out of range for the string\
      \ being queried, then\nthis function generates an error.  An error is also generated if no match is found.\nIf one adds the parameter ignore_errors=true, then the error will be suppressed and \nan empty string will be returned on any failure.\n\nFor information\
      \ on constructing Lua patterns, a form of [regular expression], see:\n\n* http://www.lua.org/manual/5.1/manual.html#5.4.1\n* http://www.mediawiki.org/wiki/Extension:Scribunto/Lua_reference_manual#Patterns\n* http://www.mediawiki.org/wiki/Extension:Scribunto/Lua_reference_manual#Ustring_patterns\n\
      \n]]\nfunction str.match( frame )\n    local new_args = str._getParameters( frame.args, {'s', 'pattern', 'start', 'match', 'plain', 'nomatch'} );\n    local s = new_args['s'] or '';\n    local start = tonumber( new_args['start'] ) or 1;\n    local plain_flag\
      \ = str._getBoolean( new_args['plain'] or false );\n    local pattern = new_args['pattern'] or '';\n    local match_index = math.floor( tonumber(new_args['match']) or 1 );\n    local nomatch = new_args['nomatch'];\n    \n    if s == '' then\n        return\
      \ str._error( 'Target string is empty' );\n    end\n    if pattern == '' then\n        return str._error( 'Pattern string is empty' );\n    end\n    if math.abs(start) &lt; 1 or math.abs(start) &gt; mw.ustring.len( s ) then\n        return str._error(\
      \ 'Requested start is out of range' );\n    end\n    if match_index == 0 then\n        return str._error( 'Match index is out of range' );\n    end\n    if plain_flag then\n        pattern = str._escapePattern( pattern );\n    end\n    \n    local result\n\
      \    if match_index == 1 then\n        -- Find first match is simple case\n        result = mw.ustring.match( s, pattern, start )\n    else\n        if start &gt; 1 then\n            s = mw.ustring.sub( s, start );\n        end\n        \n        local\
      \ iterator = mw.ustring.gmatch(s, pattern);\n        if match_index &gt; 0 then\n            -- Forward search\n            for w in iterator do\n                match_index = match_index - 1;\n                if match_index == 0 then\n               \
      \     result = w;\n                    break;\n                end\n            end    \n        else\n            -- Reverse search\n            local result_table = {};\n            local count = 1;\n            for w in iterator do\n               \
      \ result_table[count] = w;\n                count = count + 1;\n            end\n            \n            result = result_table[ count + match_index ];            \n        end\n    end        \n    \n    if result == nil then\n        if nomatch == nil\
      \ then\n            return str._error( 'Match not found' );\n        else\n            return nomatch;\n        end\n    else\n        return result;\n    end\nend\n\n--[[\npos\n\nThis function returns a single character from the target string at position\
      \ pos.\n\nUsage:\n{{#invoke:String|pos|target_string|index_value}}\nOR\n{{#invoke:String|pos|target=target_string|pos=index_value}}\n\nParameters\n    target: The string to search\n    pos: The index for the character to return\n\nIf invoked using named\
      \ parameters, Mediawiki will automatically remove any leading or\ntrailing whitespace from the target string.  In some circumstances this is desirable, in \nother cases one may want to preserve the whitespace.\n\nThe first character has an index value\
      \ of 1.\n\nIf one requests a negative value, this function will select a character by counting backwards \nfrom the end of the string.  In other words pos = -1 is the same as asking for the last character.\n\nA requested value of zero, or a value greater\
      \ than the length of the string returns an error.\n]]\nfunction str.pos( frame )\n    local new_args = str._getParameters( frame.args, {'target', 'pos'} );\n    local target_str = new_args['target'] or '';\n    local pos = tonumber( new_args['pos'] ) or\
      \ 0;\n\n    if pos == 0 or math.abs(pos) &gt; mw.ustring.len( target_str ) then\n        return str._error( 'String index out of range' );\n    end    \n    \n    return mw.ustring.sub( target_str, pos, pos );\nend\n\n--[[\nstr_find\n\nThis function duplicates\
      \ the behavior of {{str_find}}, including all of its quirks.\nThis is provided in order to support existing templates, but is NOT RECOMMENDED for \nnew code and templates.  New code is recommended to use the &quot;find&quot; function instead.\n\nReturns\
      \ the first index in &quot;source&quot; that is a match to &quot;target&quot;.  Indexing is 1-based,\nand the function returns -1 if the &quot;target&quot; string is not present in &quot;source&quot;.\n\nImportant Note: If the &quot;target&quot; string\
      \ is empty / missing, this function returns a\nvalue of &quot;1&quot;, which is generally unexpected behavior, and must be accounted for\nseparatetly.\n]]\nfunction str.str_find( frame )\n    local new_args = str._getParameters( frame.args, {'source',\
      \ 'target'} );\n    local source_str = new_args['source'] or '';\n    local target_str = new_args['target'] or '';\n\n    if target_str == '' then\n        return 1;\n    end    \n    \n    local start = mw.ustring.find( source_str, target_str, 1, true\
      \ )\n    if start == nil then\n        start = -1\n    end\n    \n    return start\nend\n\n--[[\nfind\n\nThis function allows one to search for a target string or pattern within another\nstring.\n\nUsage:\n{{#invoke:String|find|source_str|target_string|start_index|plain_flag}}\n\
      OR\n{{#invoke:String|find|source=source_str|target=target_str|start=start_index|plain=plain_flag}}\n\nParameters\n    source: The string to search\n    target: The string or pattern to find within source\n    start: The index within the source string to\
      \ start the search, defaults to 1\n    plain: Boolean flag indicating that target should be understood as plain\n        text and not as a Lua style regular expression, defaults to true\n\nIf invoked using named parameters, Mediawiki will automatically\
      \ remove any leading or\ntrailing whitespace from the parameter.  In some circumstances this is desirable, in \nother cases one may want to preserve the whitespace.\n\nThis function returns the first index &gt;= &quot;start&quot; where &quot;target&quot;\
      \ can be found \nwithin &quot;source&quot;.  Indices are 1-based.  If &quot;target&quot; is not found, then this \nfunction returns 0.  If either &quot;source&quot; or &quot;target&quot; are missing / empty, this\nfunction also returns 0.\n\nThis function\
      \ should be safe for UTF-8 strings.\n]]\nfunction str.find( frame )\n    local new_args = str._getParameters( frame.args, {'source', 'target', 'start', 'plain' } ); \n    local source_str = new_args['source'] or '';\n    local pattern = new_args['target']\
      \ or '';\n    local start_pos = tonumber(new_args['start']) or 1;\n    local plain = new_args['plain'] or true;\n        \n    if source_str == '' or pattern == '' then\n        return 0;\n    end    \n    \n    plain = str._getBoolean( plain );\n\n  \
      \  local start = mw.ustring.find( source_str, pattern, start_pos, plain )\n    if start == nil then\n        start = 0\n    end\n    \n    return start\nend\n\n--[[\nreplace\n\nThis function allows one to replace a target string or pattern within another\n\
      string.\n\nUsage:\n{{#invoke:String|replace|source_str|pattern_string|replace_string|replacement_count|plain_flag}}\nOR\n{{#invoke:String|replace|source=source_string|pattern=pattern_string|replace=replace_string|\n   count=replacement_count|plain=plain_flag}}\n\
      \nParameters\n    source: The string to search\n    pattern: The string or pattern to find within source\n    replace: The replacement text\n    count: The number of occurences to replace, defaults to all.\n    plain: Boolean flag indicating that pattern\
      \ should be understood as plain\n        text and not as a Lua style regular expression, defaults to true \n]]\nfunction str.replace( frame )\n    local new_args = str._getParameters( frame.args, {'source', 'pattern', 'replace', 'count', 'plain' } ); \n\
      \    local source_str = new_args['source'] or '';\n    local pattern = new_args['pattern'] or '';\n    local replace = new_args['replace'] or '';\n    local count = tonumber( new_args['count'] );\n    local plain = new_args['plain'] or true;\n        \n\
      \    if source_str == '' or pattern == '' then\n        return source_str;\n    end    \n    plain = str._getBoolean( plain );\n\n    if plain then\n        pattern = str._escapePattern( pattern );\n        replace = mw.ustring.gsub( replace, &quot;%%&quot;,\
      \ &quot;%%%%&quot; ); --Only need to escape replacement sequences.\n    end\n    \n    local result;\n\n    if count ~= nil then\n        result = mw.ustring.gsub( source_str, pattern, replace, count );\n    else\n        result = mw.ustring.gsub( source_str,\
      \ pattern, replace );\n    end        \n\n    return result;\nend\n\n--[[ \n    simple function to pipe string.rep to templates.\n]]\n\nfunction str.rep( frame )\n    local repetitions = tonumber( frame.args[2] )\n    if not repetitions then \n       \
      \ return str._error( 'function rep expects a number as second parameter, received &quot;' .. ( frame.args[2] or '' ) .. '&quot;' )\n    end\n    return string.rep( frame.args[1] or '', repetitions )\nend\n\n--[[\nHelper function that populates the argument\
      \ list given that user may need to use a mix of\nnamed and unnamed parameters.  This is relevant because named parameters are not\nidentical to unnamed parameters due to string trimming, and when dealing with strings\nwe sometimes want to either preserve\
      \ or remove that whitespace depending on the application.\n]]\nfunction str._getParameters( frame_args, arg_list )\n    local new_args = {};\n    local index = 1;\n    local value;\n    \n    for i,arg in ipairs( arg_list ) do\n        value = frame_args[arg]\n\
      \        if value == nil then\n            value = frame_args[index];\n            index = index + 1;\n        end\n        new_args[arg] = value;\n    end\n    \n    return new_args;\nend        \n\n--[[\nHelper function to handle error messages.\n]]\n\
      function str._error( error_str )\n    local frame = mw.getCurrentFrame();\n    local error_category = frame.args.error_category or 'Errors reported by Module String';\n    local ignore_errors = frame.args.ignore_errors or false;\n    local no_category\
      \ = frame.args.no_category or false;\n    \n    if str._getBoolean(ignore_errors) then\n        return '';\n    end\n    \n    local error_str = '&lt;strong class=&quot;error&quot;&gt;String Module Error: ' .. error_str .. '&lt;/strong&gt;';\n    if error_category\
      \ ~= '' and not str._getBoolean( no_category ) then\n        error_str = '[[Category:' .. error_category .. ']]' .. error_str;\n    end        \n    \n    return error_str;\nend\n\n--[[\nHelper Function to interpret boolean strings\n]]\nfunction str._getBoolean(\
      \ boolean_str )\n    local boolean_value;\n    \n    if type( boolean_str ) == 'string' then\n        boolean_str = boolean_str:lower();\n        if boolean_str == 'false' or boolean_str == 'no' or boolean_str == '0' \n                or boolean_str ==\
      \ '' then\n            boolean_value = false;\n        else\n            boolean_value = true;\n        end    \n    elseif type( boolean_str ) == 'boolean' then\n        boolean_value = boolean_str;\n    else\n        error( 'No boolean value found' );\n\
      \    end    \n    return boolean_value\nend\n\n--[[\nHelper function that escapes all pattern characters so that they will be treated \nas plain text.\n]]\nfunction str._escapePattern( pattern_str )\n    return mw.ustring.gsub( pattern_str, &quot;([%(%)%.%%%+%-%*%?%[%^%$%]])&quot;,\
      \ &quot;%%%1&quot; );\nend\n\nreturn str</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:04.043Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ATwitter&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:03 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025944336, 3439994567, 4115602196
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="22425474" ns="10" title="Template:Twitter"><revisions><rev user="Zyxw" timestamp="2014-09-27T05:12:28Z" comment="Remove any leading spaces from 1st unnamed parameter that would break link. Tested first at [[Template:Twitter/sandbox]] and [[Template:Twitter/testcases]]." contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">[https://twitter.com/{{Trim|{{{1|{{{id}}}}}}}} {{{2|{{{name|{{Title without disambig|{{PAGENAME}}}}}}}}}}] on [[Twitter]]&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:04.654Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Ayoutube+user&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:04 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq52 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530358713, 388620831, 4115602777
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:youtube user" to="Template:Youtube user" /></normalized><pages><page pageid="28318713" ns="10" title="Template:Youtube user"><revisions><rev user="WikiPuppies" timestamp="2012-04-02T23:04:23Z" comment="Reverted edits by [[Special:Contributions/209.137.240.161|209.137.240.161]] ([[User talk:209.137.240.161|talk]]) to last revision by Boing! said Zebedee ([[WP:HG|HG]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:YouTube user]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:04.916Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AYouTube+user&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:04 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227076300, 2402527818, 4115603237
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="12133850" ns="10" title="Template:YouTube user"><revisions><rev user="Plastikspork" timestamp="2010-08-12T14:44:40Z" comment="Protected Template:YouTube user: [[WP:HRT|Highly visible template]] ([edit=autoconfirmed] (indefinite) [move=autoconfirmed] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{YouTube|u={{{1|{{{user|?}}}}}}|{{{2|{{{title|{{PAGENAME}}}}}}}}}}&lt;noinclude&gt;
      &lt;!-- PLEASE ADD CATEGORIES AND INTERWIKIS TO THE /doc SUBPAGE, THANKS --&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:05.193Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ATom+Hanks&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:05 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227076759, 343425062, 4115603657
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"32513980\" ns=\"10\" title=\"Template:Tom Hanks\"><revisions><rev user=\"Cowlibob\" timestamp=\"2014-09-12T19:27:19Z\" comment=\"article has changed name\" contentformat=\"\
      text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n|name = Tom Hanks\n|title = [[Tom Hanks]]\n|state = {{{state|autocollapse}}}\n|listclass = hlist\n|group1 = Director\n|list1= \n* ''[[That Thing You Do!]]'' (1996)\n* ''[[Larry Crowne\
      \ ]]'' (2011) \n\n|group2 = Screenwriter\n|list2 = \n* ''[[That Thing You Do!]]'' (1996)\n* ''[[From the Earth to the Moon (TV miniseries)|From the Earth to the Moon]]'' (1998, 4 episodes)\n* ''[[Magnificent Desolation: Walking on the Moon 3D]]'' (2005)\n\
      * ''[[Larry Crowne]]'' (2011) \n\n|group3 = Producer\n|list3 = \n* ''[[Cast Away]]'' (2000)\n* ''[[My Big Fat Greek Wedding]]'' (2002)\n* ''[[Connie and Carla]]'' (2004)\n* ''[[Magnificent Desolation: Walking on the Moon 3D]]'' (2005)\n* ''[[Neil Young:\
      \ Heart of Gold]]'' (2006)\n* ''[[The Ant Bully (film)|The Ant Bully]]'' (2006)\n* ''[[Starter for 10 (film)|Starter for 10]]'' (2006)\n* ''[[Charlie Wilson's War]]'' (2007)\n* ''[[The Great Buck Howard]]'' (2008)\n* ''[[City of Ember]]'' (2008)\n* ''[[Where\
      \ the Wild Things Are (film)|Where the Wild Things Are]]'' (2009)\n* ''[[Larry Crowne]]'' (2011)\n* ''[[American Idiot (film)|American Idiot]]'' (TBA)\n\n|group4 = Executive producer\n|list4 = \n* ''[[The Polar Express (film)|The Polar Express]]'' (2004)\n\
      * ''[[Evan Almighty]]'' (2007)\n* ''[[Mamma Mia! (film)|Mamma Mia!]]'' (2008)\n* ''[[My Life in Ruins]]'' (2009)\n\n|group5 = Television \n|list5 = \n* ''[[From the Earth to the Moon (TV miniseries)|From the Earth to the Moon]]'' (1998)\n* ''[[Band of\
      \ Brothers (TV miniseries)|Band of Brothers]]'' (2001)\n* ''[[My Big Fat Greek Life]]'' (2003)\n* ''[[The Pacific (TV miniseries)|The Pacific]]'' (2010)\n* ''[[Big Love]]'' (2006&amp;ndash;2011)\n* ''[[Game Change (film)|Game Change]]'' (2012)\n\n|group6\
      \ = Related\n|list6 = \n* [[Tom Hanks on screen and stage|Filmography]]\n* [[Playtone]]\n* [[List of awards and nominations received by Tom Hanks|Awards and nominations]]\n* [[Colin Hanks]]\n* [[Rita Wilson]]\n\n}}&lt;noinclude&gt;\n{{collapsible option}}\n\
      [[Category:American film director navigational boxes|Hanks, Tom]]\n[[Category:Film writer navigational boxes]]\n[[Category:Film producer navigational boxes]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:05.575Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ANavbox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:05 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404163390, 3439996029, 4115603968
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="995954" ns="10" title="Template:Navbox"><revisions><rev user="Edokter" timestamp="2014-10-18T12:29:00Z" comment="linebreaks" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Navbox|navbox}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:06.194Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AAcademyAwardBestActor+1981-2000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:06 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq36 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025947122, 4276375229, 4115604244
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="31886208" ns="10" title="Template:AcademyAwardBestActor 1981-2000"><revisions><rev user="Regge robban2" timestamp="2013-10-08T23:26:20Z" comment="[[WP:AES|←]]Redirected page to [[Template:Academy Award Best Actor]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Academy Award Best Actor]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:06.457Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AAcademy+Award+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:06 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq41 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025947937, 655037352, 4115604795
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"15510527\" ns=\"10\" title=\"Template:Academy Award Best Actor\"><revisions><rev user=\"Chihciboy\" timestamp=\"2014-04-01T15:27:11Z\" comment=\"Undid revision 597928361 by\
      \ [[Special:Contributions/179.236.30.165|179.236.30.165]] ([[User talk:179.236.30.165|talk]]) rv unexplained edit\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name      = Academy Award Best Actor\n| title\
      \     = [[Academy Awards|Academy Award]] for [[Academy Award for Best Actor|Best Actor]]\n| state     = {{{state|autocollapse}}}\n| bodyclass = hlist\n| basestyle = background: #EEDD82\n\n| group1 = 1928–1940\n| list1  = \n* [[Emil Jannings]] (1928)\n\
      * [[Warner Baxter]] (1929)\n* [[George Arliss]] (1930)\n* [[Lionel Barrymore]] (1931)\n* [[Fredric March]] / [[Wallace Beery]] (1932)\n* [[Charles Laughton]] (1933)\n* [[Clark Gable]] (1934)\n* [[Victor McLaglen]] (1935)\n* [[Paul Muni]] (1936)\n* [[Spencer\
      \ Tracy]] (1937)\n* [[Spencer Tracy]] (1938)\n* [[Robert Donat]] (1939)\n* [[James Stewart]] (1940)\n\n| group2 = 1941–1960\n| list2  =\n* [[Gary Cooper]] (1941)\n* [[James Cagney]] (1942)\n* [[Paul Lukas]] (1943)\n* [[Bing Crosby]] (1944)\n* [[Ray Milland]]\
      \ (1945)\n* [[Fredric March]] (1946)\n* [[Ronald Colman]] (1947)\n* [[Laurence Olivier]] (1948)\n* [[Broderick Crawford]] (1949)\n* [[José Ferrer]] (1950)\n* [[Humphrey Bogart]] (1951)\n* [[Gary Cooper]] (1952)\n* [[William Holden]] (1953)\n* [[Marlon\
      \ Brando]] (1954)\n* [[Ernest Borgnine]] (1955)\n* [[Yul Brynner]] (1956)\n* [[Alec Guinness]] (1957)\n* [[David Niven]] (1958)\n* [[Charlton Heston]] (1959)\n* [[Burt Lancaster]] (1960)\n\n| group3 = 1961–1980\n| list3  =\n* [[Maximilian Schell]] (1961)\n\
      * [[Gregory Peck]] (1962)\n* [[Sidney Poitier]] (1963)\n* [[Rex Harrison]] (1964)\n* [[Lee Marvin]] (1965)\n* [[Paul Scofield]] (1966)\n* [[Rod Steiger]] (1967)\n* [[Cliff Robertson]] (1968)\n* [[John Wayne]] (1969)\n* [[George C. Scott]] (1970)\n* [[Gene\
      \ Hackman]] (1971)\n* [[Marlon Brando]] (1972)\n* [[Jack Lemmon]] (1973)\n* [[Art Carney]] (1974)\n* [[Jack Nicholson]] (1975)\n* [[Peter Finch]] (1976)\n* [[Richard Dreyfuss]] (1977)\n* [[Jon Voight]] (1978)\n* [[Dustin Hoffman]] (1979)\n* [[Robert De\
      \ Niro]] (1980)\n\n\n| group4 = 1981–2000\n| list4  =\n* [[Henry Fonda]] (1981)\n* [[Ben Kingsley]] (1982)\n* [[Robert Duvall]] (1983)\n* [[F. Murray Abraham]] (1984)\n* [[William Hurt]] (1985)\n* [[Paul Newman]] (1986)\n* [[Michael Douglas]] (1987)\n\
      * [[Dustin Hoffman]] (1988)\n* [[Daniel Day-Lewis]] (1989)\n* [[Jeremy Irons]] (1990)\n* [[Anthony Hopkins]] (1991)\n* [[Al Pacino]] (1992)\n* [[Tom Hanks]] (1993) \n* [[Tom Hanks]] (1994)\n* [[Nicolas Cage]] (1995)\n* [[Geoffrey Rush]] (1996)\n* [[Jack\
      \ Nicholson]] (1997)\n* [[Roberto Benigni]] (1998)\n* [[Kevin Spacey]] (1999)\n* [[Russell Crowe]] (2000)\n\n| group5 = 2001–present\n| list5  =\n* [[Denzel Washington]] (2001)\n* [[Adrien Brody]] (2002)\n* [[Sean Penn]] (2003)\n* [[Jamie Foxx]] (2004)\n\
      * [[Philip Seymour Hoffman]] (2005)\n* [[Forest Whitaker]] (2006)\n* [[Daniel Day-Lewis]] (2007)\n* [[Sean Penn]] (2008)\n* [[Jeff Bridges]] (2009)\n* [[Colin Firth]] (2010)\n* [[Jean Dujardin]] (2011)\n* [[Daniel Day-Lewis]] (2012)\n* [[Matthew McConaughey]]\
      \ (2013)\n\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:Academy Award for Best Actor templates| ]]\n\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:06.805Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AAFI+Life+Achievement+Award&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:06 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123547376, 2402529185, 4115604921
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"26762723\" ns=\"10\" title=\"Template:AFI Life Achievement Award\"><revisions><rev user=\"Dancedom\" timestamp=\"2014-10-03T22:29:38Z\" comment=\"\" contentformat=\"text/x-wiki\"\
      \ contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n| name  = AFI Life Achievement Award\n| title = [[AFI Life Achievement Award]]\n| listclass = hlist\n| titlestyle = background: #EEDD82\n\n| list1 = \n* [[John Ford]] (1973)\n* [[James Cagney]]\
      \ (1974)\n* [[Orson Welles]] (1975)\n* [[William Wyler]] (1976)\n* [[Bette Davis]] (1977)\n* [[Henry Fonda]] (1978)\n* [[Alfred Hitchcock]] (1979)\n* [[James Stewart]] (1980)\n* [[Fred Astaire]] (1981)\n* [[Frank Capra]] (1982)\n* [[John Huston]] (1983)\n\
      * [[Lillian Gish]] (1984)\n* [[Gene Kelly]] (1985) \n* [[Billy Wilder]] (1986)\n* [[Barbara Stanwyck]] (1987)\n* [[Jack Lemmon]] (1988)\n* [[Gregory Peck]] (1989)\n* [[David Lean]] (1990)\n* [[Kirk Douglas]] (1991)\n* [[Sidney Poitier]] (1992)\n* [[Elizabeth\
      \ Taylor]] (1993)\n* [[Jack Nicholson]] (1994)\n* [[Steven Spielberg]] (1995)\n* [[Clint Eastwood]] (1996)\n* [[Martin Scorsese]] (1997)\n* [[Robert Wise]] (1998)\n* [[Dustin Hoffman]] (1999)\n* [[Harrison Ford]] (2000)\n* [[Barbra Streisand]] (2001)\n\
      * [[Tom Hanks]] (2002)\n* [[Robert De Niro]] (2003)\n* [[Meryl Streep]] (2004) \n* [[George Lucas]] (2005)\n* [[Sean Connery]] (2006)\n* [[Al Pacino]] (2007)\n* [[Warren Beatty]] (2008)\n* [[Michael Douglas]] (2009)\n* [[Mike Nichols]] (2010)\n* [[Morgan\
      \ Freeman]] (2011)\n* [[Shirley MacLaine]] (2012)\n* [[Mel Brooks]] (2013)\n* [[Jane Fonda]] (2014)\n* [[Steve Martin]] (2015)\n}}&lt;noinclude&gt;\n[[Category:American Film Institute Awards|Film award templates]]</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:07.818Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ABAFTA+Los+Angeles+Britannia+Awards&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:07 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq56 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055749226, 3298530283, 4115605175
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"32249633\" ns=\"10\" title=\"Template:BAFTA Los Angeles Britannia Awards\"><revisions><rev user=\"Charge2charge\" timestamp=\"2014-10-31T18:58:11Z\" comment=\"\" contentformat=\"\
      text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n|titlestyle = background: #BDB76B\n|groupstyle = background: #BDB76B\n|belowstyle = background: #BDB76B\n|name = BAFTA Los Angeles Britannia Awards \n|title = [[Britannia Awards|BAFTA\
      \ Los Angeles Britannia Awards]]\n|state = {{{state|autocollapse}}}\n|listclass = hlist\n|group1 = Excellence in Film\n|list1 = \n* [[Albert R. Broccoli]] (1989)\n* [[Michael Caine]] (1990)\n* [[Peter Ustinov]] (1992)\n* [[Martin Scorsese]] (1993)\n* [[Anthony\
      \ Hopkins]] (1995)\n* [[Bob Weinstein]] and [[Harvey Weinstein]] (1996)\n* [[Dustin Hoffman]] (1997)\n* [[John Travolta]] (1998) \n* [[Stanley Kubrick]] (1999) \n* [[Steven Spielberg]] (2000) \n* [[George Lucas]] (2002) \n* [[Hugh Grant]] (2003) \n* [[Tom\
      \ Hanks]] (2004) \n* [[Tom Cruise]] (2005) \n* [[Clint Eastwood]] (2006)\n* [[Denzel Washington]] (2007) \n* [[Sean Penn]] (2008) \n* [[Robert De Niro]] (2009) \n* [[Jeff Bridges]] (2010) \n* [[Warren Beatty]] (2011)\n* [[Daniel Day-Lewis]] (2012)\n* [[George\
      \ Clooney]] (2013)\n* [[Robert Downey, Jr.]] (2014)\n\n|group2=Excellence in Directing\n|list2= \n* [[Peter Weir]] (2003) \n* [[Jim Sheridan]] (2004) \n* [[Mike Newell (director)|Mike Newell]] (2005) \n* [[Anthony Minghella]] (2006) \n* [[Martin Campbell]]\
      \ (2007) \n* [[Stephen Frears]] (2008) \n* [[Danny Boyle]] (2009) \n* [[Christopher Nolan]] (2010) \n* [[David Yates]] (2011) \n* [[Quentin Tarantino]] (2012)\n* [[Kathryn Bigelow]] (2013)\n* [[Mike Leigh]] (2014)\n\n|group3= Worldwide Contribution to&lt;br\
      \ /&gt; Entertainment\n|list3= \n* [[Howard Stringer]] (2003) \n* [[Kirk Douglas]] (2009) \n* [[Ridley Scott]] &amp; [[Tony Scott]] (2010) \n* [[John Lasseter]] (2011)\n* [[Will Wright (game designer)|Will Wright]] (2012)\n* [[Ben Kingsley|Sir Ben Kingsley]]\
      \ (2013)\n* [[Judi Dench]] (2014)\n\n|group4= British Artist of the Year\n|list4= \n* [[Rachel Weisz]] (2006) \n* [[Kate Winslet]] (2007) \n* [[Tilda Swinton]] (2008) \n* [[Emily Blunt]] (2009) \n* [[Michael Sheen]] (2010) \n* [[Helena Bonham Carter]]\
      \ (2011)\n* [[Daniel Craig]] (2012)\n* [[Benedict Cumberbatch]] (2013)\n* [[Emma Watson]] (2014)\n\n|group5=  Excellence in Comedy\n|list5=\n* [[Betty White]] (2010)\n* [[Ben Stiller]] (2011)\n* [[Trey Parker]] and [[Matt Stone]] (2012)\n* [[Sacha Baron\
      \ Cohen]] (2013)\n* [[Julia Louis-Dreyfus]] (2014)\n\n|group6= Humanitarian Award\n|list6=\n* [[Richard Curtis]] (2007)\n* [[Don Cheadle]] (2008)\n* [[Colin Firth]] (2009)\n* [[Idris Elba]] (2013)\n* [[Mark Ruffalo]] (2014)\n\n|group7= Retired Awards\n\
      |list7=\n* [[BBC]] (1999)\n* [[Aaron Spelling]] (1999)\n* [[Tarsem Singh]] (1999)\n* [[HBO| HBO Original Programming]] (2002)\n* [[Angela Lansbury]] (2003)\n* [[Helen Mirren]] (2004)\n* [[Elizabeth Taylor]] (2005)\n* [[Ronald Neame]] (2005)\n* [[Sidney\
      \ Poitier]] (2006)\n* [[Robert Shaye|Bob Shaye]] and [[Michael Lynne]] (2007)\n\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:British Academy Television Awards navigational boxes]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:08.341Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASilver+Bear+for+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:08 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq41 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055751263, 655038331, 4115606164
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42664037\" ns=\"10\" title=\"Template:Silver Bear for Best Actor\"><revisions><rev user=\"Reza amper\" timestamp=\"2014-10-26T12:03:56Z\" comment=\"\" contentformat=\"text/x-wiki\"\
      \ contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n|name = Silver Bear for Best Actor\n|title      = [[Silver Bear for Best Actor]]\n|listclass = hlist\n\n\n| list1 =\n* [[Burt Lancaster]] (1956)\n* [[Pedro Infante]] (1957)\n* [[Sidney Poitier]]\
      \ (1958)\n* [[Jean Gabin]] (1959)\n* [[Fredric March]] (1960)\n* [[Peter Finch]] (1961)\n* [[James Stewart]] (1962)\n* [[Sidney Poitier]] (1963)\n* [[Rod Steiger]] (1964)\n* [[Lee Marvin]] (1965)\n* [[Jean-Pierre Léaud]] (1966)\n* [[Michel Simon]] (1967)\n\
      * [[Jean-Louis Trintignant]] (1968)\n* [[Jean Gabin]] (1971)\n* [[Alberto Sordi]] (1972)\n* [[Vlastimil Brodský]] (1975)\n* [[Gerhard Olschewski]] (1976)\n* [[Fernando Fernán Gómez]] (1977)\n* [[Craig Russell (Canadian actor)|Craig Russell]] (1978)\n*\
      \ [[Michele Placido]] (1979)\n* [[Andrzej Seweryn]] (1980)\n* [[Anatoly Solonitsyn]] / [[Jack Lemmon]] (1981)\n* [[Stellan Skarsgård]] / [[Michel Piccoli]] (1982)\n* [[Bruce Dern]] (1983)\n* [[Albert Finney]] (1984)\n* [[Fernando Fernán Gómez]] (1985)\n\
      * [[Tuncel Kurtiz]] (1986)\n* [[Gian Maria Volonté]] (1987)\n* [[Jörg Pose]] / [[Manfred Möck]] (1988)\n* [[Gene Hackman]] (1989)\n* [[Iain Glen]] (1990)\n* [[Maynard Eziashi]] (1991)\n* [[Armin Mueller-Stahl]] (1992)\n* [[Denzel Washington]] (1993)\n\
      * [[Tom Hanks]] (1994)\n* [[Paul Newman]] (1995)\n* [[Sean Penn]] (1996)\n* [[Leonardo DiCaprio]] (1997)\n* [[Samuel L. Jackson]] (1998)\n* [[Michael Gwisdek]] (1999)\n* [[Denzel Washington]] (2000)\n* [[Benicio del Toro]] (2001)\n* [[Jacques Gamblin]]\
      \ (2002)\n* [[Sam Rockwell]] (2003)\n* [[Daniel Hendler]] (2004)\n* [[Lou Taylor Pucci]] (2005)\n* [[Moritz Bleibtreu]] (2006)\n* [[Julio Chávez]] (2007)\n* [[Reza Naji]] (2008)\n* [[Sotigui Kouyaté]] (2009)\n* Grigoriy Dobrygin / [[Sergei Puskepalis]]\
      \ (2010)\n* [[Peiman Ma'adi]] / [[Shahab Hosseini]] / Ali-Asghar Shahbazi / [[Babak Karimi]] (2011)\n* [[Mikkel Følsgaard]] (2012)\n* Nazif Mujić (2013)\n* [[Liao Fan]] (2014)\n\n| belowclass = hlist\n}}&lt;noinclude&gt;\n[[Category:Silver Bear for Best\
      \ Actor templates]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:08.613Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AEmmyAward+MiniseriesDirector+2001-2025&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:08 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq52 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055751896, 388623773, 4115606386
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="31545159" ns="10" title="Template:EmmyAward MiniseriesDirector 2001-2025"><revisions><rev user="Frietjes" timestamp="2013-09-27T15:33:34Z" comment="[[WP:AES|←]]Redirected page to [[Template:EmmyAward MiniseriesDirector]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:EmmyAward MiniseriesDirector]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:08.900Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AEmmyAward+MiniseriesDirector&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:08 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404167841, 3156606830, 4115606587
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"16586601\" ns=\"10\" title=\"Template:EmmyAward MiniseriesDirector\"><revisions><rev user=\"Jonjon889933\" timestamp=\"2014-09-21T07:56:39Z\" comment=\"\" contentformat=\"\
      text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name       = EmmyAward MiniseriesDirector\n| title      = [[Primetime Emmy Award for Outstanding Directing for a Miniseries, Movie or a Dramatic Special]]\n| bodyclass  = hlist\n\
      | basestyle  = background: {{Emmy Awards/color}};\n| belowstyle = background: transparent; border-top: 1px solid {{Emmy Awards/color}};\n| state      = {{{state|autocollapse}}}\n\n\n| list1 =\n* [[George Cukor]] (1975)\n* [[Daniel Petrie]] (1976)\n* [[Daniel\
      \ Petrie]] (1977)\n* [[David Lowell Rich]] (1978)\n* [[David Greene (director)|David Greene]] (1979)\n* [[Marvin J. Chomsky]] (1980)\n* [[James Goldstone]] (1981)\n* [[Marvin J. Chomsky]] (1982)\n* [[John Erman]] (1983)\n* [[Jeff Bleckner]] (1984)\n* [[Lamont\
      \ Johnson]] (1985)\n* [[Joseph Sargent]] (1986)\n* [[Glenn Jordan|Glenn A. Jordan]] (1987)\n* [[Lamont Johnson]] (1988)\n* [[Simon Wincer]] (1989)\n* [[Joseph Sargent]] (1990)\n* [[Brian Gibson (director)|Brian Gibson]] (1991)\n* [[Joseph Sargent]] (1992)\n\
      * [[James Steven Sadwith]] (1993)\n* [[John Frankenheimer]] (1994)\n* [[John Frankenheimer]] (1995)\n* [[John Frankenheimer]] (1996)\n* [[Andrei Konchalovsky]] (1997)\n* [[John Frankenheimer]] (1998)\n* [[Allan Arkush]] (1999)\n* [[Charles S. Dutton]]\
      \ (2000)\n* [[Mike Nichols]] (2001)\n* {{allow wrap|[[David Frankel]] &amp; [[Tom Hanks]] &amp; [[David Leland]] &amp; [[Richard Loncraine]] &amp; [[David Nutter]] &amp; [[Phil Alden Robinson]] &amp; [[Mikael Salomon]] &amp; [[Tony To]]}} (2002)\n* [[Steven\
      \ Schachter]] (2003)\n* [[Mike Nichols]] (2004)\n* [[Stephen Hopkins (director)|Stephen Hopkins]] (2005)\n* [[Tom Hooper]] (2006)\n* [[Philip Martin (director)|Philip Martin]] (2007)\n* [[Jay Roach]] (2008)\n* [[Dearbhla Walsh]] (2009)\n* [[Mick Jackson\
      \ (director)|Mick Jackson]] (2010)\n* [[Brian Percival]] for &quot;Episode One&quot; (2011)\n* [[Jay Roach]] (2012)\n* [[Steven Soderbergh]] (2013)\n* [[Colin Bucksey]] for &quot;[[Buridan's Ass (Fargo)|Buridan's Ass]]&quot; (2014)\n}}&lt;noinclude&gt;\n\
      {{collapsible option}}\n[[Category:Primetime Emmy Awards for Miniseries navigational boxes|Director]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:09.181Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AEmmy+Awards%2Fcolor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:09 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123550391, 952176119, 4115606704
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="38627822" ns="10" title="Template:Emmy Awards/color"><revisions><rev user="Frietjes" timestamp="2013-02-24T18:12:09Z" comment="[[WP:AES|←]]Created page with &#039;&lt;nowiki&gt;#&lt;/nowiki&gt;DAA520&lt;noinclude&gt; {{documentation|content= This template is used to specify the color used by Emmy award templates and infoboxes. }}&lt;/noinclude&gt;&#039;" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;nowiki&gt;#&lt;/nowiki&gt;DAA520&lt;noinclude&gt;
      {{documentation|content=
      This template is used to specify the color used by Emmy award templates and infoboxes.
      }}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:09.443Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Aallow+wrap&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:09 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq49 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404168367, 381512010, 4115606813
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:allow wrap" to="Template:Allow wrap" /></normalized><pages><page pageid="33795490" ns="10" title="Template:Allow wrap"><revisions><rev user="Edokter" timestamp="2013-01-06T12:25:33Z" comment="Use class instead of inline; makes it Mobile-compatible" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;span class=&quot;wrap&quot;&gt;{{{1}}}&lt;/span&gt;&lt;noinclude&gt;{{documentation}}&lt;!--interwikis/categories go inside doc--&gt;&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:09.707Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AEmpire+Award+for+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:09 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq45 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055753603, 952176375, 4115607059
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="33486476" ns="10" title="Template:Empire Award for Best Actor"><revisions><rev user="Gonnym" timestamp="2014-08-19T12:28:20Z" comment="" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{navbox
      |name = Empire Award for Best Actor
      |title = [[Empire Award for Best Actor]]
      |state = {{{state|autocollapse}}}
      |listclass = hlist
      |list1 =
      * [[Nigel Hawthorne]] ([[1st Empire Awards|1996]])
      * [[Morgan Freeman]] ([[2nd Empire Awards|1997]])
      * [[Kevin Spacey]] ([[3rd Empire Awards|1998]])
      * [[Tom Hanks]] ([[4th Empire Awards|1999]])
      * [[Pierce Brosnan]] ([[5th Empire Awards|2000]])
      * [[Russell Crowe]] ([[6th Empire Awards|2001]])
      * [[Elijah Wood]] ([[7th Empire Awards|2002]])
      * [[Tom Cruise]] ([[8th Empire Awards|2003]])
      * [[Johnny Depp]] ([[9th Empire Awards|2004]])
      * [[Matt Damon]] ([[10th Empire Awards|2005]])
      * [[Johnny Depp]] ([[11th Empire Awards|2006]])
      * [[Daniel Craig]] ([[12th Empire Awards|2007]])
      * [[James McAvoy]] ([[13th Empire Awards|2008]])
      * [[Christian Bale]] ([[14th Empire Awards|2009]])
      * [[Christoph Waltz]] ([[15th Empire Awards|2010]])
      * [[Colin Firth]] ([[16th Empire Awards|2011]])
      * [[Gary Oldman]] ([[17th Empire Awards|2012]])
      * [[Martin Freeman]] ([[18th Empire Awards|2013]])
      * [[James McAvoy]] ([[19th Empire Awards|2014]])
      }}&lt;noinclude&gt;
      {{collapsible option}}
      [[Category:Empire Award templates|Actor]]
      [[Category:Best Actor Empire Award winners| ]]
      [[pt:Predefinição:Empire Award para Melhor Ator]]
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:10.062Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Anavbox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:10 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq62 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123551483, 3622039629, 4115607204
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:navbox" to="Template:Navbox" /></normalized><pages><page pageid="995954" ns="10" title="Template:Navbox"><revisions><rev user="Edokter" timestamp="2014-10-18T12:29:00Z" comment="linebreaks" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Navbox|navbox}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:10.413Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AKennedy+Center+Honorees+2010s&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:10 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq54 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103595324, 217038687, 4115607549
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"33775215\" ns=\"10\" title=\"Template:Kennedy Center Honorees 2010s\"><revisions><rev user=\"Charge2charge\" timestamp=\"2014-09-07T08:07:52Z\" comment=\"added 2014\" contentformat=\"\
      text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name      = Kennedy Center Honorees 2010s\n| title     = [[Kennedy Center Honors|Kennedy Center Honorees]] (2010s)\n| state = {{{state|autocollapse}}}\n| bodyclass = hlist\n\n\
      | group1 = 2010\n| list1  = \n* [[Merle Haggard]]\n* [[Jerry Herman]]\n* [[Bill T. Jones]]\n* [[Paul McCartney]]\n* [[Oprah Winfrey]]\n\n| group2 = 2011\n| list2  = \n* [[Barbara Cook]]\n* [[Neil Diamond]]\n* [[Yo-Yo Ma]]\n* [[Sonny Rollins]]\n* [[Meryl\
      \ Streep]]\n\n| group3 = 2012\n| list3  = \n* [[Buddy Guy]]\n* [[Dustin Hoffman]]\n* [[David Letterman]]\n* [[Led Zeppelin]]\n* [[Natalia Makarova]]\n\n| group4 = 2013\n| list4  = \n* [[Martina Arroyo]]\n* [[Herbie Hancock]]\n* [[Billy Joel]]\n* [[Shirley\
      \ MacLaine]]\n* [[Carlos Santana]]\n\n| group5 = 2014\n| list5  = \n* [[Al Green]]\n* [[Tom Hanks]]\n* [[Patricia McBride]]\n* [[Sting (musician)|Sting]]\n* [[Lily Tomlin]]\n\n| below      = {{Kennedy Center Honorees footer}}\n}}&lt;noinclude&gt;\n{{collapsible\
      \ option}}\n[[Category:Kennedy Center Honors templates|2010s]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:10.768Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AKennedy+Center+Honorees+footer&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:10 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq44 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123552305, 3460543037, 4115607792
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="33795593" ns="10" title="Template:Kennedy Center Honorees footer"><revisions><rev user="Charge2charge" timestamp="2013-12-30T01:53:05Z" comment="complete list info" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;noinclude&gt;&lt;div class=&quot;hlist&quot;&gt;&lt;/noinclude&gt;
      * [[Kennedy Center Honors|Complete list]]
      * [[Template:Kennedy Center Honorees 1970s|1970s]]
      * [[Template:Kennedy Center Honorees 1980s|1980s]]
      * [[Template:Kennedy Center Honorees 1990s|1990s]]
      * [[Template:Kennedy Center Honorees 2000s|2000s]]
      * [[Template:Kennedy Center Honorees 2010s|2010s]]
      &lt;noinclude&gt;&lt;/div&gt;
      {{Footer documentation}}
      [[Category:Kennedy Center Honors templates|Footer]]
      [[Category:Awards footer templates]]

      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:11.048Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALincoln+Center+Gala+Tribute&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:11 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq43 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025953178, 2801646207, 4115608048
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"26763860\" ns=\"10\" title=\"Template:Lincoln Center Gala Tribute\"><revisions><rev user=\"Charge2charge\" timestamp=\"2014-10-12T05:15:05Z\" comment=\"added Robert Redford\"\
      \ contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n| name  = Lincoln Center Gala Tribute\n| title = [[Film Society of Lincoln Center| Film Society of Lincoln Center Gala Tribute Honorees]] \n|listclass = hlist\n\
      | titlestyle = background: #EEDD82\n| list1 = \n* [[Charlie Chaplin]] (1972)\n* [[Fred Astaire]] (1973)\n* [[Alfred Hitchcock]] (1974)\n* [[Joanne Woodward]] and [[Paul Newman]] (1975)\n* [[George Cukor]] (1978)\n* [[Bob Hope]] (1979)\n* [[John Huston]]\
      \ (1980)\n* [[Barbara Stanwyck]] (1981)\n* [[Billy Wilder]] (1982)\n* [[Laurence Olivier]] (1983)\n* [[Claudette Colbert]] (1984)\n* [[Federico Fellini]] (1985)\n* [[Elizabeth Taylor]] (1986) \n* [[Alec Guinness]] (1987)\n* [[Yves Montand]] (1988)\n* [[Bette\
      \ Davis]] (1989)\n* [[James Stewart]] (1990)\n* [[Audrey Hepburn]] (1991)\n* [[Gregory Peck]] (1992)\n* [[Jack Lemmon]] (1993)\n* [[Robert Altman]] (1994)\n* [[Shirley MacLaine]] (1995)\n* [[Clint Eastwood]] (1996)\n* [[Sean Connery]] (1997)\n* [[Martin\
      \ Scorsese]] (1998)\n* [[Mike Nichols]] (1999)\n* [[Al Pacino]] (2000)\n* [[Jane Fonda]] (2001)\n* [[Francis Ford Coppola]] (2002)\n* [[Susan Sarandon]] (2003)\n* [[Michael Caine]] (2004)\n* [[Dustin Hoffman]] (2005) \n* [[Jessica Lange]] (2006)\n* [[Diane\
      \ Keaton]] (2007)\n* [[Meryl Streep]] (2008)\n* [[Tom Hanks]] (2009)\n* [[Michael Douglas]] (2010) \n* [[Sidney Poitier]] (2011) \n* [[Catherine Deneuve]] (2012)\n* [[Barbra Streisand]] (2013)\n* [[Rob Reiner]] (2014)\n* [[Robert Redford]] (2015)\n}}&lt;noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:11.414Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AGoldenGlobeBestActorMotionPictureDrama+1981-2000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:11 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq50 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404170884, 3589328862, 4115608288
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="31195191" ns="10" title="Template:GoldenGlobeBestActorMotionPictureDrama 1981-2000"><revisions><rev user="Robsinden" timestamp="2013-11-22T12:54:26Z" comment="[[WP:AES|←]]Redirected page to [[Template:Golden Globe Award Best Actor Motion Picture Drama]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Golden Globe Award Best Actor Motion Picture Drama]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:11.688Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AGolden+Globe+Award+Best+Actor+Motion+Picture+Drama&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:11 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530369315, 2402531762, 4115608460
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"22897889\" ns=\"10\" title=\"Template:Golden Globe Award Best Actor Motion Picture Drama\"><revisions><rev user=\"CAWylie\" timestamp=\"2014-06-27T15:23:32Z\" comment=\"Separated\
      \ into 20-year sections.\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name       = Golden Globe Award Best Actor Motion Picture Drama\n| title      = [[Golden Globe Award for Best Actor – Motion Picture\
      \ Drama]]\n| basestyle  = background: #CFB53B\n| groupstyle = background: #F0DC82\n| state      = {{{state|autocollapse}}}\n| bodyclass  = hlist\n\n| group1 = 1943–1960\n| list1 = \n* [[Paul Lukas]] (1943)\n* [[Alexander Knox]] (1944)\n* [[Ray Milland]]\
      \ (1945)\n* [[Gregory Peck]] (1946)\n* [[Ronald Colman]] (1947)\n* [[Laurence Olivier]] (1948)\n* [[Broderick Crawford]] (1949)\n* [[José Ferrer]] (1950)\n* [[Fredric March]] (1951)\n* [[Gary Cooper]] (1952)\n* [[Spencer Tracy]] (1953)\n* [[Marlon Brando]]\
      \ (1954)\n* [[Ernest Borgnine]] (1955)\n* [[Kirk Douglas]] (1956)\n* [[Alec Guinness]] (1957)\n* [[David Niven]] (1958)\n* [[Anthony Franciosa]] (1959)\n* [[Burt Lancaster]] (1960)\n\n| group2 = 1961–1980\n| list2 =\n* [[Maximilian Schell]] (1961)\n* [[Gregory\
      \ Peck]] (1962)\n* [[Sidney Poitier]] (1963)\n* [[Peter O'Toole]] (1964)\n* [[Omar Sharif]] (1965)\n* [[Paul Scofield]] (1966)\n* [[Rod Steiger]] (1967)\n* [[Peter O'Toole]] (1968)\n* [[John Wayne]] (1969)\n* [[George C. Scott]] (1970)\n* [[Gene Hackman]]\
      \ (1971)\n* [[Marlon Brando]] (1972)\n* [[Al Pacino]] (1973)\n* [[Jack Nicholson]] (1974)\n* [[Jack Nicholson]] (1975)\n* [[Peter Finch]] (1976)\n* [[Richard Burton]] (1977)\n* [[Jon Voight]] (1978)\n* [[Dustin Hoffman]] (1979)\n* [[Robert De Niro]] (1980)\n\
      \n| group3 = 1981–2000\n| list3 =\n* [[Henry Fonda]] (1981)\n* [[Ben Kingsley]] (1982)\n* [[Robert Duvall]] / [[Tom Courtenay]] (1983)\n* [[F. Murray Abraham]] (1984)\n* [[Jon Voight]] (1985)\n* [[Bob Hoskins]] (1986)\n* [[Michael Douglas]] (1987)\n* [[Dustin\
      \ Hoffman]] (1988)\n* [[Tom Cruise]] (1989)\n* [[Jeremy Irons]] (1990)\n* [[Nick Nolte]] (1991)\n* [[Al Pacino]] (1992)\n* [[Tom Hanks]] (1993)\n* [[Tom Hanks]] (1994)\n* [[Nicolas Cage]] (1995)\n* [[Geoffrey Rush]] (1996)\n* [[Peter Fonda]] (1997)\n*\
      \ [[Jim Carrey]] (1998)\n* [[Denzel Washington]] (1999)\n* [[Tom Hanks]] (2000)\n\n| group4 = 2001–present\n| list4 =\n* [[Russell Crowe]] (2001)\n* [[Jack Nicholson]] (2002)\n* [[Sean Penn]] (2003)\n* [[Leonardo DiCaprio]] (2004)\n* [[Philip Seymour Hoffman]]\
      \ (2005)\n* [[Forest Whitaker]] (2006)\n* [[Daniel Day-Lewis]] (2007)\n* [[Mickey Rourke]] (2008)\n* [[Jeff Bridges]] (2009)\n* [[Colin Firth]] (2010)\n* [[George Clooney]] (2011)\n* [[Daniel Day-Lewis]] (2012)\n* [[Matthew McConaughey]] (2013)\n}}&lt;noinclude&gt;\n\
      {{collapsible option}}\n[[Category:Golden Globe Award for Best Actor Motion Picture templates|Drama]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:12.336Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AGoldenGlobeBestActorMotionPictureMusicalComedy+1981%E2%80%932000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:12 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq59 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103597688, 3268227860, 4115608597
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="22910680" ns="10" title="Template:GoldenGlobeBestActorMotionPictureMusicalComedy 1981–2000"><revisions><rev user="Regge robban2" timestamp="2014-01-23T14:34:47Z" comment="[[WP:AES|←]]Redirected page to [[Template:Golden Globe Award Best Actor Motion Picture Musical or Comedy]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Golden Globe Award Best Actor Motion Picture Musical or Comedy]]</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:13.113Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AGolden+Globe+Award+Best+Actor+Motion+Picture+Musical+or+Comedy&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:12 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq48 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404172489, 296415319, 4115609204
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"22910522\" ns=\"10\" title=\"Template:Golden Globe Award Best Actor Motion Picture Musical or Comedy\"><revisions><rev user=\"212.135.65.247\" anon=\"\" timestamp=\"2014-08-13T08:28:20Z\"\
      \ comment=\"\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name       = Golden Globe Award Best Actor Motion Picture Musical or Comedy\n| title      = [[Golden Globe Award for Best Actor – Motion Picture\
      \ Musical or Comedy]]\n| basestyle  = background: #CFB53B\n| groupstyle = background: #F0DC82\n| state      = {{{state|autocollapse}}}\n| bodyclass  = hlist\n\n| group1 = 1950–1975\n| list1  = \n* [[Fred Astaire]] (1950)\n* [[Danny Kaye]] (1951)\n* [[Donald\
      \ O'Connor]] (1952)\n* [[David Niven]] (1953)\n* [[James Mason]] (1954)\n* [[Tom Ewell]] (1955)\n* [[Cantinflas|Mario Moreno]] (1956)\n* [[Frank Sinatra]] (1957)\n* [[Danny Kaye]] (1958)\n* [[Jack Lemmon]] (1959)\n* [[Jack Lemmon]] (1960)\n* [[Glenn Ford]]\
      \ (1961)\n* [[Marcello Mastroianni]] (1962)\n* [[Alberto Sordi]] (1963)\n* [[Rex Harrison]] (1964)\n* [[Lee Marvin]] (1965)\n* [[Alan Arkin]] (1966)\n* [[Richard Harris]] (1967)\n* [[Ron Moody]] (1968)\n* [[Peter O'Toole]] (1969)\n* [[Albert Finney]] (1970)\n\
      * [[Chaim Topol]] (1971)\n* [[Jack Lemmon]] (1972)\n* [[George Segal]] (1973)\n* [[Art Carney]] (1974)\n* [[Walter Matthau]] / [[George Burns]] (1975)\n| group2 = 1976–2000\n| list2  = \n* [[Kris Kristofferson]] (1976)\n* [[Richard Dreyfuss]] (1977)\n\
      * [[Warren Beatty]] (1978)\n* [[Peter Sellers]] (1979)\n* [[Ray Sharkey]] (1980)\n* [[Dudley Moore]] (1981)\n* [[Dustin Hoffman]] (1982)\n* [[Michael Caine]] (1983)\n* [[Dudley Moore]] (1984)\n* [[Jack Nicholson]] (1985)\n* [[Paul Hogan]] (1986)\n* [[Robin\
      \ Williams]] (1987)\n* [[Tom Hanks]] (1988)\n* [[Morgan Freeman]] (1989)\n* [[Gérard Depardieu]] (1990)\n* [[Robin Williams]] (1991)\n* [[Tim Robbins]] (1992)\n* [[Robin Williams]] (1993)\n* [[Hugh Grant]] (1994)\n* [[John Travolta]] (1995)\n* [[Tom Cruise]]\
      \ (1996)\n* [[Jack Nicholson]] (1997)\n* [[Michael Caine]] (1998)\n* [[Jim Carrey]] (1999)\n* [[George Clooney]] (2000)\n\n| group3 = 2001–present\n| list3  = \n* [[Gene Hackman]] (2001)\n* [[Richard Gere]] (2002)\n* [[Bill Murray]] (2003)\n* [[Jamie Foxx]]\
      \ (2004)\n* [[Joaquin Phoenix]] (2005)\n* [[Sacha Baron Cohen]] (2006)\n* [[Johnny Depp]] (2007)\n* [[Colin Farrell]] (2008)\n* [[Robert Downey, Jr.]] (2009)\n* [[Paul Giamatti]] (2010)\n* [[Jean Dujardin]] (2011)\n* [[Hugh Jackman]] (2012)\n* [[Leonardo\
      \ DiCaprio]] (2013)\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:Golden Globe Award for Best Actor Motion Picture templates|Musical or Comedy]]\n\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:13.563Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AMTV+Movie+Award+for+Best+Performance&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:13 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq43 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103600266, 2801647467, 4115609832
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"25310704\" ns=\"10\" title=\"Template:MTV Movie Award for Best Performance\"><revisions><rev user=\"201.8.165.99\" anon=\"\" timestamp=\"2014-04-14T03:42:26Z\" comment=\"\"\
      \ contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n| name       = MTV Movie Award for Best Performance\n| title      = [[MTV Movie Award for Best Performance]]\n| state = {{{state|autocollapse}}}\n| listclass  =\
      \ hlist\n\n| group1     = [[1990s in film|1990s]]\n| list1      = \n* [[Arnold Schwarzenegger]] / [[Linda Hamilton]] (1992)\n* [[Denzel Washington]] / [[Sharon Stone]] (1993)\n* [[Tom Hanks]] / [[Janet Jackson]] (1994)\n* [[Brad Pitt]] / [[Sandra Bullock]]\
      \ (1995)\n* [[Jim Carrey]] / [[Alicia Silverstone]] (1996)\n* [[Tom Cruise]] / [[Claire Danes]] (1997)\n* [[Leonardo DiCaprio]] / [[Neve Campbell]] (1998)\n* [[Jim Carrey]] / [[Cameron Diaz]] (1999)\n\n| group2 = [[2000s in film|2000s]]\n| list2  = \n\
      * [[Keanu Reeves]] / [[Sarah Michelle Gellar]] (2000)\n* [[Tom Cruise]] / [[Julia Roberts]] (2001)\n* [[Will Smith]] / [[Nicole Kidman]] (2002)\n* [[Eminem]] / [[Kirsten Dunst]] (2003)\n* [[Johnny Depp]] / [[Uma Thurman]] (2004)\n* [[Leonardo DiCaprio]]\
      \ / [[Lindsay Lohan]] (2005)\n* [[Jake Gyllenhaal]] (2006)\n* [[Johnny Depp]] (2007)\n* [[Will Smith]] / [[Ellen Page]] (2008)\n* [[Zac Efron]] / [[Kristen Stewart]] (2009)\n\n| group3 = [[2010s in film|2010s]]\n| list3  = \n* [[Robert Pattinson]] / [[Kristen\
      \ Stewart]] (2010)\n* [[Robert Pattinson]] / [[Kristen Stewart]] (2011)\n* [[Josh Hutcherson]] / [[Jennifer Lawrence]] (2012)\n* [[Bradley Cooper]] / [[Jennifer Lawrence]] (2013)\n* [[Josh Hutcherson]] / [[Jennifer Lawrence]] (2014)\n}}&lt;noinclude&gt;\n\
      {{collapsible option}}\n[[Category:MTV Movie Award templates]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:14.035Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ANational+Board+of+Review+Award+for+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq62 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123556674, 3622042161, 4115610402
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"34229291\" ns=\"10\" title=\"Template:National Board of Review Award for Best Actor\"><revisions><rev user=\"Vanthorn\" timestamp=\"2014-03-27T00:44:08Z\" comment=\"rv\" contentformat=\"\
      text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name       = National Board of Review Award for Best Actor\n| title      = [[National Board of Review Award for Best Actor]]\n| state = {{{state|autocollapse}}}\n| listclass =\
      \ hlist\n\n|list1=\n* [[Ray Milland]] (1945)\n* [[Laurence Olivier]] (1946)\n* [[Michael Redgrave]] (1947)\n* [[Walter Huston]] (1948)\n* [[Ralph Richardson]] (1949)\n* [[Alec Guinness]] (1950)\n* [[Richard Basehart]] (1951)\n* [[Ralph Richardson]] (1952)\n\
      * [[James Mason]] (1953)\n* [[Bing Crosby]] (1954)\n* [[Ernest Borgnine]] (1955)\n* [[Yul Brynner]] (1956)\n* [[Alec Guinness]] (1957)\n* [[Spencer Tracy]] (1958)\n* [[Victor Sjöström]] (1959)\n* [[Robert Mitchum]] (1960)\n* [[Albert Finney]] (1961)\n\
      * [[Jason Robards]] (1962)\n* [[Rex Harrison]] (1963)\n* [[Anthony Quinn]] (1964)\n* [[Lee Marvin]] (1965)\n* [[Paul Scofield]] (1966)\n* [[Peter Finch]] (1967)\n* [[Cliff Robertson]] (1968)\n* [[Peter O'Toole]] (1969)\n* [[George C. Scott]] (1970)\n*\
      \ [[Gene Hackman]] (1971)\n* [[Peter O'Toole]] (1972)\n* [[Al Pacino]] / [[Robert Ryan]] (1973)\n* [[Gene Hackman]] (1974)\n* [[Jack Nicholson]] (1975)\n* [[David Carradine]] (1976)\n* [[John Travolta]] (1977)\n* [[Jon Voight]] / [[Laurence Olivier]] (1978)\n\
      * [[Peter Sellers]] (1979)\n* [[Robert De Niro]] (1980)\n* [[Henry Fonda]] (1981)\n* [[Ben Kingsley]] (1982)\n* [[Tom Conti]] (1983)\n* [[Victor Banerjee]] (1984)\n* [[William Hurt]] / [[Raúl Juliá]] (1985)\n* [[Paul Newman]] (1986)\n* [[Michael Douglas]]\
      \ (1987)\n* [[Gene Hackman]] (1988)\n* [[Morgan Freeman]] (1989)\n* [[Robert De Niro]] / [[Robin Williams]] (1990)\n* [[Warren Beatty]] (1991)\n* [[Jack Lemmon]] (1992)\n* [[Anthony Hopkins]] (1993)\n* [[Tom Hanks]] (1994)\n* [[Nicolas Cage]] (1995)\n\
      * [[Tom Cruise]] (1996)\n* [[Jack Nicholson]] (1997)\n* [[Ian McKellen]] (1998)\n* [[Russell Crowe]] (1999)\n* [[Javier Bardem]] (2000)\n* [[Billy Bob Thornton]] (2001)\n* [[Campbell Scott]] (2002)\n* [[Sean Penn]] (2003)\n* [[Jamie Foxx]] (2004)\n* [[Philip\
      \ Seymour Hoffman]] (2005)\n* [[Forest Whitaker]] (2006)\n* [[George Clooney]] (2007)\n* [[Clint Eastwood]] (2008)\n* [[George Clooney]] / [[Morgan Freeman]] (2009)\n* [[Jesse Eisenberg]] (2010)\n* [[George Clooney]] (2011)\n* [[Bradley Cooper]] (2012)\n\
      * [[Bruce Dern]] (2013)\n\n}}&lt;noinclude&gt;\n{{collapsible option}}\n\n[[Category:National Board of Review Awards|*|National Board of Review Award for Best Actor]]\n[[Category:National Board of Review Awards|*]]\n[[Category:Film award templates|{{PAGENAME}}]]\n\
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:14.562Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ANew+York+Film+Critics+Circle+Award+for+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:14 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404174989, 2402533460, 4115610714
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"42511167\" ns=\"10\" title=\"Template:New York Film Critics Circle Award for Best Actor\"><revisions><rev user=\"WOSlinker\" timestamp=\"2014-06-21T16:00:23Z\" comment=\"\
      remove article categories\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name      = New York Film Critics Circle Award for Best Actor\n| bodyclass = hlist\n| state = {{{state|autocollapse}}}\n| title    \
      \ = &lt;font color=#FFFFFF&gt;[[New York Film Critics Circle Award for Best Actor]]&lt;/font&gt;\n|titlestyle = background:#000347; color:#FFFFFF; border: 2px solid #808080\n|groupstyle = background:#000347; color:#FFFFFF; border: 2px solid #808080\n\n\
      \n|group1 = 1935–1940\n|group1style = color: white;\n|list1 =\n* [[Charles Laughton]] (1935)\n* [[Walter Huston]] (1936)\n* [[Paul Muni]] (1937)\n* [[James Cagney]] (1938)\n* [[James Stewart]] (1939)\n* [[Charlie Chaplin]] (1940)\n\n|group2 = 1941–1960\n\
      |group2style = color: white;\n|list2 =\n* [[Gary Cooper]] (1941)\n* [[James Cagney]] (1942)\n* [[Paul Lukas]] (1943)\n* [[Barry Fitzgerald]] (1944)\n* [[Ray Milland]] (1945)\n* [[Laurence Olivier]] (1946)\n* [[William Powell]] (1947)\n* [[Laurence Olivier]]\
      \ (1948)\n* [[Broderick Crawford]] (1949)\n* [[Gregory Peck]] (1950)\n* [[Arthur Kennedy (actor)|Arthur Kennedy]] (1951)\n* [[Ralph Richardson]] (1952)\n* [[Burt Lancaster]] (1953)\n* [[Marlon Brando]] (1954)\n* [[Ernest Borgnine]] (1955)\n* [[Kirk Douglas]]\
      \ (1956)\n* [[Alec Guinness]] (1957)\n* [[David Niven]] (1958)\n* [[James Stewart]] (1959)\n* [[Burt Lancaster]] (1960)\n\n|group3 = 1961–1980\n|group3style = color: white;\n|list3 =\n* [[Maximilian Schell]] (1961)\n* No Award (1962)\n* [[Albert Finney]]\
      \ (1963)\n* [[Rex Harrison]] (1964)\n* [[Oskar Werner]] (1965)\n* [[Paul Scofield]] (1966)\n* [[Rod Steiger]] (1967)\n* [[Alan Arkin]] (1968)\n* [[Jon Voight]] (1969)\n* [[George C. Scott]] (1970)\n* [[Gene Hackman]] (1971)\n* [[Laurence Olivier]] (1972)\n\
      * [[Marlon Brando]] (1973)\n* [[Jack Nicholson]] (1974)\n* [[Jack Nicholson]] (1975)\n* [[Robert De Niro]] (1976)\n* [[John Gielgud]] (1977)\n* [[Jon Voight]] (1978)\n* [[Dustin Hoffman]] (1979)\n* [[Robert De Niro]] (1980)\n\n|group4 = 1981–2000\n|group4style\
      \ = color: white;\n|list4 =\n* [[Burt Lancaster]] (1981)\n* [[Ben Kingsley]] (1982)\n* [[Robert Duvall]] (1983)\n* [[Steve Martin]] (1984)\n* [[Jack Nicholson]] (1985)\n* [[Bob Hoskins]] (1986)\n* [[Jack Nicholson]] (1987)\n* [[Jeremy Irons]] (1988)\n\
      * [[Daniel Day-Lewis]] (1989)\n* [[Robert De Niro]] (1990)\n* [[Anthony Hopkins]] (1991)\n* [[Denzel Washington]] (1992)\n* [[David Thewlis]] (1993)\n* [[Paul Newman]] (1994)\n* [[Nicolas Cage]] (1995)\n* [[Geoffrey Rush]] (1996)\n* [[Peter Fonda]] (1997)\n\
      * [[Nick Nolte]] (1998)\n* [[Richard Farnsworth]] (1999)\n* [[Tom Hanks]] (2000)\n\n|group5 = 2001–present\n|group5style = color: white\n|list5 = \n* [[Tom Wilkinson]] (2001)\n* [[Daniel Day-Lewis]] (2002)\n* [[Bill Murray]] (2003)\n* [[Paul Giamatti]]\
      \ (2004)\n* [[Heath Ledger]] (2005)\n* [[Forest Whitaker]] (2006)\n* [[Daniel Day-Lewis]] (2007)\n* [[Sean Penn]] (2008)\n* [[George Clooney]] (2009)\n* [[Colin Firth]] (2010)\n* [[Brad Pitt]] (2011)\n* [[Daniel Day-Lewis]] (2012)\n* [[Robert Redford]]\
      \ (2013)\n\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category: Film award templates]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:15.103Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASaturn+Award+for+Best+Actor&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:15 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1055 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2055762600, 1470662069, 4115610977
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"33854124\" ns=\"10\" title=\"Template:Saturn Award for Best Actor\"><revisions><rev user=\"Hyliad\" timestamp=\"2014-08-12T11:12:46Z\" comment=\"\" contentformat=\"text/x-wiki\"\
      \ contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n| name  = Saturn Award for Best Actor\n| title = [[Saturn Award for Best Actor]]\n| state = {{{state|autocollapse}}}\n| bodyclass = hlist\n\n| group1 = 1974–2000\n| list1 = \n* [[James Caan]]/[[Don\
      \ Johnson]] (1974/75)\n* [[David Bowie]]/[[Gregory Peck]] (1976)\n* [[George Burns]] (1977)\n* [[Warren Beatty]] (1978)\n* [[George Hamilton (actor)|George Hamilton]] (1979)\n* [[Mark Hamill]] (1980)\n* [[Harrison Ford]] (1981)\n* [[William Shatner]] (1982)\n\
      * [[Mark Hamill]] (1983)\n* [[Jeff Bridges]] (1984)\n* [[Michael J. Fox]] (1985)\n* [[Jeff Goldblum]] (1986)\n* [[Jack Nicholson]] (1987)\n* [[Tom Hanks]] (1988)\n* [[Jeff Daniels]] (1989/90)\n* [[Anthony Hopkins]] (1991)\n* [[Gary Oldman]] (1992)\n* [[Robert\
      \ Downey, Jr.]] (1993)\n* [[Martin Landau]] ([[21st Saturn Awards|1994]])\n* [[George Clooney]] (1995)\n* [[Eddie Murphy]] (1996)\n* [[Pierce Brosnan]] (1997)\n* [[James Woods]] (1998)\n* [[Tim Allen]] (1999)\n* [[Hugh Jackman]] (2000)\n\n| group2 = 2001–\
      present\n| list2 =\n* [[Tom Cruise]] (2001)\n* [[Robin Williams]] (2002)\n* [[Elijah Wood]] (2003)\n* [[Tobey Maguire]] (2004)\n* [[Christian Bale]] (2005)\n* [[Brandon Routh]] (2006)\n* [[Will Smith]] (2007)\n* [[Robert Downey, Jr.]] (2008)\n* [[Sam Worthington]]\
      \ (2009)\n* [[Jeff Bridges]] (2010)\n* [[Michael Shannon]] (2011)\n* [[Matthew McConaughey]] (2012)\n* [[Robert Downey, Jr.]] (2013)\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:Saturn Award for Best Actor templates]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:15.718Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AScreenActorsGuildAward+CastMotionPicture+1995%E2%80%932000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:15 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1065 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1227091290, 290996438, 4115611722
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"25498475\" ns=\"10\" title=\"Template:ScreenActorsGuildAward CastMotionPicture 1995–2000\"><revisions><rev user=\"Lugnuts\" timestamp=\"2014-05-26T17:52:29Z\" comment=\"\"\
      \ contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox\n| name      = ScreenActorsGuildAward CastMotionPicture 1995–2000\n| title     = {{#if:{{{list only|}}}||[[Screen Actors Guild Award for Outstanding Performance by\
      \ a Cast in a Motion Picture]] (1995–2000)}}\n| border    = {{#if:{{{list only|}}}|child}}\n| state     = {{{state&lt;includeonly&gt;|autocollapse&lt;/includeonly&gt;}}}\n| bodyclass = hlist\n| basestyle = background: #ABCDEF\n\n| list1 = \n* ''[[Apollo\
      \ 13 (film)|Apollo 13]]'' (1995) : {{allow wrap|[[Kevin Bacon]], [[Tom Hanks]], [[Ed Harris]], [[Bill Paxton]], [[Kathleen Quinlan]], [[Gary Sinise]]}}\n\n* ''[[The Birdcage]]'' (1996) : {{allow wrap|[[Hank Azaria]], [[Christine Baranski]], [[Dan Futterman]],\
      \ [[Gene Hackman]], [[Nathan Lane]], [[Dianne Wiest]], [[Robin Williams]]}}\n\n* ''[[The Full Monty]]'' (1997) : {{allow wrap|[[Mark Addy]], [[Paul Barber (actor)|Paul Barber]], [[Robert Carlyle]], [[Deirdre Costello]], [[Steve Huison]], [[Bruce Jones\
      \ (actor)|Bruce Jones]], [[Lesley Sharp]], [[William Snape]], [[Hugo Speer]], [[Tom Wilkinson]], [[Emily Woof]]}}\n\n* ''[[Shakespeare in Love]]'' (1998) : {{allow wrap|[[Ben Affleck]], [[Simon Callow]], [[Jim Carter (actor)|Jim Carter]], [[Martin Clunes]],\
      \ [[Judi Dench]], [[Joseph Fiennes]], [[Colin Firth]], [[Gwyneth Paltrow]], [[Geoffrey Rush]], [[Antony Sher]], [[Imelda Staunton]]}}\n\n* ''[[American Beauty (1999 film)|American Beauty]]'' (1999) : {{allow wrap|[[Annette Bening]], [[Wes Bentley]], [[Thora\
      \ Birch]], [[Chris Cooper]], [[Peter Gallagher]], [[Allison Janney]], [[Kevin Spacey]], [[Mena Suvari]]}}\n\n* ''[[Traffic (2000 film)|Traffic]]'' (2000) : {{allow wrap|[[Steven Bauer]], [[Benjamin Bratt]], [[James Brolin]], [[Don Cheadle]], [[Erika Christensen]],\
      \ [[Clifton Collins, Jr.]], [[Benicio del Toro]], [[Michael Douglas]], [[Miguel Ferrer]], [[Albert Finney]], [[Topher Grace]], [[Luis Guzmán]], [[Amy Irving]], [[Tomas Milian]], [[D. W. Moffett]], [[Dennis Quaid]], [[Peter Riegert]], [[Jacob Vargas]],\
      \ [[Catherine Zeta-Jones]]}}\n\n| below = {{#if:{{{list only|}}}||{{ScreenActorsGuildAward CastMotionPicture footer}}}}\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:Screen Actors Guild Award Outstanding Cast templates|Motion Picture 1995-2000]]\n\
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:16.436Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AScreenActorsGuildAward+CastMotionPicture+footer&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:16 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq61 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103605336, 3811695464, 4115612507
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="31105431" ns="10" title="Template:ScreenActorsGuildAward CastMotionPicture footer"><revisions><rev user="Frietjes" timestamp="2012-02-09T22:08:00Z" comment="template a repeated documentation pattern" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;noinclude&gt;&lt;div class=&quot;hlist&quot;&gt;&lt;/noinclude&gt;
      * [[:Template:ScreenActorsGuildAward CastMotionPicture|Complete list]]
      * [[:Template:ScreenActorsGuildAward CastMotionPicture 1995–2000|(1995–2000)]]
      * [[:Template:ScreenActorsGuildAward CastMotionPicture 2001–2010|(2001–2010)]]
      * [[:Template:ScreenActorsGuildAward CastMotionPicture 2011–2020|(2011–2020)]]
      &lt;noinclude&gt;&lt;/div&gt;
      {{Footer documentation}}
      [[Category:Screen Actors Guild Award footer templates]]
      [[Category:Screen Actors Guild Award Outstanding Cast templates|Motion Picture footer]]

      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:19.564Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AScreenActorsGuildAward+MaleLeadMotionPicture+1994-2000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:19 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq32 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530380929, 469380054, 4115614918
    body: '<?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="27484385" ns="10" title="Template:ScreenActorsGuildAward MaleLeadMotionPicture 1994-2000"><revisions><rev user="Xeworlebi" timestamp="2010-05-26T11:30:42Z" comment="moved [[Template:ScreenActorsGuildAward
      MaleLeadMotionPicture 1994-2000]] to [[Template:ScreenActorsGuildAward MaleLeadMotionPicture 1994–2000]]: ndash per MOS" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:ScreenActorsGuildAward MaleLeadMotionPicture
      1994–2000]]</rev></revisions></page></pages></query></api>'
- recorded: 2014-11-04T23:12:19.842Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AScreenActorsGuildAward+MaleLeadMotionPicture+1994%E2%80%932000&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:19 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq37 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530381612, 1470665422, 4115615246
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"18263802\" ns=\"10\" title=\"Template:ScreenActorsGuildAward MaleLeadMotionPicture 1994–2000\"><revisions><rev user=\"Addbot\" timestamp=\"2013-07-30T21:23:52Z\" comment=\"\
      [[User:addbot|Bot]]: Migrating interwiki links, now provided by [[Wikipedia:Wikidata|Wikidata]] on [[d:q14337735]]\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Navbox \n| name      = ScreenActorsGuildAward MaleLeadMotionPicture\
      \ 1994–2000\n| title     = {{#if:{{{list only|}}}||[[Screen Actors Guild Award for Outstanding Performance by a Male Actor in a Leading Role|Screen Actors Guild Award – Outstanding Performance by a Male Actor in a Leading Role]] (1994–2000)}}\n| basestyle\
      \ = background: #ABCDEF\n| state     = {{{state|autocollapse}}}\n| border    = {{#if:{{{list only|}}}|child}}\n| bodyclass = hlist\n\n| list1 = \n* [[Tom Hanks]] (1994)\n* [[Nicolas Cage]] (1995)\n* [[Geoffrey Rush]] (1996)\n* [[Jack Nicholson]] (1997)\n\
      * [[Roberto Benigni]] (1998)\n* [[Kevin Spacey]] (1999)\n* [[Benicio del Toro]] (2000)\n\n| below = {{#if:{{{list only|}}}||{{ScreenActorsGuildAward MaleLeadMotionPicture footer}}}}\n}}&lt;noinclude&gt;\n{{collapsible option}}\n[[Category:Screen Actors\
      \ Guild Award Outstanding Actor templates|Lead Motion Picture 1994–2000]]\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:22.780Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AScreenActorsGuildAward+MaleLeadMotionPicture+footer&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:22 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq55 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123568055, 291000107, 4115616808
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="31105980" ns="10" title="Template:ScreenActorsGuildAward MaleLeadMotionPicture footer"><revisions><rev user="Frietjes" timestamp="2012-02-09T22:09:01Z" comment="template a repeated documentation pattern" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;noinclude&gt;&lt;div class=&quot;hlist&quot;&gt;&lt;/noinclude&gt;
      * [[:Template:ScreenActorsGuildAward MaleLeadMotionPicture|Complete list]]
      * [[:Template:ScreenActorsGuildAward MaleLeadMotionPicture 1994–2000|(1994–2000)]]
      * [[:Template:ScreenActorsGuildAward MaleLeadMotionPicture 2001–2020|(2001–2020)]]
      &lt;noinclude&gt;&lt;/div&gt;
      {{Footer documentation}}
      [[Category:Screen Actors Guild Award footer templates]]
      [[Category:Screen Actors Guild Award Outstanding Actor templates|Lead Motion Picture footer]]

      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:23.055Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ANavboxes&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:23 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq42 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349057445, 2402538239, 4115617169
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="17110335" ns="10" title="Template:Navboxes"><revisions><rev user="Frietjes" timestamp="2014-09-15T22:19:41Z" comment="invoke directly, should cut down on expand size" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:navbox|navbox
      |navbar = {{#ifeq:{{{state|}}}|off |off |plain}}
      |title = {{{title|Links to related articles}}}
      |list1 = {{{list1|{{{list|}}}}}}
      |state = {{{state|collapsed}}}
      |titlestyle = background:{{{bg|#e8e8ff}}};{{#if:{{{fg|}}}|color:{{{fg}}};}}{{#if:{{{bordercolor|}}}|border: 1px solid {{{bordercolor}}};}}{{{titlestyle|}}}
      |liststyle = padding:0px;font-size:113%;
      |listpadding = 0px;
      |tracking = no
      }}{{#if:{{{list1|{{{list|}}}}}}||[[Category:Navboxes template with no content]]}}&lt;noinclude&gt;

      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2014-11-04T23:12:23.793Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Anavbox&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:23 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=hhvm
      X-Cache: cp1054 miss (0), amssq48 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.3.1
      X-Varnish: 1404186811, 296421622, 4115617477
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:navbox\" to=\"Module:Navbox\" /></normalized><pages><page pageid=\"38634746\" ns=\"828\" title=\"Module:Navbox\"><revisions><rev user=\"WOSlinker\" timestamp=\"2014-06-15T16:56:01Z\"\
      \ comment=\"change hasBackgroundColors to check titlestyle/groupstyle/basestyle contains the word background\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--\n-- This module will implement {{Navbox}}\n--\n \nlocal p =\
      \ {}\n \nlocal HtmlBuilder = require('Module:HtmlBuilder')\nlocal navbar = require('Module:Navbar')._navbar\nlocal getArgs -- lazily initialized\n\nlocal args\nlocal tableRowAdded = false\nlocal border\nlocal listnums = {}\n \nlocal function trim(s)\n\
      \    return (mw.ustring.gsub(s, &quot;^%s*(.-)%s*$&quot;, &quot;%1&quot;))\nend\n\nlocal function addNewline(s)\n    if s:match('^[*:;#]') or s:match('^{|') then\n        return '\\n' .. s ..'\\n'\n    else\n        return s\n    end\nend\n\nlocal function\
      \ addTableRow(tbl)\n    -- If any other rows have already been added, then we add a 2px gutter row.\n    if tableRowAdded then\n        tbl\n            .tag('tr')\n                .css('height', '2px')\n                .tag('td')\n                \t.attr('colspan',2)\n\
      \    end\n    \n    tableRowAdded = true\n    \n    return tbl.tag('tr')\nend\n\nlocal function renderNavBar(titleCell)\n    -- Depending on the presence of the navbar and/or show/hide link, we may need to add a spacer div on the left\n    -- or right\
      \ to keep the title centered.\n    local spacerSide = nil\n\n    if args.navbar == 'off' then\n        -- No navbar, and client wants no spacer, i.e. wants the title to be shifted to the left. If there's\n        -- also no show/hide link, then we need\
      \ a spacer on the right to achieve the left shift.\n        if args.state == 'plain' then spacerSide = 'right' end\n    elseif args.navbar == 'plain' or (not args.name and mw.getCurrentFrame():getParent():getTitle() == 'Template:Navbox' and (border ==\
      \ 'subgroup' or border == 'child' or border == 'none')) then\n        -- No navbar. Need a spacer on the left to balance out the width of the show/hide link.\n        if args.state ~= 'plain' then spacerSide = 'left' end\n    else\n        -- Will render\
      \ navbar (or error message). If there's no show/hide link, need a spacer on the right\n        -- to balance out the width of the navbar.\n        if args.state == 'plain' then spacerSide = 'right' end\n\n        titleCell.wikitext(navbar{ \n         \
      \   args.name, \n            mini = 1, \n            fontstyle = (args.basestyle or '') .. ';' .. (args.titlestyle or '') ..  ';background:none transparent;border:none;'\n        })\n    end\n    \n    -- Render the spacer div.\n    if spacerSide then\n\
      \        titleCell\n            .tag('span')\n                .css('float', spacerSide)\n                .css('width', '6em')\n                .wikitext('&amp;nbsp;')\n    end\nend\n\n--\n--   Title row\n--\nlocal function renderTitleRow(tbl)\n    if not\
      \ args.title then return end\n \n    local titleRow = addTableRow(tbl)\n     \n    if args.titlegroup then\n        titleRow\n            .tag('th')\n                .attr('scope', 'row')\n                .addClass('navbox-group')\n                .addClass(args.titlegroupclass)\n\
      \                .cssText(args.basestyle)\n                .cssText(args.groupstyle)\n                .cssText(args.titlegroupstyle)\n                .wikitext(args.titlegroup)\n    end\n    \n    local titleCell = titleRow.tag('th').attr('scope', 'col')\n\
      \            \n    if args.titlegroup then\n        titleCell\n            .css('border-left', '2px solid #fdfdfd')\n            .css('width', '100%')\n    end\n    \n    local titleColspan = 2\n    if args.imageleft then titleColspan = titleColspan +\
      \ 1 end\n    if args.image then titleColspan = titleColspan + 1 end\n    if args.titlegroup then titleColspan = titleColspan - 1 end\n    \n    titleCell\n        .cssText(args.basestyle)\n        .cssText(args.titlestyle)\n        .addClass('navbox-title')\n\
      \        .attr('colspan', titleColspan)\n \n    renderNavBar(titleCell)\n\n    titleCell\n         .tag('div')\n             .addClass(args.titleclass)\n             .css('font-size', '110%')\n             .wikitext(addNewline(args.title))\nend\n\n--\n\
      --   Above/Below rows\n--\n\nlocal function getAboveBelowColspan()\n    local ret = 2\n    if args.imageleft then ret = ret + 1 end\n    if args.image then ret = ret + 1 end\n    return ret\nend\n\nlocal function renderAboveRow(tbl)\n    if not args.above\
      \ then return end\n\n    addTableRow(tbl)\n        .tag('td')\n            .addClass('navbox-abovebelow')\n            .addClass(args.aboveclass)\n            .cssText(args.basestyle)\n            .cssText(args.abovestyle)\n            .attr('colspan',\
      \ getAboveBelowColspan())\n            .tag('div')\n                .wikitext(addNewline(args.above))\nend\n\nlocal function renderBelowRow(tbl)\n    if not args.below then return end\n\n    addTableRow(tbl)\n        .tag('td')\n            .addClass('navbox-abovebelow')\n\
      \            .addClass(args.belowclass)\n            .cssText(args.basestyle)\n            .cssText(args.belowstyle)\n            .attr('colspan', getAboveBelowColspan())\n            .tag('div')\n                .wikitext(addNewline(args.below))\nend\n\
      \ \n--\n--   List rows\n--\nlocal function renderListRow(tbl, listnum)\n    local row = addTableRow(tbl)\n    \n    if listnum == 1 and args.imageleft then\n        row\n            .tag('td')\n                .addClass('navbox-image')\n              \
      \  .addClass(args.imageclass)\n                .css('width', '0%')\n                .css('padding', '0px 2px 0px 0px')\n                .cssText(args.imageleftstyle)\n                .attr('rowspan', 2 * #listnums - 1)\n                .tag('div')\n  \
      \                  .wikitext(addNewline(args.imageleft))\n    end\n \n    if args['group' .. listnum] then\n        local groupCell = row.tag('th')\n        \n        groupCell\n               .attr('scope', 'row')\n               .addClass('navbox-group')\n\
      \               .addClass(args.groupclass)\n               .cssText(args.basestyle)\n               \n        if args.groupwidth then\n            groupCell.css('width', args.groupwidth)\n        end\n           \n        groupCell\n            .cssText(args.groupstyle)\n\
      \            .cssText(args['group' .. listnum .. 'style'])\n            .wikitext(args['group' .. listnum])\n    end\n    \n    local listCell = row.tag('td')\n\n    if args['group' .. listnum] then\n        listCell\n            .css('text-align', 'left')\n\
      \            .css('border-left-width', '2px')\n            .css('border-left-style', 'solid')\n    else\n        listCell.attr('colspan', 2)\n    end\n    \n    if not args.groupwidth then \n        listCell.css('width', '100%')\n    end\n    \n    local\
      \ isOdd = (listnum % 2) == 1\n    local rowstyle = args.evenstyle\n    if isOdd then rowstyle = args.oddstyle end\n \n    local evenOdd\n    if args.evenodd == 'swap' then\n        if isOdd then evenOdd = 'even' else evenOdd = 'odd' end\n    else\n   \
      \     if isOdd then evenOdd = args.evenodd or 'odd' else evenOdd = args.evenodd or 'even' end\n    end\n\n    listCell\n        .css('padding', '0px')\n        .cssText(args.liststyle)\n        .cssText(rowstyle)\n        .cssText(args['list' .. listnum\
      \ .. 'style'])\n        .addClass('navbox-list')\n        .addClass('navbox-' .. evenOdd)\n        .addClass(args.listclass)\n        .tag('div')\n            .css('padding', (listnum == 1 and args.list1padding) or args.listpadding or '0em 0.25em')\n \
      \           .wikitext(addNewline(args['list' .. listnum]))\n\n    if listnum == 1 and args.image then\n        row\n            .tag('td')\n                .addClass('navbox-image')\n                .addClass(args.imageclass)\n                .css('width',\
      \ '0%')\n                .css('padding', '0px 0px 0px 2px')\n                .cssText(args.imagestyle)\n                .attr('rowspan', 2 * #listnums - 1)\n                .tag('div')\n                    .wikitext(addNewline(args.image))\n    end\nend\n\
      \n\n--\n--   Tracking categories\n--\n\nlocal function needsHorizontalLists()\n    if border == 'child' or border == 'subgroup'  or args.tracking == 'no' then return false end\n    \n    local listClasses = {'plainlist', 'hlist', 'hlist hnum', 'hlist hwrap',\
      \ 'hlist vcard', 'vcard hlist', 'hlist vevent'}\n    for i, cls in ipairs(listClasses) do\n        if args.listclass == cls or args.bodyclass == cls then\n            return false\n        end\n    end\n\n    return true\nend\n\nlocal function hasBackgroundColors()\n\
      \    return mw.ustring.match(args.titlestyle or '','background') or mw.ustring.match(args.groupstyle or '','background') or mw.ustring.match(args.basestyle or '','background')\nend\n\nlocal function getTrackingCategories()\n    local cats = {}\n    if\
      \ needsHorizontalLists() then table.insert(cats, 'Navigational boxes without horizontal lists') end\n    if hasBackgroundColors() then table.insert(cats, 'Navboxes using background colours') end\n    return cats\nend\n\nlocal function renderTrackingCategories(builder)\n\
      \    local title = mw.title.getCurrentTitle()\n    if title.namespace ~= 10 then return end -- not in template space\n    local subpage = title.subpageText\n    if subpage == 'doc' or subpage == 'sandbox' or subpage == 'testcases' then return end\n   \
      \ \n    for i, cat in ipairs(getTrackingCategories()) do\n        builder.wikitext('[[Category:' .. cat .. ']]') \n    end\nend\n\n--\n--   Main navbox tables\n--\nlocal function renderMainTable()\n    local tbl = HtmlBuilder.create('table')\n        .attr('cellspacing',\
      \ 0)\n        .addClass('nowraplinks')\n        .addClass(args.bodyclass)\n             \n    if args.title and (args.state ~= 'plain' and args.state ~= 'off') then\n        tbl\n            .addClass('collapsible')\n            .addClass(args.state or\
      \ 'autocollapse')\n    end\n \n    tbl.css('border-spacing', 0)\n    if border == 'subgroup' or border == 'child' or border == 'none' then\n        tbl\n            .addClass('navbox-subgroup')\n            .cssText(args.bodystyle)\n            .cssText(args.style)\n\
      \    else -- regular navobx - bodystyle and style will be applied to the wrapper table\n        tbl\n            .addClass('navbox-inner')\n            .css('background', 'transparent')\n            .css('color', 'inherit')\n    end\n    tbl.cssText(args.innerstyle)\n\
      \ \n    renderTitleRow(tbl)\n    renderAboveRow(tbl)\n    for i, listnum in ipairs(listnums) do\n        renderListRow(tbl, listnum) \n    end\n    renderBelowRow(tbl)\n    \n    return tbl\nend\n\nfunction p._navbox(navboxArgs)\n    args = navboxArgs\n\
      \    \n    for k, v in pairs(args) do\n        local listnum = ('' .. k):match('^list(%d+)$')\n        if listnum then table.insert(listnums, tonumber(listnum)) end\n    end\n    table.sort(listnums)\n \n    border = trim(args.border or args[1] or '')\n\
      \n    -- render the main body of the navbox\n    local tbl = renderMainTable()\n\n    -- render the appropriate wrapper around the navbox, depending on the border param\n    local res = HtmlBuilder.create()\n    if border == 'none' then\n        res.node(tbl)\n\
      \    elseif border == 'subgroup' or border == 'child' then\n        -- We assume that this navbox is being rendered in a list cell of a parent navbox, and is\n        -- therefore inside a div with padding:0em 0.25em. We start with a &lt;/div&gt; to avoid\
      \ the\n        -- padding being applied, and at the end add a &lt;div&gt; to balance out the parent's &lt;/div&gt;\n        res\n            .tag('/div', {unclosed = true})\n                .done()\n            .node(tbl)\n            .tag('div', {unclosed\
      \ = true})\n    else\n        res\n            .tag('table')\n                .attr('cellspacing', 0)\n                .addClass('navbox')\n                .css('border-spacing', 0)\n                .cssText(args.bodystyle)\n                .cssText(args.style)\n\
      \                .tag('tr')\n                    .tag('td')\n                        .css('padding', '2px')\n                        .node(tbl)\n    end\n \n    renderTrackingCategories(res)\n \n    return tostring(res)\nend\n \nfunction p.navbox(frame)\n\
      \    if not getArgs then\n    \tgetArgs = require('Module:Arguments').getArgs\n    end\n    args = getArgs(frame, {wrappers = 'Template:Navbox'})\n\n    -- Read the arguments in the order they'll be output in, to make references number in the right order.\n\
      \    local _\n    _ = args.title\n    _ = args.above\n    for i = 1, 20 do\n        _ = args[&quot;group&quot; .. tostring(i)]\n        _ = args[&quot;list&quot; .. tostring(i)]\n    end    \n    _ = args.below\n\n    return p._navbox(args)\nend\n \nreturn\
      \ p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:24.097Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AAuthority+control&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:24 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404187659, 3440006207, 4115617900
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"23327809\" ns=\"10\" title=\"Template:Authority control\"><revisions><rev user=\"Docu\" timestamp=\"2014-01-07T07:08:40Z\" comment=\"fmt\" contentformat=\"text/x-wiki\" contentmodel=\"\
      wikitext\" xml:space=\"preserve\">{{#invoke:Authority control|authorityControl}}&lt;noinclude&gt;{{Documentation}}&lt;/noinclude&gt;&lt;includeonly&gt;&lt;!-- tracking categories to compare with Wikidata \n--&gt;{{#switch:{{NAMESPACE}}||{{ns:14}}=&lt;!--\
      \ Only articles and categories. \n--&gt;{{#ifeq:{{{VIAF|}}}|\n    |&lt;!-- empty or no VIAF in template --&gt;\n    |&lt;!-- VIAF in template \n  --&gt;{{#ifeq:{{#property:P214}}|\n      |&lt;!-- no property P214 at Wikidata --&gt; [[Category:VIAF not\
      \ on Wikidata]] &lt;!-- These we still need to import --&gt;\n      |&lt;!-- property P214 at Wikidata    --&gt; \n       {{#ifeq:{{{VIAF|}}}|{{#property:P214}}\n        |&lt;!-- same ID: We want to end up here --&gt;\n        |[[Category:VIAF different\
      \ on Wikidata]] &lt;!-- Figure out the best link, FIXME: multiple values on Wikidata --&gt;\n       }}\n     }}\n  }}\n}}&lt;/includeonly&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:24.488Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AAuthority_control&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:24 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1053 miss (0), amssq52 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 3103617773, 388633013, 4115618033
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Authority_control\" to=\"Module:Authority control\" /></normalized><pages><page pageid=\"39028170\" ns=\"828\" title=\"Module:Authority control\"><revisions><rev user=\"\
      Legoktm\" timestamp=\"2014-10-24T23:39:06Z\" comment=\"disable MusicBrainz requirement checking, see my note on the talk page\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">require('Module:No globals')\n\nlocal function\
      \ getCatForId( id )\n    local title = mw.title.getCurrentTitle()\n    local namespace = title.namespace\n    if namespace == 0 then\n        return '[[Category:Wikipedia articles with ' .. id .. ' identifiers]]'\n    elseif namespace == 2 and not title.isSubpage\
      \ then\n        return '[[Category:User pages with ' .. id .. ' identifiers]]'\n    else\n        return '[[Category:Miscellaneous pages with ' .. id .. ' identifiers]]'\n    end\nend\n\nlocal function viafLink( id )\n    if not string.match( id, '^%d+$'\
      \ ) then\n        return false\n    end\n    return '[https://viaf.org/viaf/' .. id .. ' ' .. id .. ']' .. getCatForId( 'VIAF' )\nend\n\nlocal function kulturnavLink( id )\n    return '[http://kulturnav.org/language/en/' .. id .. ' id]' \nend\n\nlocal\
      \ function sikartLink( id )\n    return '[http://www.sikart.ch/KuenstlerInnen.aspx?id=' .. id .. '&amp;lng=en ' .. id .. ']' \nend\n\nlocal function tlsLink( id )\n\tlocal id2 = mw.ustring.gsub(id, '%s', function(s) return mw.uri.encode(s, 'WIKI') end)\n\
      \    return '[http://tls.theaterwissenschaft.ch/wiki/' .. id2 .. ' ' .. id .. ']' \nend\n\n\nlocal function ciniiLink( id )\n    return '[http://ci.nii.ac.jp/author/' .. id .. '?l=en ' .. id .. ']' \nend\n\nlocal function bneLink( id )\n    return '[http://catalogo.bne.es/uhtbin/authoritybrowse.cgi?action=display&amp;authority_id='\
      \ .. id .. ' ' .. id .. ']' \nend\n\n\nlocal function uscongressLink( id )\n    return '[http://bioguide.congress.gov/scripts/biodisplay.pl?index=' .. id .. ' ' .. id .. ']' \nend\n\nlocal function narapersonLink( id )\n    return '[http://research.archives.gov/person/'\
      \ .. id .. ' ' .. id .. ']' \nend\n\nlocal function naraorganizationLink( id )\n    return '[http://research.archives.gov/organization/' .. id .. ' ' .. id .. ']' \nend\n\nlocal function botanistLink( id )\n\tlocal id2 = mw.ustring.gsub(id, '%s', function(s)\
      \ return mw.uri.encode(s, 'PATH') end)\n    return '[http://www.ipni.org/ipni/advAuthorSearch.do?find_abbreviation=' .. id2 .. ' ' .. id .. ']' \nend\n\nlocal function mgpLink( id )\n    -- TODO Implement some sanity checking regex\n    return '[http://www.genealogy.ams.org/id.php?id='\
      \ .. id .. ' ' .. id .. ']' \nend\n\nlocal function rslLink( id )\n    -- TODO Implement some sanity checking regex\n    return '[http://aleph.rsl.ru/F?func=find-b&amp;find_code=SYS&amp;adjacent=Y&amp;local_base=RSL11&amp;request=' .. id .. '&amp;CON_LNG=ENG\
      \ ' .. id .. ']'\nend\n\nlocal function leonoreLink( id )\n-- Identifiants allant de LH/1/1 à LH/2794/54 (légionnaires)\n-- Identifiants allant de C/0/1 à C/0/84 (84 légionnaires célèbres)\n-- Identifiants allant de 19800035/1/1 à 19800035/385/51670 (lé\
      gionnaires décédés entre 1954 et 1977, et quelques dossiers de légionnaires décédés avant 1954)\n    if not string.match( id, '^LH/%d%d?%d?%d?/%d%d?%d?$' ) and\n       not string.match( id, '^C/0/%d%d?$' ) and\n\t   not string.match( id, '^19800035/%d%d?%d?%d?/%d%d?%d?%d?%d?$'\
      \ ) then\n        return false\n    end\n    return '[//www.culture.gouv.fr/public/mistral/leonore_fr?ACTION=CHERCHER&amp;FIELD_1=COTE&amp;VALUE_1=' .. id .. ' ' .. id .. ']' \nend\n\nlocal function sbnLink( id )\n    if not string.match( id, '^IT\\\\\
      ICCU\\\\%d%d%d%d%d%d%d%d%d%d$' ) and not string.match( id, '^IT\\\\ICCU\\\\%u%u[%d%u]%u\\\\%d%d%d%d%d%d$' ) then\n        return false\n    end\n    return '[http://opac.sbn.it/opacsbn/opac/iccu/scheda_authority.jsp?bid=' .. id .. ' ' .. id .. ']'\nend\n\
      \nlocal function nkcLink( id )\n\treturn '[http://aleph.nkp.cz/F/?func=find-c&amp;local_base=aut&amp;ccl_term=ica=' .. id .. '&amp;CON_LNG=ENG ' .. id .. ']' \nend\n\nlocal function nclLink( id )\n    if not string.match( id, '^%d+$' ) then\n        return\
      \ false\n    end\n    return '[http://aleweb.ncl.edu.tw/F/?func=accref&amp;acc_sequence=' .. id .. '&amp;CON_LNG=ENG ' .. id .. ']' \nend\n\nlocal function ndlLink( id )\n\treturn '[http://id.ndl.go.jp/auth/ndlna/' .. id .. ' ' .. id .. ']' \nend\n\nlocal\
      \ function sudocLink( id )\n    if not string.match( id, '^%d%d%d%d%d%d%d%d[%dxX]$' ) then\n        return false\n    end\n    return '[http://www.idref.fr/' .. id .. ' ' .. id .. ']' \nend\n\nlocal function hlsLink( id )\n    if not string.match( id,\
      \ '^%d+$' ) then\n        return false\n    end\n    return '[http://www.hls-dhs-dss.ch/textes/f/F' .. id .. '.php ' .. id .. ']'\nend\n\nlocal function lirLink( id )\n    if not string.match( id, '^%d+$' ) then\n        return false\n    end\n    return\
      \ '[http://www.e-lir.ch/e-LIR___Lexicon.' .. id .. '.450.0.html ' .. id .. ']'\nend\n\nlocal function splitLccn( id )\n    if id:match( '^%l%l?%l?%d%d%d%d%d%d%d%d%d?%d?$' ) then\n        id = id:gsub( '^(%l+)(%d+)(%d%d%d%d%d%d)$', '%1/%2/%3' )\n    end\n\
      \    if id:match( '^%l%l?%l?/%d%d%d?%d?/%d+$' ) then\n         return mw.text.split( id, '/' )\n    end\n    return false\nend\n\nlocal function append(str, c, length)\n    while str:len() &lt; length do\n        str = c .. str\n    end\n    return str\n\
      end\n\nlocal function lccnLink( id )\n    local parts = splitLccn( id )\n    if not parts then\n        return false\n    end\n    local lccnType = parts[1] ~= 'sh' and 'names' or 'subjects'\n    id = parts[1] .. parts[2] .. append( parts[3], '0', 6 )\n\
      \    return '[http://id.loc.gov/authorities/' .. lccnType .. '/' .. id .. ' ' .. id .. ']' .. getCatForId( 'LCCN' )\nend\n\nlocal function mbLink( id )\n    -- TODO Implement some sanity checking regex\n    return '[//musicbrainz.org/artist/' .. id ..\
      \ ' ' .. id .. ']' .. getCatForId( 'MusicBrainz' )\nend\n\n--Returns the ISNI check digit isni must be a string where the 15 first elements are digits\nlocal function getIsniCheckDigit( isni )\n    local total = 0\n    for i = 1, 15 do\n        local digit\
      \ = isni:byte( i ) - 48 --Get integer value\n        total = (total + digit) * 2\n    end\n    local remainder = total % 11\n    local result = (12 - remainder) % 11\n    if result == 10 then\n        return &quot;X&quot;\n    end\n    return tostring(\
      \ result )\nend\n\n--Validate ISNI (and ORCID) and retuns it as a 16 characters string or returns false if it's invalid\n--See http://support.orcid.org/knowledgebase/articles/116780-structure-of-the-orcid-identifier\nlocal function validateIsni( id )\n\
      \    id = id:gsub( '[ %-]', '' ):upper()\n    if not id:match( '^%d%d%d%d%d%d%d%d%d%d%d%d%d%d%d[%dX]$' ) then\n        return false\n    end\n    if getIsniCheckDigit( id ) ~= string.char( id:byte( 16 ) ) then\n        return false\n    end\n    return\
      \ id\nend\n\nlocal function isniLink( id )\n    id = validateIsni( id )\n    if not id then\n        return false\n    end\n    return '[http://isni-url.oclc.nl/isni/' .. id .. ' ' .. id:sub( 1, 4 ) .. ' ' .. id:sub( 5, 8 ) .. ' '  .. id:sub( 9, 12 ) ..\
      \ ' '  .. id:sub( 13, 16 ) .. ']' .. getCatForId( 'ISNI' )\nend\n\nlocal function orcidLink( id )\n    id = validateIsni( id )\n    if not id then\n        return false\n    end\n    id = id:sub( 1, 4 ) .. '-' .. id:sub( 5, 8 ) .. '-'  .. id:sub( 9, 12\
      \ ) .. '-'  .. id:sub( 13, 16 )\n    return '[http://orcid.org/' .. id .. ' ' .. id .. ']' .. getCatForId( 'ORCID' )\nend\n\nlocal function gndLink( id )\n    return '[http://d-nb.info/gnd/' .. id .. ' ' .. id .. ']' .. getCatForId( 'GND' )\nend\n\nlocal\
      \ function selibrLink( id )\n\tif not string.match( id, '^%d+$' ) then\n        return false\n    end\n    return '[//libris.kb.se/auth/' .. id .. ' ' .. id .. ']' .. getCatForId( 'SELIBR' )\nend\n\nlocal function bnfLink( id )\n    --Add cb prefix if\
      \ it has been removed\n    if not string.match( id, '^cb.+$' ) then\n        id = 'cb' .. id\n    end\n\n    return '[http://catalogue.bnf.fr/ark:/12148/' .. id .. ' ' .. id .. '] [http://data.bnf.fr/ark:/12148/' .. id .. ' (data)]' .. getCatForId( 'BNF'\
      \ )\nend\n\nlocal function bpnLink( id )\n    if not string.match( id, '^%d+$' ) then\n        return false\n    end\n    return '[http://www.biografischportaal.nl/en/persoon/' .. id .. ' ' .. id .. ']' .. getCatForId( 'BPN' )\nend\n\nlocal function ridLink(\
      \ id )\n    return '[http://www.researcherid.com/rid/' .. id .. ' ' .. id .. ']' .. getCatForId( 'RID' )\nend\n\nlocal function bibsysLink( id )\n    return '[http://ask.bibsys.no/ask/action/result?cmd=&amp;kilde=biblio&amp;cql=bs.autid+%3D+' .. id ..\
      \ '&amp;feltselect=bs.autid ' .. id .. ']' .. getCatForId( 'BIBSYS' )\nend\n\nlocal function ulanLink( id )\n    return '[//www.getty.edu/vow/ULANFullDisplay?find=&amp;role=&amp;nation=&amp;subjectid=' .. id .. ' ' .. id .. ']' .. getCatForId( 'ULAN' )\n\
      end\n\nlocal function nlaLink( id )\n\treturn '[//nla.gov.au/anbd.aut-an' .. id .. ' ' .. id .. ']' .. getCatForId( 'NLA' )\nend\n\nlocal function getIdsFromWikidata( item, property )\n    local ids = {}\n    if not item.claims[property] then\n       \
      \ return ids\n    end\n    for _, statement in pairs( item.claims[property] ) do\n        table.insert( ids, statement.mainsnak.datavalue.value )\n    end\n    return ids\nend\n\nlocal function matchesWikidataRequirements( item, reqs )\n    for _, group\
      \ in pairs( reqs ) do\n        local property = 'p' .. group[1]\n        local qid = group[2]\n        if item.claims[property] ~= nil then\n            for _, statement in pairs ( item.claims[property] ) do\n            \tif statement.mainsnak.datavalue\
      \ ~= nil then\n\t                if statement.mainsnak.datavalue.value['numeric-id'] == qid then\n    \t                return true\n        \t        end\n        \t    end\n            end\n        end\n    end\n    return false\nend\n\nlocal function\
      \ createRow( id, label, rawValue, link, withUid )\n    if link then\n        if withUid then\n            return '* ' .. label .. ' &lt;span class=&quot;uid&quot;&gt;' .. link .. '&lt;/span&gt;\\n'\n        else\n            return '* ' .. label .. ' '\
      \ .. link .. '\\n'\n        end\n    else\n        return '* &lt;span class=&quot;error&quot;&gt;The ' .. id .. ' id ' .. rawValue .. ' is not valid.&lt;/span&gt;[[Category:Wikipedia articles with faulty authority control identifiers (' .. id .. ')]]\\\
      n'\n    end\nend\n\n--In this order: name of the parameter, label, propertyId in Wikidata, formatting function\nlocal conf = {\n    { 'VIAF', '[[Virtual International Authority File|VIAF]]', 214, viafLink },\n    { 'LCCN', '[[Library of Congress Control\
      \ Number|LCCN]]', 244, lccnLink },\n    { 'ISNI', '[[International Standard Name Identifier|ISNI]]', 213, isniLink },\n    { 'ORCID', '[[ORCID]]', 496, orcidLink },\n    { 'GND', '[[Integrated Authority File|GND]]', 227, gndLink },\n    { 'SELIBR', '[[LIBRIS|SELIBR]]',\
      \ 906, selibrLink },\n    { 'SUDOC', '[[Système universitaire de documentation|SUDOC]]', 269, sudocLink },    \n    { 'BNF', '[[Bibliothèque nationale de France|BNF]]', 268, bnfLink },\n    { 'BPN', '[[Biografisch Portaal|BPN]]', 651, bpnLink },\n    {\
      \ 'RID', '[[ResearcherID]]', 1053, ridLink },\n    { 'BIBSYS', '[[BIBSYS]]', 1015, bibsysLink },\n    { 'ULAN', '[[Union List of Artist Names|ULAN]]', 245, ulanLink },\n    { 'HDS', '[[Historical Dictionary of Switzerland|HDS]]', 902, hlsLink },\n    {\
      \ 'LIR', '[[Historical Dictionary of Switzerland#Lexicon_Istoric_Retic|LIR]]', 886, lirLink },\n    { 'MBA', '[[MusicBrainz]]', 434, mbLink },\n    { 'MGP', '[[Mathematics Genealogy Project|MGP]]', 549, mgpLink },    \n    { 'NLA', '[[National Library\
      \ of Australia|NLA]]', 409, nlaLink },\n    { 'NDL', '[[National Diet Library|NDL]]', 349, ndlLink },\n    { 'NCL', '[[National Central Library|NCL]]', 1048, nclLink },\n    { 'NKC', '[[National Library of the Czech Republic|NKC]]', 691, nkcLink },\n \
      \   { 'Léonore', '[[:fr:Base Léonore|Léonore]]', 640, leonoreLink }, \n    { 'SBN', '[[Istituto Centrale per il Catalogo Unico|ICCU]]', 396, sbnLink },     \n    { 'RLS', '[[Russian State Library|RLS]]', 947, rslLink },\n    { 'Botanist', '[[Author citation\
      \ (botany)|Botanist]]', 428, botanistLink },\n    { 'NARA-person', '[[National Archives and Records Administration|NARA]]', 1222, narapersonLink },\n    { 'NARA-organization', '[[National Archives and Records Administration|NARA]]', 1223, naraorganizationLink\
      \ },\n    { 'USCongress', '[[Biographical Directory of the United States Congress|US Congress]]', 1157, uscongressLink },\n    { 'BNE', '[[Biblioteca Nacional de España|BNE]]', 950, bneLink },\n    { 'CINII', '[[CiNii]]', 271, ciniiLink },\n    { 'TLS',\
      \ '[[Theaterlexikon der Schweiz|TLS]]', 0, tlsLink },\n    { 'SIKART', '[[SIKART]]', 781, sikartLink },\n    { 'KULTURNAV', '[[KulturNav]]', 1248, kulturnavLink },\n}\n\n-- Check that the Wikidata item has this property--&gt;value before adding it\nlocal\
      \ reqs = {}\n\nlocal p = {}\n\nfunction p.authorityControl( frame )\n    local parentArgs = frame:getParent().args\n    --Create rows\n    local elements = {}\n\n    --redirect PND to GND\n    if (parentArgs.GND == nil or parentArgs.GND == '') and parentArgs.PND\
      \ ~= nil and parentArgs.PND ~= '' then\n        parentArgs.GND = parentArgs.PND\n    end\n\n    --Wikidata fallback if requested\n    local item = mw.wikibase.getEntity()\n    if item ~= nil and item.claims ~= nil then\n        for _, params in pairs(\
      \ conf ) do\n            if params[3] ~= 0 then\n                local val = parentArgs[params[1]]\n                if not val or val == '' then\n                \tlocal canUseWikidata = nil\n                    if reqs[params[1]] ~= nil then\n       \
      \                 canUseWikidata = matchesWikidataRequirements( item, reqs[params[1]] )\n                    else\n                        canUseWikidata = true\n                    end\n                    if canUseWikidata then\n                    \
      \    local wikidataIds = getIdsFromWikidata( item, 'p' .. params[3] )\n                        if wikidataIds[1] then\n                            parentArgs[params[1]] = wikidataIds[1]\n                        end\n                    end\n          \
      \      end\n            end\n        end\n    end\n\n    --Worldcat\n    if parentArgs['WORLDCATID'] and parentArgs['WORLDCATID'] ~= '' then\n        table.insert( elements, createRow( 'WORLDCATID', '', parentArgs['WORLDCATID'], '[//www.worldcat.org/identities/'\
      \ .. parentArgs['WORLDCATID'] .. ' WorldCat]', false ) ) --Validation?\n    elseif parentArgs['LCCN'] and parentArgs['LCCN'] ~= '' then\n        local lccnParts = splitLccn( parentArgs['LCCN'] )\n        if lccnParts then\n            table.insert( elements,\
      \ createRow( 'LCCN', '', parentArgs['LCCN'], '[//www.worldcat.org/identities/lccn-' .. lccnParts[1] .. lccnParts[2] .. '-' .. lccnParts[3] .. ' WorldCat]', false ) )\n        end\n    end\n\n    --Configured rows\n    local rct = 0\n    for k, params in\
      \ pairs( conf ) do\n        local val = parentArgs[params[1]]\n        if val and val ~= '' then\n            table.insert( elements, createRow( params[1], params[2] .. ':', val, params[4]( val ), true ) )\n            rct = rct + 1\n        end\n    end\n\
      \    local Navbox = require('Module:Navbox')\n    local elementscats = ''\n    if rct &gt; 13 then\n    \telementscats  = '[[Category:AC with ' .. rct .. ' elements]]'\n\tend\n\t\n\tif #elements ~= 0 then\n\t\treturn Navbox._navbox( {\n\t\t\tname  = 'Authority\
      \ control',\n\t\t\tbodyclass = 'hlist',\n\t\t\tgroup1 = '[[Authority control]]' .. elementscats,\n\t\t\tlist1 = table.concat( elements )\n\t\t\t} )\n\telse\n\t\treturn &quot;&quot;\n\tend\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:24.757Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3APersondata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:24 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq58 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025969846, 343435669, 4115618412
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page pageid=\"3501055\" ns=\"10\" title=\"Template:Persondata\"><revisions><rev user=\"Plastikspork\" timestamp=\"2014-10-26T22:59:32Z\" comment=\"Add noprint\" contentformat=\"text/x-wiki\"\
      \ contentmodel=\"wikitext\" xml:space=\"preserve\">{| id=&quot;persondata&quot; class=&quot;persondata noprint&quot; style=&quot;border:1px solid #aaa; display:none; speak:none;&quot;\n! colspan=&quot;2&quot; | [[Wikipedia:Persondata|Persondata]]\n|-\n\
      | class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Name\n| {{{name|{{{NAME|}}}}}}\n|- \n| class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Alternative names \n| {{{alternative names|{{{ALTERNATIVE NAMES|}}}}}}\n|- \n\
      | class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Short description\n| {{{short description|{{{SHORT DESCRIPTION|}}}}}}\n|-\n| class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Date of birth\n| {{{date of birth|{{{DATE\
      \ OF BIRTH|}}}}}}\n|-\n| class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Place of birth \n| {{{place of birth|{{{PLACE OF BIRTH|}}}}}}\n|-\n| class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Date of death\n| {{{date\
      \ of death|{{{DATE OF DEATH|}}}}}}\n|-\n| class=&quot;persondata-label&quot; style=&quot;color:#aaa;&quot; | Place of death\n| {{{place of death|{{{PLACE OF DEATH|}}}}}}\n|}&lt;includeonly&gt; {{#if: {{{name|{{{NAME|}}}}}} | | [[Category:Persondata templates\
      \ without name parameter]] }} {{#if: {{{short description|{{{SHORT DESCRIPTION|}}}}}} | | [[Category:Persondata templates without short description parameter]]}}&lt;/includeonly&gt;&lt;noinclude&gt;\n{{Documentation}}\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2014-11-04T23:12:25.052Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATomHanksJan2009+%28cropped%29.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:25 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq51 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349059669, 571416475, 4115618521
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page ns="6" title="File:TomHanksJan2009 (cropped).jpg" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/9/98/TomHanksJan2009_%28cropped%29.jpg/220px-TomHanksJan2009_%28cropped%29.jpg" thumbwidth="220" thumbheight="264" url="http://upload.wikimedia.org/wikipedia/commons/9/98/TomHanksJan2009_%28cropped%29.jpg" descriptionurl="http://commons.wikimedia.org/wiki/File:TomHanksJan2009_(cropped).jpg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:25.531Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATomHanks1989.png&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:25 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=hhvm
      X-Cache: cp1052 miss (0), amssq39 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.3.1
      X-Varnish: 4025970768, 3682508818, 4115619011
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page ns="6" title="File:TomHanks1989.png" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/f/f5/TomHanks1989.png/220px-TomHanks1989.png" thumbwidth="220" thumbheight="332" url="http://upload.wikimedia.org/wikipedia/commons/f/f5/TomHanks1989.png" descriptionurl="http://commons.wikimedia.org/wiki/File:TomHanks1989.png" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:26.469Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATomHanksForrestGump94.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:26 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1068 miss (0), amssq34 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1530390674, 3440007508, 4115619665
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page ns="6" title="File:TomHanksForrestGump94.jpg" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/9/95/TomHanksForrestGump94.jpg/220px-TomHanksForrestGump94.jpg" thumbwidth="220" thumbheight="463" url="http://upload.wikimedia.org/wikipedia/commons/9/95/TomHanksForrestGump94.jpg" descriptionurl="http://commons.wikimedia.org/wiki/File:TomHanksForrestGump94.jpg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:27.387Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATom+Hanks+-+footprint.JPG&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:27 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq46 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123574200, 2973996925, 4115620268
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page ns="6" title="File:Tom Hanks - footprint.JPG" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/6/65/Tom_Hanks_-_footprint.JPG/220px-Tom_Hanks_-_footprint.JPG" thumbwidth="220" thumbheight="165" url="http://upload.wikimedia.org/wikipedia/commons/6/65/Tom_Hanks_-_footprint.JPG" descriptionurl="http://commons.wikimedia.org/wiki/File:Tom_Hanks_-_footprint.JPG" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:27.876Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATom+Hanks+2008a.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:27 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1067 miss (0), amssq57 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 2123575444, 3156617632, 4115621042
    body: <?xml version="1.0"?><api><continue iistart="2008-10-02T15:05:17Z" continue="||" /><query><pages><page ns="6" title="File:Tom Hanks 2008a.jpg" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Tom_Hanks_2008a.jpg/220px-Tom_Hanks_2008a.jpg" thumbwidth="220" thumbheight="337" url="http://upload.wikimedia.org/wikipedia/commons/c/c6/Tom_Hanks_2008a.jpg" descriptionurl="http://commons.wikimedia.org/wiki/File:Tom_Hanks_2008a.jpg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:28.619Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ATom+Hanks+and+wife+Rita+Wilson+836.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:28 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq52 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349064412, 388635916, 4115621469
    body: <?xml version="1.0"?><api><continue iistart="2007-10-06T22:38:19Z" continue="||" /><query><pages><page ns="6" title="File:Tom Hanks and wife Rita Wilson 836.jpg" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/4/4d/Tom_Hanks_and_wife_Rita_Wilson_836.jpg/220px-Tom_Hanks_and_wife_Rita_Wilson_836.jpg" thumbwidth="220" thumbheight="274" url="http://upload.wikimedia.org/wikipedia/commons/4/4d/Tom_Hanks_and_wife_Rita_Wilson_836.jpg" descriptionurl="http://commons.wikimedia.org/wiki/File:Tom_Hanks_and_wife_Rita_Wilson_836.jpg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:29.212Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ASteven+Spielberg+%26+Tom+Hanks+at+National+World+War+II+Memorial+for+premiere+of+The+Pacific+2010-03-11.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:29 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1066 miss (0), amssq54 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 349065283, 217049812, 4115621985
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page ns="6" title="File:Steven Spielberg &amp; Tom Hanks at National World War II Memorial for premiere of The Pacific 2010-03-11.jpg" missing="" imagerepository="shared"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Steven_Spielberg_%26_Tom_Hanks_at_National_World_War_II_Memorial_for_premiere_of_The_Pacific_2010-03-11.jpg/220px-Steven_Spielberg_%26_Tom_Hanks_at_National_World_War_II_Memorial_for_premiere_of_The_Pacific_2010-03-11.jpg" thumbwidth="220" thumbheight="163" url="http://upload.wikimedia.org/wikipedia/commons/b/bb/Steven_Spielberg_%26_Tom_Hanks_at_National_World_War_II_Memorial_for_premiere_of_The_Pacific_2010-03-11.jpg" descriptionurl="http://commons.wikimedia.org/wiki/File:Steven_Spielberg_%26_Tom_Hanks_at_National_World_War_II_Memorial_for_premiere_of_The_Pacific_2010-03-11.jpg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:29.702Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3AP+vip.svg&prop=imageinfo&iiprop=url&iiurlwidth=24
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:29 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1054 miss (0), amssq46 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 1404195192, 2973998344, 4115622216
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="27108821" ns="6" title="File:P vip.svg" imagerepository="local"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/en/thumb/6/69/P_vip.svg/24px-P_vip.svg.png" thumbwidth="24" thumbheight="24" url="http://upload.wikimedia.org/wikipedia/en/6/69/P_vip.svg" descriptionurl="http://en.wikipedia.org/wiki/File:P_vip.svg" /></imageinfo></page></pages></query></api>
- recorded: 2014-11-04T23:12:30.463Z
  request:
    method: GET
    uri: http://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3AVideo-x-generic.svg&prop=imageinfo&iiprop=url&iiurlwidth=24
    headers:
      Content-Length: '0'
      Cookie: GeoIP=PT:Lisbon:38.7167:-9.1333:v4
      Cookie2: $Version=1
      Host: en.wikipedia.org
      Proxy-Connection: Keep-Alive
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Tue, 04 Nov 2014 23:12:30 GMT
      Server: Apache
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,X-Use-HHVM
      X-Analytics: php=zend
      X-Cache: cp1052 miss (0), amssq60 miss (0), amssq36 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Varnish: 4025976512, 361910059, 4115622527
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page pageid="23473533" ns="6" title="File:Video-x-generic.svg" imagerepository="local"><imageinfo><ii thumburl="http://upload.wikimedia.org/wikipedia/en/thumb/e/e7/Video-x-generic.svg/24px-Video-x-generic.svg.png" thumbwidth="24" thumbheight="24" url="http://upload.wikimedia.org/wikipedia/en/e/e7/Video-x-generic.svg" descriptionurl="http://en.wikipedia.org/wiki/File:Video-x-generic.svg" /></imageinfo></page></pages></query></api>
