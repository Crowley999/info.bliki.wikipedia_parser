!tape
name: Foobar
interactions:
- recorded: 2015-06-28T17:40:50.022Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Foobar&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:49 GMT
      Server: nginx/1.9.2
      Set-Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; Path=/; Domain=.wikipedia.org, WMF-Last-Access=28-Jun-2015;Path=/;HttpOnly;Expires=Thu, 30 Jul 2015 12:00:00 GMT
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1
      X-Cache: cp1055 miss (0), cp3006 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1017466815, 417981577, 1029489159
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="11178" pageid="11178" ns="0" title="Foobar"><revisions><rev user="F.macroo" timestamp="2015-06-06T09:44:59Z" comment="" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Distinguish}}
      {{Redirect|Foo|other uses|Foo (disambiguation)}}
      The terms '''foobar''' ({{IPAc-en|ˈ|f|uː|b|ɑr}}), '''fubar''', or '''foo''', '''bar''', '''baz''' and '''qux''' (alternatively, '''quux''') and sometimes '''norf'''&lt;ref&gt;http://www.vidyokarma.com/article.php?c=R-programming-language&amp;page=1&lt;/ref&gt;&lt;ref&gt;http://rstudio-pubs-static.s3.amazonaws.com/43080_1d7db6d9f7044c8bae0e6a7f90c563cc.html&lt;/ref&gt;&lt;ref&gt;http://mathalope.co.uk/2015/03/08/swirl-r-programming-lesson-6-subsetting-vectors/&lt;/ref&gt;&lt;ref&gt;http://www.perlmonks.org/?node_id=1116433&lt;/ref&gt; and many others&lt;ref name=&quot;hackerdict&quot;&gt;http://www.dourish.com/goodies/jargon.html&lt;/ref&gt;&lt;ref&gt;http://www.catb.org/jargon/html/M/metasyntactic-variable.html&lt;/ref&gt; are sometimes used as [[placeholder name]]s (also referred to as [[metasyntactic variable]]s) in [[computer programming]] or computer-related documentation.&lt;ref name=&quot;rfc3092&quot; /&gt; They have been used to name entities such as [[Variable (computer science)|variable]]s, [[Function (computer science)|functions]], and [[command (computing)|command]]s whose exact identity is unimportant and serve only to demonstrate a concept.  The words themselves have no meaning in this usage.  ''Foobar'' is sometimes used alone; ''foo'', ''bar'', and ''baz'' are sometimes used, when multiple entities are needed.

      The usage in [[computer programming]] examples and [[pseudocode]] varies; in certain circles, it is used extensively, but many prefer descriptive names, while others prefer to use single letters.  [[Eric S. Raymond]] has called it an &quot;important hackerism&quot; alongside [[kludge]] and [[cruft]].&lt;ref name=&quot;Raymond&quot;&gt;{{cite book|url=http://books.google.com/books?id=g80P_4v4QbIC&amp;lpg=PP1&amp;pg=PA5|title=The New Hacker's Dictionary|author=[[Eric S. Raymond]]|publisher=[[MIT Press]]|year=1996|isbn=0-262-68092-0}}&lt;/ref&gt;

      == History and etymology ==

      [[File:Smokeycover.jpg|thumb|upright|[[Smokey Stover]]&lt;!-- no italics, character’s name --&gt; driving a &quot;foomobile&quot;, with ''phoo'' visible on the front]]
      The word ''foo'' originated as a [[nonsense word]] from the 1930s, the military term [[FUBAR]] emerged in the 1940s, and the use of ''foo'' in a programming context is generally credited to the [[Tech Model Railroad Club]] (TMRC) of [[Massachusetts Institute of Technology|MIT]] from circa 1960.&lt;ref&gt;{{cite web|url=http://www.ietf.org/rfc/rfc3092.txt|title=Etymology of &quot;Foo&quot;}}&lt;/ref&gt; However, the precise relationship of these terms is not known with certainty, and several anecdotal theories have been advanced to identify them.

      The etymology of ''foo'' is explored in the [[Internet Engineering Task Force]] (IETF) RFC 3092, which gives the earliest documented use as being in the 1930s comic ''[[Smokey Stover]]'' by [[Bill Holman (cartoonist)|Bill Holman]], where it is used as a nonsense word.&lt;ref name=&quot;jargon&quot;&gt;http://catb.org/jargon/html/F/foo.html foo&lt;/ref&gt;&lt;ref&gt;http://catb.org/jargon/html/index.html&lt;/ref&gt; Holman states that he used the word due to having seen it on bottom of a jade Chinese figurine in [[Chinatown, San Francisco]], meaning &quot;good luck&quot;.&lt;ref&gt;http://www.smokey-stover.com/history.html&lt;/ref&gt;&lt;ref&gt;[http://www.smokey-stover.com/ smokey-stover.com]&lt;/ref&gt;&lt;ref&gt;http://members.aol.com/EOCostello/&lt;/ref&gt; This is presumably as a transliteration of the [[fu character]] (fú, 福), which is a common character for fortune, and figurines of the trio of eponymous male &quot;star gods&quot; ''[[Fu Lu Shou|Fú, Lù, Shòu]]'' are common in Chinese communities; compare [[Fu Manchu]], fictional character popular in the 1930s. ''Smokey Stover'' ran 1935–73, and continued to feature ''foo'' prominently, as on the front of the &quot;foomobile&quot; illustrated in the cover at right. The word ''foo'' became very popular in the 1930s, and also appeared in other cartoons including the ''[[Looney Tunes]]'' cartoons of [[Bob Clampett]] such as ''[[The Daffy Doc]]'' and ''[[Porky in Wackyland]]'' (both 1938, with [[Daffy Duck]] and [[Porky Pig]]), and in other comic strips such as ''[[Pogo (comics)|Pogo]]''.

      From there, the Foo migrated into military slang, merged with &quot;FU&quot; of the [[FUBAR]].&lt;ref name=&quot;rfc3092&quot;&gt;{{cite web|url=http://www.ietf.org/rfc/rfc3092.txt|title=Etymology of &quot;Foo&quot;|author=D. Eastlake III|year=2001|publisher=[[Internet Engineering Task Force]]|accessdate=2007-11-05|display-authors=etal}}&lt;/ref&gt; The term ''[[foo fighter]]'' was used by [[Allies of World War II|Allied]] aircraft pilots in [[World War II]] to describe various [[unidentified flying object|UFOs]] or mysterious aerial phenomena.

      The first known use of the terms in print in a programming context appears in a 1965 edition of MIT's &quot;Tech Engineering News&quot;.&lt;ref&gt;{{cite book|url=http://books.google.com/books?id=aOQRAQAAMAAJ&amp;q=foobar&amp;dq=foobar&amp;source=bl&amp;ots=vuAhTreOhj&amp;sig=Xk-_9ZRIXoyQ_F_gvvDflYKzXwI&amp;hl=en&amp;sa=X&amp;ei=jUEkUI_ZDoPY2QWrjoHACA&amp;ved=0CDoQ6AEwAQ|title=Tech Engineering News, Volume 47|year=1965|publisher=[[Massachusetts Institute of Technology]]|page=63|quote=Further, it is possible to search for an effective address; e.g., if an instruction such as &quot;add 1 foo&quot; were used, specifying indirect addressing thru location &quot;foo&quot;, and location &quot;foo&quot; contained the address of location &quot;foobar&quot;, than an effective word search for &quot;foobar&quot; would find location &quot;foo&quot; and the location containing the &quot;add&quot; instruction as well.}}&lt;/ref&gt; ''Foobar'' may have come about as a result of the pre-existing &quot;Foo&quot; being conjoined with &quot;bar&quot; an addition borrowed from the military's FUBAR. The use of ''foo'' in hacker and eventually in programming context may have begun in MIT's [[Tech Model Railroad Club]] (TMRC). In the complex model system, there were [[scram]] switches located at numerous places around the room that could be thrown if something undesirable was about to occur, such as a train going full-bore at an obstruction. Another feature of the system was a digital clock on the dispatch board. When someone hit a scram switch the clock stopped and the display was replaced with the word &quot;FOO&quot;; at TMRC the scram switches are therefore called &quot;Foo switches&quot;. Because of this, an entry in the 1959 Dictionary of the TMRC Language went something like this: &quot;FOO: The first syllable of the misquoted sacred chant phrase '[[Om mani padme hum|foo mane padme hum]].' Our first obligation is to keep the foo counters turning.&quot;&lt;ref&gt;{{cite web|url=http://www.computer-dictionary-online.org/?q=foo|title=Computer Dictionary Online}}, computer-dictionary-online.org&lt;/ref&gt; One book{{which|date=November 2010}} describing the MIT train room describes two buttons by the door: labeled foo and bar. These were general purpose buttons and were often re-purposed for whatever fun idea the MIT hackers had at the time, hence the adoption of foo and bar as general purpose variable names. An entry in the &quot;Abridged Dictionary of the TMRC Language&quot; states:&lt;ref&gt;{{cite web|url=http://tmrc.mit.edu/dictionary.html|title=Abridged Dictionary of the TMRC Language|publisher=[[MIT]]}}&lt;/ref&gt;

      {{Quote|text = Multiflush: stop-all-trains-button. Next best thing to the red door button. Also called FOO. Displays &quot;FOO&quot; on the clock when used.}}

      The term ''foobar'' was propagated through computer science circles in the 1960s and early 1970s by system manuals from [[Digital Equipment Corporation]].{{citation needed|date=May 2009}} ''Foobar'' was also used as a variable name in the [[Fortran]] code of ''[[Colossal Cave Adventure]]'' (1977 Crowther and Woods version). The variable FOOBAR was used to contain the player's progress in saying the magic phrase &quot;Fee Fie Foe Foo&quot;.

      ==Usage in code==
      The terms are very often used in programming examples, much like the [[Hello World]] program is commonly used as an introduction.  For example, ''foo'' and ''bar'' might be used to illustrate a simple string concatenation:

      &lt;syntaxhighlight lang=&quot;c&quot;&gt;
      /* C code */

      #include &lt;stdio.h&gt;

      int main()
      {
         char *foo = &quot;Hello&quot;;
         char *bar = &quot;World!&quot;;
         fprintf(stdout, &quot;%s %s\n&quot;, foo, bar);

         return 0;
      }
      &lt;/syntaxhighlight&gt;
      Also see  [[metasyntactic variables#Programming language examples|metasyntactic variables]].

      ==Usage in speech==
      The terms are used in speech in an analogous way, although older synonyms may be used.  For example, &quot;''Some function foo'' will then be called&quot;.  In these cases, ''foo'' and ''bar'' are synonyms for ''whatever'' or ''whichever''. Or: &quot;A database record for user ''foo''&quot; is synonymous with: &quot;A database record for user ''whoever''&quot;.

      ==Usage in culture==
      ''$foo'' is the name of a [[Perl]] programming magazine,&lt;ref&gt;[http://foo-magazin.de/ foo-magazin.de] {{de icon}}&lt;/ref&gt; and [[Foo Camp]] is an annual [[hacker convention]].

      During the ''[[United States v. Microsoft Corp.]]'' trial, some evidence was presented that Microsoft had tried to use the [[Web Services Interoperability]] organization as a means to stifle competition, including e-mails in which top executives including [[Bill Gates]] referred to the WS-I using the codename &quot;foo&quot;.&lt;ref&gt;[http://www.news.com/Microsoft-ploy-to-block-Sun-exposed/2100-1001_3-912906.html Microsoft ploy to block Sun exposed], news.com&lt;/ref&gt;

      These terms gave the name to [[foobar2000]], an audio player independently developed using C++, as its author was more focused on producing a functional program than on aesthetics.

      There is a character named &quot;Master Foo&quot; in ''Rootless Root'', a collection of [[hacker koans]].

      Google releases https://google.com/foobar in November 2014.

      == See also ==
      {{Portal|Computer programming}}
      * [[BarCamp]], an international network of user generated conferences
      * [[Foo Camp]], an annual hacker event hosted by publisher O'Reilly Media
      * [[Foobar2000]], a highly customizable audio player which name is derived from foobar
      * [[Placeholder name]]
      * [[Snafu]]
      * [[xyzzy (computing)|xyzzy]]
      {{Clear}}

      == References ==
      {{Reflist|30em}}

      == External links ==
      {{wiktionary|foobar|foo|bar}}
      * [http://tools.ietf.org/html/rfc3092 RFC3092 Etymology of &quot;Foo&quot;], tools.ietf.org
      * [http://foldoc.org/index.cgi?query=foo The Free Online Dictionary of Computing entry on &quot;foo&quot;], foldoc.org
      * [http://www.catb.org/jargon/html/F/foo.html The Jargon File entry on &quot;foobar&quot;], catb.org
      * RFC 1639 – FTP Operation Over Big Address Records (FOOBAR)

      [[Category:Placeholder names]]
      [[Category:Variable (computer programming)]]</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:50.658Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ADistinguish&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:50 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3013 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791335822, 1492447542, 1029490838
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="3406012" pageid="3406012" ns="10" title="Template:Distinguish"><revisions><rev user="Technical 13" timestamp="2015-04-15T12:19:37Z" comment="Undid revision 656592368 by [[Special:Contributions/Wbm1058|Wbm1058]] ([[User talk:Wbm1058|talk]]) --- Fixed problem" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#if:{{{1|}}}
       |{{Hatnote|Not to be confused with [[:{{trim|{{{1}}}}}]]{{
          #if: {{{3|}}}{{{4|}}}
          | , [[:{{trim|{{{2}}}}}]], {{
            #if: {{{4|}}}
            | [[:{{trim|{{{3}}}}}]], or [[:{{trim|{{{4}}}}}]]
            | or [[:{{trim|{{{3}}}}}]]
            }}
          | {{
            #if: {{{2|}}}
            | &amp;nbsp;or [[:{{trim|{{{2}}}}}]]
            }}
          }}.
        }}
      }}&lt;noinclude&gt;&lt;!-- splitting these lines causes {{Documentation}} template to terminate green shading when Distinguish is used in /doc pages. --&gt;
      {{Documentation}}
      &lt;!-- Add categories to the /doc subpage and interwikis to Wikidata, not here! --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:50.949Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ARedirect&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:50 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1065 miss (0), cp3013 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1868440686, 1492448032, 1029493669
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="1649987" pageid="1649987" ns="10" title="Template:Redirect"><revisions><rev user="Mr. Stradivarius" timestamp="2014-08-05T21:42:33Z" comment="convert this to use [[Module:Redirect hatnote]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:redirect hatnote|redirect}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:51.442Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Aredirect+hatnote&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:51 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3031 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165586735, 1371656628, 1029495643
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:redirect hatnote\" to=\"Module:Redirect hatnote\" /></normalized><pages><page _idx=\"42680232\" pageid=\"42680232\" ns=\"828\" title=\"Module:Redirect hatnote\"><revisions><rev\
      \ user=\"Fayenatic london\" timestamp=\"2015-03-02T11:20:27Z\" comment=\"update category, see [[Wikipedia:Categories for discussion/Log/2015 February 21]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[[\n-- This module\
      \ produces a &quot;redirect&quot; hatnote. It looks like this:\n-- '&quot;X&quot; redirects here. For other uses, see Y.'\n-- It implements the {{redirect}} template.\n--]]\n\nlocal mHatnote = require('Module:Hatnote')\nlocal libraryUtil = require('libraryUtil')\n\
      local checkType = libraryUtil.checkType\n\nlocal p = {}\n\nlocal function getTitle(...)\n\tlocal success, titleObj = pcall(mw.title.new, ...)\n\tif success then\n\t\treturn titleObj\n\telse\n\t\treturn nil\n\tend\nend\n\nfunction p.redirect(frame)\n\t\
      -- Get the args table and work out the maximum arg key.\n\tlocal origArgs = frame:getParent().args\n\tlocal args = {}\n\tlocal maxArg = 0\n\tfor k, v in pairs(origArgs) do\n\t\tif type(k) == 'number' and k &gt; maxArg then\n\t\t\tmaxArg = k\n\t\tend\n\t\
      \tv = v:match('^%s*(.-)%s*$') -- Trim whitespace\n\t\tif v ~= '' then\n\t\t\targs[k] = v\n\t\tend\n\tend\n\n\t-- Return an error if no redirect was specified.\n\tlocal redirect = args[1]\n\tif not redirect then\n\t\treturn mHatnote.makeWikitextError(\n\
      \t\t\t'no redirect specified',\n\t\t\t'Template:Redirect#Errors',\n\t\t\targs.category\n\t\t)\n\tend\n\n\t-- Create the data table.\n\tlocal data = {}\n\tlocal iArg = 0\n\tlocal iData = 1\n\trepeat\n\t\tiArg = iArg + 2\n\t\tlocal useTable = data[iData]\
      \ or {}\n\t\tlocal pages = useTable.pages or {}\n\t\tlocal use = args[iArg]\n\t\tlocal page = args[iArg + 1]\n\t\tlocal nextUse = args[iArg + 2]\n\t\tpages[#pages + 1] = page\n\t\tuseTable.pages = pages\n\t\tif use ~= 'and' then\n\t\t\tuseTable.use = use\n\
      \t\tend\n\t\tdata[iData] = useTable\n\t\tif nextUse ~= 'and' then\n\t\t\tiData = iData + 1\n\t\tend\n\tuntil iArg &gt;= maxArg - 1\n\n\t-- Create the options table.\n\tlocal options = {}\n\toptions.selfref = args.selfref\n\t\t\n\treturn p._redirect(redirect,\
      \ data, options)\nend\n\nlocal function formatUseTable(useTable, isFirst, redirect)\n\t-- Formats one use table. Use tables are the tables inside the data array.\n\t-- Each one corresponds to one use. (A use might be the word &quot;cats&quot; in the\n\t\
      -- phrase &quot;For cats, see [[Felines]]&quot;.)\n\t-- Returns a string, or nil if no use was specified.\n\t-- The isFirst parameter is used to apply special formatting for the first\n\t-- table in the data array. If isFirst is specified, the redirect\
      \ parameter\n\tuseTable = useTable or {}\n\tlocal use\n\tif isFirst then\n\t\tuse = useTable.use or 'other uses'\n\telseif not useTable.use then\n\t\treturn nil\n\telseif tonumber(useTable.use) == 1 then\n\t\tuse = 'other uses'\n\telse\n\t\tuse = useTable.use\n\
      \tend\n\tlocal pages = useTable.pages or {}\n\tif isFirst then\n\t\tredirect = redirect or error(\n\t\t\t'isFirst was set in formatUseTable, but no redirect was supplied',\n\t\t\t2\n\t\t)\n\t\tpages[1] = pages[1] or redirect .. ' (disambiguation)'\n\t\
      else\n\t\tpages[1] = pages[1] or useTable.use .. ' (disambiguation)'\n\tend\n\tpages = mHatnote.formatPages(unpack(pages))\n\tpages = mw.text.listToText(pages)\n\treturn string.format(\n\t\t'For %s, see %s.',\n\t\tuse,\n\t\tpages\n\t)\nend\n\nfunction\
      \ p._redirect(redirect, data, options, currentTitle, redirectTitle, targetTitle)\n\t-- Validate the input. Don't bother checking currentTitle, redirectTitle or\n\t-- targetTitle, as they are only used in testing.\n\tcheckType('_redirect', 1, redirect,\
      \ 'string')\n\tcheckType('_redirect', 2, data, 'table', true)\n\tcheckType('_redirect', 3, options, 'table', true)\n\tdata = data or {}\n\toptions = options or {}\n\tcurrentTitle = currentTitle or mw.title.getCurrentTitle()\n\n\t-- Generate the text.\n\
      \tlocal text = {}\n\ttext[#text + 1] = '&quot;' .. redirect .. '&quot; redirects here.'\n\ttext[#text + 1] = formatUseTable(data[1] or {}, true, redirect)\n\tif data[1] and data[1].use and data[1].use ~= 'other uses' then\n\t\tfor i = 2, #data do\n\t\t\
      \ttext[#text + 1] = formatUseTable(data[i] or {}, false)\n\t\tend\n\tend\n\ttext = table.concat(text, ' ')\n\t\n\t-- Generate the tracking category.\n\t-- We don't need a tracking category if the template invocation has been\n\t-- copied directly from\
      \ the docs, or if we aren't in mainspace.\n\tlocal category\n\tif not redirect:find('^REDIRECT%d*$') and redirect ~= 'TERM' -- \n\t\tand currentTitle.namespace == 0\n\tthen\n\t\tredirectTitle = redirectTitle or getTitle(redirect)\n\t\tif not redirectTitle\
      \ or not redirectTitle.exists then\n\t\t\tcategory = 'Missing redirects'\n\t\telseif not redirectTitle.isRedirect then\n\t\t\tcategory = 'Articles with redirect hatnotes needing review'\n\t\telse\n\t\t\tlocal mRedirect = require('Module:Redirect')\n\t\t\
      \tlocal target = mRedirect.getTarget(redirectTitle)\n\t\t\ttargetTitle = targetTitle or target and getTitle(target)\n\t\t\tif targetTitle and targetTitle ~= currentTitle then\n\t\t\t\tcategory = 'Articles with redirect hatnotes needing review'\n\t\t\t\
      end\n\t\tend\n\tend\n\tcategory = category and string.format('[[Category:%s]]', category) or ''\n\n\t-- Generate the options to pass to [[Module:Hatnote]].\n\tlocal mhOptions = {}\n\tif currentTitle.namespace == 0\n\t\tand redirectTitle and redirectTitle.namespace\
      \ ~= 0\n\tthen\n\t\t-- We are on a mainspace page, and the hatnote starts with something\n\t\t-- like &quot;Wikipedia:Foo redirects here&quot;, so automatically label it as a\n\t\t-- self-reference.\n\t\tmhOptions.selfref = true\n\telse\n\t\tmhOptions.selfref\
      \ = options.selfref\n\tend\n\n\treturn mHatnote._hatnote(text, mhOptions) .. category\nend\n \nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:51.891Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AHatnote&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:51 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550961526, 4019092970, 1029497155
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"42498502\" pageid=\"42498502\" ns=\"828\" title=\"Module:Hatnote\"><revisions><rev user=\"Codename Lisa\" timestamp=\"2015-01-16T18:15:24Z\" comment=\"Minor comment change\"\
      \ contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n--                              Module:Hatnote                                --\n--    \
      \                                                                        --\n-- This module produces hatnote links and links to related articles. It       --\n-- implements the {{hatnote}} and {{format link}} meta-templates and includes --\n-- helper functions\
      \ for other Lua hatnote modules.                            --\n--------------------------------------------------------------------------------\n\nlocal libraryUtil = require('libraryUtil')\nlocal checkType = libraryUtil.checkType\nlocal mArguments --\
      \ lazily initialise [[Module:Arguments]]\nlocal yesno -- lazily initialise [[Module:Yesno]]\n\nlocal p = {}\n\n--------------------------------------------------------------------------------\n-- Helper functions\n--------------------------------------------------------------------------------\n\
      \nlocal function getArgs(frame)\n\t-- Fetches the arguments from the parent frame. Whitespace is trimmed and\n\t-- blanks are removed.\n\tmArguments = require('Module:Arguments')\n\treturn mArguments.getArgs(frame, {parentOnly = true})\nend\n\nlocal function\
      \ removeInitialColon(s)\n\t-- Removes the initial colon from a string, if present.\n\treturn s:match('^:?(.*)')\nend\n\nfunction p.findNamespaceId(link, removeColon)\n\t-- Finds the namespace id (namespace number) of a link or a pagename. This\n\t-- function\
      \ will not work if the link is enclosed in double brackets. Colons\n\t-- are trimmed from the start of the link by default. To skip colon\n\t-- trimming, set the removeColon parameter to true.\n\tcheckType('findNamespaceId', 1, link, 'string')\n\tcheckType('findNamespaceId',\
      \ 2, removeColon, 'boolean', true)\n\tif removeColon ~= false then\n\t\tlink = removeInitialColon(link)\n\tend\n\tlocal namespace = link:match('^(.-):')\n\tif namespace then\n\t\tlocal nsTable = mw.site.namespaces[namespace]\n\t\tif nsTable then\n\t\t\t\
      return nsTable.id\n\t\tend\n\tend\n\treturn 0\nend\n\nfunction p.formatPages(...)\n\t-- Formats a list of pages using formatLink and returns it as an array. Nil\n\t-- values are not allowed.\n\tlocal pages = {...}\n\tlocal ret = {}\n\tfor i, page in ipairs(pages)\
      \ do\n\t\tret[i] = p._formatLink(page)\n\tend\n\treturn ret\nend\n\nfunction p.formatPageTables(...)\n\t-- Takes a list of page/display tables and returns it as a list of\n\t-- formatted links. Nil values are not allowed.\n\tlocal pages = {...}\n\tlocal\
      \ links = {}\n\tfor i, t in ipairs(pages) do\n\t\tcheckType('formatPageTables', i, t, 'table')\n\t\tlocal link = t[1]\n\t\tlocal display = t[2]\n\t\tlinks[i] = p._formatLink(link, display)\n\tend\n\treturn links\nend\n\nfunction p.makeWikitextError(msg,\
      \ helpLink, addTrackingCategory)\n\t-- Formats an error message to be returned to wikitext. If\n\t-- addTrackingCategory is not false after being returned from\n\t-- [[Module:Yesno]], and if we are not on a talk page, a tracking category\n\t-- is added.\n\
      \tcheckType('makeWikitextError', 1, msg, 'string')\n\tcheckType('makeWikitextError', 2, helpLink, 'string', true)\n\tyesno = require('Module:Yesno')\n\tlocal title = mw.title.getCurrentTitle()\n\t-- Make the help link text.\n\tlocal helpText\n\tif helpLink\
      \ then\n\t\thelpText = ' ([[' .. helpLink .. '|help]])'\n\telse\n\t\thelpText = ''\n\tend\n\t-- Make the category text.\n\tlocal category\n\tif not title.isTalkPage and yesno(addTrackingCategory) ~= false then\n\t\tcategory = 'Hatnote templates with errors'\n\
      \t\tcategory = string.format(\n\t\t\t'[[%s:%s]]',\n\t\t\tmw.site.namespaces[14].name,\n\t\t\tcategory\n\t\t)\n\telse\n\t\tcategory = ''\n\tend\n\treturn string.format(\n\t\t'&lt;strong class=&quot;error&quot;&gt;Error: %s%s.&lt;/strong&gt;%s',\n\t\tmsg,\n\
      \t\thelpText,\n\t\tcategory\n\t)\nend\n\n--------------------------------------------------------------------------------\n-- Format link\n--\n-- Makes a wikilink from the given link and display values. Links are escaped\n-- with colons if necessary, and\
      \ links to sections are detected and displayed\n-- with &quot; § &quot; as a separator rather than the standard MediaWiki &quot;#&quot;. Used in\n-- the {{format hatnote link}} template.\n--------------------------------------------------------------------------------\n\
      \nfunction p.formatLink(frame)\n\tlocal args = getArgs(frame)\n\tlocal link = args[1]\n\tlocal display = args[2]\n\tif not link then\n\t\treturn p.makeWikitextError(\n\t\t\t'no link specified',\n\t\t\t'Template:Format hatnote link#Errors',\n\t\t\targs.category\n\
      \t\t)\n\tend\n\treturn p._formatLink(link, display)\nend\n\nfunction p._formatLink(link, display)\n\t-- Find whether we need to use the colon trick or not. We need to use the\n\t-- colon trick for categories and files, as otherwise category links\n\t--\
      \ categorise the page and file links display the file.\n\tcheckType('_formatLink', 1, link, 'string')\n\tcheckType('_formatLink', 2, display, 'string', true)\n\tlink = removeInitialColon(link)\n\tlocal namespace = p.findNamespaceId(link, false)\n\tlocal\
      \ colon\n\tif namespace == 6 or namespace == 14 then\n\t\tcolon = ':'\n\telse\n\t\tcolon = ''\n\tend\n\n\t-- Find whether a faux display value has been added with the {{!}} magic\n\t-- word.\n\tif not display then\n\t\tlocal prePipe, postPipe = link:match('^(.-)|(.*)$')\n\
      \t\tlink = prePipe or link\n\t\tdisplay = postPipe\n\tend\n\n\t-- Find the display value.\n\tif not display then\n\t\tlocal page, section = link:match('^(.-)#(.*)$')\n\t\tif page then\n\t\t\tdisplay = page .. ' § ' .. section\n\t\tend\n\tend\n\n\t-- Assemble\
      \ the link.\n\tif display then\n\t\treturn string.format('[[%s%s|%s]]', colon, link, display)\n\telse\n\t\treturn string.format('[[%s%s]]', colon, link)\n\tend\nend\n\n--------------------------------------------------------------------------------\n--\
      \ Hatnote\n--\n-- Produces standard hatnote text. Implements the {{hatnote}} template.\n--------------------------------------------------------------------------------\n\nfunction p.hatnote(frame)\n\tlocal args = getArgs(frame)\n\tlocal s = args[1]\n\t\
      local options = {}\n\tif not s then\n\t\treturn p.makeWikitextError(\n\t\t\t'no text specified',\n\t\t\t'Template:Hatnote#Errors',\n\t\t\targs.category\n\t\t)\n\tend\n\toptions.extraclasses = args.extraclasses\n\toptions.selfref = args.selfref\n\treturn\
      \ p._hatnote(s, options)\nend\n\nfunction p._hatnote(s, options)\n\tcheckType('_hatnote', 1, s, 'string')\n\tcheckType('_hatnote', 2, options, 'table', true)\n\tlocal classes = {'hatnote'}\n\tlocal extraclasses = options.extraclasses\n\tlocal selfref =\
      \ options.selfref\n\tif type(extraclasses) == 'string' then\n\t\tclasses[#classes + 1] = extraclasses\n\tend\n\tif selfref then\n\t\tclasses[#classes + 1] = 'selfref'\n\tend\n\treturn string.format(\n\t\t'&lt;div class=&quot;%s&quot;&gt;%s&lt;/div&gt;',\n\
      \t\ttable.concat(classes, ' '),\n\t\ts\n\t)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:52.224Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AIPAc-en&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:52 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464549687, 123539657, 1029499158
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="24747137" pageid="24747137" ns="10" title="Template:IPAc-en"><revisions><rev user="Mr. Stradivarius" timestamp="2015-06-19T01:47:04Z" comment="convert to Lua version at [[Module:IPAc-en]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:IPAc-en|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:52.563Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AIPAc-en&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:52 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3008 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791338523, 3578334807, 1029501110
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"47001391\" pageid=\"47001391\" ns=\"828\" title=\"Module:IPAc-en\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2015-06-19T01:47:43Z\" comment=\"Protected Module:IPAc-en:\
      \ [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--\
      \ This module implements [[Template:IPAc-en]].\n\nlocal data = mw.loadData('Module:IPAc-en/data')\nlocal p = {}\n\n-- Global container for tracking categories\nlocal categories = {}\n\n-- Trims whitespace from a string\nlocal function trim(s)\n\treturn\
      \ s:match('^%s*(.-)%s*$')\nend\n\n-- This implements [[Template:Nowrap]].\nlocal function makeNowrapSpan(s)\n\tlocal span = mw.html.create('span')\n\t\t:addClass('nowrap')\n\t\t:wikitext(s)\n\treturn tostring(span)\nend\n\nlocal function makePronunciationText(id)\n\
      \tid = id and string.lower(trim(id))\n\tif id and id ~= '' and data.pronunciation[id] then\n\t\treturn data.pronunciation[id].text\n\tend\nend\n\nlocal function getFilepath(file)\n\treturn mw.getCurrentFrame():callParserFunction('filepath', file)\nend\n\
      \nlocal function makeAudioLink(file)\n\tcategories[&quot;Articles including recorded pronunciations&quot;] = true\n\tlocal span = mw.html.create('span')\n\tspan\n\t\t:addClass('noexcerpt')\n\t\t:wikitext(string.format(\n\t\t\t'[[File:Speakerlink-new.svg|11px|link=%s|Listen]]',\n\
      \t\t\tgetFilepath(file)\n\t\t))\n\t\t:tag('sup')\n\t\t\t:tag('span')\n\t\t\t\t:css('color', '#00e')\n\t\t\t\t:css('font', 'bold 80% sans-serif')\n\t\t\t\t:css('padding', '0 .1em')\n\t\t\t\t:addClass('IPA')\n\t\t\t\t:wikitext(string.format('[[:File:%s|i]]',\
      \ file))\n\treturn tostring(span)\nend\n\n-- This adds a tooltip icon to a label. It implements [[Template:H:title]].\nlocal function makeTooltip(label, tooltip)\n\tlocal span = mw.html.create('span')\n\t\t:attr('title', tooltip)\n\t\t:wikitext(label)\n\
      \treturn tostring(span)\nend\n\nlocal function formatPhonemeGroup(phonemes)\n\tif #phonemes &gt; 0 then\n\t\tlocal span = mw.html.create('span')\n\t\t\t:css('border-bottom', '1px dotted')\n\t\t\t:wikitext(table.concat(phonemes))\n\t\treturn tostring(span)\n\
      \telse\n\t\treturn ''\n\tend\nend\n\nlocal function renderCategories()\n\tlocal ret = {}\n\tfor cat in pairs(categories) do\n\t\ttable.insert(ret, string.format('[[Category:%s]]', cat))\n\tend\n\ttable.sort(ret)\n\treturn table.concat(ret)\nend\n\nfunction\
      \ p._main(args)\n\tlocal ret = {}\n\tlocal i = 0 -- Keeps track of numbered args\n\n\t-- Pronunciation\n\tdo\n\t\tlocal pron = {}\n\t\twhile true do\n\t\t\ti = i + 1\n\t\t\tlocal pronItem = makePronunciationText(args[i])\n\t\t\tif pronItem then\n\t\t\t\
      \tpron[#pron + 1] = pronItem\n\t\t\t\tpron[#pron + 1] = ' '\n\t\t\telse\n\t\t\t\tbreak\n\t\t\tend\n\t\tend\n\t\tif #pron &gt; 0 then\n\t\t\tret[#ret + 1] = string.format(\n\t\t\t\t'&lt;small&gt;%s&lt;/small&gt;',\n\t\t\t\ttable.concat(pron)\n\t\t\t)\n\t\
      \tend\n\tend\n\n\t-- Audio link\n\tdo\n\t\tlocal file = args.audio and trim(args.audio)\n\t\tif file and file ~= '' then\n\t\t\tret[#ret + 1] = makeAudioLink(file)\n\t\tend\n\tend\n\n\t-- Phonemes\n\tdo\n\t\t-- Loop through the numbered args, separating\
      \ them into phoneme groups\n\t\t-- and separator strings (both called &quot;words&quot; for convenience). We only\n\t\t-- underline the phoneme groups, not the separators.\n\t\tlocal words = {}\n\t\twords[#words + 1] = '/' -- Opening slash\n\t\ti = i -\
      \ 1 -- Set up i again as it was changed in the pronunciation loop\n\t\tlocal id\n\t\trepeat\n\t\t\tlocal phonemes = {}\n\t\t\tlocal isWordEnd = false\n\t\t\twhile not isWordEnd do\n\t\t\t\ti = i + 1\n\t\t\t\tid = args[i]\n\t\t\t\tid = id and trim(id)\n\
      \t\t\t\tif not id then\n\t\t\t\t\tisWordEnd = true\n\t\t\t\t\twords[#words + 1] = formatPhonemeGroup(phonemes)\n\t\t\t\telseif id ~= '' then\n\t\t\t\t\tlocal t = data.phonemes[id]\n\t\t\t\t\tif not t then\n\t\t\t\t\t\t-- We were passed an invalid id.\n\
      \t\t\t\t\t\tisWordEnd = true\n\t\t\t\t\t\tcategories[&quot;Ill-formatted IPAc-en transclusions&quot;] = true\n\t\t\t\t\t\twords[#words + 1] = formatPhonemeGroup(phonemes)\n\t\t\t\t\t\twords[#words + 1] = makeTooltip(\n\t\t\t\t\t\t\t&quot;'''[unsupported\
      \ input]'''&quot;,\n\t\t\t\t\t\t\t'Unrecognized symbol'\n\t\t\t\t\t\t)\n\t\t\t\t\telseif not t.label then\n\t\t\t\t\t\t-- The data module contains bad data, so throw an error.\n\t\t\t\t\t\terror(string.format(\n\t\t\t\t\t\t\t&quot;no label was found for\
      \ id '%s'&quot;,\n\t\t\t\t\t\t\ttostring(id)\n\t\t\t\t\t\t))\n\t\t\t\t\telseif t.tooltip then\n\t\t\t\t\t\t-- We are dealing with a regular phoneme.\n\t\t\t\t\t\tphonemes[#phonemes + 1] = makeTooltip(\n\t\t\t\t\t\t\tt.label,\n\t\t\t\t\t\t\tt.tooltip\n\t\
      \t\t\t\t\t)\n\t\t\t\t\telse\n\t\t\t\t\t\t-- We are dealing with a separator.\n\t\t\t\t\t\tisWordEnd = true\n\t\t\t\t\t\twords[#words + 1] = formatPhonemeGroup(phonemes)\n\t\t\t\t\t\twords[#words + 1] = t.label\t\t\t\t\t\t\n\t\t\t\t\tend\n\t\t\t\tend\n\t\
      \t\tend\n\t\tuntil not id\n\t\twords[#words + 1] = '/' -- Closing slash\n\n\t\t-- Wrap the words in a link to IPA help.\n\t\tlocal span = mw.html.create('span')\n\t\t\t:addClass('IPA nopopups')\n\t\t\t:wikitext(string.format(\n\t\t\t\t'[[Help:IPA for English|%s]]',\n\
      \t\t\t\ttable.concat(words)\n\t\t\t))\n\n\t\tret[#ret + 1] = tostring(span)\n\tend\n\n\t-- Nowrap and categories\n\tret = makeNowrapSpan(table.concat(ret)) .. renderCategories()\n\n\t-- Reset the categories table in case we are run again.\n\tcategories\
      \ = {}\n\n\treturn ret\nend\n\nfunction p.main(frame)\n\treturn p._main(frame:getParent().args)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:52.843Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AIPAc-en%2Fdata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:52 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1055 miss (0), cp3040 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1017469574, 2605860153, 1029502032
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"47002254\" pageid=\"47002254\" ns=\"828\" title=\"Module:IPAc-en/data\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2015-06-19T11:38:13Z\" comment=\"switch to main\
      \ data modules\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module processes data for [[Module:IPAc-en]]. It is intended to be\n-- loaded with mw.loadData.\n\nlocal PRONUNCIATION_MODULE = 'Module:IPAc-en/pronunciation'\n\
      local PHONEME_MODULE = 'Module:IPAc-en/phonemes'\n\nlocal function makeData(oldData)\n\tlocal newData = {}\n\tfor i, old in ipairs(oldData) do\n\t\tlocal new = {}\n\t\tfor k, v in pairs(old) do\n\t\t\tif k ~= 'aliases' and k ~= 'code' then\n\t\t\t\tnew[k]\
      \ = v\n\t\t\tend\n\t\tend\n\t\tnewData[old.code] = new\n\t\tif old.aliases then\n\t\t\tfor i, alias in ipairs(old.aliases) do\n\t\t\t\tnewData[alias] = new\n\t\t\tend\t\t\t\n\t\tend\n\tend\n\treturn newData\nend\n\nlocal function main()\n\tlocal pronunciation\
      \ = makeData(require(PRONUNCIATION_MODULE))\n\tlocal phonemes = makeData(require(PHONEME_MODULE))\n\n\t-- Check that no pronunciation keys are also contained in the phonemes\n\t-- data. This would cause silent, hard-to-debug errors if it went\n\t-- unchecked,\
      \ so  make it cause a big red error message instead.\n\tfor id in pairs(pronunciation) do\n\t\tif phonemes[id] then\n\t\t\terror(string.format(\n\t\t\t\t&quot;duplicate ID '%s' found in %s and %s&quot;,\n\t\t\t\tid,\n\t\t\t\tPRONUNCIATION_MODULE,\n\t\t\
      \t\tPHONEME_MODULE\n\t\t\t))\n\t\tend\n\tend\n\n\treturn {\n\t\tpronunciation = pronunciation,\n\t\tphonemes = phonemes,\n\t}\nend\n\nreturn main()</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:53.032Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AIPAc-en%2Fpronunciation&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:52 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3040 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550963236, 2605860286, 1029503235
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"47002555\" pageid=\"47002555\" ns=\"828\" title=\"Module:IPAc-en/pronunciation\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2015-06-19T11:37:37Z\" comment=\"use ordered\
      \ data for easier doc generation\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module contains pronunciation-key data for [[Module:IPAc-en]].\n\nreturn {\n\t{\n\t\tcode = 'lang',\n\t\taliases = {'english'},\n\t\
      \ttext = 'English'\n\t},\n\t{\n\t\tcode = 'pron',\n\t\taliases = {'pronunciation'},\n\t\ttext = 'pronunciation:'\n\t},\n\t{\n\t\tcode = 'local',\n\t\ttext = 'local'\n\t},\n\t{\n\t\tcode = 'ipa',\n\t\ttext = '[[International Phonetic Alphabet|IPA]]'\n\t\
      },\n\t{\n\t\tcode = 'aus',\n\t\ttext = '[[Australian English|AU]]'\n\t},\n\t{\n\t\tcode = 'ca',\n\t\ttext = '[[Canadian English|CA]]'\n\t},\n\t{\n\t\tcode = 'ie',\n\t\ttext = '[[Irish English|IE]]'\n\t},\n\t{\n\t\tcode = 'nz',\n\t\ttext = '[[New Zealand\
      \ English|NZ]]'\n\t},\n\t{\n\t\tcode = 'uk',\n\t\ttext = '[[British English|UK]]'\n\t},\n\t{\n\t\tcode = 'us',\n\t\ttext = '[[American English|US]]'\n\t},\n\t{\n\t\tcode = 'za',\n\t\ttext = '[[South African English|ZA]]'\n\t},\n}</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:53.343Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AIPAc-en%2Fphonemes&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:53 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165590004, 1778185844, 1029504012
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"47001902\" pageid=\"47001902\" ns=\"828\" title=\"Module:IPAc-en/phonemes\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2015-06-19T11:37:48Z\" comment=\"use ordered\
      \ data for easier doc generation\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module contains phoneme data for [[Module:IPAc-en]].\n\nreturn {\n\t{\n\t\tcode = &quot;b&quot;,\n\t\tlabel = &quot;b&quot;,\n\t\t\
      tooltip = &quot;'b' in 'buy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;d&quot;,\n\t\tlabel = &quot;d&quot;,\n\t\ttooltip = &quot;'d' in 'dye'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ᵈ&quot;,\n\t\taliases = {&quot;(d)&quot;},\n\t\tlabel = &quot;ᵈ&quot;,\n\t\ttooltip\
      \ = &quot;optional 'd'&quot;,\n\t},\n\t{\n\t\tcode = &quot;dj&quot;,\n\t\taliases = {&quot;dy&quot;, &quot;dʲ&quot;},\n\t\tlabel = &quot;dj&quot;,\n\t\ttooltip = &quot;/dj/ 'd' in 'dew'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ð&quot;,\n\t\taliases = {&quot;D&quot;,\
      \ &quot;dh&quot;},\n\t\tlabel = &quot;ð&quot;,\n\t\ttooltip = &quot;/ð/ 'th' in 'thy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;dʒ&quot;,\n\t\taliases = {&quot;J&quot;, &quot;dZ&quot;, &quot;dzh&quot;, &quot;ʤ&quot;},\n\t\tlabel = &quot;dʒ&quot;,\n\t\ttooltip\
      \ = &quot;/dʒ/ 'j' in 'jam'&quot;,\n\t},\n\t{\n\t\tcode = &quot;f&quot;,\n\t\tlabel = &quot;f&quot;,\n\t\ttooltip = &quot;'f' in 'find'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɡ&quot;,\n\t\taliases = {&quot;g&quot;},\n\t\tlabel = &quot;ɡ&quot;,\n\t\ttooltip\
      \ = &quot;'g' in 'guy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;h&quot;,\n\t\tlabel = &quot;h&quot;,\n\t\ttooltip = &quot;'h' in 'hi'&quot;,\n\t},\n\t{\n\t\tcode = &quot;j&quot;,\n\t\taliases = {&quot;y&quot;},\n\t\tlabel = &quot;j&quot;,\n\t\ttooltip = &quot;/j/\
      \ 'y' in 'yes'&quot;,\n\t},\n\t{\n\t\tcode = &quot;k&quot;,\n\t\tlabel = &quot;k&quot;,\n\t\ttooltip = &quot;'k' in 'kind'&quot;,\n\t},\n\t{\n\t\tcode = &quot;l&quot;,\n\t\taliases = {&quot;ɫ&quot;},\n\t\tlabel = &quot;l&quot;,\n\t\ttooltip = &quot;'l'\
      \ in 'lie'&quot;,\n\t},\n\t{\n\t\tcode = &quot;lj&quot;,\n\t\taliases = {&quot;ly&quot;, &quot;lʲ&quot;},\n\t\tlabel = &quot;lj&quot;,\n\t\ttooltip = &quot;/lj/ 'l' in 'lute'&quot;,\n\t},\n\t{\n\t\tcode = &quot;m&quot;,\n\t\tlabel = &quot;m&quot;,\n\t\t\
      tooltip = &quot;'m' in 'my'&quot;,\n\t},\n\t{\n\t\tcode = &quot;n&quot;,\n\t\tlabel = &quot;n&quot;,\n\t\ttooltip = &quot;'n' in 'no'&quot;,\n\t},\n\t{\n\t\tcode = &quot;nj&quot;,\n\t\taliases = {&quot;ny&quot;, &quot;nʲ&quot;},\n\t\tlabel = &quot;nj&quot;,\n\
      \t\ttooltip = &quot;/nj/ 'n' in 'new'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ŋ&quot;,\n\t\taliases = {&quot;N&quot;, &quot;ng&quot;},\n\t\tlabel = &quot;ŋ&quot;,\n\t\ttooltip = &quot;/ŋ/ 'ng' in 'sing'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ŋg&quot;,\n\t\taliases\
      \ = {&quot;ngg&quot;, &quot;Ng&quot;},\n\t\tlabel = &quot;ŋɡ&quot;,\n\t\ttooltip = &quot;/ŋɡ/ 'ng' in 'finger'&quot;,\n\t},\n\t{\n\t\tcode = &quot;θ&quot;,\n\t\taliases = {&quot;T&quot;, &quot;th&quot;},\n\t\tlabel = &quot;θ&quot;,\n\t\ttooltip = &quot;/θ\
      / 'th' in 'thigh'&quot;,\n\t},\n\t{\n\t\tcode = &quot;θj&quot;,\n\t\taliases = {&quot;thy&quot;, &quot;thj&quot;, &quot;θʲ&quot;},\n\t\tlabel = &quot;θj&quot;,\n\t\ttooltip = &quot;/θj/ 'th' in 'enthusiasm'&quot;,\n\t},\n\t{\n\t\tcode = &quot;p&quot;,\n\
      \t\tlabel = &quot;p&quot;,\n\t\ttooltip = &quot;'p' in 'pie'&quot;,\n\t},\n\t{\n\t\tcode = &quot;r&quot;,\n\t\taliases = {&quot;ɹ&quot;, &quot;ɻ&quot;},\n\t\tlabel = &quot;r&quot;,\n\t\ttooltip = &quot;'r' in 'rye'&quot;,\n\t},\n\t{\n\t\tcode = &quot;s&quot;,\n\
      \t\tlabel = &quot;s&quot;,\n\t\ttooltip = &quot;'s' in 'sigh'&quot;,\n\t},\n\t{\n\t\tcode = &quot;sj&quot;,\n\t\taliases = {&quot;sy&quot;, &quot;sʲ&quot;},\n\t\tlabel = &quot;sj&quot;,\n\t\ttooltip = &quot;/sj/ 's' in 'suit'&quot;,\n\t},\n\t{\n\t\tcode\
      \ = &quot;ʃ&quot;,\n\t\taliases = {&quot;S&quot;, &quot;sh&quot;},\n\t\tlabel = &quot;ʃ&quot;,\n\t\ttooltip = &quot;/ʃ/ 'sh' in 'shy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;t&quot;,\n\t\tlabel = &quot;t&quot;,\n\t\ttooltip = &quot;'t' in 'tie'&quot;,\n\t\
      },\n\t{\n\t\tcode = &quot;ᵗ&quot;,\n\t\taliases = {&quot;(t)&quot;},\n\t\tlabel = &quot;ᵗ&quot;,\n\t\ttooltip = &quot;optional 't'&quot;,\n\t},\n\t{\n\t\tcode = &quot;tj&quot;,\n\t\taliases = {&quot;ty&quot;, &quot;tʲ&quot;},\n\t\tlabel = &quot;tj&quot;,\n\
      \t\ttooltip = &quot;/tj/ 't' in 'tune'&quot;,\n\t},\n\t{\n\t\tcode = &quot;tʃ&quot;,\n\t\taliases = {&quot;C&quot;, &quot;ch&quot;, &quot;tS&quot;, &quot;ʧ&quot;},\n\t\tlabel = &quot;tʃ&quot;,\n\t\ttooltip = &quot;/tʃ/ 'ch' in 'china'&quot;,\n\t},\n\t\
      {\n\t\tcode = &quot;v&quot;,\n\t\tlabel = &quot;v&quot;,\n\t\ttooltip = &quot;'v' in 'vie'&quot;,\n\t},\n\t{\n\t\tcode = &quot;w&quot;,\n\t\tlabel = &quot;w&quot;,\n\t\ttooltip = &quot;'w' in 'wind'&quot;,\n\t},\n\t{\n\t\tcode = &quot;hw&quot;,\n\t\taliases\
      \ = {&quot;ʍ&quot;, &quot;wh&quot;},\n\t\tlabel = &quot;hw&quot;,\n\t\ttooltip = &quot;/hw/ 'wh' in 'why'&quot;,\n\t},\n\t{\n\t\tcode = &quot;z&quot;,\n\t\tlabel = &quot;z&quot;,\n\t\ttooltip = &quot;'z' in 'Zion'&quot;,\n\t},\n\t{\n\t\tcode = &quot;zj&quot;,\n\
      \t\taliases = {&quot;zy&quot;, &quot;zʲ&quot;},\n\t\tlabel = &quot;zj&quot;,\n\t\ttooltip = &quot;/zj/ 'z' in 'Zeus'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʒ&quot;,\n\t\taliases = {&quot;Z&quot;, &quot;zh&quot;},\n\t\tlabel = &quot;ʒ&quot;,\n\t\ttooltip =\
      \ &quot;/ʒ/ 's' in 'pleasure'&quot;,\n\t},\n\t{\n\t\tcode = &quot;x&quot;,\n\t\taliases = {&quot;kh&quot;},\n\t\tlabel = &quot;x&quot;,\n\t\ttooltip = &quot;/x/ 'ch' in 'loch'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʔ&quot;,\n\t\taliases = {&quot;?&quot;},\n\
      \t\tlabel = &quot;ʔ&quot;,\n\t\ttooltip = &quot;/ʔ/ the catch in 'uh-oh'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɑː&quot;,\n\t\taliases = {&quot;A:&quot;, &quot;ah&quot;, &quot;aa&quot;, &quot;ɑ:&quot;, &quot;ä&quot;, &quot;â&quot;},\n\t\tlabel = &quot;ɑː\
      &quot;,\n\t\ttooltip = &quot;/ɑː/ 'a' in 'father'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɑr&quot;,\n\t\taliases = {&quot;ar&quot;, &quot;ɑɹ&quot;, &quot;är&quot;, &quot;âr&quot;, &quot;aːr&quot;, &quot;a:r&quot;, &quot;ɑ:r&quot;, &quot;ɑːr&quot;},\n\t\tlabel\
      \ = &quot;ɑr&quot;,\n\t\ttooltip = &quot;/ɑr/ 'ar' in 'bard'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɒ&quot;,\n\t\taliases = {&quot;Q&quot;, &quot;ŏ&quot;},\n\t\tlabel = &quot;ɒ&quot;,\n\t\ttooltip = &quot;/ɒ/ short 'o' in 'body'&quot;,\n\t},\n\t{\n\t\tcode\
      \ = &quot;ɒː&quot;,\n\t\taliases = {&quot;Q:&quot;},\n\t\tlabel = &quot;ɒː&quot;,\n\t\ttooltip = &quot;/ɒː/ 'o' in 'coffee'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɒ̃&quot;,\n\t\taliases = {&quot;ɑ̃&quot;, &quot;ɒ~&quot;, &quot;ɑ~&quot;, &quot;ã&quot;, &quot;a~&quot;,\
      \ &quot;Q~&quot;},\n\t\tlabel = &quot;ɒ̃&quot;,\n\t\ttooltip = &quot;/ɒ̃/ nasal 'an' in 'vin blanc'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɒr&quot;,\n\t\taliases = {&quot;ŏr&quot;, &quot;Qr&quot;},\n\t\tlabel = &quot;ɒr&quot;,\n\t\ttooltip = &quot;/ɒr/ 'or'\
      \ in 'moral'&quot;,\n\t},\n\t{\n\t\tcode = &quot;æ&quot;,\n\t\taliases = {&quot;ae&quot;, &quot;&amp;&quot;, &quot;{&quot;, &quot;}&quot;, &quot;ă&quot;},\n\t\tlabel = &quot;æ&quot;,\n\t\ttooltip = &quot;/æ/ short 'a' in 'bad'&quot;,\n\t},\n\t{\n\t\tcode\
      \ = &quot;aː&quot;,\n\t\taliases = {&quot;a:&quot;},\n\t\tlabel = &quot;aː&quot;,\n\t\ttooltip = &quot;/aː/ 'a' in 'bath'&quot;,\n\t},\n\t{\n\t\tcode = &quot;aɪ&quot;,\n\t\taliases = {&quot;ai&quot;, &quot;aI&quot;, &quot;ye&quot;, &quot;eye&quot;, &quot;ī\
      &quot;},\n\t\tlabel = &quot;aɪ&quot;,\n\t\ttooltip = &quot;/aɪ/ long 'i' in 'tide'&quot;,\n\t},\n\t{\n\t\tcode = &quot;aɪər&quot;,\n\t\taliases = {&quot;aɪr&quot;, &quot;aIr&quot;, &quot;īr&quot;, &quot;aɪə&quot;, &quot;yr&quot;},\n\t\tlabel = &quot;aɪ\
      ər&quot;,\n\t\ttooltip = &quot;/aɪər/ 'ire' in 'fire'&quot;,\n\t},\n\t{\n\t\tcode = &quot;aʊ&quot;,\n\t\taliases = {&quot;au&quot;, &quot;aU&quot;, &quot;ow&quot;},\n\t\tlabel = &quot;aʊ&quot;,\n\t\ttooltip = &quot;/aʊ/ 'ou' in 'pout'&quot;,\n\t},\n\t\
      {\n\t\tcode = &quot;aʊər&quot;,\n\t\taliases = {&quot;aʊr&quot;, &quot;aUr&quot;, &quot;aʊə&quot;, &quot;aur&quot;},\n\t\tlabel = &quot;aʊər&quot;,\n\t\ttooltip = &quot;/aʊər/ 'our' in 'hour'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɛ&quot;,\n\t\taliases =\
      \ {&quot;E&quot;, &quot;ĕ&quot;},\n\t\tlabel = &quot;ɛ&quot;,\n\t\ttooltip = &quot;/ɛ/ short 'e' in 'bed'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɛr&quot;,\n\t\taliases = {&quot;Er&quot;, &quot;ĕr&quot;, &quot;err&quot;},\n\t\tlabel = &quot;ɛr&quot;,\n\t\t\
      tooltip = &quot;/ɛr/ 'err' in 'merry'&quot;,\n\t},\n\t{\n\t\tcode = &quot;eɪ&quot;,\n\t\taliases = {&quot;ei&quot;, &quot;eI&quot;, &quot;ay&quot;, &quot;ā&quot;, &quot;eː&quot;, &quot;e:&quot;},\n\t\tlabel = &quot;eɪ&quot;,\n\t\ttooltip = &quot;/eɪ/ long\
      \ 'a' in 'base'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ær&quot;,\n\t\taliases = {&quot;aer&quot;, &quot;&amp;r&quot;, &quot;æɹ&quot;, &quot;ăr&quot;, &quot;arr&quot;},\n\t\tlabel = &quot;ær&quot;,\n\t\ttooltip = &quot;/ær/ 'arr' in 'marry'&quot;,\n\t},\n\t\
      {\n\t\tcode = &quot;ɛər&quot;,\n\t\taliases = {&quot;eir&quot;, &quot;eIr&quot;, &quot;e@r&quot;, &quot;E@r&quot;, &quot;air&quot;, &quot;ɛɪɹ&quot;, &quot;eɪr&quot;, &quot;eːr&quot;, &quot;e:r&quot;, &quot;ɛəɹ&quot;, &quot;ār&quot;, &quot;ɛə&quot;},\n\t\
      \tlabel = &quot;ɛər&quot;,\n\t\ttooltip = &quot;/ɛər/ 'are' in 'bare'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɪ&quot;,\n\t\taliases = {&quot;I&quot;, &quot;ĭ&quot;},\n\t\tlabel = &quot;ɪ&quot;,\n\t\ttooltip = &quot;/ɪ/ short 'i' in 'bid'&quot;,\n\t},\n\t{\n\
      \t\tcode = &quot;ɪr&quot;,\n\t\taliases = {&quot;ĭr&quot;, &quot;irr&quot;},\n\t\tlabel = &quot;ɪr&quot;,\n\t\ttooltip = &quot;/ɪr/ 'irr' in 'mirror'&quot;,\n\t},\n\t{\n\t\tcode = &quot;iː&quot;,\n\t\taliases = {&quot;i:&quot;, &quot;ee&quot;, &quot;ē\
      &quot;},\n\t\tlabel = &quot;iː&quot;,\n\t\ttooltip = &quot;/iː/ long 'e' in 'bead'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɪər&quot;,\n\t\taliases = {&quot;i:r&quot;, &quot;iːr&quot;, &quot;I@r&quot;, &quot;i@r&quot;, &quot;eer&quot;, &quot;ɪəɹ&quot;, &quot;iː\
      ɹ&quot;, &quot;ēr&quot;, &quot;ɪə&quot;},\n\t\tlabel = &quot;ɪər&quot;,\n\t\ttooltip = &quot;/ɪər/ 'ear' in 'beard'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ⁱ&quot;,\n\t\taliases = {&quot;(i)&quot;, &quot;(ɪ)&quot;},\n\t\tlabel = &quot;ⁱ&quot;,\n\t\ttooltip\
      \ = &quot;/ⁱ/ optional 'i' in 'nasturtium'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ᵊ&quot;,\n\t\taliases = {&quot;(ə)&quot;, &quot;(@)&quot;},\n\t\tlabel = &quot;ᵊ&quot;,\n\t\ttooltip = &quot;/ᵊ/ optional 'ə' in 'jewelry'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʲ\
      &quot;,\n\t\taliases = {&quot;(j)&quot;, &quot;(y)&quot;, &quot;ʸ&quot;},\n\t\tlabel = &quot;ʲ&quot;,\n\t\ttooltip = &quot;/ʲ/ optional 'j' in 'Lucas'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɔː&quot;,\n\t\taliases = {&quot;O&quot;, &quot;O:&quot;, &quot;aw&quot;,\
      \ &quot;ɔ:&quot;, &quot;ô&quot;},\n\t\tlabel = &quot;ɔː&quot;,\n\t\ttooltip = &quot;/ɔː/ 'au' in 'fraud'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɔr&quot;,\n\t\taliases = {&quot;Or&quot;, &quot;awr&quot;, &quot;ɔɹ&quot;, &quot;ôr&quot;, &quot;ɔ(r)&quot;},\n\
      \t\tlabel = &quot;ɔr&quot;,\n\t\ttooltip = &quot;/ɔr/ 'or' in 'born'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɔɪ&quot;,\n\t\taliases = {&quot;oj&quot;, &quot;ɔj&quot;, &quot;oi&quot;, &quot;oɪ&quot;, &quot;ɔi&quot;, &quot;OI&quot;, &quot;oy&quot;},\n\t\tlabel\
      \ = &quot;ɔɪ&quot;,\n\t\ttooltip = &quot;/ɔɪ/ 'oy' in 'boy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɔɪər&quot;,\n\t\taliases = {&quot;ɔɪr&quot;, &quot;oyr&quot;, &quot;ɔɪə&quot;},\n\t\tlabel = &quot;ɔɪər&quot;,\n\t\ttooltip = &quot;/ɔɪər/ 'oir' in 'loir' (rare)&quot;,\n\
      \t},\n\t{\n\t\tcode = &quot;oʊ&quot;,\n\t\taliases = {&quot;o:&quot;, &quot;oː&quot;, &quot;ou&quot;, &quot;oU&quot;, &quot;@u&quot;, &quot;@U&quot;, &quot;oh&quot;, &quot;oe&quot;, &quot;əʊ&quot;, &quot;əu&quot;, &quot;ɔʊ&quot;, &quot;ɔu&quot;, &quot;ō\
      &quot;},\n\t\tlabel = &quot;oʊ&quot;,\n\t\ttooltip = &quot;/oʊ/ long 'o' in 'code'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɔər&quot;,\n\t\taliases = {&quot;oUr&quot;, &quot;ohr&quot;, &quot;ɔəɹ&quot;, &quot;ɔʊɹ&quot;, &quot;oʊɹ&quot;, &quot;oʊr&quot;, &quot;oː\
      r&quot;, &quot;o:r&quot;, &quot;ōr&quot;, &quot;ɔə&quot;, &quot;ɔə(r)&quot;},\n\t\tlabel = &quot;ɔər&quot;,\n\t\ttooltip = &quot;/ɔər/ 'ore' in 'bore'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʊ&quot;,\n\t\taliases = {&quot;U&quot;, &quot;uu&quot;, &quot;ŏŏ\
      &quot;},\n\t\tlabel = &quot;ʊ&quot;,\n\t\ttooltip = &quot;/ʊ/ short 'oo' in 'foot'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʊr&quot;,\n\t\taliases = {&quot;uur&quot;, &quot;Ur&quot;, &quot;ŏŏr&quot;},\n\t\tlabel = &quot;ʊr&quot;,\n\t\ttooltip = &quot;/ʊr/ 'our'\
      \ in 'courier'&quot;,\n\t},\n\t{\n\t\tcode = &quot;uː&quot;,\n\t\taliases = {&quot;u:&quot;, &quot;oo&quot;, &quot;ōō&quot;},\n\t\tlabel = &quot;uː&quot;,\n\t\ttooltip = &quot;/uː/ long 'oo' in 'food'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʊər&quot;,\n\t\t\
      aliases = {&quot;u:r&quot;, &quot;uːr&quot;, &quot;u@r&quot;, &quot;U@r&quot;, &quot;oor&quot;, &quot;ʊəɹ&quot;, &quot;ōōr&quot;, &quot;ʊə&quot;},\n\t\tlabel = &quot;ʊər&quot;,\n\t\ttooltip = &quot;/ʊər/ 'our' in 'tour'&quot;,\n\t},\n\t{\n\t\tcode = &quot;juː\
      &quot;,\n\t\taliases = {&quot;ju:&quot;, &quot;yu:&quot;, &quot;yew&quot;, &quot;ew&quot;, &quot;ū&quot;, &quot;yoo&quot;},\n\t\tlabel = &quot;juː&quot;,\n\t\ttooltip = &quot;/juː/ long 'u' in 'cute'&quot;,\n\t},\n\t{\n\t\tcode = &quot;jʊər&quot;,\n\t\t\
      aliases = {&quot;ūr&quot;, &quot;yoor&quot;, &quot;ju:r&quot;, &quot;juːr&quot;, &quot;jʊə&quot;},\n\t\tlabel = &quot;jʊər&quot;,\n\t\ttooltip = &quot;/jʊər/ 'ure' in 'cure'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʌ&quot;,\n\t\taliases = {&quot;V&quot;, &quot;ŭ\
      &quot;},\n\t\tlabel = &quot;ʌ&quot;,\n\t\ttooltip = &quot;/ʌ/ short 'u' in 'bud'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʌr&quot;,\n\t\taliases = {&quot;urr&quot;, &quot;Vr&quot;, &quot;ʌɹ&quot;, &quot;ŭr&quot;},\n\t\tlabel = &quot;ʌr&quot;,\n\t\ttooltip =\
      \ &quot;/ʌr/ 'urr' in 'hurry'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɜr&quot;,\n\t\taliases = {&quot;3&quot;, &quot;3:&quot;, &quot;ɝː&quot;, &quot;ɝ&quot;, &quot;ɜː&quot;, &quot;ɜ:&quot;, &quot;ɜ&quot;, &quot;3r&quot;, &quot;3:r&quot;, &quot;@:r&quot;, &quot;@:&quot;,\
      \ &quot;ɜɹ&quot;, &quot;ûr&quot;, &quot;ɜ(r)&quot;},\n\t\tlabel = &quot;ɜr&quot;,\n\t\ttooltip = &quot;/ɜr/ 'ir' in 'bird'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ə&quot;,\n\t\taliases = {&quot;schwa&quot;, &quot;@&quot;},\n\t\tlabel = &quot;ə&quot;,\n\t\t\
      tooltip = &quot;/ə/ 'a' in 'about'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ər&quot;,\n\t\taliases = {&quot;ɚ&quot;, &quot;@r&quot;, &quot;əɹ&quot;, &quot;ə(r)&quot;},\n\t\tlabel = &quot;ər&quot;,\n\t\ttooltip = &quot;/ər/ 'er' in 'finger'&quot;,\n\t},\n\t\
      {\n\t\tcode = &quot;ən&quot;,\n\t\taliases = {&quot;@n&quot;, &quot;ᵊn&quot;, &quot;n̩&quot;},\n\t\tlabel = &quot;ən&quot;,\n\t\ttooltip = &quot;/ən/ 'on' in 'button'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɵ&quot;,\n\t\taliases = {&quot;&lt;s&gt;o&lt;/s&gt;&quot;,\
      \ &quot;o-&quot;, &quot;ou-&quot;, &quot;oʊ-&quot;},\n\t\tlabel = &quot;ɵ&quot;,\n\t\ttooltip = &quot;/ɵ/ variable 1st 'o' in 'omission'&quot;, -- ambiguous example\n\t},\n\t{\n\t\tcode = &quot;əm&quot;,\n\t\taliases = {&quot;@m&quot;, &quot;ᵊm&quot;,\
      \ &quot;m̩&quot;},\n\t\tlabel = &quot;əm&quot;,\n\t\ttooltip = &quot;/əm/ 'm' in 'rhythm'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ɨ&quot;,\n\t\taliases = {&quot;&lt;s&gt;ɪ&lt;/s&gt;&quot;, &quot;i-&quot;, &quot;I-&quot;, &quot;ɪ-&quot;},\n\t\tlabel = &quot;ɨ\
      &quot;,\n\t\ttooltip = &quot;/ɨ/ 'e' in 'roses'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ʉ&quot;,\n\t\taliases = {&quot;&lt;s&gt;ʊ&lt;/s&gt;&quot;, &quot;u-&quot;, &quot;U-&quot;, &quot;ʊ-&quot;},\n\t\tlabel = &quot;ʉ&quot;,\n\t\ttooltip = &quot;/ʉ/ variable\
      \ 2nd 'u' in 'beautiful'&quot;, -- ambiguous example\n\t},\n\t{\n\t\tcode = &quot;jʉ&quot;,\n\t\taliases = {&quot;j&lt;s&gt;ʊ&lt;/s&gt;&quot;, &quot;y&lt;s&gt;ʊ&lt;/s&gt;&quot;, &quot;ju-&quot;, &quot;yu-&quot;, &quot;jU-&quot;, &quot;yU-&quot;, &quot;jʊ\
      -&quot;},\n\t\tlabel = &quot;jʉ&quot;,\n\t\ttooltip = &quot;/jʉ/ variable 2nd 'u' in 'curriculum'&quot;, -- ambigious example\n\t},\n\t{\n\t\tcode = &quot;əl&quot;,\n\t\taliases = {&quot;@l&quot;, &quot;ᵊl&quot;, &quot;əɫ&quot;, &quot;l̩&quot;},\n\t\t\
      label = &quot;əl&quot;,\n\t\ttooltip = &quot;/əl/ 'le' in 'bottle'&quot;,\n\t},\n\t{\n\t\tcode = &quot;i&quot;,\n\t\tlabel = &quot;i&quot;,\n\t\ttooltip = &quot;/i/ 'y' in 'happy'&quot;,\n\t},\n\t{\n\t\tcode = &quot;u&quot;,\n\t\tlabel = &quot;u&quot;,\n\
      \t\ttooltip = &quot;/u/ 'oo' in 'bedroom'&quot;,\n\t},\n\t{\n\t\tcode = &quot;ˈ&quot;,\n\t\taliases = {&quot;'&quot;},\n\t\tlabel = &quot;ˈ&quot;,\n\t\ttooltip = &quot;/ˈ/ primary stress follows&quot;,\n\t},\n\t{\n\t\tcode = &quot;ˌ&quot;,\n\t\taliases\
      \ = {&quot;,&quot;},\n\t\tlabel = &quot;ˌ&quot;,\n\t\ttooltip = &quot;/ˌ/ secondary stress follows&quot;,\n\t},\n\t{\n\t\tcode = &quot;.&quot;,\n\t\taliases = {&quot;·&quot;},\n\t\tlabel = &quot;.&quot;,\n\t\ttooltip = &quot;/./ syllable break&quot;,\n\
      \t},\n\t{\n\t\tcode = &quot;-&quot;,\n\t\taliases = {&quot;–&quot;},\n\t\tlabel = &quot;-&quot;,\n\t\ttooltip = &quot;/-/ affix&quot;,\n\t},\n\n\t-- Separators\n\t-- Tables without tooltip text are used as word separators. In addition to\n\t-- not having\
      \ any tooltip text in the template output, they are not\n\t-- underlined.\n\t{\n\t\tcode = &quot;,_&quot;,\n\t\tlabel = &quot;, &quot;,\n\t},\n\t{\n\t\tcode = &quot;_&quot;,\n\t\tlabel = &quot; &quot;,\n\t},\n\t-- this is useful for &quot;and&quot; in\
      \ place names, which is highly variable and not important to transcribe\n\t{\n\t\tcode = &quot;and&quot;,\n\t\tlabel = &quot;/ &amp; /&quot;,\n\t},\n\t-- this is useful for other highly variable words in place names, which are not important to transcribe\n\
      \t{\n\t\tcode = &quot;...&quot;,\n\t\tlabel = &quot;...&quot;,\n\t},\n}</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:53.767Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+book&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:53 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3004 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421594914, 3878580725, 1029506069
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite book" to="Template:Cite book" /></normalized><pages><page _idx="4086375" pageid="4086375" ns="10" title="Template:Cite book"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:57:54Z" comment="Changed protection level of Template:Cite book: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=book
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:54.682Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3Acitation%2FCS1&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:54 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791340201, 4019094193, 1029507412
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:citation/CS1\" to=\"Module:Citation/CS1\" /></normalized><pages><page _idx=\"38573037\" pageid=\"38573037\" ns=\"828\" title=\"Module:Citation/CS1\"><revisions><rev\
      \ user=\"Trappist the monk\" timestamp=\"2015-04-18T10:10:25Z\" comment=\"script-title bug fix;\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\nlocal z = {\n\terror_categories = {};\t\t-- for categorizing citations that\
      \ contain errors\n\terror_ids = {};\n\tmessage_tail = {};\n\tmaintenance_cats = {};\t\t-- for categorizing citations that aren't erroneous per se, but could use a little work\n\tproperties_cats = {};\t\t-- for categorizing citations based on certain properties,\
      \ language of source for instance\n}\n\n--[[--------------------------&lt; F O R W A R D   D E C L A R A T I O N S &gt;--------------------------------------\n]]\nlocal dates, year_date_check\t-- functions in Module:Citation/CS1/Date_validation\n\nlocal\
      \ cfg = {};\t\t\t\t\t-- table of configuration tables that are defined in Module:Citation/CS1/Configuration\nlocal whitelist = {};\t\t\t-- talbe of tables listing valid template parameter names; defined in Module:Citation/CS1/Whitelist\n\n--[[--------------------------&lt;\
      \ I S _ S E T &gt;------------------------------------------------------------------\n\nReturns true if argument is set; false otherwise. Argument is 'set' when it exists (not nil) or when it is not an empty string.\nThis function is global because it\
      \ is called from both this module and from Date validation\n\n]]\nfunction is_set( var )\n\treturn not (var == nil or var == '');\nend\n\n--[[--------------------------&lt; F I R S T _ S E T &gt;------------------------------------------------------------\n\
      \nFirst set variable or nil if none\n\n]]\n\nlocal function first_set(...)\n\tlocal list = {...};\n\tfor _, var in pairs(list) do\n\t\tif is_set( var ) then\n\t\t\treturn var;\n\t\tend\n\tend\nend\n\n--[[--------------------------&lt; I N _ A R R A Y &gt;--------------------------------------------------------------\n\
      \nWhether needle is in haystack\n\n]]\n\nlocal function in_array( needle, haystack )\n\tif needle == nil then\n\t\treturn false;\n\tend\n\tfor n,v in ipairs( haystack ) do\n\t\tif v == needle then\n\t\t\treturn n;\n\t\tend\n\tend\n\treturn false;\nend\n\
      \n--[[--------------------------&lt; S U B S T I T U T E &gt;----------------------------------------------------------\n\nPopulates numbered arguments in a message string using an argument table.\n\n]]\n\nlocal function substitute( msg, args )\n\treturn\
      \ args and mw.message.newRawMessage( msg, args ):plain() or msg;\nend\n\n--[[--------------------------&lt; E R R O R _ C O M M E N T &gt;----------------------------------------------------\n\nWraps error messages with css markup according to the state\
      \ of hidden.\n\n]]\nlocal function error_comment( content, hidden )\n\treturn substitute( hidden and cfg.presentation['hidden-error'] or cfg.presentation['visible-error'], content );\nend\n\n--[[--------------------------&lt; S E T _ E R R O R &gt;--------------------------------------------------------------\n\
      \nSets an error condition and returns the appropriate error message.  The actual placement of the error message in the output is\nthe responsibility of the calling function.\n\n]]\nlocal function set_error( error_id, arguments, raw, prefix, suffix )\n\t\
      local error_state = cfg.error_conditions[ error_id ];\n\t\n\tprefix = prefix or &quot;&quot;;\n\tsuffix = suffix or &quot;&quot;;\n\t\n\tif error_state == nil then\n\t\terror( cfg.messages['undefined_error'] );\n\telseif is_set( error_state.category )\
      \ then\n\t\ttable.insert( z.error_categories, error_state.category );\n\tend\n\t\n\tlocal message = substitute( error_state.message, arguments );\n\t\n\tmessage = message .. &quot; ([[&quot; .. cfg.messages['help page link'] .. \n\t\t&quot;#&quot; .. error_state.anchor\
      \ .. &quot;|&quot; ..\n\t\tcfg.messages['help page label'] .. &quot;]])&quot;;\n\t\n\tz.error_ids[ error_id ] = true;\n\tif in_array( error_id, { 'bare_url_missing_title', 'trans_missing_title' } )\n\t\t\tand z.error_ids['citation_missing_title'] then\n\
      \t\treturn '', false;\n\tend\n\t\n\tmessage = table.concat({ prefix, message, suffix });\n\t\n\tif raw == true then\n\t\treturn message, error_state.hidden;\n\tend\t\t\n\t\t\n\treturn error_comment( message, error_state.hidden );\nend\n\n--[[--------------------------&lt;\
      \ A D D _ M A I N T _ C A T &gt;------------------------------------------------------\n\nAdds a category to z.maintenance_cats using names from the configuration file with additional text if any.\n\n]]\n\nlocal function add_maint_cat (key, arguments)\n\
      \ttable.insert( z.maintenance_cats, substitute (cfg.maint_cats [key], arguments));\t-- make name then add to table\nend\n\n--[[--------------------------&lt; A D D _ P R O P _ C A T &gt;--------------------------------------------------------\n\nAdds a\
      \ category to z.properties_cats using names from the configuration file with additional text if any.\n\n]]\n\nlocal function add_prop_cat (key, arguments)\n\ttable.insert( z.properties_cats, substitute (cfg.prop_cats [key], arguments));\t\t-- make name\
      \ then add to table\nend\n\n--[[--------------------------&lt; C H E C K _ U R L &gt;------------------------------------------------------------\n\nDetermines whether a URL string is valid.\n\nAt present the only check is whether the string appears to\
      \ be prefixed with a URI scheme.  It is not determined whether \nthe URI scheme is valid or whether the URL is otherwise well formed.\n\n]]\n\nlocal function check_url( url_str )\n\treturn url_str:sub(1,2) == &quot;//&quot; or url_str:match( &quot;^[^/]*:&quot;\
      \ ) ~= nil;\t\t-- Protocol-relative or URL scheme\nend\n\n--[[--------------------------&lt; S A F E _ F O R _ I T A L I C S &gt;----------------------------------------------\n\nProtects a string that will be wrapped in wiki italic markup '' ... ''\n\n\
      Note: We cannot use &lt;i&gt; for italics, as the expected behavior for italics specified by ''...'' in the title is that\nthey will be inverted (i.e. unitalicized) in the resulting references.  In addition, &lt;i&gt; and '' tend to interact\npoorly under\
      \ Mediawiki's HTML tidy.\n\n]]\n\nlocal function safe_for_italics( str )\n\tif not is_set(str) then\n\t\treturn str;\n\telse\n\t\tif str:sub(1,1) == &quot;'&quot; then str = &quot;&lt;span /&gt;&quot; .. str; end\n\t\tif str:sub(-1,-1) == &quot;'&quot;\
      \ then str = str .. &quot;&lt;span /&gt;&quot;; end\n\t\t\n\t\t-- Remove newlines as they break italics.\n\t\treturn str:gsub( '\\n', ' ' );\n\tend\nend\n\n--[[--------------------------&lt; S A F E _ F O R _ U R L &gt;------------------------------------------------------\n\
      \nEscape sequences for content that will be used for URL descriptions\n\n]]\n\nlocal function safe_for_url( str )\n\tif str:match( &quot;%[%[.-%]%]&quot; ) ~= nil then \n\t\ttable.insert( z.message_tail, { set_error( 'wikilink_in_url', {}, true ) } );\n\
      \tend\n\t\n\treturn str:gsub( '[%[%]\\n]', {\t\n\t\t['['] = '&amp;#91;',\n\t\t[']'] = '&amp;#93;',\n\t\t['\\n'] = ' ' } );\nend\n\n--[[--------------------------&lt; W R A P _ S T Y L E &gt;----------------------------------------------------------\n\n\
      Applies styling to various parameters.  Supplied string is wrapped using a message_list configuration taking one\nargument; protects italic styled parameters.  Additional text taken from citation_config.presentation - the reason\nthis function is similar\
      \ to but separate from wrap_msg().\n\n]]\n\nlocal function wrap_style (key, str)\n\tif not is_set( str ) then\n\t\treturn &quot;&quot;;\n\telseif in_array( key, { 'italic-title', 'trans-italic-title' } ) then\n\t\tstr = safe_for_italics( str );\n\tend\n\
      \n\treturn substitute( cfg.presentation[key], {str} );\nend\n\n--[[--------------------------&lt; E X T E R N A L _ L I N K &gt;----------------------------------------------------\n\nFormat an external link with error checking\n\n]]\n\nlocal function\
      \ external_link( URL, label, source )\n\tlocal error_str = &quot;&quot;;\n\tif not is_set( label ) then\n\t\tlabel = URL;\n\t\tif is_set( source ) then\n\t\t\terror_str = set_error( 'bare_url_missing_title', { wrap_style ('parameter', source) }, false,\
      \ &quot; &quot; );\n\t\telse\n\t\t\terror( cfg.messages[&quot;bare_url_no_origin&quot;] );\n\t\tend\t\t\t\n\tend\n\tif not check_url( URL ) then\n\t\terror_str = set_error( 'bad_url', {}, false, &quot; &quot; ) .. error_str;\n\tend\n\treturn table.concat({\
      \ &quot;[&quot;, URL, &quot; &quot;, safe_for_url( label ), &quot;]&quot;, error_str });\nend\n\n--[[--------------------------&lt; E X T E R N A L _ L I N K _ I D &gt;----------------------------------------------\n\nFormats a wiki style external link\n\
      \n]]\n\nlocal function external_link_id(options)\n\tlocal url_string = options.id;\n\tif options.encode == true or options.encode == nil then\n\t\turl_string = mw.uri.encode( url_string );\n\tend\n\treturn mw.ustring.format( '[[%s|%s]]%s[%s%s%s %s]',\n\
      \t\toptions.link, options.label, options.separator or &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, url_string, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n--[[\nCategorize and emit an error message when the citation contains\
      \ one or more deprecated parameters.  Because deprecated parameters (currently |month=,\n|coauthor=, and |coauthors=) aren't related to each other and because these parameters may be concatenated into the variables used by |date= and |author#= (and aliases)\n\
      details of which parameter caused the error message are not provided.  Only one error message is emitted regardless of the number of deprecated parameters in the citation.\n]]\nlocal function deprecated_parameter(name)\n\tif true ~= Page_in_deprecated_cat\
      \ then\t-- if we haven't been here before then set a \n\t\tPage_in_deprecated_cat=true;\t\t-- sticky flag so that if there are more than one deprecated parameter the category is added only once\n\t\ttable.insert( z.message_tail, { set_error( 'deprecated_params',\
      \ {name}, true ) } );\t\t-- add error message\n\tend\nend\n\n--[[--------------------------&lt; K E R N _ Q U O T E S &gt;--------------------------------------------------------\n\nApply kerning to open the space between the quote mark provided by the\
      \ Module and a leading or trailing quote mark contained in a |title= or |chapter= parameter's value.\nThis function will positive kern either single or double quotes:\n\t&quot;'Unkerned title with leading and trailing single quote marks'&quot;\n\t&quot;\
      \ 'Kerned title with leading and trailing single quote marks' &quot; (in real life the kerning isn't as wide as this example)\nDouble single quotes (italic or bold wikimarkup) are not kerned.\n\nCall this function for chapter titles, for website titles,\
      \ etc; not for book titles.\n\n]]\n\nlocal function kern_quotes (str)\n\tlocal cap='';\n\tlocal cap2='';\n\t\n\tcap, cap2 = str:match (&quot;^([\\&quot;\\'])([^\\'].+)&quot;);\t\t\t\t\t\t\t\t-- match leading double or single quote but not double single\
      \ quotes\n\tif is_set (cap) then\n\t\tstr = substitute (cfg.presentation['kern-left'], {cap, cap2});\n\tend\n\n\tcap, cap2 = str:match (&quot;^(.+[^\\'])([\\&quot;\\'])$&quot;)\n\tif is_set (cap) then\n\t\tstr = substitute (cfg.presentation['kern-right'],\
      \ {cap, cap2});\n\tend\n\treturn str;\nend\n\n--[[--------------------------&lt; F O R M A T _ S C R I P T _ V A L U E &gt;----------------------------------------\n\n|script-title= holds title parameters that are not written in Latin based scripts: Chinese,\
      \ Japanese, Arabic, Hebrew, etc. These scripts should\nnot be italicized and may be written right-to-left.  The value supplied by |script-title= is concatenated onto Title after Title has been wrapped\nin italic markup.\n\nRegardless of language, all values\
      \ provided by |script-title= are wrapped in &lt;bdi&gt;...&lt;/bdi&gt; tags to isolate rtl languages from the English left to right.\n\n|script-title= provides a unique feature.  The value in |script-title= may be prefixed with a two-character ISO639-1\
      \ language code and a colon:\n\t|script-title=ja:*** *** (where * represents a Japanese character)\nSpaces between the two-character code and the colon and the colon and the first script character are allowed:\n\t|script-title=ja : *** ***\n\t|script-title=ja:\
      \ *** ***\n\t|script-title=ja :*** ***\nSpaces preceding the prefix are allowed: |script-title = ja:*** ***\n\nThe prefix is checked for validity.  If it is a valid ISO639-1 language code, the lang attribute (lang=&quot;ja&quot;) is added to the &lt;bdi&gt;\
      \ tag so that browsers can\nknow the language the tag contains.  This may help the browser render the script more correctly.  If the prefix is invalid, the lang attribute\nis not added.  At this time there is no error message for this condition.\n\nAt\
      \ this writing, only |script-title= is supported.  It is anticipated that additional parameters will be created to use this function.\n\nTODO: error messages when prefix is invalid ISO639-1 code; when script_value has prefix but no script;\n]]\n\nlocal\
      \ function format_script_value (script_value)\n\tlocal lang='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- initialize to empty string\n\tlocal name;\n\tif script_value:match('^%l%l%s*:') then\t\t\t\t\t\t\t\t\t\t-- if first 3 non-space characters are script language\
      \ prefix\n\t\tlang = script_value:match('^(%l%l)%s*:%s*%S.*');\t\t\t\t\t\t-- get the language prefix or nil if there is no script\n\t\tif not is_set (lang) then\n\t\t\treturn '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- script_value was just the prefix so return\
      \ empty string\n\t\tend\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if we get this far we have prefix and script\n\t\tname = mw.language.fetchLanguageName( lang, &quot;en&quot; );\t\t\t\t\t\t-- get language name so that we can use it to categorize\n\t\t\
      if is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- is prefix a proper ISO 639-1 language code?\n\t\t\tscript_value = script_value:gsub ('^%l%l%s*:%s*', '');\t\t\t\t-- strip prefix from script\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- is prefix one of\
      \ these language codes?\n\t\t\tif in_array (lang, {'ar', 'bg', 'bs', 'dv', 'el', 'fa', 'hy', 'ja', 'ka', 'ko', 'ku', 'he', 'ps', 'ru', 'sd', 'sr', 'th', 'uk', 'ug', 'yi', 'zh'}) then\n\t\t\t\tadd_prop_cat ('script_with_name', {name, lang})\n\t\t\telse\n\
      \t\t\t\tadd_prop_cat ('script')\n\t\t\tend\n\t\t\tlang = ' lang=&quot;' .. lang .. '&quot; ';\t\t\t\t\t\t\t\t\t-- convert prefix into a lang attribute\n\t\telse\n\t\t\tlang = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- invalid so set lang to empty string\n\t\t\
      end\n\tend\n\tscript_value = substitute (cfg.presentation['bdi'], {lang, script_value});\t-- isolate in case script is rtl\n\n\treturn script_value;\nend\n\n--[[--------------------------&lt; S C R I P T _ C O N C A T E N A T E &gt;------------------------------------------\n\
      \nInitially for |title= and |script-title=, this function concatenates those two parameter values after the script value has been \nwrapped in &lt;bdi&gt; tags.\n]]\n\nlocal function script_concatenate (title, script)\n\tif is_set (script) then\n\t\tscript\
      \ = format_script_value (script);\t\t\t\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; returns empty string on error\n\t\tif is_set (script) then\n\t\t\ttitle = title .. ' ' .. script;\t\t\t\t\t\t\t\t\t\t-- concatenate title and script\
      \ title\n\t\tend\n\tend\n\treturn title;\nend\n\n\n--[[--------------------------&lt; W R A P _ M S G &gt;--------------------------------------------------------------\n\nApplies additional message text to various parameter values. Supplied string is\
      \ wrapped using a message_list\nconfiguration taking one argument.  Supports lower case text for {{citation}} templates.  Additional text taken\nfrom citation_config.messages - the reason this function is similar to but separate from wrap_style().\n\n\
      ]]\n\nlocal function wrap_msg (key, str, lower)\n\tif not is_set( str ) then\n\t\treturn &quot;&quot;;\n\tend\n\tif true == lower then\n\t\tlocal msg;\n\t\tmsg = cfg.messages[key]:lower();\t\t\t\t\t\t\t\t\t\t-- set the message to lower case before \n\t\
      \tstr = substitute( msg, {str} );\t\t\t\t\t\t\t\t\t\t\t-- including template text\n\t\treturn str;\n\telse\n\t\treturn substitute( cfg.messages[key], {str} );\n\tend\t\t\nend\n\n--[[--------------------------&lt; S E L E C T _ O N E &gt;----------------------------------------------------------\n\
      \nChooses one matching parameter from a list of parameters to consider\nGenerates an error if more than one match is present.\n\n]]\n\nlocal function select_one( args, possible, error_condition, index )\n\tlocal value = nil;\n\tlocal selected = '';\n\t\
      local error_list = {};\n\t\n\tif index ~= nil then index = tostring(index); end\n\t\n\t-- Handle special case of &quot;#&quot; replaced by empty string\n\tif index == '1' then\n\t\tfor _, v in ipairs( possible ) do\n\t\t\tv = v:gsub( &quot;#&quot;, &quot;&quot;\
      \ );\n\t\t\tif is_set(args[v]) then\n\t\t\t\tif value ~= nil and selected ~= v then\n\t\t\t\t\ttable.insert( error_list, v );\n\t\t\t\telse\n\t\t\t\t\tvalue = args[v];\n\t\t\t\t\tselected = v;\n\t\t\t\tend\n\t\t\tend\n\t\tend\t\t\n\tend\n\t\n\tfor _, v\
      \ in ipairs( possible ) do\n\t\tif index ~= nil then\n\t\t\tv = v:gsub( &quot;#&quot;, index );\n\t\tend\n\t\tif is_set(args[v]) then\n\t\t\tif value ~= nil and selected ~=  v then\n\t\t\t\ttable.insert( error_list, v );\n\t\t\telse\n\t\t\t\tvalue = args[v];\n\
      \t\t\t\tselected = v;\n\t\t\tend\n\t\tend\n\tend\n\t\n\tif #error_list &gt; 0 then\n\t\tlocal error_str = &quot;&quot;;\n\t\tfor _, k in ipairs( error_list ) do\n\t\t\tif error_str ~= &quot;&quot; then error_str = error_str .. cfg.messages['parameter-separator']\
      \ end\n\t\t\terror_str = error_str .. wrap_style ('parameter', k);\n\t\tend\n\t\tif #error_list &gt; 1 then\n\t\t\terror_str = error_str .. cfg.messages['parameter-final-separator'];\n\t\telse\n\t\t\terror_str = error_str .. cfg.messages['parameter-pair-separator'];\n\
      \t\tend\n\t\terror_str = error_str .. wrap_style ('parameter', selected);\n\t\ttable.insert( z.message_tail, { set_error( error_condition, {error_str}, true ) } );\n\tend\n\t\n\treturn value, selected;\nend\n\n--[[--------------------------&lt; F O R M\
      \ A T _ C H A P T E R _ T I T L E &gt;--------------------------------------\n\nFormat the three chapter parameters: |chapter=, |trans-chapter=, and |chapter-url= into a single Chapter meta-\nparameter (chapter_url_source used for error messages).\n\n\
      ]]\n\nlocal function format_chapter_title (chapter, transchapter, chapterurl, chapter_url_source)\n\tlocal chapter_error = '';\n\t\n\tif not is_set (chapter) then\n\t\tchapter = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- just to be safe for concatenation\n\t\t\
      if is_set (transchapter) then\n\t\t\tchapter = wrap_style ('trans-quoted-title', transchapter);\n\t\t\tchapter_error = &quot; &quot; .. set_error ('trans_missing_chapter');\n\t\tend\n\t\tif is_set (chapterurl) then\n\t\t\tchapter = external_link (chapterurl,\
      \ chapter, chapter_url_source);\t-- adds bare_url_missing_title error if appropriate\n\t\tend\n\t\treturn chapter .. chapter_error;\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- here when chapter is set\n\t\tchapter = kern_quotes (chapter);\t\t\t\t\t\t\
      \t\t\t\t-- if necessary, separate chapter title's leading and trailing quote marks from Module provided quote marks\n\t\tchapter = wrap_style ('quoted-title', chapter);\n\t\tif is_set (transchapter) then\n\t\t\ttranschapter = wrap_style ('trans-quoted-title',\
      \ transchapter);\n\t\t\tchapter = chapter .. ' ' .. transchapter;\n\t\tend\n\t\tif is_set (chapterurl) then\n\t\t\tchapter = external_link (chapterurl, chapter);\t\t\t\t\t\t-- adds bare_url_missing_title error if appropriate\n\t\tend\n\tend\n\treturn chapter;\n\
      end\n\n--[[\nArgument wrapper.  This function provides support for argument \nmapping defined in the configuration file so that multiple names\ncan be transparently aliased to single internal variable.\n]]\n\nlocal function argument_wrapper( args )\n\t\
      local origin = {};\n\t\n\treturn setmetatable({\n\t\tORIGIN = function( self, k )\n\t\t\tlocal dummy = self[k]; --force the variable to be loaded.\n\t\t\treturn origin[k];\n\t\tend\n\t},\n\t{\n\t\t__index = function ( tbl, k )\n\t\t\tif origin[k] ~= nil\
      \ then\n\t\t\t\treturn nil;\n\t\t\tend\n\t\t\t\n\t\t\tlocal args, list, v = args, cfg.aliases[k];\n\t\t\t\n\t\t\tif type( list ) == 'table' then\n\t\t\t\tv, origin[k] = select_one( args, list, 'redundant_parameters' );\n\t\t\t\tif origin[k] == nil then\n\
      \t\t\t\t\torigin[k] = ''; -- Empty string, not nil\n\t\t\t\tend\n\t\t\telseif list ~= nil then\n\t\t\t\tv, origin[k] = args[list], list;\n\t\t\telse\n\t\t\t\t-- maybe let through instead of raising an error?\n\t\t\t\t-- v, origin[k] = args[k], k;\n\t\t\
      \t\terror( cfg.messages['unknown_argument_map'] );\n\t\t\tend\n\t\t\t\n\t\t\t-- Empty strings, not nil;\n\t\t\tif v == nil then\n\t\t\t\tv = cfg.defaults[k] or '';\n\t\t\t\torigin[k] = '';\n\t\t\tend\n\t\t\t\n\t\t\ttbl = rawset( tbl, k, v );\n\t\t\treturn\
      \ v;\n\t\tend,\n\t});\nend\n\n--[[\nLooks for a parameter's name in the whitelist.\n\nParameters in the whitelist can have three values:\n\ttrue - active, supported parameters\n\tfalse - deprecated, supported parameters\n\tnil - unsupported parameters\n\
      ]]\n\nlocal function validate( name )\n\tlocal name = tostring( name );\n\tlocal state = whitelist.basic_arguments[ name ];\n\t\n\t-- Normal arguments\n\tif true == state then return true; end\t\t-- valid actively supported parameter\n\tif false == state\
      \ then\n\t\tdeprecated_parameter (name);\t\t\t\t-- parameter is deprecated but still supported\n\t\treturn true;\n\tend\n\t\n\t-- Arguments with numbers in them\n\tname = name:gsub( &quot;%d+&quot;, &quot;#&quot; );\t\t\t\t-- replace digit(s) with # (last25\
      \ becomes last#\n\tstate = whitelist.numbered_arguments[ name ];\n\tif true == state then return true; end\t\t-- valid actively supported parameter\n\tif false == state then\n\t\tdeprecated_parameter (name);\t\t\t\t-- parameter is deprecated but still\
      \ supported\n\t\treturn true;\n\tend\n\t\n\treturn false;\t\t\t\t\t\t\t\t-- Not supported because not found or name is set to nil\nend\n\n\n-- Formats a wiki style internal link\nlocal function internal_link_id(options)\n\treturn mw.ustring.format( '[[%s|%s]]%s[[%s%s%s|%s]]',\n\
      \t\toptions.link, options.label, options.separator or &quot;&amp;nbsp;&quot;,\n\t\toptions.prefix, options.id, options.suffix or &quot;&quot;,\n\t\tmw.text.nowiki(options.id)\n\t);\nend\n\n\n--[[--------------------------&lt; N O W R A P _ D A T E &gt;--------------------------------------------------------\n\
      \nWhen date is YYYY-MM-DD format wrap in nowrap span: &lt;span ...&gt;YYYY-MM-DD&lt;/span&gt;.  When date is DD MMMM YYYY or is\nMMMM DD, YYYY then wrap in nowrap span: &lt;span ...&gt;DD MMMM&lt;/span&gt; YYYY or &lt;span ...&gt;MMMM DD,&lt;/span&gt;\
      \ YYYY\n\nDOES NOT yet support MMMM YYYY or any of the date ranges.\n\n]]\n\nlocal function nowrap_date (date)\n\tlocal cap='';\n\tlocal cap2='';\n\n\tif date:match(&quot;^%d%d%d%d%-%d%d%-%d%d$&quot;) then\n\t\tdate = substitute (cfg.presentation['nowrap1'],\
      \ date);\n\t\n\telseif date:match(&quot;^%a+%s*%d%d?,%s*%d%d%d%d$&quot;) or date:match (&quot;^%d%d?%s*%a+%s*%d%d%d%d$&quot;) then\n\t\tcap, cap2 = string.match (date, &quot;^(.*)%s+(%d%d%d%d)$&quot;);\n\t\tdate = substitute (cfg.presentation['nowrap2'],\
      \ {cap, cap2});\n\tend\n\t\n\treturn date;\nend\n\n--[[--------------------------&lt; IS _ V A L I D _ I S X N &gt;-----------------------------------------------------\n\nISBN-10 and ISSN validator code calculates checksum across all isbn/issn digits\
      \ including the check digit. ISBN-13 is checked in check_isbn().\nIf the number is valid the result will be 0. Before calling this function, issbn/issn must be checked for length and stripped of dashes,\nspaces and other non-isxn characters.\n\n]]\n\n\
      local function is_valid_isxn (isxn_str, len)\n\tlocal temp = 0;\n\tisxn_str = { isxn_str:byte(1, len) };\t-- make a table of byte values '0' → 0x30 .. '9'  → 0x39, 'X' → 0x58\n\tlen = len+1;\t\t\t\t\t\t\t-- adjust to be a loop counter\n\tfor i, v in ipairs(\
      \ isxn_str ) do\t\t-- loop through all of the bytes and calculate the checksum\n\t\tif v == string.byte( &quot;X&quot; ) then\t\t-- if checkdigit is X (compares the byte value of 'X' which is 0x58)\n\t\t\ttemp = temp + 10*( len - i );\t-- it represents\
      \ 10 decimal\n\t\telse\n\t\t\ttemp = temp + tonumber( string.char(v) )*(len-i);\n\t\tend\n\tend\n\treturn temp % 11 == 0;\t\t\t\t\t-- returns true if calculation result is zero\nend\n\n\n--[[--------------------------&lt; C H E C K _ I S B N &gt;------------------------------------------------------------\n\
      \nDetermines whether an ISBN string is valid\n\n]]\n\nlocal function check_isbn( isbn_str )\n\tif nil ~= isbn_str:match(&quot;[^%s-0-9X]&quot;) then return false; end\t\t-- fail if isbn_str contains anything but digits, hyphens, or the uppercase X\n\t\
      isbn_str = isbn_str:gsub( &quot;-&quot;, &quot;&quot; ):gsub( &quot; &quot;, &quot;&quot; );\t-- remove hyphens and spaces\n\tlocal len = isbn_str:len();\n \n\tif len ~= 10 and len ~= 13 then\n\t\treturn false;\n\tend\n\n\tif len == 10 then\n\t\tif isbn_str:match(\
      \ &quot;^%d*X?$&quot; ) == nil then return false; end\n\t\treturn is_valid_isxn(isbn_str, 10);\n\telse\n\t\tlocal temp = 0;\n\t\tif isbn_str:match( &quot;^97[89]%d*$&quot; ) == nil then return false; end\t-- isbn13 begins with 978 or 979\n\t\tisbn_str\
      \ = { isbn_str:byte(1, len) };\n\t\tfor i, v in ipairs( isbn_str ) do\n\t\t\ttemp = temp + (3 - 2*(i % 2)) * tonumber( string.char(v) );\n\t\tend\n\t\treturn temp % 10 == 0;\n\tend\nend\n\n--[[--------------------------&lt; I S S N &gt;----------------------------------------------------------------------\n\
      \nValidate and format an issn.  This code fixes the case where an editor has included an ISSN in the citation but has separated the two groups of four\ndigits with a space.  When that condition occurred, the resulting link looked like this:\n\n\t|issn=0819\
      \ 4327 gives: [http://www.worldcat.org/issn/0819 4327 0819 4327]  -- can't have spaces in an external link\n\t\nThis code now prevents that by inserting a hyphen at the issn midpoint.  It also validates the issn for length and makes sure that the checkdigit\
      \ agrees\nwith the calculated value.  Incorrect length (8 digits), characters other than 0-9 and X, or checkdigit / calculated value mismatch will all cause a check issn\nerror message.  The issn is always displayed with a hyphen, even if the issn was\
      \ given as a single group of 8 digits.\n\n]]\n\nlocal function issn(id)\n\tlocal issn_copy = id;\t\t-- save a copy of unadulterated issn; use this version for display if issn does not validate\n\tlocal handler = cfg.id_handlers['ISSN'];\n\tlocal text;\n\
      \tlocal valid_issn = true;\n\n\tid=id:gsub( &quot;[%s-–]&quot;, &quot;&quot; );\t\t\t\t\t\t\t\t\t-- strip spaces, hyphens, and endashes from the issn\n\n\tif 8 ~= id:len() or nil == id:match( &quot;^%d*X?$&quot; ) then\t\t-- validate the issn: 8 digits\
      \ long, containing only 0-9 or X in the last position\n\t\tvalid_issn=false;\t\t\t\t\t\t\t\t\t\t-- wrong length or improper character\n\telse\n\t\tvalid_issn=is_valid_isxn(id, 8);\t\t\t\t\t\t-- validate issn\n\tend\n\n\tif true == valid_issn then\n\t\t\
      id = string.sub( id, 1, 4 ) .. &quot;-&quot; .. string.sub( id, 5 );\t-- if valid, display correctly formatted version\n\telse\n\t\tid = issn_copy;\t\t\t\t\t\t\t\t\t\t\t-- if not valid, use the show the invalid issn with error message\n\tend\n\t\n\ttext\
      \ = external_link_id({link = handler.link, label = handler.label,\n\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n \n\tif false == valid_issn then\n\t\ttext = text .. ' ' .. set_error( 'bad_issn' )\t\t\t-- add an\
      \ error message if the issn is invalid\n\tend \n\t\n\treturn text\nend\n\n--[[--------------------------&lt; A M A Z O N &gt;------------------------------------------------------------------\n\nFormats a link to Amazon.  Do simple error checking: asin\
      \ must be mix of 10 numeric or uppercase alpha\ncharacters.  If a mix, first character must be uppercase alpha; if all numeric, asins must be 10-digit\nisbn. If 10-digit isbn, add a maintenance category so a bot or awb script can replace |asin= with |isbn=.\n\
      Error message if not 10 characters, if not isbn10, if mixed and first character is a digit.\n\n]]\n\nlocal function amazon(id, domain)\n\tlocal err_cat = &quot;&quot;\n\n\tif not id:match(&quot;^[%d%u][%d%u][%d%u][%d%u][%d%u][%d%u][%d%u][%d%u][%d%u][%d%u]$&quot;)\
      \ then\n\t\terr_cat =  ' ' .. set_error ('bad_asin');\t\t\t\t\t\t\t\t-- asin is not a mix of 10 uppercase alpha and numeric characters\n\telse\n\t\tif id:match(&quot;^%d%d%d%d%d%d%d%d%d[%dX]$&quot;) then\t\t\t\t\t\t\t\t-- if 10-digit numeric (or 9 digits\
      \ with terminal X)\n\t\t\tif check_isbn( id ) then\t\t\t\t\t\t\t\t\t\t\t\t-- see if asin value is isbn10\n\t\t\t\tadd_maint_cat ('ASIN');\n\t\t\telseif not is_set (err_cat) then\n\t\t\t\terr_cat =  ' ' .. set_error ('bad_asin');\t\t\t\t\t\t-- asin is not\
      \ isbn10\n\t\t\tend\n\t\telseif not id:match(&quot;^%u[%d%u]+$&quot;) then\n\t\t\terr_cat =  ' ' .. set_error ('bad_asin');\t\t\t\t\t\t\t-- asin doesn't begin with uppercase alpha\n\t\tend\n\tend\n\tif not is_set(domain) then \n\t\tdomain = &quot;com&quot;;\n\
      \telseif in_array (domain, {'jp', 'uk'}) then\t\t\t-- Japan, United Kingdom\n\t\tdomain = &quot;co.&quot; .. domain;\n\telseif in_array (domain, {'au', 'br', 'mx'}) then\t-- Australia, Brazil, Mexico\n\t\tdomain = &quot;com.&quot; .. domain;\n\tend\n\t\
      local handler = cfg.id_handlers['ASIN'];\n\treturn external_link_id({link = handler.link,\n\t\tlabel=handler.label , prefix=&quot;//www.amazon.&quot;..domain..&quot;/dp/&quot;,id=id,\n\t\tencode=handler.encode, separator = handler.separator}) .. err_cat;\n\
      end\n\n--[[--------------------------&lt; A R X I V &gt;--------------------------------------------------------------------\n\nSee: http://arxiv.org/help/arxiv_identifier\n\nformat and error check arXiv identifier.  There are three valid forms of the\
      \ identifier:\nthe first form, valid only between date codes 9108 and 0703 is:\n\tarXiv:&lt;archive&gt;.&lt;class&gt;/&lt;date code&gt;&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;archive&gt; is a string of alpha characters - may be hyphenated; no other\
      \ punctuation\n\t&lt;class&gt; is a string of alpha characters - may be hyphenated; no other punctuation\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits of the four-digit year and MM is the month number January = 01\n\
      \t\tfirst digit of YY for this form can only 9 and 0\n\t&lt;number&gt; is a three-digit number\n\t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces (undocumented)\n\t\nthe second form, valid from April 2007 through December\
      \ 2014 is:\n\tarXiv:&lt;date code&gt;.&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;date code&gt; is four digits in the form YYMM where YY is the last two digits of the four-digit year and MM is the month number January = 01\n\t&lt;number&gt; is a four-digit\
      \ number\n\t&lt;version&gt; is a 1 or more digit number preceded with a lowercase v; no spaces\n\nthe third form, valid from January 2015 is:\n\tarXiv:&lt;date code&gt;.&lt;number&gt;&lt;version&gt;\nwhere:\n\t&lt;date code&gt; and &lt;version&gt; are\
      \ as defined for 0704-1412\n\t&lt;number&gt; is a five-digit number\n]]\n\nlocal function arxiv (id, class)\n\tlocal handler = cfg.id_handlers['ARXIV'];\n\tlocal year, month, version;\n\tlocal err_cat = '';\n\tlocal text;\n\t\n\tif id:match(&quot;^%a[%a%.%-]+/[90]%d[01]%d%d%d%d$&quot;)\
      \ or id:match(&quot;^%a[%a%.%-]+/[90]%d[01]%d%d%d%dv%d+$&quot;) then\t-- test for the 9108-0703 format w/ &amp; w/o version\n\t\tyear, month = id:match(&quot;^%a[%a%.%-]+/([90]%d)([01]%d)%d%d%d[v%d]*$&quot;);\n\t\tyear = tonumber(year);\n\t\tmonth = tonumber(month);\n\
      \t\tif ((not (90 &lt; year or 8 &gt; year)) or (1 &gt; month or 12 &lt; month)) or\t\t-- if invalid year or invalid month\n\t\t\t((91 == year and 7 &gt; month) or (7 == year and 3 &lt; month)) then\t\t-- if years ok, are starting and ending months ok?\n\
      \t\t\t\terr_cat = ' ' .. set_error( 'bad_arxiv' );\t\t\t\t\t\t-- set error message\n\t\tend\n\telseif id:match(&quot;^%d%d[01]%d%.%d%d%d%d$&quot;) or id:match(&quot;^%d%d[01]%d%.%d%d%d%dv%d+$&quot;) then\t-- test for the 0704-1412 w/ &amp; w/o version\n\
      \t\tyear, month = id:match(&quot;^(%d%d)([01]%d)%.%d%d%d%d[v%d]*$&quot;);\n\t\tyear = tonumber(year);\n\t\tmonth = tonumber(month);\n\t\tif ((7 &gt; year) or (14 &lt; year) or (1 &gt; month or 12 &lt; month)) or\t\t\t-- is year invalid or is month invalid?\
      \ (doesn't test for future years)\n\t\t\t((7 == year) and (4 &gt; month)) then --or\t\t\t\t\t\t\t\t\t-- when year is 07, is month invalid (before April)?\n\t\t\t\terr_cat = ' ' .. set_error( 'bad_arxiv' );\t\t\t\t\t\t-- set error message\n\t\tend\n\telseif\
      \ id:match(&quot;^%d%d[01]%d%.%d%d%d%d%d$&quot;) or id:match(&quot;^%d%d[01]%d%.%d%d%d%d%dv%d+$&quot;) then\t-- test for the 1501- format w/ &amp; w/o version\n\t\tyear, month = id:match(&quot;^(%d%d)([01]%d)%.%d%d%d%d%d[v%d]*$&quot;);\n\t\tyear = tonumber(year);\n\
      \t\tmonth = tonumber(month);\n\t\tif ((15 &gt; year) or (1 &gt; month or 12 &lt; month)) then\t\t\t\t\t\t-- is year invalid or is month invalid? (doesn't test for future years)\n\t\t\terr_cat = ' ' .. set_error( 'bad_arxiv' );\t\t\t\t\t\t\t-- set error\
      \ message\n\t\tend\n\telse\n\t\terr_cat = ' ' .. set_error( 'bad_arxiv' );\t\t\t\t\t\t\t\t-- arXiv id doesn't match any format\n\tend\n\n\ttext = external_link_id({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator,\
      \ encode=handler.encode}) .. err_cat;\n\n\tif is_set (class) then\n\t\tclass = ' [[' .. '//arxiv.org/archive/' .. class .. ' ' .. class .. ']]';\t-- external link within square brackets, not wikilink\n\telse\n\t\tclass = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t-- empty string for concatenation\n\tend\n\t\n\treturn text .. class;\nend\n\n--[[\nlccn normalization (http://www.loc.gov/marc/lccn-namespace.html#normalization)\n1. Remove all blanks.\n2. If there is a forward slash (/) in the string, remove it,\
      \ and remove all characters to the right of the forward slash.\n3. If there is a hyphen in the string:\n\ta. Remove it.\n\tb. Inspect the substring following (to the right of) the (removed) hyphen. Then (and assuming that steps 1 and 2 have been carried\
      \ out):\n\t\t1. All these characters should be digits, and there should be six or less. (not done in this function)\n\t\t2. If the length of the substring is less than 6, left-fill the substring with zeroes until the length is six.\n\nReturns a normalized\
      \ lccn for lccn() to validate.  There is no error checking (step 3.b.1) performed in this function.\n]]\n\nlocal function normalize_lccn (lccn)\n\tlccn = lccn:gsub (&quot;%s&quot;, &quot;&quot;);\t\t\t\t\t\t\t\t\t-- 1. strip whitespace\n\n\tif nil ~= string.find\
      \ (lccn,'/') then\n\t\tlccn = lccn:match (&quot;(.-)/&quot;);\t\t\t\t\t\t\t\t-- 2. remove forward slash and all character to the right of it\n\tend\n\n\tlocal prefix\n\tlocal suffix\n\tprefix, suffix = lccn:match (&quot;(.+)%-(.+)&quot;);\t\t\t\t\t\t--\
      \ 3.a remove hyphen by splitting the string into prefix and suffix\n\n\tif nil ~= suffix then\t\t\t\t\t\t\t\t\t\t\t-- if there was a hyphen\n\t\tsuffix=string.rep(&quot;0&quot;, 6-string.len (suffix)) .. suffix;\t-- 3.b.2 left fill the suffix with 0s if\
      \ suffix length less than 6\n\t\tlccn=prefix..suffix;\t\t\t\t\t\t\t\t\t\t-- reassemble the lccn\n\tend\n\t\n\treturn lccn;\n\tend\n\n--[[\nFormat LCCN link and do simple error checking.  LCCN is a character string 8-12 characters long. The length of the\
      \ LCCN dictates the character type of the first 1-3 characters; the\nrightmost eight are always digits. http://info-uri.info/registry/OAIHandler?verb=GetRecord&amp;metadataPrefix=reg&amp;identifier=info:lccn/\n\nlength = 8 then all digits\nlength = 9 then\
      \ lccn[1] is lower case alpha\nlength = 10 then lccn[1] and lccn[2] are both lower case alpha or both digits\nlength = 11 then lccn[1] is lower case alpha, lccn[2] and lccn[3] are both lower case alpha or both digits\nlength = 12 then lccn[1] and lccn[2]\
      \ are both lower case alpha\n\n]]\n\nlocal function lccn(lccn)\n\tlocal handler = cfg.id_handlers['LCCN'];\n\tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that LCCN is valid\n\tlocal id = lccn;\t\t\t\t\t\t\t\t\t-- local copy of the lccn\n\n\tid = normalize_lccn\
      \ (id);\t\t\t\t\t\t\t-- get canonical form (no whitespace, hyphens, forward slashes)\n\tlocal len = id:len();\t\t\t\t\t\t\t\t-- get the length of the lccn\n\n\tif 8 == len then\n\t\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t-- if LCCN has anything\
      \ but digits (nil if only digits)\n\t\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t-- set an error message\n\t\tend\n\telseif 9 == len then\t\t\t\t\t\t\t\t-- LCCN should be adddddddd\n\t\tif nil == id:match(&quot;%l%d%d%d%d%d%d%d%d&quot;) then\t\t\t--\
      \ does it match our pattern?\n\t\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t-- set an error message\n\t\tend\n\telseif 10 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddd or dddddddddd\n\t\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t--\
      \ if LCCN has anything but digits (nil if only digits) ...\n\t\t\tif nil == id:match(&quot;^%l%l%d%d%d%d%d%d%d%d&quot;) then\t-- ... see if it matches our pattern\n\t\t\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t-- no match, set an error message\n\t\
      \t\tend\n\t\tend\n\telseif 11 == len then\t\t\t\t\t\t\t\t-- LCCN should be aaadddddddd or adddddddddd\n\t\tif not (id:match(&quot;^%l%l%l%d%d%d%d%d%d%d%d&quot;) or id:match(&quot;^%l%d%d%d%d%d%d%d%d%d%d&quot;)) then\t-- see if it matches one of our patterns\n\
      \t\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t-- no match, set an error message\n\t\tend\n\telseif 12 == len then\t\t\t\t\t\t\t\t-- LCCN should be aadddddddddd\n\t\tif not id:match(&quot;^%l%l%d%d%d%d%d%d%d%d%d%d&quot;) then\t-- see if it matches our\
      \ pattern\n\t\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t-- no match, set an error message\n\t\tend\n\telse\n\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t\t-- wrong length, set an error message\n\tend\n\n\tif not is_set (err_cat) and nil ~= lccn:find\
      \ ('%s') then\n\t\terr_cat = ' ' .. set_error( 'bad_lccn' );\t\t-- lccn contains a space, set an error message\n\tend\n\n\treturn external_link_id({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=lccn,separator=handler.separator,\
      \ encode=handler.encode}) .. err_cat;\nend\n\n--[[\nFormat PMID and do simple error checking.  PMIDs are sequential numbers beginning at 1 and counting up.  This code checks the PMID to see that it\ncontains only digits and is less than test_limit; the\
      \ value in local variable test_limit will need to be updated periodically as more PMIDs are issued.\n]]\n\nlocal function pmid(id)\n\tlocal test_limit = 30000000;\t\t\t\t\t\t-- update this value as PMIDs approach\n\tlocal handler = cfg.id_handlers['PMID'];\n\
      \tlocal err_cat =  '';\t\t\t\t\t\t\t\t-- presume that PMID is valid\n\t\n\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMID has anything but digits\n\t\terr_cat = ' ' .. set_error( 'bad_pmid' );\t\t-- set an error message\n\telse\t\t\t\t\t\t\
      \t\t\t\t\t\t-- PMID is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or test_limit &lt; id_num then\t\t-- if PMID is outside test limit boundaries\n\t\t\terr_cat = ' ' .. set_error(\
      \ 'bad_pmid' );\t-- set an error message\n\t\tend\n\tend\n\t\n\treturn external_link_id({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode}) .. err_cat;\nend\n\n--[[--------------------------&lt;\
      \ I S _ E M B A R G O E D &gt;------------------------------------------------------\n\nDetermines if a PMC identifier's online version is embargoed. Compares the date in |embargo= against today's date.  If embargo date is\nin the future, returns the content\
      \ of |embargo=; otherwise, returns and empty string because the embargo has expired or because\n|embargo= was not set in this cite.\n\n]]\n\nlocal function is_embargoed (embargo)\n\tif is_set (embargo) then\n\t\tlocal lang = mw.getContentLanguage();\n\t\
      \tlocal good1, embargo_date, good2, todays_date;\n\t\tgood1, embargo_date = pcall( lang.formatDate, lang, 'U', embargo );\n\t\tgood2, todays_date = pcall( lang.formatDate, lang, 'U' );\n\t\n\t\tif good1 and good2 then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if embargo\
      \ date and today's date are good dates\n\t\t\tif tonumber( embargo_date ) &gt;= tonumber( todays_date ) then\t\t\t-- is embargo date is in the future?\n\t\t\t\treturn embargo;\t\t\t\t\t\t\t\t\t\t\t\t\t-- still embargoed\n\t\t\telse\n\t\t\t\tadd_maint_cat\
      \ ('embargo')\n\t\t\t\treturn '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset because embargo has expired\n\t\t\tend\n\t\tend\n\tend\n\treturn '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- |embargo= not set return empty string\nend\n\n--[[--------------------------&lt;\
      \ P M C &gt;------------------------------------------------------------------------\n\nFormat a PMC, do simple error checking, and check for embargoed articles.\n\nThe embargo parameter takes a date for a value. If the embargo date is in the future the\
      \ PMC identifier will not\nbe linked to the article.  If the embargo date is today or in the past, or if it is empty or omitted, then the\nPMC identifier is linked to the article through the link at cfg.id_handlers['PMC'].prefix.\n\nPMC embargo date testing\
      \ is done in function is_embargoed () which is called earlier because when the citation\nhas |pmc=&lt;value&gt; but does not have a |url= then |title= is linked with the PMC link.  Function is_embargoed ()\nreturns the embargo date if the PMC article is\
      \ still embargoed, otherwise it returns an empty string.\n\nPMCs are sequential numbers beginning at 1 and counting up.  This code checks the PMC to see that it contains only digits and is less\nthan test_limit; the value in local variable test_limit will\
      \ need to be updated periodically as more PMCs are issued.\n\n]]\n\nlocal function pmc(id, embargo)\n\tlocal test_limit = 5000000;\t\t\t\t\t\t\t-- update this value as PMCs approach\n\tlocal handler = cfg.id_handlers['PMC'];\n\tlocal err_cat =  '';\t\t\
      \t\t\t\t\t\t-- presume that PMC is valid\n\t\n\tlocal text;\n\n\tif id:match(&quot;[^%d]&quot;) then\t\t\t\t\t\t\t-- if PMC has anything but digits\n\t\terr_cat = ' ' .. set_error( 'bad_pmc' );\t\t\t-- set an error message\n\telse\t\t\t\t\t\t\t\t\t\t\t\
      \t-- PMC is only digits\n\t\tlocal id_num = tonumber(id);\t\t\t\t\t-- convert id to a number for range testing\n\t\tif 1 &gt; id_num or test_limit &lt; id_num then\t\t-- if PMC is outside test limit boundaries\n\t\t\terr_cat = ' ' .. set_error( 'bad_pmc'\
      \ );\t\t-- set an error message\n\t\tend\n\tend\n\t\n\tif is_set (embargo) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- is PMC is still embargoed?\n\t\ttext=&quot;[[&quot; .. handler.link .. &quot;|&quot; .. handler.label .. &quot;]]:&quot; .. handler.separator ..\
      \ id .. err_cat;\t-- still embargoed so no external link\n\telse\n\t\ttext = external_link_id({link = handler.link, label = handler.label,\t\t\t-- no embargo date or embargo has expired, ok to link to article\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator,\
      \ encode=handler.encode}) .. err_cat;\n\tend\n\treturn text;\nend\n\n-- Formats a DOI and checks for DOI errors.\n\n-- DOI names contain two parts: prefix and suffix separated by a forward slash.\n--  Prefix: directory indicator '10.' followed by a registrant\
      \ code\n--  Suffix: character string of any length chosen by the registrant\n\n-- This function checks a DOI name for: prefix/suffix.  If the doi name contains spaces or endashes,\n-- or, if it ends with a period or a comma, this function will emit a bad_doi\
      \ error message.\n\n-- DOI names are case-insensitive and can incorporate any printable Unicode characters so the test for spaces, endash,\n-- and terminal punctuation may not be technically correct but it appears, that in practice these characters are\
      \ rarely if ever used in doi names.\n\nlocal function doi(id, inactive)\n\tlocal cat = &quot;&quot;\n\tlocal handler = cfg.id_handlers['DOI'];\n\t\n\tlocal text;\n\tif is_set(inactive) then\n\t\tlocal inactive_year = inactive:match(&quot;%d%d%d%d&quot;)\
      \ or '';\t\t-- try to get the year portion from the inactive date\n\t\ttext = &quot;[[&quot; .. handler.link .. &quot;|&quot; .. handler.label .. &quot;]]:&quot; .. id;\n\t\tif is_set(inactive_year) then\n\t\t\ttable.insert( z.error_categories, &quot;Pages\
      \ with DOIs inactive since &quot; .. inactive_year );\n\t\telse\n\t\t\ttable.insert( z.error_categories, &quot;Pages with inactive DOIs&quot; );\t-- when inactive doesn't contain a recognizable year\n\t\tend\n\t\tinactive = &quot; (&quot; .. cfg.messages['inactive']\
      \ .. &quot; &quot; .. inactive .. &quot;)&quot; \n\telse \n\t\ttext = external_link_id({link = handler.link, label = handler.label,\n\t\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n\t\tinactive = &quot;&quot; \n\t\
      end\n\n\tif nil == id:match(&quot;^10%.[^%s–]-/[^%s–]-[^%.,]$&quot;) then\t-- doi must begin with '10.', must contain a fwd slash, must not contain spaces or endashes, and must not end with period or comma\n\t\tcat = ' ' .. set_error( 'bad_doi' );\n\t\
      end\n\treturn text .. inactive .. cat \nend\n\n-- Formats an OpenLibrary link, and checks for associated errors.\nlocal function openlibrary(id)\n\tlocal code = id:match(&quot;^%d+([AMW])$&quot;);\t\t\t\t\t-- only digits followed by 'A', 'M', or 'W'\n\t\
      local handler = cfg.id_handlers['OL'];\n\n\tif ( code == &quot;A&quot; ) then\n\t\treturn external_link_id({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/authors/OL&quot;,id=id, separator=handler.separator,\n\t\t\t\
      encode = handler.encode})\n\telseif ( code == &quot;M&quot; ) then\n\t\treturn external_link_id({link=handler.link, label=handler.label,\n\t\t\tprefix=&quot;http://openlibrary.org/books/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\
      \telseif ( code == &quot;W&quot; ) then\n\t\treturn external_link_id({link=handler.link, label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/works/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode})\n\telse\n\t\t\
      return external_link_id({link=handler.link, label=handler.label,\n\t\t\tprefix= &quot;http://openlibrary.org/OL&quot;,id=id, separator=handler.separator,\n\t\t\tencode = handler.encode}) .. \n\t\t\t' ' .. set_error( 'bad_ol' );\n\tend\nend\n\n\n--[[--------------------------&lt;\
      \ M E S S A G E _ I D &gt;----------------------------------------------------------\n\nValidate and format a usenet message id.  Simple error checking, looks for 'id-left@id-right' not enclosed in\n'&lt;' and/or '&gt;' angle brackets.\n\n]]\n\nlocal function\
      \ message_id (id)\n\tlocal handler = cfg.id_handlers['USENETID'];\n\n\ttext = external_link_id({link = handler.link, label = handler.label,\n\t\tprefix=handler.prefix,id=id,separator=handler.separator, encode=handler.encode})\n \n\tif not id:match('^.+@.+$')\
      \ or not id:match('^[^&lt;].*[^&gt;]$')then\t\t\t\t-- doesn't have '@' or has one or first or last character is '&lt; or '&gt;'\n\t\ttext = text .. ' ' .. set_error( 'bad_message_id' )\t\t\t\t\t\t-- add an error message if the message id is invalid\n\t\
      end \n\t\n\treturn text\nend\n\n--[[--------------------------&lt; S E T _ T I T L E T Y P E &gt;----------------------------------------------------\n\nThis function sets default title types (equivalent to the citation including |type=&lt;default value&gt;)\
      \ for those templates that have defaults.\nAlso handles the special case where it is desirable to omit the title type from the rendered citation (|type=none).\n\n]]\n\nlocal function set_titletype (cite_class, title_type)\n\tif is_set(title_type) then\n\
      \t\tif &quot;none&quot; == title_type then\n\t\t\ttitle_type = &quot;&quot;;\t\t\t\t\t\t\t\t\t\t\t\t\t-- if |type=none then type parameter not displayed\n\t\tend\n\t\treturn title_type;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if |type= has been set to any other\
      \ value use that value\n\tend\n\n\treturn cfg.title_types [cite_class] or '';\t\t\t\t\t\t\t\t\t-- set template's default title type; else empty string for concatenation\nend\n\n--[[--------------------------&lt; C L E A N _ I S B N &gt;----------------------------------------------------------\n\
      \nRemoves irrelevant text and dashes from ISBN number\nSimilar to that used for Special:BookSources\n\n]]\n\nlocal function clean_isbn( isbn_str )\n\treturn isbn_str:gsub( &quot;[^-0-9X]&quot;, &quot;&quot; );\nend\n\n--[[--------------------------&lt;\
      \ E S C A P E _ L U A _ M A G I C _ C H A R S &gt;----------------------------------\n\nReturns a string where all of lua's magic characters have been escaped.  This is important because functions like\nstring.gsub() treat their pattern and replace strings\
      \ as patterns, not literal strings.\n]]\nlocal function escape_lua_magic_chars (argument)\n\targument = argument:gsub(&quot;%%&quot;, &quot;%%%%&quot;);\t\t\t\t\t\t\t\t\t\t-- replace % with %%\n\targument = argument:gsub(&quot;([%^%$%(%)%.%[%]%*%+%-%?])&quot;,\
      \ &quot;%%%1&quot;);\t\t\t\t-- replace all other lua magic pattern characters\n\treturn argument;\nend\n\n--[[--------------------------&lt; S T R I P _ A P O S T R O P H E _ M A R K U P &gt;--------------------------------\n\nStrip wiki italic and bold\
      \ markup from argument so that it doesn't contaminate COinS metadata.\nThis function strips common patterns of apostrophe markup.  We presume that editors who have taken the time to\nmarkup a title have, as a result, provided valid markup. When they don't,\
      \ some single apostrophes are left behind.\n\n]]\n\nlocal function strip_apostrophe_markup (argument)\n\tif not is_set (argument) then return argument; end\n\n\twhile true do\n\t\tif argument:match (&quot;%'%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- bold\
      \ italic (5)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'%'&quot;, &quot;&quot;);\t\t\t\t\t\t\t-- remove all instances of it\n\t\telseif argument:match (&quot;%'%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- italic start and end without content (4)\n\t\t\targument=argument:gsub(&quot;%'%'%'%'&quot;,\
      \ &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'%'&quot;) then\t\t\t\t\t\t\t\t\t-- bold (3)\n\t\t\targument=argument:gsub(&quot;%'%'%'&quot;, &quot;&quot;);\n\t\telseif argument:match (&quot;%'%'&quot;) then\t\t\t\t\t\t\t\t\t\t-- italic (2)\n\t\t\
      \targument=argument:gsub(&quot;%'%'&quot;, &quot;&quot;);\n\t\telse\n\t\t\tbreak;\n\t\tend\n\tend\n\treturn argument;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- done\nend\n\n--[[--------------------------&lt; M A K E _ C O I N S _ T I T L E &gt;----------------------------------------------\n\
      \nMakes a title for COinS from Title and / or ScriptTitle (or any other name-script pairs)\n\nApostrophe markup (bold, italics) is stripped from each value so that the COinS metadata isn't correupted with strings\nof %27%27...\n]]\n\nlocal function make_coins_title\
      \ (title, script)\n\tif is_set (title) then\n\t\ttitle = strip_apostrophe_markup (title);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\telse\n\t\ttitle='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure title is an empty string\n\tend\n\tif\
      \ is_set (script) then\n\t\tscript = script:gsub ('^%l%l%s*:%s*', '');\t\t\t\t\t\t\t\t-- remove language prefix if present (script value may now be empty string)\n\t\tscript = strip_apostrophe_markup (script);\t\t\t\t\t\t\t\t-- strip any apostrophe markup\n\
      \telse\n\t\tscript='';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if not set, make sure script is an empty string\n\tend\n\tif is_set (title) and is_set (script) then\n\t\tscript = ' ' .. script;\t\t\t\t\t\t\t\t\t\t\t\t\t-- add a space before we concatenate\n\t\
      end\n\treturn title .. script;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- return the concatenation\nend\n\n--[[--------------------------&lt; G E T _ C O I N S _ P A G E S &gt;------------------------------------------------\n\nExtract page numbers from external wikilinks\
      \ in any of the |page=, |pages=, or |at= parameters for use in COinS.\n\n]]\n\nlocal function get_coins_pages (pages)\n\tlocal pattern;\n\tif not is_set (pages) then return pages; end\t\t\t\t\t\t\t\t-- if no page numbers then we're done\n\t\n\twhile true\
      \ do\n\t\tpattern = pages:match(&quot;%[(%w*:?//[^ ]+%s+)[%w%d].*%]&quot;);\t\t\t\t\t-- pattern is the opening bracket, the url and following space(s): &quot;[url &quot;\n\t\tif nil == pattern then break; end\t\t\t\t\t\t\t\t\t\t-- no more urls\n\t\tpattern\
      \ = escape_lua_magic_chars (pattern);\t\t\t\t\t\t\t\t-- pattern is not a literal string; escape lua's magic pattern characters\n\t\tpages = pages:gsub(pattern, &quot;&quot;);\t\t\t\t\t\t\t\t\t\t-- remove as many instances of pattern as possible\n\tend\n\
      \tpages = pages:gsub(&quot;[%[%]]&quot;, &quot;&quot;);\t\t\t\t\t\t\t\t\t\t\t-- remove the brackets\n\tpages = pages:gsub(&quot;–&quot;, &quot;-&quot; );\t\t\t\t\t\t\t-- replace endashes with hyphens\n\tpages = pages:gsub(&quot;&amp;%w+;&quot;, &quot;-&quot;\
      \ );\t\t\t\t\t\t-- and replace html entities (&amp;ndash; etc.) with hyphens; do we need to replace numerical entities like &amp;#32; and the like?\n\treturn pages;\nend\n\n-- Gets the display text for a wikilink like [[A|B]] or [[B]] gives B\nlocal function\
      \ remove_wiki_link( str )\n\treturn (str:gsub( &quot;%[%[([^%[%]]*)%]%]&quot;, function(l)\n\t\treturn l:gsub( &quot;^[^|]*|(.*)$&quot;, &quot;%1&quot; ):gsub(&quot;^%s*(.-)%s*$&quot;, &quot;%1&quot;);\n\tend));\nend\n\n-- Converts a hyphen to a dash\n\
      local function hyphen_to_dash( str )\n\tif not is_set(str) or str:match( &quot;[%[%]{}&lt;&gt;]&quot; ) ~= nil then\n\t\treturn str;\n\tend\t\n\treturn str:gsub( '-', '–' );\nend\n\n--[[--------------------------&lt; S A F E _ J O I N &gt;------------------------------------------------------------\n\
      \nJoins a sequence of strings together while checking for duplicate separation characters.\n\n]]\n\nlocal function safe_join( tbl, duplicate_char )\n\t--[[\n\tNote: we use string functions here, rather than ustring functions.\n\t\n\tThis has considerably\
      \ faster performance and should work correctly as \n\tlong as the duplicate_char is strict ASCII.  The strings\n\tin tbl may be ASCII or UTF8.\n\t]]\n\t\n\tlocal str = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- the output string\n\tlocal comp = '';\t\t\t\t\t\
      \t\t\t\t\t\t\t\t\t\t-- what does 'comp' mean?\n\tlocal end_chr = '';\n\tlocal trim;\n\tfor _, value in ipairs( tbl ) do\n\t\tif value == nil then value = ''; end\n\t\t\n\t\tif str == '' then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if output string is empty\n\t\t\
      \tstr = value;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- assign value to it (first time through the loop)\n\t\telseif value ~= '' then\n\t\t\tif value:sub(1,1) == '&lt;' then\t\t\t\t\t\t\t\t\t\t-- Special case of values enclosed in spans and other markup.\n\t\t\t\t\
      comp = value:gsub( &quot;%b&lt;&gt;&quot;, &quot;&quot; );\t\t\t\t\t\t\t\t-- remove html markup (&lt;span&gt;string&lt;/span&gt; -&gt; string)\n\t\t\telse\n\t\t\t\tcomp = value;\n\t\t\tend\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- typically duplicate_char\
      \ is sepc\n\t\t\tif comp:sub(1,1) == duplicate_char then\t\t\t\t\t\t\t\t-- is first charactier same as duplicate_char? why test first character?\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--   Because individual string segments often (always?) begin with\
      \ terminal punct for th\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t--   preceding segment: 'First element' .. 'sepc next element' .. etc?\n\t\t\t\ttrim = false;\n\t\t\t\tend_chr = str:sub(-1,-1);\t\t\t\t\t\t\t\t\t\t-- get the last character of the output\
      \ string\n\t\t\t\t-- str = str .. &quot;&lt;HERE(enchr=&quot; .. end_chr.. &quot;)&quot;\t\t\t\t\t-- debug stuff?\n\t\t\t\tif end_chr == duplicate_char then\t\t\t\t\t\t\t\t-- if same as separator\n\t\t\t\t\tstr = str:sub(1,-2);\t\t\t\t\t\t\t\t\t\t-- remove\
      \ it\n\t\t\t\telseif end_chr == &quot;'&quot; then\t\t\t\t\t\t\t\t\t\t-- if it might be wikimarkup\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char .. &quot;''&quot; then\t\t\t-- if last three chars of str are sepc'' \n\t\t\t\t\t\tstr = str:sub(1, -4) ..\
      \ &quot;''&quot;;\t\t\t\t\t\t\t-- remove them and add back ''\n\t\t\t\t\telseif str:sub(-5,-1) == duplicate_char .. &quot;]]''&quot; then\t\t-- if last five chars of str are sepc]]'' \n\t\t\t\t\t\ttrim = true;\t\t\t\t\t\t\t\t\t\t\t-- why? why do this and\
      \ next differently from previous?\n\t\t\t\t\telseif str:sub(-4,-1) == duplicate_char .. &quot;]''&quot; then\t\t-- if last four chars of str are sepc]'' \n\t\t\t\t\t\ttrim = true;\t\t\t\t\t\t\t\t\t\t\t-- same question\n\t\t\t\t\tend\n\t\t\t\telseif end_chr\
      \ == &quot;]&quot; then\t\t\t\t\t\t\t\t\t\t-- if it might be wikimarkup\n\t\t\t\t\tif str:sub(-3,-1) == duplicate_char .. &quot;]]&quot; then\t\t\t-- if last three chars of str are sepc]] wikilink \n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-2,-1)\
      \ == duplicate_char .. &quot;]&quot; then\t\t\t-- if last two chars of str are sepc] external link\n\t\t\t\t\t\ttrim = true;\n\t\t\t\t\telseif str:sub(-4,-1) == duplicate_char .. &quot;'']&quot; then\t\t-- normal case when |url=something &amp; |title=Title.\n\
      \t\t\t\t\t\ttrim = true;\n\t\t\t\t\tend\n\t\t\t\telseif end_chr == &quot; &quot; then\t\t\t\t\t\t\t\t\t\t-- if last char of output string is a space\n\t\t\t\t\tif str:sub(-2,-1) == duplicate_char .. &quot; &quot; then\t\t\t\t-- if last two chars of str\
      \ are &lt;sepc&gt;&lt;space&gt;\n\t\t\t\t\t\tstr = str:sub(1,-3);\t\t\t\t\t\t\t\t\t-- remove them both\n\t\t\t\t\tend\n\t\t\t\tend\n\n\t\t\t\tif trim then\n\t\t\t\t\tif value ~= comp then \t\t\t\t\t\t\t\t\t\t-- value does not equal comp when value contains\
      \ html markup\n\t\t\t\t\t\tlocal dup2 = duplicate_char;\n\t\t\t\t\t\tif dup2:match( &quot;%A&quot; ) then dup2 = &quot;%&quot; .. dup2; end\t\t-- if duplicate_char not a letter then escape it\n\t\t\t\t\t\t\n\t\t\t\t\t\tvalue = value:gsub( &quot;(%b&lt;&gt;)&quot;\
      \ .. dup2, &quot;%1&quot;, 1 )\t\t\t-- remove duplicate_char if it follows html markup\n\t\t\t\t\telse\n\t\t\t\t\t\tvalue = value:sub( 2, -1 );\t\t\t\t\t\t\t\t-- remove duplicate_char when it is first character\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\
      \t\tstr = str .. value;\t\t\t\t\t\t\t\t\t\t\t\t\t--add it to the output string\n\t\tend\n\tend\n\treturn str;\nend  \n\n--[[--------------------------&lt; I S _ G O O D _ V A N C _ N A M E &gt;--------------------------------------------\n\nFor Vancouver\
      \ Style, author/editor names are supposed to be rendered in Latin (read ASCII) characters.  When a name\nuses characters that contain diacritical marks, those characters are to converted to the corresponding Latin character.\nWhen a name is written using\
      \ a non-Latin alphabet or logogram, that name is to be transliterated into Latin characters.\nThese things are not currently possible in this module so are left to the editor to do.\n\nThis test allows |first= and |last= names to contain any of the letters\
      \ defined in the four Unicode Latin character sets\n\t[http://www.unicode.org/charts/PDF/U0000.pdf C0 Controls and Basic Latin] 0041–005A, 0061–007A\n\t[http://www.unicode.org/charts/PDF/U0080.pdf C1 Controls and Latin-1 Supplement] 00C0–00D6, 00D8–00F6,\
      \ 00F8–00FF\n\t[http://www.unicode.org/charts/PDF/U0100.pdf Latin Extended-A] 0100–017F\n\t[http://www.unicode.org/charts/PDF/U0180.pdf Latin Extended-B] 0180–01BF, 01C4–024F\n\n|lastn= also allowed to contain hyphens, spaces, and apostrophes. (http://www.ncbi.nlm.nih.gov/books/NBK7271/box/A35029/)\n\
      |firstn= also allowed to contain hyphens, spaces, apostrophes, and periods\n\nAt the time of this writing, I had to write the 'if nil == mw.ustring.find ...' test ouside of the code editor and past it here\nbecause the code editor gets confused between\
      \ character insertion point and cursor position.\n\n]]\n\nlocal function is_good_vanc_name (last, first)\n\tif nil == mw.ustring.find (last, &quot;^[A-Za-zÀ-ÖØ-öø-ƿǄ-ɏ%-%s%']*$&quot;) or nil == mw.ustring.find (first, &quot;^[A-Za-zÀ-ÖØ-öø-ƿǄ-ɏ%-%s%'%.]*$&quot;)\
      \ then\n\t\tif true ~= Page_in_vanc_error_cat then\t\t\t\t\t\t\t\t\t-- if we haven't been here before then set a sticky flag\n\t\t\tPage_in_vanc_error_cat=true;\t\t\t\t\t\t\t\t\t\t-- so that if there are more than one error the category is added only once\n\
      \t\t\ttable.insert( z.message_tail, { set_error( 'vancouver', {}, true ) } );\n\t\tend\n\t\treturn false;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not a string of latin characters; Vancouver required Romanization\n\tend;\n\treturn true;\nend\n\n--[[--------------------------&lt;\
      \ R E D U C E _ T O _ I N I T I A L S &gt;------------------------------------------\n\nAttempts to convert names to initials in support of |name-list-format=vanc.  \n\nNames in |firstn= may be separated by spaces or hyphens, or for initials, a period.\
      \ See http://www.ncbi.nlm.nih.gov/books/NBK7271/box/A35062/.\n\nVancouver style requires family rank designations (Jr, II, III, etc) to be rendered as Jr, 2nd, 3rd, etc.  This form is not\ncurrently supported by this code so correctly formed names like\
      \ Smith JL 2nd are converted to Smith J2. See http://www.ncbi.nlm.nih.gov/books/NBK7271/box/A35085/.\n\nThis function uses ustring functions because firstname initials may be any of the unicode Latin characters accepted by is_good_vanc_name ().\n\n]]\n\
      \nlocal function reduce_to_initials(first)\n\tif mw.ustring.match(first, &quot;^%u%u$&quot;) then return first end;\t\t\t\t\t-- when first contains just two upper-case letters, nothing to do\n\tlocal initials = {}\n\tlocal i = 0;\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t\t\t-- counter for number of initials\n\tfor word in mw.ustring.gmatch(first, &quot;[^%s%.%-]+&quot;) do\t\t\t\t\t\t-- names separated by spaces, hyphens, or periods\n\t\ttable.insert(initials, mw.ustring.sub(word,1,1))\t\t\t\t\t\t-- Vancouver format\
      \ does not include full stops.\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- bump the counter \n\t\tif 2 &lt;= i then break; end\t\t\t\t\t\t\t\t\t\t\t\t-- only two initials allowed in Vancouver system; if 2, quit\n\tend\n\treturn table.concat(initials)\t\
      \t\t\t\t\t\t\t\t\t\t\t-- Vancouver format does not include spaces.\nend\n\n--[[--------------------------&lt; L I S T  _ P E O P L E &gt;-------------------------------------------------------\n\nFormats a list of people (e.g. authors / editors) \n\n]]\n\
      \nlocal function list_people(control, people, etal)\n\tlocal sep;\n\tlocal namesep;\n\tlocal format = control.format\n\tlocal maximum = control.maximum\n\tlocal lastauthoramp = control.lastauthoramp;\n\tlocal text = {}\n\n\tif 'vanc' == format then\t\t\
      \t\t\t\t\t\t\t\t\t\t\t-- Vancouver-like author/editor name styling?\n\t\tsep = ',';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- name-list separator between authors is a comma\n\t\tnamesep = ' ';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- last/first separator is a space\n\t\
      else\n\t\tsep = ';'\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- name-list separator between authors is a semicolon\n\t\tnamesep = ', '\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- last/first separator is &lt;comma&gt;&lt;space&gt;\n\tend\n\t\n\tif sep:sub(-1,-1) ~= &quot; &quot;\
      \ then sep = sep .. &quot; &quot; end\n\tif is_set (maximum) and maximum &lt; 1 then return &quot;&quot;, 0; end\t\t\t\t\t-- returned 0 is for EditorCount; not used for authors\n\t\n\tfor i,person in ipairs(people) do\n\t\tif is_set(person.last) then\n\
      \t\t\tlocal mask = person.mask\n\t\t\tlocal one\n\t\t\tlocal sep_one = sep;\n\t\t\tif is_set (maximum) and i &gt; maximum then\n\t\t\t\tetal = true;\n\t\t\t\tbreak;\n\t\t\telseif (mask ~= nil) then\n\t\t\t\tlocal n = tonumber(mask)\n\t\t\t\tif (n ~= nil)\
      \ then\n\t\t\t\t\tone = string.rep(&quot;&amp;mdash;&quot;,n)\n\t\t\t\telse\n\t\t\t\t\tone = mask;\n\t\t\t\t\tsep_one = &quot; &quot;;\n\t\t\t\tend\n\t\t\telse\n\t\t\t\tone = person.last\n\t\t\t\tlocal first = person.first\n\t\t\t\tif is_set(first) then\
      \ \n\t\t\t\t\tif ( &quot;vanc&quot; == format ) then\t\t\t\t\t\t\t\t-- if vancouver format\n\t\t\t\t\t\tone = one:gsub ('%.', '');\t\t\t\t\t\t\t\t-- remove periods from surnames (http://www.ncbi.nlm.nih.gov/books/NBK7271/box/A35029/)\n\t\t\t\t\t\tif is_good_vanc_name\
      \ (one, first) then\t\t\t\t\t-- and name is all Latin characters\n\t\t\t\t\t\t\tfirst = reduce_to_initials(first)\t\t\t\t\t\t-- attempt to convert first name(s) to initials\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\t\tone = one .. namesep .. first \n\t\t\
      \t\tend\n\t\t\t\tif is_set(person.link) and person.link ~= control.page_name then\n\t\t\t\t\tone = &quot;[[&quot; .. person.link .. &quot;|&quot; .. one .. &quot;]]&quot;\t\t-- link author/editor if this page is not the author's/editor's page\n\t\t\t\t\
      end\n\n\t\t\t\tif is_set(person.link) and ((nil ~= person.link:find(&quot;//&quot;)) or (nil ~= person.link:find(&quot;[%[%]]&quot;))) then\n\t\t\t\t\tone = one .. &quot; &quot; .. set_error( 'bad_authorlink' ) end\t-- url or wikilink in author link;\n\
      \t\t\tend\n\t\t\ttable.insert( text, one )\n\t\t\ttable.insert( text, sep_one )\n\t\tend\n\tend\n\n\tlocal count = #text / 2;\n\tif count &gt; 0 then \n\t\tif count &gt; 1 and is_set(lastauthoramp) and not etal then\n\t\t\ttext[#text-2] = &quot; &amp;\
      \ &quot;;\n\t\tend\n\t\ttext[#text] = nil; \n\tend\n\t\n\tlocal result = table.concat(text) -- construct list\n\tif etal then \n\t\tlocal etal_text = cfg.messages['et al'];\n\t\tresult = result .. &quot; &quot; .. etal_text;\n\tend\n\t\n\treturn result,\
      \ count\nend\n\n--[[--------------------------&lt; A N C H O R _ I D &gt;------------------------------------------------------------\n\nGenerates a CITEREF anchor ID if we have at least one name or a date.  Otherwise returns an empty string.\n\n]]\n\n\
      local function anchor_id( options )\n\tlocal id = table.concat( options );\t\t\t\t\t\t\t\t\t\t\t-- concatenate names and year for CITEREF id\n\tif is_set (id) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if concatenation is not an empty string\n\t\treturn &quot;CITEREF&quot;\
      \ .. id;\t\t\t\t\t\t\t\t\t\t\t\t\t-- add the CITEREF portion\n\telse\n\t\treturn '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- return an empty string; no reason to include CITEREF id in this citation\n\tend\nend\n\n--[[--------------------------&lt; E X T R A\
      \ C T _ N A M E S &gt;----------------------------------------------------\nGets name list from the input arguments\n\nSearches through args in sequential order to find |lastn= and |firstn= parameters (or their aliases), and their matching link and mask\
      \ parameters.\nStops searching when both |lastn= and |firstn= are not found in args after two sequential attempts: found |last1=, |last2=, and |last3= but doesn't\nfind |last4= and |last5= then the search is done.\n\nThis function emits an error message\
      \ when there is a |firstn= without a matching |lastn=.  When there are 'holes' in the list of last names, |last1= and |last3=\nare present but |last2= is missing, an error message is emitted. |lastn= is not required to have a matching |firstn=.\n\nWhen\
      \ an author or editor parameter contains some form of 'et al.', the 'et al.' is stripped from the parameter and a flag (etal) returned\nthat will cause list_people() to add the static 'et al.' text from Module:Citation/CS1/Configuration.  This keeps 'et\
      \ al.' out of the \ntemplate's metadata.  When this occurs, the page is added to a maintenance category.\n\n]]\n\nlocal function extract_names(args, list_name)\n\tlocal names = {};\t\t\t-- table of names\n\tlocal last;\t\t\t\t\t-- individual name components\n\
      \tlocal first;\n\tlocal link;\n\tlocal mask;\n\tlocal i = 1;\t\t\t\t-- loop counter/indexer\n\tlocal n = 1;\t\t\t\t-- output table indexer\n\tlocal count = 0;\t\t\t-- used to count the number of times we haven't found a |last= (or alias for authors, |editor-last\
      \ or alias for editors)\n\tlocal etal=false;\t\t\t-- return value set to true when we find some form of et al. in an author parameter\n\tlocal pattern = &quot;,? *'*[Ee][Tt] *[Aa][Ll][%.']*$&quot;\t\t\t\t\t\t\t-- variations on the 'et al' theme\n\t\n\t\
      local err_msg_list_name = list_name:match (&quot;(%w+)List&quot;) .. 's list';\t\t-- modify AuthorList or EditorList for use in error messages if necessary\n\n\twhile true do\n\t\tlast = select_one( args, cfg.aliases[list_name .. '-Last'], 'redundant_parameters',\
      \ i );\t\t-- search through args for name components beginning at 1\n\t\tfirst = select_one( args, cfg.aliases[list_name .. '-First'], 'redundant_parameters', i );\n\t\tlink = select_one( args, cfg.aliases[list_name .. '-Link'], 'redundant_parameters',\
      \ i );\n\t\tmask = select_one( args, cfg.aliases[list_name .. '-Mask'], 'redundant_parameters', i );\n\n\t\tlocal name = tostring(last);\n\t\tif name:match (pattern) then\t\t\t\t\t\t\t\t\t\t\t-- varients on et al.\n\t\t\tlast = name:gsub (pattern, '');\t\
      \t\t\t\t\t\t\t\t\t-- if found, remove\n\t\t\tetal = true;\n\t\tend\n\t\tname = tostring(first);\n\t\tif name:match (pattern) then\t\t\t\t\t\t\t\t\t\t\t-- varients on et al.\n\t\t\tfirst = name:gsub (pattern, '');\t\t\t\t\t\t\t\t\t-- if found, remove\n\t\
      \t\tetal = true;\n\t\tend\n\n\t\tif first and not last then\t\t\t\t\t\t\t\t\t\t\t\t-- if there is a firstn without a matching lastn\n\t\t\ttable.insert( z.message_tail, { set_error( 'first_missing_last', {err_msg_list_name, i}, true ) } );\t-- add this\
      \ error message\n\t\telseif not first and not last then\t\t\t\t\t\t\t\t\t\t-- if both firstn and lastn aren't found, are we done?\n\t\t\tcount = count + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t-- number of times we haven't found last and first\n\t\t\tif 2 == count\
      \ then\t\t\t\t\t\t\t\t\t\t\t\t\t-- two missing names and we give up\n\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- normal exit or there is a two-name hole in the list; can't tell which\n\t\t\tend\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- we have last\
      \ with or without a first\n\t\t\tnames[n] = {last = last, first = first, link = link, mask = mask};\t-- add this name to our names list\n\t\t\tn = n + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next location in the names table\n\t\t\tif 1 == count then\t\
      \t\t\t\t\t\t\t\t\t\t\t\t-- if the previous name was missing\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'missing_name', {err_msg_list_name, i-1}, true ) } );\t\t-- add this error message\n\t\t\tend\n\t\t\tcount = 0;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\
      -- reset the counter, we're looking for two consecutive missing names\n\t\tend\n\t\ti = i + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- point to next args location\n\tend\n\t\n\tif true == etal then\n\t\tadd_maint_cat ('etal');\n\tend\n\treturn names, etal;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t\t-- all done, return our list of names\nend\n\n-- Populates ID table from arguments using configuration settings\nlocal function extract_ids( args )\n\tlocal id_list = {};\n\tfor k, v in pairs( cfg.id_handlers ) do\t\n\t\tv =\
      \ select_one( args, v.parameters, 'redundant_parameters' );\n\t\tif is_set(v) then id_list[k] = v; end\n\tend\n\treturn id_list;\nend\n\n--[[--------------------------&lt; B U I L D _ I D _ L I S T &gt;--------------------------------------------------------\n\
      \nTakes a table of IDs and turns it into a table of formatted ID outputs.\n\n]]\n\nlocal function build_id_list( id_list, options )\n\tlocal new_list, handler = {};\n\n\tfunction fallback(k) return { __index = function(t,i) return cfg.id_handlers[k][i]\
      \ end } end;\n\t\n\tfor k, v in pairs( id_list ) do\n\t\t-- fallback to read-only cfg\n\t\thandler = setmetatable( { ['id'] = v }, fallback(k) );\n\t\t\n\t\tif handler.mode == 'external' then\n\t\t\ttable.insert( new_list, {handler.label, external_link_id(\
      \ handler ) } );\n\t\telseif handler.mode == 'internal' then\n\t\t\ttable.insert( new_list, {handler.label, internal_link_id( handler ) } );\n\t\telseif handler.mode ~= 'manual' then\n\t\t\terror( cfg.messages['unknown_ID_mode'] );\n\t\telseif k == 'DOI'\
      \ then\n\t\t\ttable.insert( new_list, {handler.label, doi( v, options.DoiBroken ) } );\n\t\telseif k == 'ARXIV' then\n\t\t\ttable.insert( new_list, {handler.label, arxiv( v, options.Class ) } ); \n\t\telseif k == 'ASIN' then\n\t\t\ttable.insert( new_list,\
      \ {handler.label, amazon( v, options.ASINTLD ) } ); \n\t\telseif k == 'LCCN' then\n\t\t\ttable.insert( new_list, {handler.label, lccn( v ) } );\n\t\telseif k == 'OL' then\n\t\t\ttable.insert( new_list, {handler.label, openlibrary( v ) } );\n\t\telseif\
      \ k == 'PMC' then\n\t\t\ttable.insert( new_list, {handler.label, pmc( v, options.Embargo ) } );\n\t\telseif k == 'PMID' then\n\t\t\ttable.insert( new_list, {handler.label, pmid( v ) } );\n\t\telseif k == 'ISSN' then\n\t\t\ttable.insert( new_list, {handler.label,\
      \ issn( v ) } );\n\t\telseif k == 'ISBN' then\n\t\t\tlocal ISBN = internal_link_id( handler );\n\t\t\tif not check_isbn( v ) and not is_set(options.IgnoreISBN) then\n\t\t\t\tISBN = ISBN .. set_error( 'bad_isbn', {}, false, &quot; &quot;, &quot;&quot; );\n\
      \t\t\tend\n\t\t\ttable.insert( new_list, {handler.label, ISBN } );\t\t\t\t\n\t\telseif k == 'USENETID' then\n\t\t\ttable.insert( new_list, {handler.label, message_id( v ) } );\n\t\telse\n\t\t\terror( cfg.messages['unknown_manual_ID'] );\n\t\tend\n\tend\n\
      \t\n\tfunction comp( a, b )\t-- used in following table.sort()\n\t\treturn a[1] &lt; b[1];\n\tend\n\t\n\ttable.sort( new_list, comp );\n\tfor k, v in ipairs( new_list ) do\n\t\tnew_list[k] = v[2];\n\tend\n\t\n\treturn new_list;\nend\n  \n\n-- COinS metadata\
      \ (see &lt;http://ocoins.info/&gt;) allows automated tools to parse\n-- the citation information.\nlocal function COinS(data, class)\n\tif 'table' ~= type(data) or nil == next(data) then\n\t\treturn '';\n\tend\n\t\n\tlocal ctx_ver = &quot;Z39.88-2004&quot;;\n\
      \t\n\t-- treat table strictly as an array with only set values.\n\tlocal OCinSoutput = setmetatable( {}, {\n\t\t__newindex = function(self, key, value)\n\t\t\tif is_set(value) then\n\t\t\t\trawset( self, #self+1, table.concat{ key, '=', mw.uri.encode(\
      \ remove_wiki_link( value ) ) } );\n\t\t\tend\n\t\tend\n\t});\n\t\n\tif is_set(data.Chapter) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;bookitem&quot;;\n\t\tOCinSoutput[&quot;rft.atitle&quot;]\
      \ = data.Chapter;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Title;\n\telseif is_set(data.Periodical) then\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:journal&quot;;\n\t\tif 'arxiv' == class then\n\t\t\tOCinSoutput[&quot;rft.genre&quot;]\
      \ = &quot;preprint&quot;;\t\t\t\t\t\t\t\t-- cite arxiv\n\t\telse\n\t\t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;article&quot;;\n\t\tend\n\t\tOCinSoutput[&quot;rft.jtitle&quot;] = data.Periodical;\n\t\tOCinSoutput[&quot;rft.atitle&quot;] = data.Title;\n\
      \telse\n\t\tOCinSoutput.rft_val_fmt = &quot;info:ofi/fmt:kev:mtx:book&quot;;\n\t\tOCinSoutput[&quot;rft.genre&quot;] = &quot;book&quot;\n\t\tOCinSoutput[&quot;rft.btitle&quot;] = data.Title;\n\tend\n\t\n\tOCinSoutput[&quot;rft.place&quot;] = data.PublicationPlace;\n\
      \tOCinSoutput[&quot;rft.date&quot;] = data.Date;\n\tOCinSoutput[&quot;rft.series&quot;] = data.Series;\n\tOCinSoutput[&quot;rft.volume&quot;] = data.Volume;\n\tOCinSoutput[&quot;rft.issue&quot;] = data.Issue;\n\tOCinSoutput[&quot;rft.pages&quot;] = data.Pages;\n\
      \tOCinSoutput[&quot;rft.edition&quot;] = data.Edition;\n\tOCinSoutput[&quot;rft.pub&quot;] = data.PublisherName;\n\t\n\tfor k, v in pairs( data.ID_list ) do\n\t\tlocal id, value = cfg.id_handlers[k].COinS;\n\t\tif k == 'ISBN' then value = clean_isbn( v\
      \ ); else value = v; end\n\t\tif string.sub( id or &quot;&quot;, 1, 4 ) == 'info' then\n\t\t\tOCinSoutput[&quot;rft_id&quot;] = table.concat{ id, &quot;/&quot;, v };\n\t\telse\n\t\t\tOCinSoutput[ id ] = value;\n\t\tend\n\tend\n\t\n\tlocal last, first;\n\
      \tfor k, v in ipairs( data.Authors ) do\n\t\tlast, first = v.last, v.first;\n\t\tif k == 1 then\n\t\t\tif is_set(last) then\n\t\t\t\tOCinSoutput[&quot;rft.aulast&quot;] = last;\n\t\t\tend\n\t\t\tif is_set(first) then \n\t\t\t\tOCinSoutput[&quot;rft.aufirst&quot;]\
      \ = first;\n\t\t\tend\n\t\tend\n\t\tif is_set(last) and is_set(first) then\n\t\t\tOCinSoutput[&quot;rft.au&quot;] = table.concat{ last, &quot;, &quot;, first };\n\t\telseif is_set(last) then\n\t\t\tOCinSoutput[&quot;rft.au&quot;] = last;\n\t\tend\n\tend\n\
      \t\n\tOCinSoutput.rft_id = data.URL;\n\tOCinSoutput.rfr_id = table.concat{ &quot;info:sid/&quot;, mw.site.server:match( &quot;[^/]*$&quot; ), &quot;:&quot;, data.RawPage };\n\tOCinSoutput = setmetatable( OCinSoutput, nil );\n\t\n\t-- sort with version\
      \ string always first, and combine.\n\ttable.sort( OCinSoutput );\n\ttable.insert( OCinSoutput, 1, &quot;ctx_ver=&quot; .. ctx_ver );  -- such as &quot;Z39.88-2004&quot;\n\treturn table.concat(OCinSoutput, &quot;&amp;&quot;);\nend\n\n\n--[[--------------------------&lt;\
      \ G E T _ I S O 6 3 9 _ C O D E &gt;------------------------------------------------\n\nValidates language names provided in |language= parameter if not an ISO639-1 code.  Handles the special case that is Norwegian where\nISO639-1 code 'no' is mapped to\
      \ language name 'Norwegian Bokmål' by Extention:CLDR.\n\nReturns the language name and associated ISO639-1 code.  Because case of the source may be incorrect or different from the case that Wikimedia\nuses, the name comparisons are done in lower case and\
      \ when a match is found, the Wikimedia version (assumed to be correct) is returned along\nwith the code.  When there is no match, we return the original language name string.\n\nmw.language.fetchLanguageNames() will return a list of languages that aren't\
      \ part of ISO639-1. Names that aren't ISO639-1 but that are included\nin the list will be found if that name is provided in the |language= parameter.  For example, if |language=Samaritan Aramaic, that name will be\nfound with the associated code 'sam',\
      \ not an ISO639-1 code.  When names are found and the associated code is not two characters, this function\nreturns only the Wikimedia language name.\n\nAdapted from code taken from Module:Check ISO 639-1.\n\n]]\n\nlocal function get_iso639_code (lang)\n\
      \tif 'norwegian' == lang:lower() then\t\t\t\t\t\t\t\t\t\t\t-- special case related to Wikimedia remap of code 'no' at Extension:CLDR\n\t\treturn 'Norwegian', 'no';\t\t\t\t\t\t\t\t\t\t\t\t-- Make sure rendered version is properly capitalized\n\tend\n\t\n\
      \tlocal languages = mw.language.fetchLanguageNames('en', 'all')\t\t\t\t-- get a list of language names known to Wikimedia\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- ('all' is required for North Ndebele, South Ndebele, and Ojibwa)\n\tlocal langlc = mw.ustring.lower(lang);\t\
      \t\t\t\t\t\t\t\t\t-- lower case version for comparisons\n\t\n\tfor code, name in pairs(languages) do\t\t\t\t\t\t\t\t\t\t-- scan the list to see if we can find our language\n\t\tif langlc == mw.ustring.lower(name) then\n\t\t\tif 2 ~= code:len() then\t\t\
      \t\t\t\t\t\t\t\t\t\t-- ISO639-1 codes only\n\t\t\t\treturn name;\t\t\t\t\t\t\t\t\t\t\t\t\t-- so return the name but not the code\n\t\t\tend\n\t\t\treturn name, code;\t\t\t\t\t\t\t\t\t\t\t\t\t-- found it, return name to ensure proper capitalization and\
      \ the ISO639-1 code\n\t\tend\n\tend\n\treturn lang;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not valid language; return language in original case and nil for ISO639-1 code\nend\n\n--[[--------------------------&lt; L A N G U A G E _ P A R A M E T E R &gt;------------------------------------------\n\
      \nGet language name from ISO639-1 code value provided.  If a code is valid use the returned name; if not, then use the value that was provided with the language parameter.\n\nThere is an exception.  There are three ISO639-1 codes for Norewegian language\
      \ variants.  There are two official variants: Norwegian Bokmål (code 'nb') and\nNorwegian Nynorsk (code 'nn').  The third, code 'no',  is defined by ISO639-1 as 'Norwegian' though in Norway this is pretty much meaningless.  However, it appears\nthat on\
      \ enwiki, editors are for the most part unaware of the nb and nn variants (compare page counts for these variants at Category:Articles with non-English-language external links.\n\nBecause Norwegian Bokmål is the most common language variant, Media wiki\
      \ has been modified to return Norwegian Bokmål for ISO639-1 code 'no'. Here we undo that and\nreturn 'Norwegian' when editors use |language=no.  We presume that editors don't know about the variants or can't descriminate between them.\n\nSee Help talk:Citation\
      \ Style_1#An ISO 639-1 language name test\n\nWhen |language= contains a valid ISO639-1 code, the page is assigned to the category for that code: Category:Norwegian-language sources (no) if\nthe page is a mainspace page and the ISO639-1 code is not 'en'.\
      \  Similarly, if the  parameter is |language=Norwegian, it will be categorized in the same way.\n\nThis function supports multiple languages in the form |language=nb, French, th where the language names or codes are separated from each other by commas.\n\
      \n]]\n\nlocal function language_parameter (lang, namespace)\n\tlocal code;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- the ISO639-1 two character code\n\tlocal name;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- the language name\n\tlocal language_list = {};\t\t\t\t\t\t\
      \t\t\t\t\t\t\t-- table of language names to be rendered\n\tlocal names_table = {};\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- table made from the value assigned to |language=\n\tlocal unrec_cat = false\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- flag so that we only add unrecognized\
      \ category once\n\t\n\tnames_table = mw.text.split (lang, '%s*,%s*');\t\t\t\t\t\t\t\t-- names should be a comma separated list\n\t\n\tfor _, lang in ipairs (names_table) do\t\t\t\t\t\t\t\t\t\t-- reuse lang\n\t\tif 0 == namespace and (('en' == lang:lower())\
      \ or ('english' == lang:lower())) then\n\t\t\tadd_maint_cat ('english');\n\t\tend\n\t\n\t\tif 2 == lang:len() then\t\t\t\t\t\t\t\t\t\t\t\t\t-- ISO639-1 language code are 2 characters (fetchLanguageName also supports 3 character codes)\n\t\t\tname = mw.language.fetchLanguageName(\
      \ lang:lower(), &quot;en&quot; );\t\t\t-- get ISO 639-1 language name if Language is a proper code\n\t\tend\n\t\n\t\tif is_set (name) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if Language specified a valid ISO639-1 code\n\t\t\tcode = lang:lower();\t\t\t\t\t\t\t\
      \t\t\t\t\t-- save it\n\t\telse\n\t\t\tname, code = get_iso639_code (lang);\t\t\t\t\t\t\t\t-- attempt to get code from name (assign name here so that we are sure of proper capitalization)\n\t\tend\n\t\n\t\tif is_set (code) then\n\t\t\tif 'no' == code then\
      \ name = 'Norwegian' end;\t\t\t\t\t\t-- override wikimedia when code is 'no'\n\t\t\tif 0 == namespace and 'en' ~= code then\t\t\t\t\t\t\t\t-- is this page main / article space and English not the language?\n\t\t\t\tadd_prop_cat ('foreign_lang_source',\
      \ {name, code})\n\t\t\tend\n\t\telseif false == unrec_cat then\n\t\t\tunrec_cat = true;\t\t\t\t\t\t\t\t\t\t\t\t\t-- only add this category once\n\t\t\tadd_maint_cat (unknown_lang);\n\t\tend\n\t\t\n\t\ttable.insert (language_list, name);\n\t\tname = '';\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- so we can reuse it\n\tend\n\t\n\tcode = #language_list\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- reuse code as number of languages in the list\n\tif 2 &gt;= code then\n\t\tname = table.concat (language_list, ' and ')\t\t\t\t\t\t\t\
      -- insert '&lt;space&gt;and&lt;space&gt;' between two language names\n\telseif 2 &lt; code then\n\t\tlanguage_list[code] = 'and ' .. language_list[code];\t\t\t\t\t-- prepend last name with 'and&lt;space&gt;'\n\t\tname = table.concat (language_list, ',\
      \ ')\t\t\t\t\t\t\t\t-- and concatenate with '&lt;comma&gt;&lt;space&gt;' separators\n\tend\n\treturn (&quot; &quot; .. wrap_msg ('language', name));\t\t-- wrap with '(in ...)'\nend\n\n--[[--------------------------&lt; S E T _ C S 1 _ S T Y L E &gt;----------------------------------------------------\n\
      \nSet style settings for CS1 citation templates. Returns separator and postscript settings\n\n]]\n\nlocal function set_cs1_style (ps)\n\tif not is_set (ps) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unless explicitely set to something\n\t\tps = '.';\t\t\t\t\t\t\
      \t\t\t\t\t\t\t\t\t\t-- terminate the rendered citation with a period\n\tend\n\treturn '.', ps;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- separator is a full stop\nend\n\n--[[--------------------------&lt; S E T _ C S 2 _ S T Y L E &gt;----------------------------------------------------\n\
      \nSet style settings for CS2 citation templates. Returns separator, postscript, ref settings\n\n]]\n\nlocal function set_cs2_style (ps, ref)\n\tif not is_set (ps) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if |postscript= has not been set, set cs2 default\n\t\t\
      ps = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- make sure it isn't nil\n\tend\n\tif not is_set (ref) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if |ref= is not set\n\t\tref = &quot;harv&quot;;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- set default |ref=harv\n\tend\n\treturn ',',\
      \ ps, ref;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- separator is a comma\nend\n\n--[[--------------------------&lt; G E T _ S E T T I N G S _ F R O M _ C I T E _ C L A S S &gt;----------------------\n\nWhen |mode= is not set or when its value is invalid, use config.CitationClass\
      \ and parameter values to establish\nrendered style.\n\n]]\n\nlocal function get_settings_from_cite_class (ps, ref, cite_class)\n\tlocal sep;\n\tif (cite_class == &quot;citation&quot;) then\t\t\t\t\t\t\t\t\t\t\t-- for citation templates (CS2)\n\t\tsep,\
      \ ps, ref = set_cs2_style (ps, ref);\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not a citation template so CS1\n\t\tsep, ps = set_cs1_style (ps);\n\tend\n\n\treturn sep, ps, ref\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- return them all\nend\n\n--[[--------------------------&lt;\
      \ S E T _ S T Y L E &gt;------------------------------------------------------------\n\nEstablish basic style settings to be used when rendering the citation.  Uses |mode= if set and valid or uses\nconfig.CitationClass from the template's #invoke: to establish\
      \ style.\n\n]]\n\nlocal function set_style (mode, ps, ref, cite_class)\n\tlocal sep;\n\tif 'cs2' == mode then\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if this template is to be rendered in CS2 (citation) style\n\t\tsep, ps, ref = set_cs2_style (ps, ref);\n\telseif\
      \ 'cs1' == mode then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if this template is to be rendered in CS1 (cite xxx) style\n\t\tsep, ps = set_cs1_style (ps);\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- anything but cs1 or cs2\n\t\tif is_set (mode) then\n\t\t\ttable.insert(\
      \ z.message_tail, { set_error( 'invalid_param_val', {'mode', mode}, true ) } );\t\t-- add error message\n\t\tend\n\t\tsep, ps, ref = get_settings_from_cite_class (ps, ref, cite_class);\t\t-- get settings based on the template's CitationClass\n\tend\n\t\
      if 'none' == ps:lower() then\t\t\t\t\t\t\t\t\t\t\t\t-- if assigned value is 'none' then\n\t\tps = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- set to empty string\n\tend\n\t\n\treturn sep, ps, ref\nend\n\n--[=[-------------------------&lt; I S _ P D F &gt;------------------------------------------------------------------\n\
      \nDetermines if a url has the file extension is one of the pdf file extensions used by [[MediaWiki:Common.css]] when\napplying the pdf icon to external links.\n\nreturns true if file extension is one of the recognized extension, else false\n\n]=]\n\nlocal\
      \ function is_pdf (url)\n\treturn url:match ('%.pdf[%?#]?') or url:match ('%.PDF[%?#]?');\nend\n\n--[[--------------------------&lt; S T Y L E _ F O R M A T &gt;------------------------------------------------------\n\nApplies css style to |format=, |chapter-format=,\
      \ etc.  Also emits an error message if the format parameter does\nnot have a matching url parameter.  If the format parameter is not set and the url contains a file extension that\nis recognized as a pdf document by MediaWiki's commons.css, this code will\
      \ set the format parameter to (PDF) with\nthe appropriate styling.\n\n]]\n\nlocal function style_format (format, url, fmt_param, url_param)\n\tif is_set (format) then\n\t\tformat = wrap_style ('format', format:upper());\t\t\t\t\t\t\t-- force upper case,\
      \ add leading space, parenthases, resize\n\t\tif not is_set (url) then\n\t\t\tformat = format .. set_error( 'format_missing_url', {fmt_param, url_param} );\t-- add an error message\n\t\tend\n\telseif is_pdf (url) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- format\
      \ is not set so if url is a pdf file then\n\t\tformat = wrap_style ('format', 'PDF');\t\t\t\t\t\t\t\t\t-- set format to pdf\n\telse\n\t\tformat = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- empty string for concatenation\n\tend\n\treturn format;\nend\n\n--[[--------------------------&lt;\
      \ G E T _ D I S P L A Y _ A U T H O R S _ E D I T O R S &gt;------------------------\n\nReturns a number that may or may not limit the length of the author or editor name lists.\n\nWhen the value assigned to |display-authors= is a number greater than or\
      \ equal to zero, return the number and\nthe previous state of the 'etal' flag (false by default but may have been set to true if the name list contains\nsome variant of the text 'et al.').\n\nWhen the value assigned to |display-authors= is the keyword\
      \ 'etal', return a number that is one greater than the\nnumber of authors in the list and set the 'etal' flag true.  This will cause the list_people() to display all of\nthe names in the name list followed by 'et al.'\n\nIn all other cases, returns nil\
      \ and the previous state of the 'etal' flag.\n\n]]\n\nlocal function get_display_authors_editors (max, count, list_name, etal)\n\tif is_set (max) then\n\t\tif 'etal' == max:lower():gsub(&quot;[ '%.]&quot;, '') then\t\t\t\t\t\t-- the :gsub() portion makes\
      \ 'etal' from a variety of 'et al.' spellings and stylings\n\t\t\tmax = count + 1;\t\t\t\t\t\t\t\t\t\t\t\t\t-- number of authors + 1 so display all author name plus et al.\n\t\t\tetal = true;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- overrides value set by extract_names()\n\
      \t\telseif max:match ('^%d+$') then\t\t\t\t\t\t\t\t\t\t\t-- if is a string of numbers\n\t\t\tmax = tonumber (max);\t\t\t\t\t\t\t\t\t\t\t\t-- make it a number\n\t\t\tif max &gt;= count and 'authors' == list_name then\t-- AUTHORS ONLY\t\t-- if |display-xxxxors=\
      \ value greater than or equal to number of authors/editors\n\t\t\t\tadd_maint_cat ('disp_auth_ed', list_name);\n\t\t\tend\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not a valid keyword or number\n\t\t\ttable.insert( z.message_tail, { set_error( 'invalid_param_val',\
      \ {'display-' .. list_name, max}, true ) } );\t\t-- add error message\n\t\t\tmax = nil;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\tend\n\telseif 'authors' == list_name then\t\t-- AUTHORS ONLY\tneed to clear implicit et al category\n\t\tmax = count + 1;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t-- number of authors + 1\n\tend\n\t\n\treturn max, etal;\nend\n\n--[[--------------------------&lt; C I T A T I O N 0 &gt;------------------------------------------------------------\n\nThis is the main function doing the majority\
      \ of the citation\nformatting.\n\n]]\n\nlocal function citation0( config, args)\n\t--[[ \n\tLoad Input Parameters\n\tThe argument_wrapper facilitates the mapping of multiple\n\taliases to single internal variable.\n\t]]\n\tlocal A = argument_wrapper( args\
      \ );\n\n\tlocal i \n\tlocal PPrefix = A['PPrefix']\n\tlocal PPPrefix = A['PPPrefix']\n\tif is_set( A['NoPP'] ) then PPPrefix = &quot;&quot; PPrefix = &quot;&quot; end\n\t\n\t-- Pick out the relevant fields from the arguments.  Different citation templates\n\
      \t-- define different field names for the same underlying things.\t\n\tlocal Authors = A['Authors'];\n\tlocal author_etal;\n\tlocal a, author_etal = extract_names( args, 'AuthorList' );\n\n\tlocal Coauthors = A['Coauthors'];\n\tlocal Others = A['Others'];\n\
      \tlocal Editors = A['Editors'];\n\tlocal editor_etal;\n\tlocal e, editor_etal = extract_names( args, 'EditorList' );\n\n\tlocal NameListFormat = A['NameListFormat'];\t\t\t\t\t\t\t\t\t-- replaces |author-format= and |editor-format=\n\tif is_set (NameListFormat)\
      \ and ('vanc' ~= NameListFormat) then\t\t\t\t\t\t\t\t\t\t\t-- only accepted value for this parameter is 'vanc'\n\t\ttable.insert( z.message_tail, { set_error( 'invalid_param_val', {'name-list-format', NameListFormat}, true ) } );\t-- not vanc so add error\
      \ message\n\t\tNameListFormat = '';\t\t\t\t\t\t\t\t\t\t\t\t\t-- set to empty string\n\tend\n\n\tlocal Year = A['Year'];\n\tlocal PublicationDate = A['PublicationDate'];\n\tlocal OrigYear = A['OrigYear'];\n\tlocal Date = A['Date'];\n\tlocal LayDate = A['LayDate'];\n\
      \t------------------------------------------------- Get title data\n\tlocal Title = A['Title'];\n\tlocal ScriptTitle = A['ScriptTitle'];\n\tlocal BookTitle = A['BookTitle'];\n\tlocal Conference = A['Conference'];\n\tlocal TransTitle = A['TransTitle'];\n\
      \tlocal TitleNote = A['TitleNote'];\n\tlocal TitleLink = A['TitleLink'];\n\tlocal Chapter = A['Chapter'];\n\tlocal ChapterLink = A['ChapterLink'];\t\t\t\t\t\t\t\t\t\t-- deprecated\n\tlocal TransChapter = A['TransChapter'];\n\tlocal TitleType = A['TitleType'];\n\
      \tlocal Degree = A['Degree'];\n\tlocal Docket = A['Docket'];\n\tlocal ArchiveFormat = A['ArchiveFormat'];\n\tlocal ArchiveURL = A['ArchiveURL'];\n\tlocal URL = A['URL']\n\tlocal URLorigin = A:ORIGIN('URL');\t\t\t\t\t\t\t\t\t\t\t-- get name of parameter\
      \ that holds URL\n\tlocal ChapterURL = A['ChapterURL'];\n\tlocal ChapterURLorigin = A:ORIGIN('ChapterURL');\t\t\t\t\t\t\t-- get name of parameter that holds ChapterURL\n\tlocal ConferenceFormat = A['ConferenceFormat'];\n\tlocal ConferenceURL = A['ConferenceURL'];\n\
      \tlocal ConferenceURLorigin = A:ORIGIN('ConferenceURL');\t\t\t\t\t\t-- get name of parameter that holds ConferenceURL\n\tlocal Periodical = A['Periodical'];\n\n\tlocal Series = A['Series'];\n\tlocal Volume = A['Volume'];\n\tlocal Issue = A['Issue'];\n\t\
      local Position = '';\n\tlocal Page = A['Page'];\n\tlocal Pages = hyphen_to_dash( A['Pages'] );\t\n\tlocal At = A['At'];\n\n\tlocal Edition = A['Edition'];\n\tlocal PublicationPlace = A['PublicationPlace']\n\tlocal Place = A['Place'];\n\t\n\tlocal PublisherName\
      \ = A['PublisherName'];\n\tlocal RegistrationRequired = A['RegistrationRequired'];\n\tlocal SubscriptionRequired = A['SubscriptionRequired'];\n\tlocal Via = A['Via'];\n\tlocal AccessDate = A['AccessDate'];\n\tlocal ArchiveDate = A['ArchiveDate'];\n\tlocal\
      \ Agency = A['Agency'];\n\tlocal DeadURL = A['DeadURL']\n\tlocal Language = A['Language'];\n\tlocal Format = A['Format'];\n\tlocal ChapterFormat = A['ChapterFormat'];\n\tlocal DoiBroken = A['DoiBroken'];\n\tlocal ID = A['ID'];\n\tlocal ASINTLD = A['ASINTLD'];\n\
      \tlocal IgnoreISBN = A['IgnoreISBN'];\n\tlocal Embargo = A['Embargo'];\n\tlocal Class = A['Class'];\t\t\t\t\t\t\t\t\t\t\t\t\t-- arxiv class identifier\n\n\tlocal ID_list = extract_ids( args );\n\n\tlocal Quote = A['Quote'];\n\n\tlocal LayFormat = A['LayFormat'];\n\
      \tlocal LayURL = A['LayURL'];\n\tlocal LaySource = A['LaySource'];\n\tlocal Transcript = A['Transcript'];\n\tlocal TranscriptFormat = A['TranscriptFormat'];\n\tlocal TranscriptURL = A['TranscriptURL'] \n\tlocal TranscriptURLorigin = A:ORIGIN('TranscriptURL');\t\
      \t\t\t\t\t-- get name of parameter that holds TranscriptURL\n\n\tlocal LastAuthorAmp = A['LastAuthorAmp'];\n\tlocal no_tracking_cats = A['NoTracking'];\n\n--these are used by cite interview\n\tlocal Callsign = A['Callsign'];\n\tlocal City = A['City'];\n\
      \tlocal Program = A['Program'];\n\n--local variables that are not cs1 parameters\n\tlocal use_lowercase;\t\t\t\t\t\t\t\t-- controls capitalization of certain static text\n\tlocal this_page = mw.title.getCurrentTitle();\t\t-- also used for COinS and for\
      \ language\n\tlocal anchor_year;\t\t\t\t\t\t\t\t\t-- used in the CITEREF identifier\n\tlocal COinS_date;\t\t\t\t\t\t\t\t\t-- used in the COinS metadata\n\n-- set default parameter values defined by |mode= parameter.  If |mode= is empty or omitted, use\
      \ CitationClass to set these values\n\tlocal sepc;\t\t\t\t\t\t\t\t\t\t\t-- separator between citation elements for CS1 a period, for CS2, a comma\n\tlocal PostScript;\n\tlocal Ref;\n\tsepc, PostScript, Ref = set_style (A['Mode']:lower(), A['PostScript'],\
      \ A['Ref'], config.CitationClass);\n\tuse_lowercase = ( sepc == ',' );\t\t\t\t\t-- used to control capitalization for certain static text\n\n--check this page to see if it is in one of the namespaces that cs1 is not supposed to add to the error categories\n\
      \tif not is_set (no_tracking_cats) then\t\t\t\t\t\t\t\t\t\t-- ignore if we are already not going to categorize this page\n\t\tif in_array (this_page.nsText, cfg.uncategorized_namespaces) then\n\t\t\tno_tracking_cats = &quot;true&quot;;\t\t\t\t\t\t\t\t\t\
      \t\t-- set no_tracking_cats\n\t\tend\n\t\tfor _,v in ipairs (cfg.uncategorized_subpages) do\t\t\t\t\t\t-- cycle through page name patterns\n\t\t\tif this_page.text:match (v) then\t\t\t\t\t\t\t\t\t-- test page name against each pattern\n\t\t\t\tno_tracking_cats\
      \ = &quot;true&quot;;\t\t\t\t\t\t\t\t\t\t-- set no_tracking_cats\n\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- bail out if one is found\n\t\t\tend\n\t\tend\n\tend\n\n-- check for extra |page=, |pages= or |at= parameters. \n\tif is_set(Page) then\n\t\t\
      if is_set(Pages) or is_set(At) then\n\t\t\tPage = Page .. &quot; &quot; .. set_error('extra_pages');\t-- add error message\n\t\t\tPages = '';\t\t\t\t\t\t\t\t\t\t-- unset the others\n\t\t\tAt = '';\n\t\tend\n\telseif is_set(Pages) then\n\t\tif is_set(At)\
      \ then\n\t\t\tPages = Pages .. &quot; &quot; .. set_error('extra_pages');\t-- add error messages\n\t\t\tAt = '';\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\tend\n\tend\t\n\n-- both |publication-place= and |place= (|location=) allowed if different\n\tif not is_set(PublicationPlace)\
      \ and is_set(Place) then\n\t\tPublicationPlace = Place;\t\t\t\t\t\t\t-- promote |place= (|location=) to |publication-place\n\tend\n\t\n\tif PublicationPlace == Place then Place = ''; end\t\t-- don't need both if they are the same\n\t\n--[[\nParameter remapping\
      \ for cite encyclopedia:\nWhen the citation has these parameters:\n\t|encyclopedia and |title then map |title to |article and |encyclopedia to |title\n\t|encyclopedia and |article then map |encyclopedia to |title\n\t|encyclopedia then map |encyclopedia\
      \ to |title\n\n\t|trans_title maps to |trans_chapter when |title is re-mapped\n\t|url maps to |chapterurl when |title is remapped\n\nAll other combinations of |encyclopedia, |title, and |article are not modified\nTODO: script-title to script-chapter if\
      \ and when we support script-chapter\n]]\n\nlocal Encyclopedia = A['Encyclopedia'];\n\n\tif ( config.CitationClass == &quot;encyclopaedia&quot; ) or ( config.CitationClass == &quot;citation&quot; and is_set (Encyclopedia)) then\t-- test code for citation\n\
      \t\tif is_set(Periodical) then\t\t\t\t\t-- Periodical is set when |encyclopedia is set\n\t\t\tif is_set(Title) then\n\t\t\t\tif not is_set(Chapter) then\n\t\t\t\t\tChapter = Title;\t\t\t\t-- |encyclopedia and |title are set so map |title to |article and\
      \ |encyclopedia to |title\n\t\t\t\t\tTransChapter = TransTitle;\n\t\t\t\t\tChapterURL = URL;\n\t\t\t\t\tTitle = Periodical;\n\t\t\t\t\tChapterFormat = Format;\n\t\t\t\t\tPeriodical = '';\t\t\t\t-- redundant so unset\n\t\t\t\t\tTransTitle = '';\t\t\t\t\
      -- redundant so unset\n\t\t\t\t\tURL = '';\t\t\t\t\t\t-- redundant so unset\n\t\t\t\t\tFormat = '';\t\t\t\t\t-- redundant so unset\n\t\t\t\tend\n\t\t\telse\t\t\t\t\t\t\t\t\t-- |title not set\n\t\t\t\tTitle = Periodical;\t\t\t\t\t-- |encyclopedia set and\
      \ |article set or not set so map |encyclopedia to |title\n\t\t\t\tPeriodical = '';\t\t\t\t\t-- redundant so unset\n\t\t\tend\n\t\tend\n\tend\n\n-- Special case for cite techreport.\n\tif (config.CitationClass == &quot;techreport&quot;) then\t-- special\
      \ case for cite techreport\n\t\tif is_set(Issue) then\t\t\t\t\t\t-- cite techreport uses 'number', which other citations aliase to 'issue'\n\t\t\tif not is_set(ID) then\t\t\t\t\t-- can we use ID for the &quot;number&quot;?\n\t\t\t\tID = Issue;\t\t\t\t\t\
      \t\t-- yes, use it\n\t\t\t\tIssue = &quot;&quot;;\t\t\t\t\t\t\t-- unset Issue so that &quot;number&quot; isn't duplicated in the rendered citation or COinS metadata\n\t\t\telse\t\t\t\t\t\t\t\t\t-- can't use ID so emit error message\n\t\t\t\tID = ID ..\
      \ &quot; &quot; .. set_error('redundant_parameters', '&lt;code&gt;&amp;#124;id=&lt;/code&gt; and &lt;code&gt;&amp;#124;number=&lt;/code&gt;');\n\t\t\tend\n\t\tend\t\n\tend\n\n-- special case for cite interview\n\tif (config.CitationClass == &quot;interview&quot;)\
      \ then\n\t\tif is_set(Program) then\n\t\t\tID = ' ' .. Program;\n\t\tend\n\t\tif is_set(Callsign) then\n\t\t\tif is_set(ID) then\n\t\t\t\tID = ID .. sepc .. ' ' .. Callsign;\n\t\t\telse\n\t\t\t\tID = ' ' .. Callsign;\n\t\t\tend\n\t\tend\n\t\tif is_set(City)\
      \ then\n\t\t\tif is_set(ID) then\n\t\t\t\tID = ID .. sepc .. ' ' .. City;\n\t\t\telse\n\t\t\t\tID = ' ' .. City;\n\t\t\tend\n\t\tend\n\n\t\tif is_set(Others) then\n\t\t\tif is_set(TitleType) then\n\t\t\t\tOthers = ' ' .. TitleType .. ' with ' .. Others;\n\
      \t\t\t\tTitleType = '';\n\t\t\telse\n\t\t\t\tOthers = ' ' .. 'Interview with ' .. Others;\n\t\t\tend\n\t\telse\n\t\t\tOthers = '(Interview)';\n\t\tend\n\tend\n\n-- special case for cite mailing list\n\tif (config.CitationClass == &quot;mailinglist&quot;)\
      \ then\n\t\tPeriodical = A ['MailingList'];\n\tend\n\n-- Account for the oddity that is {{cite conference}}, before generation of COinS data.\n\tif 'conference' == config.CitationClass then\n\t\tif is_set(BookTitle) then\n\t\t\tChapter = Title;\n--\t\t\
      \tChapterLink = TitleLink;\t\t\t\t\t\t\t\t\t\t\t-- |chapterlink= is deprecated\n\t\t\tChapterURL = URL;\n\t\t\tChapterURLorigin = URLorigin;\n\t\t\tURLorigin = '';\n\t\t\tChapterFormat = Format;\n\t\t\tTransChapter = TransTitle;\n\t\t\tTitle = BookTitle;\n\
      \t\t\tFormat = '';\n--\t\t\tTitleLink = '';\n\t\t\tTransTitle = '';\n\t\t\tURL = '';\n\t\tend\n\telseif 'speech' ~= config.CitationClass then\n\t\tConference = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- not cite conference or cite speech so make sure this is empty\
      \ string\n\tend\n\n-- cite map oddities\n\tlocal Cartography = &quot;&quot;;\n\tlocal Scale = &quot;&quot;;\n\tlocal Sheet = A['Sheet'] or '';\n\tlocal Sheets = A['Sheets'] or '';\n\tif config.CitationClass == &quot;map&quot; then\n\t\tChapter = A['Map'];\n\
      \t\tChapterURL = A['MapURL'];\n\t\tTransChapter = A['TransMap'];\n\t\tChapterURLorigin = A:ORIGIN('MapURL');\n\t\tChapterFormat = A['MapFormat'];\n\t\t\n\t\tCartography = A['Cartography'];\n\t\tif is_set( Cartography ) then\n\t\t\tCartography = sepc ..\
      \ &quot; &quot; .. wrap_msg ('cartography', Cartography, use_lowercase);\n\t\tend\t\t\n\t\tScale = A['Scale'];\n\t\tif is_set( Scale ) then\n\t\t\tScale = sepc .. &quot; &quot; .. Scale;\n\t\tend\n\tend\n\n-- Account for the oddities that are {{cite episode}}\
      \ and {{cite serial}}, before generation of COinS data.\n\tif 'episode' == config.CitationClass or 'serial' == config.CitationClass then\n\t\tlocal AirDate = A['AirDate'];\n\t\tlocal Began = A['Began'];\t\t\t\t\t\t\t\t\t\t\t\t-- these two are deprecated\
      \ because the module understands date ranges\n\t\tlocal Ended = A['Ended'];\n\t\tlocal SeriesLink = A['SeriesLink'];\n\t\tlocal Network = A['Network'];\n\t\tlocal Station = A['Station'];\n\t\tlocal s, n = {}, {};\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t-- do common parameters first\n\t\tif is_set(Network) then table.insert(n, Network); end\n\t\tif is_set(Station) then table.insert(n, Station); end\n\t\tID = table.concat(n, sepc .. ' ');\n\t\t\n\t\tif not is_set (Date) then\t\t\t\t\t\t\t\t\t\t\t\t\
      -- promote airdate or Began/Ended to date\n\t\t\tif is_set (AirDate) then\n\t\t\t\tDate = AirDate;\n\t\t\telseif is_set (Began) then\t\t\t\t\t\t\t\t\t\t\t-- deprecated\n\t\t\t\tif Began:match('%s') or Ended:match('%s') then\t\t\t\t\t-- so we don't create\
      \ errors: if either has spaces then\n\t\t\t\t\tDate = Began .. ' – ' .. Ended;\t\t\t\t\t\t\t\t-- use spaced ndash as separator\n\t\t\t\telse\n\t\t\t\t\tDate = Began .. '–' .. Ended;\t\t\t\t\t\t\t\t-- elsewise no spaces\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\
      \n\t\tif 'episode' == config.CitationClass then\t\t\t\t\t\t\t\t-- handle the oddities that are strictly {{cite episode}}\n\t\t\tlocal Season = A['Season'];\n\t\t\tlocal SeriesNumber = A['SeriesNumber'];\n\n\t\t\tif is_set (Season) and is_set (SeriesNumber)\
      \ then\t\t\t\t\t-- these are mutually exclusive so if both are set\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'redundant_parameters', {wrap_style ('parameter', 'season') .. ' and ' .. wrap_style ('parameter', 'seriesno')}, true ) } );\t\t-- add\
      \ error message\n\t\t\t\tSeriesNumber = '';\t\t\t\t\t\t\t\t\t\t\t\t-- unset; prefer |season= over |seriesno=\n\t\t\tend\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- assemble a table of parts concatenated later into Series\n\t\t\tif is_set(Season) then table.insert(s,\
      \ wrap_msg ('season', Season, use_lowercase)); end\n\t\t\tif is_set(SeriesNumber) then table.insert(s, wrap_msg ('series', SeriesNumber, use_lowercase)); end\n\t\t\tif is_set(Issue) then table.insert(s, wrap_msg ('episode', Issue, use_lowercase)); end\n\
      \t\t\tIssue = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset because this is not a unique parameter\n\t\n\t\t\tChapter = Title;\t\t\t\t\t\t\t\t\t\t\t\t\t-- promote title parameters to chapter\n\t\t\tChapterLink = TitleLink;\t\t\t\t\t\t\t\t\t\t\t-- alias episodelink\n\
      \t\t\tTransChapter = TransTitle;\n\t\t\tChapterURL = URL;\n\t\t\tChapterURLorigin = A:ORIGIN('URL');\n\t\t\t\n\t\t\tTitle = Series;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- promote series to title\n\t\t\tTitleLink = SeriesLink;\n\t\t\tSeries = table.concat(s, sepc\
      \ .. ' ');\t\t\t\t\t\t\t\t-- this is concatenation of season, seriesno, episode number\n\n\t\t\tif is_set (ChapterLink) and not is_set (ChapterURL) then\t\t\t-- link but not URL\n\t\t\t\tChapter = '[[' .. ChapterLink .. '|' .. Chapter .. ']]';\t\t-- ok\
      \ to wikilink\n\t\t\telseif is_set (ChapterLink) and is_set (ChapterURL) then\t\t\t-- if both are set, URL links episode;\n\t\t\t\tSeries = '[[' .. ChapterLink .. '|' .. Series .. ']]';\t\t\t-- series links with ChapterLink (episodelink -&gt; TitleLink\
      \ -&gt; ChapterLink) ugly\n\t\t\tend\n\t\t\tURL = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\t\tTransTitle = '';\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset\n\t\t\t\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- now oddities that are cite serial\n\t\t\tIssue =\
      \ '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- unset because this parameter no longer supported by the citation/core version of cite serial\n\t\t\tChapter = A['Episode'];\t\t\t\t\t\t\t\t\t\t\t\t-- TODO: make |episode= available to cite episode someday?\n\t\t\tif\
      \ is_set (Series) and is_set (SeriesLink) then\n\t\t\t\tSeries = '[[' .. SeriesLink .. '|' .. Series .. ']]';\n\t\t\tend\n\t\t\tSeries = wrap_style ('italic-title', Series);\t\t\t\t\t\t-- series is italicized\n\t\tend\t\n\tend\n-- end of {{cite episode}}\
      \ stuff\n\n-- Account for the oddities that are {{cite arxiv}}, before generation of COinS data.\n\tif 'arxiv' == config.CitationClass then\n\t\tif not is_set (ID_list['ARXIV']) then\t\t\t\t\t\t\t\t\t-- |arxiv= or |eprint= required for cite arxiv\n\t\t\
      \ttable.insert( z.message_tail, { set_error( 'arxiv_missing', {}, true ) } );\t\t-- add error message\n\t\tend\n\t\tif first_set (AccessDate, At, Chapter, Format, Page, Pages, Periodical, PublisherName, URL,\t-- a crude list of parameters that are not\
      \ supported by cite arxiv\n\t\t\tID_list['ASIN'], ID_list['BIBCODE'], ID_list['DOI'], ID_list['ISBN'], ID_list['ISSN'],\n\t\t\tID_list['JFM'], ID_list['JSTOR'], ID_list['LCCN'], ID_list['MR'], ID_list['OCLC'], ID_list['OL'],\n\t\t\tID_list['OSTI'], ID_list['PMC'],\
      \ ID_list['PMID'], ID_list['RFC'], ID_list['SSRN'], ID_list['USENETID'], ID_list['ZBL']) then\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'arxiv_params_not_supported', {}, true ) } );\t\t-- add error message\n\n\t\t\t\tAccessDate= '';\t\t\t\t\t\
      \t\t\t\t\t\t\t\t-- set these to empty string; not supported in cite arXiv\n\t\t\t\tPublisherName = '';\t\t\t\t\t\t\t\t\t\t\t\t-- (if the article has been published, use cite journal, or other)\n\t\t\t\tChapter = '';\n\t\t\t\tURL = '';\n\t\t\t\tFormat =\
      \ '';\n\t\t\t\tPage = ''; Pages = ''; At = '';\n\t\tend\n\t\tPeriodical = 'arXiv';\t\t\t\t\t\t\t\t\t\t\t\t\t-- set to arXiv for COinS; after that, must be set to empty string\n\tend\n\n-- handle type parameter for those CS1 citations that have default\
      \ values\n\n\tif in_array(config.CitationClass, {&quot;AV-media-notes&quot;, &quot;DVD-notes&quot;, &quot;mailinglist&quot;, &quot;map&quot;, &quot;podcast&quot;, &quot;pressrelease&quot;, &quot;report&quot;, &quot;techreport&quot;, &quot;thesis&quot;})\
      \ then\n\t\tTitleType = set_titletype (config.CitationClass, TitleType);\n\t\tif is_set(Degree) and &quot;Thesis&quot; == TitleType then\t\t\t\t\t\t-- special case for cite thesis\n\t\t\tTitleType = Degree .. &quot; thesis&quot;;\n\t\tend\n\tend\n\n\t\
      if is_set(TitleType) then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if type parameter is specified\n\t\tTitleType = &quot; (&quot; .. TitleType .. &quot;)&quot;;\t\t\t\t\t\t\t\t\t-- display it in parentheses\n\tend\n\n-- legacy: promote concatenation of |month=, and\
      \ |year= to Date if Date not set; or, promote PublicationDate to Date if neither Date nor Year are set.\n\tif not is_set (Date) then\n\t\tDate = Year;\t\t\t\t\t\t-- promote Year to Date\n\t\tYear = nil;\t\t\t\t\t\t\t-- make nil so Year as empty string\
      \ isn't used for CITEREF\n\t\tif is_set(Date) then\n\t\t\tlocal Month = A['Month'];\n\t\t\tif is_set(Month) then\n\t\t\t\tDate = Month .. &quot; &quot; .. Date;\n\t\t\tend\n\t\telseif is_set(PublicationDate) then\t-- use PublicationDate when |date= and\
      \ |year= are not set\n\t\t\tDate = PublicationDate;\t\t\t-- promote PublicationDate to Date\n\t\t\tPublicationDate = '';\t\t\t-- unset, no longer needed\n\t\tend\n\tend\n\n\tif PublicationDate == Date then PublicationDate = ''; end\t-- if PublicationDate\
      \ is same as Date, don't display in rendered citation\n\n--[[\nGo test all of the date-holding parameters for valid MOS:DATE format and make sure that dates are real dates. This must be done before we do COinS because here is where\nwe get the date used\
      \ in the metadata.\n\nDate validation supporting code is in Module:Citation/CS1/Date_validation\n]]\n\tdo\t-- create defined block to contain local variables error_message and mismatch\n\t\tlocal error_message = '';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t-- AirDate has been promoted to Date so not necessary to check it\n\t\tanchor_year, COinS_date, error_message = dates({['accessdate']=AccessDate, ['archivedate']=ArchiveDate, ['date']=Date, ['doi_brokendate']=DoiBroken,\n\t\t\t['embargo']=Embargo,\
      \ ['laydate']=LayDate, ['publicationdate']=PublicationDate, ['year']=Year});\n\n\t\tif is_set (Year) and is_set (Date) then\t\t\t\t\t\t\t\t\t-- both |date= and |year= not normally needed; \n\t\t\tlocal mismatch = year_date_check (Year, Date)\n\t\t\tif\
      \ 0 == mismatch then\t\t\t\t\t\t\t\t\t\t\t\t-- |year= does not match a year-value in |date=\n\t\t\t\tif is_set (error_message) then\t\t\t\t\t\t\t\t\t-- if there is already an error message\n\t\t\t\t\terror_message = error_message .. ', ';\t\t\t\t\t\t--\
      \ tack on this additional message\n\t\t\t\tend\n\t\t\t\terror_message = error_message .. '&amp;#124;year= / &amp;#124;date= mismatch';\n\t\t\telseif 1 == mismatch then\t\t\t\t\t\t\t\t\t\t\t-- |year= matches year-value in |date=\n\t\t\t\tadd_maint_cat ('date_year');\n\
      \t\t\tend\n\t\tend\n\n\t\tif is_set(error_message) then\n\t\t\ttable.insert( z.message_tail, { set_error( 'bad_date', {error_message}, true ) } );\t-- add this error message\n\t\tend\n\tend\t-- end of do\n\n-- Account for the oddity that is {{cite journal}}\
      \ with |pmc= set and |url= not set.  Do this after date check but before COInS.\n-- Here we unset Embargo if PMC not embargoed (|embargo= not set in the citation) or if the embargo time has expired. Otherwise, holds embargo date\n\tEmbargo = is_embargoed\
      \ (Embargo);\t\t\t\t\t\t\t\t\t\t\t-- \n\n\tif config.CitationClass == &quot;journal&quot; and not is_set(URL) and is_set(ID_list['PMC']) then\n\t\tif not is_set (Embargo) then\t\t\t\t\t\t\t\t\t\t\t-- if not embargoed or embargo has expired\n\t\t\tURL=cfg.id_handlers['PMC'].prefix\
      \ .. ID_list['PMC'];\t\t\t\t-- set url to be the same as the PMC external link if not embargoed\n\t\t\tURLorigin = cfg.id_handlers['PMC'].parameters[1];\t\t\t\t\t-- set URLorigin to parameter name for use in error message if citation is missing a |title=\n\
      \t\tend\n\tend\n\n-- At this point fields may be nil if they weren't specified in the template use.  We can use that fact.\n\t-- Test if citation has no title\n\tif\tnot is_set(Title) and\n\t\tnot is_set(TransTitle) and\n\t\tnot is_set(ScriptTitle) then\n\
      \t\ttable.insert( z.message_tail, { set_error( 'citation_missing_title', {}, true ) } );\n\tend\n\t\n\tif 'none' == Title and is_set(Periodical) and not (( config.CitationClass == &quot;encyclopaedia&quot; ) or ( config.CitationClass == &quot;citation&quot;\
      \ and is_set (Encyclopedia))) then\t\t\t\t\t\t\t\t-- special case\n\t\tTitle = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- set title to empty string\n\t\tadd_maint_cat ('untitled');\n\tend\n\n\t-- COinS metadata (see &lt;http://ocoins.info/&gt;) for automated\
      \ parsing of citation information.\n\t-- handle the oddity that is cite encyclopedia and {{citation |encyclopedia=something}}. Here we presume that\n\t-- when Periodical, Title, and Chapter are all set, then Periodical is the book (encyclopedia) title,\
      \ Title\n\t-- is the article title, and Chapter is a section within the article.  So, we remap \n\t\n\tlocal coins_chapter = Chapter;\t\t\t\t\t\t\t\t\t\t\t\t-- default assuming that remapping not required\n\tlocal coins_title = Title;\t\t\t\t\t\t\t\t\t\
      \t\t\t\t-- et tu\n\tif 'encyclopaedia' == config.CitationClass or ('citation' == config.CitationClass and is_set (Encyclopedia)) then\n\t\tif is_set (Chapter) and is_set (Title) and is_set (Periodical) then\t\t-- if all are used then\n\t\t\tcoins_chapter\
      \ = Title;\t\t\t\t\t\t\t\t\t\t\t\t-- remap\n\t\t\tcoins_title = Periodical;\n\t\tend\n\tend\n\t\n\t-- this is the function call to COinS()\n\tlocal OCinSoutput = COinS({\n\t\t['Periodical'] = Periodical,\n\t\t['Chapter'] = strip_apostrophe_markup (coins_chapter),\t\
      \t\t\t\t-- Chapter stripped of bold / italic wikimarkup\n\t\t['Title'] = make_coins_title (coins_title, ScriptTitle),\t\t\t\t-- Title and ScriptTitle stripped of bold / italic wikimarkup\n\t\t['PublicationPlace'] = PublicationPlace,\n\t\t['Date'] = first_set(COinS_date,\
      \ Date),\t\t-- COinS_date has correctly formatted date if Date is valid; any reason to keep Date here?  Should we be including invalid dates in metadata?\n\t\t['Series'] = Series,\n\t\t['Volume'] = Volume,\n\t\t['Issue'] = Issue,\n\t\t['Pages'] = get_coins_pages\
      \ (first_set(Sheet, Sheets, Page, Pages, At)),\t\t\t\t-- pages stripped of external links\n\t\t['Edition'] = Edition,\n\t\t['PublisherName'] = PublisherName,\n\t\t['URL'] = first_set( URL, ChapterURL ),\n\t\t['Authors'] = a,\n\t\t['ID_list'] = ID_list,\n\
      \t\t['RawPage'] = this_page.prefixedText,\n\t}, config.CitationClass);\n\n-- Account for the oddities that are {{cite arxiv}}, AFTER generation of COinS data.\n\tif 'arxiv' == config.CitationClass then\t\t\t\t\t\t\t\t\t\t-- we have set rft.jtitle in COinS\
      \ to arXiv, now unset so it isn't displayed\n\t\tPeriodical = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- periodical not allowed in cite arxiv; if article has been published, use cite journal\n\tend\n\n-- special case for cite newsgroup.  Do this after COinS because\
      \ we are modifying Publishername to include some static text\n\tif 'newsgroup' == config.CitationClass then\n\t\tif is_set (PublisherName) then\n\t\t\tPublisherName = '[[Newsgroup]]:&amp;nbsp;' ..  external_link( 'news:' .. PublisherName, PublisherName\
      \ );\n\t\tend\n\tend\n\n\n\n\t-- Now perform various field substitutions.\n\t-- We also add leading spaces and surrounding markup and punctuation to the\n\t-- various parts of the citation, but only when they are non-nil.\n\tdo\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t\t\t\t\t-- do-block to limit scope of LastFirstAuthors\n\t\tlocal LastFirstAuthors;\n\t\tlocal Maximum = A['DisplayAuthors'];\n\n\t\tMaximum , author_etal = get_display_authors_editors (Maximum, #a, 'authors', author_etal);\n\n\t\tlocal control = {\
      \ \n\t\t\tformat = NameListFormat,\t\t\t\t\t\t\t\t\t\t\t-- empty string or 'vanc'\n\t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via authorlinkn\n\
      \t\t};\n\t\t\n\t\t-- If the coauthor field is also used, prevent ampersand and et al. formatting.\n\t\tif is_set(Coauthors) then\n\t\t\tcontrol.lastauthoramp = nil;\n\t\t\tcontrol.maximum = #a + 1;\n\t\tend\n\t\t\n\t\tLastFirstAuthors = list_people(control,\
      \ a, author_etal);\n\n\t\tif is_set (Authors) then\n\t\t\tif is_set (LastFirstAuthors) then\t\t\t\t\t\t\t\t\t-- if both author name styles\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'redundant_parameters', {wrap_style ('parameter', 'authors')\
      \ .. ' and ' .. wrap_style ('parameter', 'last')}, true ) } );\t\t-- add error message\n\t\t\t\tAuthors = LastFirstAuthors;\t\t\t\t\t\t\t\t\t\t-- TODO: is this correct or should we use |authors= instead?\n\t\t\tend\n\t\telse\n\t\t\tAuthors = LastFirstAuthors;\t\
      \t\t\t\t\t\t\t\t\t\t-- either an author name list or an empty string\n\t\tend\n\tend\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- end of do\n\n\tif not is_set(Authors) and is_set(Coauthors) then\t-- coauthors aren't displayed if one of authors=, authorn=, or\
      \ lastn= isn't specified\n\t\ttable.insert( z.message_tail, { set_error('coauthors_missing_author', {}, true) } );\t-- emit error message\n\tend\n\n\tlocal EditorCount;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- used only for choosing {ed.) or (eds.) annotation at\
      \ end of editor name-list\n\tif not is_set(Editors) then\n\t\tlocal Maximum = A['DisplayEditors'];\n\n\t\tMaximum , editor_etal = get_display_authors_editors (Maximum, #e, 'editors', editor_etal);\n\t\t-- Preserve old-style implicit et al.\n\t\tif not\
      \ is_set(Maximum) and #e == 4 then \n\t\t\tMaximum = 3;\n\t\t\ttable.insert( z.message_tail, { set_error('implict_etal_editor', {}, true) } );\n\t\tend\n\n\t\tlocal control = { \n\t\t\tformat = NameListFormat,\t\t\t\t\t\t\t\t\t\t\t-- empty string or 'vanc'\n\
      \t\t\tmaximum = Maximum,\n\t\t\tlastauthoramp = LastAuthorAmp,\n\t\t\tpage_name = this_page.text\t\t\t\t-- get current page name so that we don't wikilink to it via editorlinkn\n\t\t};\n\n\t\tEditors, EditorCount = list_people(control, e, editor_etal);\n\
      \t\tif 1 == EditorCount and (true == editor_etal or 1 &lt; #e) then\t\t\t-- only one editor displayed but includes etal then \n\t\t\tEditorCount = 2;\t\t\t\t\t\t\t\t\t\t\t\t\t-- spoof to display (eds.) annotation\n\t\tend\n\telse\n\t\tEditorCount = 1;\n\
      \tend\n\n-- apply |[xx-]format= styling; at the end, these parameters hold correctly styled format annotation,\n-- an error message if the associated url is not set, or an empty string for concatenation\n\tArchiveFormat = style_format (ArchiveFormat, ArchiveURL,\
      \ 'archive-format', 'archive-url');\n\tChapterFormat = style_format (ChapterFormat, ChapterURL, 'chapter-format', 'chapter-url');\n\tConferenceFormat = style_format (ConferenceFormat, ConferenceURL, 'conference-format', 'conference-url');\n\tFormat = style_format\
      \ (Format, URL, 'format', 'url');\n\tLayFormat = style_format (LayFormat, LayURL, 'lay-format', 'lay-url');\n\tTranscriptFormat = style_format (TranscriptFormat, TranscriptURL, 'transcript-format', 'transcripturl');\n\n\tif  not is_set(URL) then --and\n\
      --\t\tnot is_set(ArchiveURL) then --and\t\t\t\t\t\t\t\t\t\t-- prevents format_missing_url error from registering\n--\t\tnot is_set(ConferenceURL) and\t\t\t\t\t\t\t\t\t\t\t-- TODO: keep this here? conference as part of cite web or cite podcast?\n--\t\t\
      not is_set(TranscriptURL) then\t\t\t\t\t\t\t\t\t\t\t-- TODO: remove? |transcript-url= and |transcript= has separate test\n\t\t\n\t\t-- Test if cite web or cite podcast |url= is missing or empty \n\t\tif in_array(config.CitationClass, {&quot;web&quot;,&quot;podcast&quot;,\
      \ &quot;mailinglist&quot;}) then\t\n\t\t\ttable.insert( z.message_tail, { set_error( 'cite_web_url', {}, true ) } );\n\t\tend\n\t\t\n\t\t-- Test if accessdate is given without giving a URL\n\t\tif is_set(AccessDate) and not is_set(ChapterURL)then\t\t\t\
      \t\t-- ChapterURL may be set when the others are not set; TODO: move this to a separate test?\n\t\t\ttable.insert( z.message_tail, { set_error( 'accessdate_missing_url', {}, true ) } );\n\t\t\tAccessDate = '';\n\t\tend\n\tend\n\n\tlocal OriginalURL, OriginalFormat;\t\
      \t\t\t\t\t\t\t\t\t\t-- TODO: swap chapter and title here so that archive applies to most specific if both are set?\n\tDeadURL = DeadURL:lower();\t\t\t\t\t\t\t\t\t\t\t\t\t-- used later when assembling archived text\n\tif is_set( ArchiveURL ) then\n\t\t\
      if is_set (URL) then\n\t\t\tOriginalURL = URL;\t\t\t\t\t\t\t\t\t\t\t\t\t-- save copy of original source URL\n\t\t\tOriginalFormat = Format;\t\t\t\t\t\t\t\t\t\t\t-- and original |format=\n\t\t\tif 'no' ~= DeadURL then\t\t\t\t\t\t\t\t\t\t\t\t-- if URL set\
      \ then archive-url applies to it\n\t\t\t\tURL = ArchiveURL\t\t\t\t\t\t\t\t\t\t\t\t-- swap-in the archive's url\n\t\t\t\tURLorigin = A:ORIGIN('ArchiveURL')\t\t\t\t\t\t\t\t-- name of archive url parameter for error messages\n\t\t\t\tFormat = ArchiveFormat\
      \ or '';\t\t\t\t\t\t\t\t\t-- swap in archive's format\n\t\t\tend\n\t\telseif is_set (ChapterURL) then \t\t\t\t\t\t\t\t\t\t-- URL not set so if chapter-url is set apply archive url to it\n\t\t\tOriginalURL = ChapterURL;\t\t\t\t\t\t\t\t\t\t\t-- save copy\
      \ of source chapter's url for archive text\n\t\t\tOriginalFormat = ChapterFormat;\t\t\t\t\t\t\t\t\t\t-- and original |format=\n\t\t\tif 'no' ~= DeadURL then\n\t\t\t\tChapterURL = ArchiveURL\t\t\t\t\t\t\t\t\t\t\t-- swap-in the archive's url\n\t\t\t\tURLorigin\
      \ = A:ORIGIN('ArchiveURL')\t\t\t\t\t\t\t\t-- name of archive url parameter for error messages\n\t\t\t\tChapterFormat = ArchiveFormat or '';\t\t\t\t\t\t\t-- swap in archive's format\n\t\t\tend\n\t\tend\n\tend\n\n\tif in_array(config.CitationClass, {&quot;web&quot;,&quot;news&quot;,&quot;journal&quot;,&quot;pressrelease&quot;,&quot;podcast&quot;,\
      \ &quot;newsgroup&quot;, 'arxiv'}) or\n\t\t('citation' == config.CitationClass and is_set (Periodical) and not is_set (Encyclopedia)) then\n\t\t\tif is_set (Chapter) or is_set (TransChapter) or is_set (ChapterURL)then\t-- chapter parameters not supported\
      \ for these citation types\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'chapter_ignored', {}, true ) } );\t\t-- add error message\n\t\t\t\tChapter = '';\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- set to empty string to be safe with concatenation\n\t\t\t\tTransChapter\
      \ = '';\n\t\t\t\tChapterURL = '';\n\t\t\tend\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- otherwise, format chapter / article title\n\t\tChapter = format_chapter_title (Chapter, TransChapter, ChapterURL, ChapterURLorigin);\n\t\tif is_set (Chapter) then\n\
      \t\t\tif 'map' == config.CitationClass and is_set (TitleType) then\n\t\t\t\tChapter = Chapter .. ' ' .. TitleType;\n\t\t\tend\n\t\t\tChapter = Chapter .. ChapterFormat .. sepc .. ' ';\n\t\tend\n\tend\n\n\t-- Format main title.\n\tif is_set(TitleLink) and\
      \ is_set(Title) then\n\t\tTitle = &quot;[[&quot; .. TitleLink .. &quot;|&quot; .. Title .. &quot;]]&quot;\n\tend\n\n\tif in_array(config.CitationClass, {&quot;web&quot;,&quot;news&quot;,&quot;journal&quot;,&quot;pressrelease&quot;,&quot;podcast&quot;,\
      \ &quot;newsgroup&quot;, &quot;mailinglist&quot;, 'arxiv'}) or\n\t\t('citation' == config.CitationClass and is_set (Periodical) and not is_set (Encyclopedia)) or\n\t\t('map' == config.CitationClass and is_set (Periodical)) then\t\t\t-- special case for\
      \ cite map when the map is in a periodical treat as an article\n\t\t\tTitle = kern_quotes (Title);\t\t\t\t\t\t\t\t\t\t-- if necessary, separate title's leading and trailing quote marks from Module provided quote marks\n\t\t\tTitle = wrap_style ('quoted-title',\
      \ Title);\n\t\n\t\t\tTitle = script_concatenate (Title, ScriptTitle);\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title is wrapped\n\t\t\tTransTitle= wrap_style ('trans-quoted-title', TransTitle );\n\telseif 'report'\
      \ == config.CitationClass then\t\t\t\t\t\t\t\t-- no styling for cite report\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute, categorization, etc; must be done after title is wrapped\n\t\tTransTitle= wrap_style\
      \ ('trans-quoted-title', TransTitle );\t\t\t\t-- for cite report, use this form for trans-title\n\telse\n\t\tTitle = wrap_style ('italic-title', Title);\n\t\tTitle = script_concatenate (Title, ScriptTitle);\t\t\t\t\t\t-- &lt;bdi&gt; tags, lang atribute,\
      \ categorization, etc; must be done after title is wrapped\n\t\tTransTitle = wrap_style ('trans-italic-title', TransTitle);\n\tend\n\n\tTransError = &quot;&quot;;\n\tif is_set(TransTitle) then\n\t\tif is_set(Title) then\n\t\t\tTransTitle = &quot; &quot;\
      \ .. TransTitle;\n\t\telse\n\t\t\tTransError = &quot; &quot; .. set_error( 'trans_missing_title' );\n\t\tend\n\tend\n\t\n\tTitle = Title .. TransTitle;\n\t\n\tif is_set(Title) then\n\t\tif not is_set(TitleLink) and is_set(URL) then \n\t\t\tTitle = external_link(\
      \ URL, Title ) .. TransError .. Format;\n\t\t\tURL = &quot;&quot;;\n\t\t\tFormat = &quot;&quot;;\n\t\telse\n\t\t\tTitle = Title .. TransError;\n\t\tend\n\tend\n\n\tif is_set(Place) then\n\t\tPlace = &quot; &quot; .. wrap_msg ('written', Place, use_lowercase)\
      \ .. sepc .. &quot; &quot;;\n\tend\n\n\tif is_set (Conference) then\n\t\tif is_set (ConferenceURL) then\n\t\t\tConference = external_link( ConferenceURL, Conference );\n\t\tend\n\t\tConference = sepc .. &quot; &quot; .. Conference .. ConferenceFormat;\n\
      \telseif is_set(ConferenceURL) then\n\t\tConference = sepc .. &quot; &quot; .. external_link( ConferenceURL, nil, ConferenceURLorigin );\n\tend\n\n\tif not is_set(Position) then\n\t\tlocal Minutes = A['Minutes'];\n\t\tif is_set(Minutes) then\n\t\t\tPosition\
      \ = &quot; &quot; .. Minutes .. &quot; &quot; .. cfg.messages['minutes'];\n\t\telse\n\t\t\tlocal Time = A['Time'];\n\t\t\tif is_set(Time) then\n\t\t\t\tlocal TimeCaption = A['TimeCaption']\n\t\t\t\tif not is_set(TimeCaption) then\n\t\t\t\t\tTimeCaption\
      \ = cfg.messages['event'];\n\t\t\t\t\tif sepc ~= '.' then\n\t\t\t\t\t\tTimeCaption = TimeCaption:lower();\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\t\tPosition = &quot; &quot; .. TimeCaption .. &quot; &quot; .. Time;\n\t\t\tend\n\t\tend\n\telse\n\t\tPosition =\
      \ &quot; &quot; .. Position;\n\t\tAt = '';\n\tend\n\t\n\tif not is_set(Page) then\n\t\tif is_set(Pages) then\n\t\t\tif is_set(Periodical) and\n\t\t\t\tnot in_array(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;})\
      \ then\n\t\t\t\tPages = &quot;: &quot; .. Pages;\n\t\t\telseif tonumber(Pages) ~= nil then\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPrefix .. Pages;\n\t\t\telse\n\t\t\t\tPages = sepc ..&quot; &quot; .. PPPrefix .. Pages;\n\t\t\tend\n\t\tend\n\telse\n\t\
      \tif is_set(Periodical) and\n\t\t\tnot in_array(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;book&quot;,&quot;news&quot;,&quot;podcast&quot;}) then\n\t\t\tPage = &quot;: &quot; .. Page;\n\t\telse\n\t\t\tPage = sepc ..&quot; &quot;\
      \ .. PPrefix .. Page;\n\t\tend\n\tend\n\n\tif 'map' == config.CitationClass then\t\t\t\t\t\t\t\t\t\t-- cite map oddity done after COinS call (and with other in-source locators)\n\t\tif is_set (Sheet) or is_set (Sheets) then\n\t\t\tlocal err_msg1 = 'sheet=,\
      \ &amp;#124;sheets';\t\t\t\t\t\t\t-- default error message in case any of page pages or at are set\n\t\t\tlocal err_msg2;\n\t\t\tif is_set (Page) or is_set (Pages) or is_set (At) then\t\t\t\t-- are any set?\n\t\t\t\terr_msg2 = 'page=, &amp;#124;pages=,\
      \ &amp;#124;at';\t\t\t\t\t\t-- a generic error message\n\t\t\t\tPage = ''; Pages = ''; At = '';\n\t\t\telseif is_set (Sheet) and is_set (Sheets) then\t\t\t\t\t\t-- if both are set make error message\n\t\t\t\terr_msg1 = 'sheet';\n\t\t\t\terr_msg2 = 'sheets';\n\
      \t\t\tend\n\t\t\tif is_set (err_msg2) then\n\t\t\t\ttable.insert( z.message_tail, { set_error( 'redundant_parameters', {wrap_style ('parameter', err_msg1) .. ' and ' .. wrap_style ('parameter', err_msg2)}, true ) } );\t\t-- add error message\n\t\t\tend\n\
      \t\t\tif not is_set (Sheet) then\t\t\t\t\t\t\t\t\t\t\t-- do sheet static text and formatting; Sheet has priority over Sheets if both provided\n\t\t\t\tif is_set (Sheets) then\n\t\t\t\t\tif is_set (Periodical) then\n\t\t\t\t\t\tSheet = &quot;: Sheets &quot;\
      \ .. Sheets;\t\t\t\t\t\t\t-- because Sheet has priority, no need to support both later on\n\t\t\t\t\telse\n\t\t\t\t\t\tSheet = sepc .. &quot; Sheets &quot; .. Sheets;\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\telse\n\t\t\t\tif is_set (Periodical) then\n\t\t\t\t\
      \tSheet = &quot;: Sheet &quot; .. Sheet;\n\t\t\t\telse\n\t\t\t\t\tSheet = sepc .. &quot; Sheet &quot; .. Sheet;\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\n\tAt = is_set(At) and (sepc .. &quot; &quot; .. At) or &quot;&quot;;\n\tPosition = is_set(Position)\
      \ and (sepc .. &quot; &quot; .. Position) or &quot;&quot;;\n\tif config.CitationClass == 'map' then\n\t\tlocal Section = A['Section'];\n\t\tlocal Sections = A['Sections'];\n\t\tlocal Inset = A['Inset'];\n\t\t\n\t\tif is_set( Inset ) then\n\t\t\tInset =\
      \ sepc .. &quot; &quot; .. wrap_msg ('inset', Inset, use_lowercase);\n\t\tend\t\t\t\n\n\t\tif is_set( Sections ) then\n\t\t\tSection = sepc .. &quot; &quot; .. wrap_msg ('sections', Sections, use_lowercase);\n\t\telseif is_set( Section ) then\n\t\t\tSection\
      \ = sepc .. &quot; &quot; .. wrap_msg ('section', Section, use_lowercase);\n\t\tend\n\t\tAt = At .. Inset .. Section;\t\t\n\tend\t\n\n\tif is_set (Language) then\n\t\tLanguage = language_parameter (Language, this_page.namespace);\t\t\t-- format, categories\
      \ (article namespace only), name from ISO639-1, etc\n\telse\n\t\tLanguage=&quot;&quot;;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- language not specified so make sure this is an empty string;\n\tend\n\n\tOthers = is_set(Others) and (sepc .. &quot; &quot; .. Others)\
      \ or &quot;&quot;;\n\n\tTitleNote = is_set(TitleNote) and (sepc .. &quot; &quot; .. TitleNote) or &quot;&quot;;\n\tEdition = is_set(Edition) and (&quot; &quot; .. wrap_msg ('edition', Edition)) or &quot;&quot;;\n\tIssue = is_set(Issue) and (&quot; (&quot;\
      \ .. Issue .. &quot;)&quot;) or &quot;&quot;;\n\tSeries = is_set(Series) and (sepc .. &quot; &quot; .. Series) or &quot;&quot;;\n\tOrigYear = is_set(OrigYear) and (&quot; [&quot; .. OrigYear .. &quot;]&quot;) or &quot;&quot;;\n\tAgency = is_set(Agency)\
      \ and (sepc .. &quot; &quot; .. Agency) or &quot;&quot;;\n\n\tif is_set(Volume) then\n\t\tif ( mw.ustring.len(Volume) &gt; 4 )\n\t\t  then Volume = sepc ..&quot; &quot; .. Volume;\n\t\t  else Volume = &quot; &lt;b&gt;&quot; .. hyphen_to_dash(Volume) ..\
      \ &quot;&lt;/b&gt;&quot;;\n\t\tend\n\tend\n\n\t------------------------------------ totally unrelated data\n\tif is_set(Via) then\n\t\tVia = &quot; &quot; .. wrap_msg ('via', Via);\n\tend\n\n--[[\nSubscription implies paywall; Registration does not.  If\
      \ both are used in a citation, the subscription required link\nnote is displayed. There are no error messages for this condition.\n\n]]\n\tif in_array(SubscriptionRequired:lower(), {'yes', 'true', 'y'}) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot;\
      \ .. cfg.messages['subscription'];\t\t-- subscription required message\n\telseif in_array(RegistrationRequired:lower(), {'yes', 'true', 'y'}) then\n\t\tSubscriptionRequired = sepc .. &quot; &quot; .. cfg.messages['registration'];\t\t-- registration required\
      \ message\n\telse\n\t\tSubscriptionRequired = '';\t\t\t\t\t\t\t\t\t\t\t\t-- either or both might be set to something other than yes true y\n\tend\n\n\tif is_set(AccessDate) then\n\t\tlocal retrv_text = &quot; &quot; .. cfg.messages['retrieved']\n\n\t\t\
      AccessDate = nowrap_date (AccessDate);\t\t\t\t\t\t\t\t\t-- wrap in nowrap span if date in appropriate format\n\t\tif (sepc ~= &quot;.&quot;) then retrv_text = retrv_text:lower() end\t\t\t\t-- if 'citation', lower case\n\t\tAccessDate = substitute (retrv_text,\
      \ AccessDate);\t\t\t\t\t\t-- add retrieved text\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- neither of these work; don't know why; it seems that substitute() isn't being called\t\n\t\tAccessDate = substitute (cfg.presentation['accessdate'], {sepc, AccessDate});\t\
      -- allow editors to hide accessdates\n\tend\n\t\n\tif is_set(ID) then ID = sepc ..&quot; &quot;.. ID; end\n   \tif &quot;thesis&quot; == config.CitationClass and is_set(Docket) then\n\t\tID = sepc ..&quot; Docket &quot;.. Docket .. ID;\n\tend\n   \tif\
      \ &quot;report&quot; == config.CitationClass and is_set(Docket) then\t\t\t\t\t-- for cite report when |docket= is set\n\t\tID = sepc .. ' ' .. Docket;\t\t\t\t\t\t\t\t\t\t\t\t-- overwrite ID even if |id= is set\n\tend\n\n\tID_list = build_id_list( ID_list,\
      \ {DoiBroken = DoiBroken, ASINTLD = ASINTLD, IgnoreISBN = IgnoreISBN, Embargo=Embargo, Class = Class} );\n\n\tif is_set(URL) then\n\t\tURL = &quot; &quot; .. external_link( URL, nil, URLorigin );\n\tend\n\n\tif is_set(Quote) then\n\t\tif Quote:sub(1,1)\
      \ == '&quot;' and Quote:sub(-1,-1) == '&quot;' then\n\t\t\tQuote = Quote:sub(2,-2);\n\t\tend\n\t\tQuote = sepc ..&quot; &quot; .. wrap_style ('quoted-text', Quote ); \t\t\t\t-- wrap in &lt;q&gt;...&lt;/q&gt; tags\n\t\tPostScript = &quot;&quot;;\t\t\t\t\
      \t\t\t\t\t\t\t\t\t\t-- CS1 does not supply terminal punctuation when |quote= is set\n\tend\n\t\n\tlocal Archived\n\tif is_set(ArchiveURL) then\n\t\tif not is_set(ArchiveDate) then\n\t\t\tArchiveDate = set_error('archive_missing_date');\n\t\tend\n\t\tif\
      \ &quot;no&quot; == DeadURL then\n\t\t\tlocal arch_text = cfg.messages['archived'];\n\t\t\tif sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( cfg.messages['archived-not-dead'],\n\t\t\t\
      \t{ external_link( ArchiveURL, arch_text ) .. ArchiveFormat, ArchiveDate } );\n\t\t\tif not is_set(OriginalURL) then\n\t\t\t\tArchived = Archived .. &quot; &quot; .. set_error('archive_missing_url');\t\t\t\t\t\t\t   \n\t\t\tend\n\t\telseif is_set(OriginalURL)\
      \ then\n\t\t\tlocal arch_text = cfg.messages['archived-dead'];\n\t\t\tif sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute( arch_text,\n\t\t\t\t{ external_link( OriginalURL, cfg.messages['original']\
      \ ) .. OriginalFormat, ArchiveDate } );\t-- format already styled\n\t\telse\n\t\t\tlocal arch_text = cfg.messages['archived-missing'];\n\t\t\tif sepc ~= &quot;.&quot; then arch_text = arch_text:lower() end\n\t\t\tArchived = sepc .. &quot; &quot; .. substitute(\
      \ arch_text, \n\t\t\t\t{ set_error('archive_missing_url'), ArchiveDate } );\n\t\tend\n\telseif is_set (ArchiveFormat) then\n\t\tArchived = ArchiveFormat;\t\t\t\t\t\t\t\t\t\t\t\t-- if set and ArchiveURL not set ArchiveFormat has error message\n\telse\n\t\
      \tArchived = &quot;&quot;\n\tend\n\t\n\tlocal Lay = '';\n\tif is_set(LayURL) then\n\t\tif is_set(LayDate) then LayDate = &quot; (&quot; .. LayDate .. &quot;)&quot; end\n\t\tif is_set(LaySource) then \n\t\t\tLaySource = &quot; &amp;ndash; ''&quot; .. safe_for_italics(LaySource)\
      \ .. &quot;''&quot;;\n\t\telse\n\t\t\tLaySource = &quot;&quot;;\n\t\tend\n\t\tif sepc == '.' then\n\t\t\tLay = sepc .. &quot; &quot; .. external_link( LayURL, cfg.messages['lay summary'] ) .. LayFormat .. LaySource .. LayDate\n\t\telse\n\t\t\tLay = sepc\
      \ .. &quot; &quot; .. external_link( LayURL, cfg.messages['lay summary']:lower() ) .. LayFormat .. LaySource .. LayDate\n\t\tend\t\t\t\n\telseif is_set (LayFormat) then\t\t\t\t\t\t\t\t\t\t\t\t-- Test if |lay-format= is given without giving a |lay-url=\n\
      \t\tLay = sepc .. LayFormat;\t\t\t\t\t\t\t\t\t\t\t\t-- if set and LayURL not set, then LayFormat has error message\n\tend\n\n\tif is_set(Transcript) then\n\t\tif is_set(TranscriptURL) then\n\t\t\tTranscript = external_link( TranscriptURL, Transcript );\n\
      \t\tend\n\t\tTranscript = sepc .. ' ' .. Transcript .. TranscriptFormat;\n\telseif is_set(TranscriptURL) then\n\t\tTranscript = external_link( TranscriptURL, nil, TranscriptURLorigin );\n\tend\n\n\tlocal Publisher;\n\tif is_set(Periodical) and\n\t\tnot\
      \ in_array(config.CitationClass, {&quot;encyclopaedia&quot;,&quot;web&quot;,&quot;pressrelease&quot;,&quot;podcast&quot;}) then\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace) then\n\t\t\t\tPublisher = PublicationPlace .. &quot;:\
      \ &quot; .. PublisherName;\n\t\t\telse\n\t\t\t\tPublisher = PublisherName;  \n\t\t\tend\n\t\telseif is_set(PublicationPlace) then\n\t\t\tPublisher= PublicationPlace;\n\t\telse \n\t\t\tPublisher = &quot;&quot;;\n\t\tend\n\t\tif is_set(PublicationDate) then\n\
      \t\t\tif is_set(Publisher) then\n\t\t\t\tPublisher = Publisher .. &quot;, &quot; .. wrap_msg ('published', PublicationDate);\n\t\t\telse\n\t\t\t\tPublisher = PublicationDate;\n\t\t\tend\n\t\tend\n\t\tif is_set(Publisher) then\n\t\t\tPublisher = &quot;\
      \ (&quot; .. Publisher .. &quot;)&quot;;\n\t\tend\n\telse\n\t\tif is_set(PublicationDate) then\n\t\t\tPublicationDate = &quot; (&quot; .. wrap_msg ('published', PublicationDate) .. &quot;)&quot;;\n\t\tend\n\t\tif is_set(PublisherName) then\n\t\t\tif is_set(PublicationPlace)\
      \ then\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublicationPlace .. &quot;: &quot; .. PublisherName .. PublicationDate;\n\t\t\telse\n\t\t\t\tPublisher = sepc .. &quot; &quot; .. PublisherName .. PublicationDate;  \n\t\t\tend\t\t\t\n\t\telseif is_set(PublicationPlace)\
      \ then \n\t\t\tPublisher= sepc .. &quot; &quot; .. PublicationPlace .. PublicationDate;\n\t\telse \n\t\t\tPublisher = PublicationDate;\n\t\tend\n\tend\n\t\n\t-- Several of the above rely upon detecting this as nil, so do it last.\n\tif is_set(Periodical)\
      \ then\n\t\tif is_set(Title) or is_set(TitleNote) then \n\t\t\tPeriodical = sepc .. &quot; &quot; .. wrap_style ('italic-title', Periodical) \n\t\telse \n\t\t\tPeriodical = wrap_style ('italic-title', Periodical)\n\t\tend\n\tend\n\n--[[\nHandle the oddity\
      \ that is cite speech.  This code overrides whatever may be the value assigned to TitleNote (through |department=) and forces it to be &quot; (Speech)&quot; so that\nthe annotation directly follows the |title= parameter value in the citation rather than\
      \ the |event= parameter value (if provided).\n]]\n\tif &quot;speech&quot; == config.CitationClass then\t\t\t\t-- cite speech only\n\t\tTitleNote = &quot; (Speech)&quot;;\t\t\t\t\t\t\t-- annotate the citation\n\t\tif is_set (Periodical) then\t\t\t\t\t\t\
      \t-- if Periodical, perhaps because of an included |website= or |journal= parameter \n\t\t\tif is_set (Conference) then\t\t\t\t\t\t-- and if |event= is set\n\t\t\t\tConference = Conference .. sepc .. &quot; &quot;;\t\t-- then add appropriate punctuation\
      \ to the end of the Conference variable before rendering\n\t\t\tend\n\t\tend\n\tend\n\n\t-- Piece all bits together at last.  Here, all should be non-nil.\n\t-- We build things this way because it is more efficient in LUA\n\t-- not to keep reassigning\
      \ to the same string variable over and over.\n\n\tlocal tcommon\n\tif in_array(config.CitationClass, {&quot;journal&quot;,&quot;citation&quot;}) and is_set(Periodical) then\n\t\tif is_set(Others) then Others = Others .. sepc .. &quot; &quot; end\n\t\t\
      tcommon = safe_join( {Others, Title, TitleNote, Conference, Periodical, Format, TitleType, Series, \n\t\t\tLanguage, Edition, Publisher, Agency, Volume, Issue}, sepc );\n\t\t\n\telseif 'map' == config.CitationClass then\t\t\t\t\t\t\t\t\t-- special cases\
      \ for cite map\n\t\tif is_set (Chapter) then\t\t\t\t\t\t\t\t\t\t\t\t-- map in a book; TitleType is part of Chapter\n\t\t\ttcommon = safe_join( {Title, Format, Edition, Scale, Series, Language, Cartography, Others, Publisher, Volume}, sepc );\n\t\telseif\
      \ is_set (Periodical) then\t\t\t\t\t\t\t\t\t\t\t-- map in a periodical\n\t\t\ttcommon = safe_join( {Title, TitleType, Format, Periodical, Scale, Series, Language, Cartography, Others, Publisher, Volume, Issue}, sepc );\n\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t\t\t\t-- a sheet or stand-alone map\n\t\t\ttcommon = safe_join( {Title, TitleType, Format, Edition, Scale, Series, Language, Cartography, Others, Publisher}, sepc );\n\t\tend\n\t\t\n\telseif 'episode' == config.CitationClass then\t\t\t\t\t\t\t\t--\
      \ special case for cite episode\n\t\ttcommon = safe_join( {Title, TitleNote, TitleType, Series, Transcript, Language, Edition, Publisher}, sepc );\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- all other CS1 templates\n\t\ttcommon = safe_join( {Title, TitleNote,\
      \ Conference, Periodical, Format, TitleType, Series, Language, \n\t\t\tVolume, Issue, Others, Edition, Publisher, Agency}, sepc );\n\tend\n\t\n\tif #ID_list &gt; 0 then\n\t\tID_list = safe_join( { sepc .. &quot; &quot;,  table.concat( ID_list, sepc ..\
      \ &quot; &quot; ), ID }, sepc );\n\telse\n\t\tID_list = ID;\n\tend\n\t\n\tlocal idcommon = safe_join( { ID_list, URL, Archived, AccessDate, Via, SubscriptionRequired, Lay, Quote }, sepc );\n\tlocal text;\n\tlocal pgtext = Position .. Sheet .. Page .. Pages\
      \ .. At;\n\t\n\tif is_set(Authors) then\n\t\tif is_set(Coauthors) then\n\t\t\tlocal sep = '; ';\n\t\t\tif 'vanc' == NameListFormat then\n\t\t\t\tsep = ', ';\n\t\t\tend\n\t\t\tAuthors = Authors .. sep .. Coauthors;\n\t\tend\n\t\tif is_set(Date) then\n\t\
      \t\tDate = &quot; (&quot;..Date..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telseif string.sub(Authors,-1,-1) == sepc then\n\t\t\tAuthors = Authors .. &quot; &quot;\n\t\telse\n\t\t\tAuthors = Authors .. sepc .. &quot; &quot;\n\t\tend\n\t\t\
      if is_set(Editors) then\n\t\t\tlocal in_text = &quot; &quot;;\n\t\t\tlocal post_text = &quot;&quot;;\n\t\t\tif is_set(Chapter) then\n\t\t\t\tin_text = in_text .. cfg.messages['in'] .. &quot; &quot;\n\t\t\telse\n\t\t\t\tif EditorCount &lt;= 1 then\n\t\t\
      \t\t\tpost_text = &quot;, &quot; .. cfg.messages['editor'];\n\t\t\t\telse\n\t\t\t\t\tpost_text = &quot;, &quot; .. cfg.messages['editors'];\n\t\t\t\tend\n\t\t\tend \n\t\t\tif (sepc ~= '.') then in_text = in_text:lower() end\n\t\t\tEditors = in_text ..\
      \ Editors .. post_text;\n\t\t\tif (string.sub(Editors,-1,-1) == sepc) or (string.sub(Editors,-3,-1) == sepc .. ']]') then\t-- if last editor name ends with sepc char\n\t\t\t\tEditors = Editors .. &quot; &quot;;\t\t\t\t\t\t\t\t\t\t-- don't add another\n\
      \t\t\telse\n\t\t\t\tEditors = Editors .. sepc .. &quot; &quot;\t\t\t\t\t\t\t\t-- otherwise terninate the editor list\n\t\t\tend\n\t\tend\n\t\ttext = safe_join( {Authors, Date, Chapter, Place, Editors, tcommon }, sepc );\n\t\ttext = safe_join( {text, pgtext,\
      \ idcommon}, sepc );\n\telseif is_set(Editors) then\n\t\tif is_set(Date) then\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editor'];\n\t\t\telse\n\t\t\t\tEditors = Editors .. &quot;, &quot; .. cfg.messages['editors'];\n\
      \t\t\tend\n\t\t\tDate = &quot; (&quot; .. Date ..&quot;)&quot; .. OrigYear .. sepc .. &quot; &quot;\n\t\telse\n\t\t\tif EditorCount &lt;= 1 then\n\t\t\t\tEditors = Editors .. &quot; (&quot; .. cfg.messages['editor'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\
      \t\t\telse\n\t\t\t\tEditors = Editors .. &quot; (&quot; .. cfg.messages['editors'] .. &quot;)&quot; .. sepc .. &quot; &quot;\n\t\t\tend\n\t\tend\n\t\ttext = safe_join( {Editors, Date, Chapter, Place, tcommon}, sepc );\n\t\ttext = safe_join( {text, pgtext,\
      \ idcommon}, sepc );\n\telse\n\t\tif is_set(Date) then\n\t\t\tif ( string.sub(tcommon,-1,-1) ~= sepc )\n\t\t\t  then Date = sepc ..&quot; &quot; .. Date .. OrigYear\n\t\t\t  else Date = &quot; &quot; .. Date .. OrigYear\n\t\t\tend\n\t\tend\n\t\tif config.CitationClass==&quot;journal&quot;\
      \ and is_set(Periodical) then\n\t\t\ttext = safe_join( {Chapter, Place, tcommon}, sepc );\n\t\t\ttext = safe_join( {text, pgtext, Date, idcommon}, sepc );\n\t\telse\n\t\t\ttext = safe_join( {Chapter, Place, tcommon, Date}, sepc );\n\t\t\ttext = safe_join(\
      \ {text, pgtext, idcommon}, sepc );\n\t\tend\n\tend\n\t\n\tif is_set(PostScript) and PostScript ~= sepc then\n\t\ttext = safe_join( {text, sepc}, sepc );  --Deals with italics, spaces, etc.\n\t\ttext = text:sub(1,-sepc:len()-1);\n\tend\t\n\t\n\ttext =\
      \ safe_join( {text, PostScript}, sepc );\n\n\t-- Now enclose the whole thing in a &lt;span/&gt; element\n\tlocal options = {};\n\t\n\tif is_set(config.CitationClass) and config.CitationClass ~= &quot;citation&quot; then\n\t\toptions.class = &quot;citation\
      \ &quot; .. config.CitationClass;\n\telse\n\t\toptions.class = &quot;citation&quot;;\n\tend\n\t\n\tif is_set(Ref) and Ref:lower() ~= &quot;none&quot; then\n\t\tlocal id = Ref\n\t\tif ( &quot;harv&quot; == Ref ) then\n\t\t\tlocal names = {} --table of last\
      \ names &amp; year\n\t\t\tif #a &gt; 0 then\n\t\t\t\tfor i,v in ipairs(a) do \n\t\t\t\t\tnames[i] = v.last \n\t\t\t\t\tif i == 4 then break end\n\t\t\t\tend\n\t\t\telseif #e &gt; 0 then\n\t\t\t\tfor i,v in ipairs(e) do \n\t\t\t\t\tnames[i] = v.last \n\t\
      \t\t\t\tif i == 4 then break end\t\t\t\t\n\t\t\t\tend\n\t\t\tend\n\t\t\tnames[ #names + 1 ] = first_set(Year, anchor_year);\t-- Year first for legacy citations and for YMD dates that require disambiguation\n\t\t\tid = anchor_id(names)\n\t\tend\n\t\toptions.id\
      \ = id;\n\tend\n\t\n\tif string.len(text:gsub(&quot;&lt;span[^&gt;/]*&gt;.-&lt;/span&gt;&quot;, &quot;&quot;):gsub(&quot;%b&lt;&gt;&quot;,&quot;&quot;)) &lt;= 2 then\n\t\tz.error_categories = {};\n\t\ttext = set_error('empty_citation');\n\t\tz.message_tail\
      \ = {};\n\tend\n\t\n\tif is_set(options.id) then \n\t\ttext = '&lt;span id=&quot;' .. mw.uri.anchorEncode(options.id) ..'&quot; class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\telse\n\t\ttext = '&lt;span\
      \ class=&quot;' .. mw.text.nowiki(options.class) .. '&quot;&gt;' .. text .. &quot;&lt;/span&gt;&quot;;\n\tend\t\t\n\n\tlocal empty_span = '&lt;span style=&quot;display:none;&quot;&gt;&amp;nbsp;&lt;/span&gt;';\n\t\n\t-- Note: Using display: none on then\
      \ COinS span breaks some clients.\n\tlocal OCinS = '&lt;span title=&quot;' .. OCinSoutput .. '&quot; class=&quot;Z3988&quot;&gt;' .. empty_span .. '&lt;/span&gt;';\n\ttext = text .. OCinS;\n\t\n\tif #z.message_tail ~= 0 then\n\t\ttext = text .. &quot;\
      \ &quot;;\n\t\tfor i,v in ipairs( z.message_tail ) do\n\t\t\tif is_set(v[1]) then\n\t\t\t\tif i == #z.message_tail then\n\t\t\t\t\ttext = text .. error_comment( v[1], v[2] );\n\t\t\t\telse\n\t\t\t\t\ttext = text .. error_comment( v[1] .. &quot;; &quot;,\
      \ v[2] );\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\n\tif #z.maintenance_cats ~= 0 then\n\t\ttext = text .. ' &lt;span class=&quot;citation-comment&quot; style=&quot;display:none; color:#33aa33&quot;&gt;';\n\t\tfor _, v in ipairs( z.maintenance_cats )\
      \ do\t\t\t\t\t\t\t\t-- append maintenance categories\n\t\t\ttext = text .. v .. ' ([[:Category:' .. v ..'|link]])';\n\t\tend\n\t\ttext = text .. '&lt;/span&gt;';\t-- maintenance mesages (realy just the names of the categories for now)\n\tend\n\t\n\tno_tracking_cats\
      \ = no_tracking_cats:lower();\n\tif in_array(no_tracking_cats, {&quot;&quot;, &quot;no&quot;, &quot;false&quot;, &quot;n&quot;}) then\n\t\tfor _, v in ipairs( z.error_categories ) do\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _,\
      \ v in ipairs( z.maintenance_cats ) do\t\t\t\t\t\t\t\t-- append maintenance categories\n\t\t\ttext = text .. '[[Category:' .. v ..']]';\n\t\tend\n\t\tfor _, v in ipairs( z.properties_cats ) do\t\t\t\t\t\t\t\t-- append maintenance categories\n\t\t\ttext\
      \ = text .. '[[Category:' .. v ..']]';\n\t\tend\n\tend\n\t\n\treturn text\nend\n\n-- This is used by templates such as {{cite book}} to create the actual citation text.\nfunction z.citation(frame)\n\tlocal pframe = frame:getParent()\n\tlocal validation;\n\
      \t\n\tif nil ~= string.find (frame:getTitle(), 'sandbox', 1, true) then\t\t\t-- did the {{#invoke:}} use sandbox version?\n\t\tcfg = mw.loadData ('Module:Citation/CS1/Configuration/sandbox');\t\t-- load sandbox versions of Configuration and Whitelist and\
      \ ...\n\t\twhitelist = mw.loadData ('Module:Citation/CS1/Whitelist/sandbox');\n\t\tvalidation = require ('Module:Citation/CS1/Date_validation/sandbox');\t-- ... sandbox version of date validation code\n\n\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- otherwise\n\
      \t\tcfg = mw.loadData ('Module:Citation/CS1/Configuration');\t\t\t\t-- load live versions of Configuration and Whitelist and ...\n\t\twhitelist = mw.loadData ('Module:Citation/CS1/Whitelist');\n\t\tvalidation = require ('Module:Citation/CS1/Date_validation');\t\
      \t\t-- ... live version of date validation code\n\tend\n\n\tdates = validation.dates;\t\t\t\t\t\t\t\t\t\t\t\t\t-- imported functions\n\tyear_date_check = validation.year_date_check;\n\n\tlocal args = {};\n\tlocal suggestions = {};\n\tlocal error_text,\
      \ error_state;\n\n\tlocal config = {};\n\tfor k, v in pairs( frame.args ) do\n\t\tconfig[k] = v;\n\t\targs[k] = v;\t   \n\tend\t\n\n\tfor k, v in pairs( pframe.args ) do\n\t\tif v ~= '' then\n\t\t\tif not validate( k ) then\t\t\t\n\t\t\t\terror_text =\
      \ &quot;&quot;;\n\t\t\t\tif type( k ) ~= 'string' then\n\t\t\t\t\t-- Exclude empty numbered parameters\n\t\t\t\t\tif v:match(&quot;%S+&quot;) ~= nil then\n\t\t\t\t\t\terror_text, error_state = set_error( 'text_ignored', {v}, true );\n\t\t\t\t\tend\n\t\t\
      \t\telseif validate( k:lower() ) then \n\t\t\t\t\terror_text, error_state = set_error( 'parameter_ignored_suggest', {k, k:lower()}, true );\n\t\t\t\telse\n\t\t\t\t\tif #suggestions == 0 then\n\t\t\t\t\t\tsuggestions = mw.loadData( 'Module:Citation/CS1/Suggestions'\
      \ );\n\t\t\t\t\tend\n\t\t\t\t\tif suggestions[ k:lower() ] ~= nil then\n\t\t\t\t\t\terror_text, error_state = set_error( 'parameter_ignored_suggest', {k, suggestions[ k:lower() ]}, true );\n\t\t\t\t\telse\n\t\t\t\t\t\terror_text, error_state = set_error(\
      \ 'parameter_ignored', {k}, true );\n\t\t\t\t\tend\n\t\t\t\tend\t\t\t\t  \n\t\t\t\tif error_text ~= '' then\n\t\t\t\t\ttable.insert( z.message_tail, {error_text, error_state} );\n\t\t\t\tend\t\t\t\t\n\t\t\tend\n\t\t\targs[k] = v;\n\t\telseif args[k] ~=\
      \ nil or (k == 'postscript') then\n\t\t\targs[k] = v;\n\t\tend\t\t\n\tend\t\n\t\n\treturn citation0( config, args)\nend\n\nreturn z</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:55.327Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACitation%2FCS1%2FConfiguration&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:55 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1065 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1868448940, 123541666, 1029511572
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"39043527\" pageid=\"39043527\" ns=\"828\" title=\"Module:Citation/CS1/Configuration\"><revisions><rev user=\"Trappist the monk\" timestamp=\"2015-04-18T09:53:32Z\" comment=\"\
      Synch from sandbox;\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\nlocal citation_config = {};\n\n-- override &lt;code&gt;...&lt;/code&gt; styling to remove color, border, and padding.  &lt;code&gt; css is specified\
      \ here:\n-- https://git.wikimedia.org/blob/mediawiki%2Fcore.git/69cd73811f7aadd093050dbf20ed70ef0b42a713/skins%2Fcommon%2FcommonElements.css#L199\nlocal code_style=&quot;color:inherit; border:inherit; padding:inherit;&quot;;\n\n--[[--------------------------&lt;\
      \ U N C A T E G O R I Z E D _ N A M E S P A C E S &gt;------------------------------\n\nList of namespaces that should not be included in citation error categories.  Same as setting notracking = true by default\n\nNote: Namespace names should use underscores\
      \ instead of spaces.\n\n]]\nlocal uncategorized_namespaces = { 'User', 'Talk', 'User_talk', 'Wikipedia_talk', 'File_talk', 'Template_talk',\n\t'Help_talk', 'Category_talk', 'Portal_talk', 'Book_talk', 'Draft', 'Draft_talk', 'Education_Program_talk', \n\
      \t'Module_talk', 'MediaWiki_talk' };\n\nlocal uncategorized_subpages = {'/[Ss]andbox', '/[Tt]estcases'};\t\t-- list of Lua patterns found in page names of pages we should not categorize\n\n--[[--------------------------&lt; M E S S A G E S &gt;--------------------------------------------------------------\n\
      \nTranslation table\n\nThe following contains fixed text that may be output as part of a citation.\nThis is separated from the main body to aid in future translations of this\nmodule.\n\n]]\n\nlocal messages = {\n  ['published'] = 'published $1',\n  ['lay\
      \ summary'] = 'Lay summary',\n  ['retrieved'] = 'Retrieved $1',\n  ['inactive'] = 'inactive',\n  ['archived-dead'] = 'Archived from $1 on $2',\n  ['archived-not-dead'] = '$1 from the original on $2',\n  ['archived-missing'] = 'Archived from the original$1\
      \ on $2',\n  ['archived'] = 'Archived',\n  ['original'] = 'the original',\n  ['editor'] = 'ed.',\n  ['editors'] = 'eds.', \n  ['edition'] = '($1 ed.)', \n  ['episode'] = 'Episode $1',\n  ['season'] = 'Season $1', \n  ['series'] = 'Series $1',\n  ['cartography']\
      \ = 'Cartography by $1',\n  ['section'] = '§ $1',\n  ['sections'] = '§§ $1',\n  ['inset'] = '$1 inset',\n  ['written'] = 'Written at $1',\n  ['in'] = 'In',\n  ['et al'] = 'et al.', \n  \n  ['subscription'] = '&lt;span style=&quot;font-size:0.95em; font-size:90%;\
      \ color:#555&quot;&gt;(subscription required (&lt;span title=&quot;Sources are not required to be available online. Online sources do not have to be freely available. The site may require a paid subscription.&quot; style=&quot;border-bottom:1px dotted;cursor:help&quot;&gt;help&lt;/span&gt;))&lt;/span&gt;'\
      \ ..\n  \t'[[Category:Pages containing links to subscription-only content]]', \n\n  ['registration']='&lt;span style=&quot;font-size:0.95em; font-size:90%; color:#555&quot;&gt;(registration required (&lt;span title=&quot;Sources are not required to be\
      \ available online. Online sources do not have to be freely available. The site may require registration.&quot; style=&quot;border-bottom:1px dotted;cursor:help&quot;&gt;help&lt;/span&gt;))&lt;/span&gt;' ..\n  \t'[[Category:Pages with login required references\
      \ or sources]]',\n  \n  ['language'] = '(in $1)', \n  ['via'] = &quot; &amp;ndash; via $1&quot;,\n  ['event'] = 'Event occurs at',\n  ['minutes'] = 'minutes in', \n\n  ['parameter-separator'] = ', ',\n  ['parameter-final-separator'] = ', and ',\n  ['parameter-pair-separator']\
      \ = ' and ',\n\n  -- Determines the location of the help page\n  ['help page link'] = 'Help:CS1 errors',\n  ['help page label'] = 'help',\n  \n  -- Internal errors (should only occur if configuration is bad)\n  ['undefined_error'] = 'Called with an undefined\
      \ error condition',\n  ['unknown_manual_ID'] = 'Unrecognized manual ID mode',\n  ['unknown_ID_mode'] = 'Unrecognized ID mode',\n  ['unknown_argument_map'] = 'Argument map not defined for this variable',\n  ['bare_url_no_origin'] = 'Bare url found but origin\
      \ indicator is nil or empty',\n}\n\n--[[--------------------------&lt; P R E S E N T A T I O N &gt;------------------------------------------------------\n\nFixed presentation markup.  Originally part of citation_config.messages it has been moved into\
      \ its own, more semantically\ncorrect place.\n\n]]\nlocal presentation = \n\t{\n\t-- Error output\n\t-- .error class is specified at https://git.wikimedia.org/blob/mediawiki%2Fcore.git/9553bd02a5595da05c184f7521721fb1b79b3935/skins%2Fcommon%2Fshared.css#L538\n\
      \t-- .citation-comment class is specified at Help:CS1_errors#Controlling_error_message_display\n\t['hidden-error'] = '&lt;span style=&quot;display:none;font-size:100%&quot; class=&quot;error citation-comment&quot;&gt;$1&lt;/span&gt;',\n\t['visible-error']\
      \ = '&lt;span style=&quot;font-size:100%&quot; class=&quot;error citation-comment&quot;&gt;$1&lt;/span&gt;',\n\n\t['accessdate'] = '&lt;span class=&quot;reference-accessdate&quot;&gt;$1$2&lt;/span&gt;',\t\t\t-- to allow editors to hide accessdate using\
      \ personal css\n\n\t['bdi'] = '&lt;bdi$1&gt;$2&lt;/bdi&gt;',\t\t\t\t\t\t\t\t\t\t\t\t-- bidirectional isolation used with |script-title= and the like\n\n\t['format'] = ' &lt;span style=&quot;font-size:85%;&quot;&gt;($1)&lt;/span&gt;',\t\t\t\t\t-- for |format=,\
      \ |chapter-format=, etc\n\n\t['italic-title'] = &quot;''$1''&quot;,\n\n\t['kern-left'] = '&lt;span style=&quot;padding-left:0.2em;&quot;&gt;$1&lt;/span&gt;$2',\t\t\t-- spacing to use when title contains leading single or double quote mark\n\t['kern-right']\
      \ = '$1&lt;span style=&quot;padding-right:0.2em;&quot;&gt;$2&lt;/span&gt;',\t\t\t-- spacing to use when title contains trailing single or double quote mark\n\n\t['nowrap1'] = '&lt;span class=&quot;nowrap&quot;&gt;$1&lt;/span&gt;',\t\t\t\t\t\t\t\t-- for\
      \ nowrapping an item: &lt;span ...&gt;yyyy-mm-dd&lt;/span&gt;\n\t['nowrap2'] = '&lt;span class=&quot;nowrap&quot;&gt;$1&lt;/span&gt; $2',\t\t\t\t\t\t\t-- for nowrapping portions of an item: &lt;span ...&gt;dd mmmm&lt;/span&gt; yyyy (note white space)\n\
      \t\n\t['parameter'] = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=&lt;/code&gt;',\n\n\t['quoted-text'] = '&lt;q&gt;$1&lt;/q&gt;',\t\t\t\t\t\t\t\t\t\t\t\t-- for wrapping |quote= content\n\t['quoted-title'] = '&quot;$1&quot;',\n\n\t['trans-italic-title']\
      \ = &quot;&amp;#91;''$1''&amp;#93;&quot;,\n\t['trans-quoted-title'] = &quot;&amp;#91;$1&amp;#93;&quot;,\n\t}\n\n--[[--------------------------&lt; A L I A S E S &gt;----------------------------------------------------------------\n\nAliases table for commonly\
      \ passed parameters\n\n]]\n\nlocal aliases = {\n\t['AccessDate'] = {'access-date', 'accessdate'},\n\t['Agency'] = 'agency',\n\t['AirDate'] = {'air-date', 'airdate'},\n\t['ArchiveDate'] = {'archive-date', 'archivedate'},\n\t['ArchiveFormat'] = 'archive-format',\n\
      \t['ArchiveURL'] = {'archive-url', 'archiveurl'},\n\t['ASINTLD'] = {'ASIN-TLD', 'asin-tld'},\n\t['At'] = 'at',\n\t['Authors'] = {'authors', 'people', 'host', 'credits'},\n\t['AuthorFormat'] = {'author-format', 'authorformat'},\t\t\t\t\t\t-- deprecated\
      \ in favor of NameListFormat;\n\t['AuthorSeparator'] = 'author-separator',\t\t\t\t\t\t\t\t\t-- deprecated\n\t['AuthorNameSeparator'] = 'author-name-separator',\t\t\t\t\t\t\t-- deprecated\n\t['Began'] = 'began',\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite episode\
      \ and cite series\n\t['BookTitle'] = {'book-title', 'booktitle'},\n\t['Callsign'] = {'call-sign', 'callsign'},\t\t\t\t\t\t\t\t\t-- cite interview\n\t['Cartography'] = 'cartography',\n\t['Chapter'] = {'chapter', 'contribution', 'entry', 'article', 'section'},\n\
      \t['ChapterFormat'] = {'chapter-format', 'contribution-format', 'section-format'};\n\t['ChapterLink'] = {'chapter-link', 'chapterlink'},\t\t\t\t\t\t\t-- deprecated; remove after 1 January 2015?\n\t['ChapterURL'] = {'chapter-url', 'chapterurl', 'contribution-url',\
      \ 'contributionurl', 'section-url', 'sectionurl'},\n\t['City'] = 'city',\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite interview\n\t['Class'] = 'class',\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite arxiv and arxiv identifiers\n\t['Coauthors'] = {'coauthors', 'coauthor'},\t\
      \t\t\t\t\t\t\t\t-- coauthor and coauthors are deprecated; remove after 1 January 2015?\n\t['Conference'] = {'conference', 'event'},\n\t['ConferenceFormat'] = {'conference-format', 'event-format'},\n\t['ConferenceURL'] = {'conference-url', 'conferenceurl',\
      \ 'event-url', 'eventurl'},\n\t['Date'] = {'date', 'air-date', 'airdate'},\n\t['DeadURL'] = {'dead-url', 'deadurl'},\n\t['Degree'] = 'degree',\n\t['DisplayAuthors'] = {'display-authors', 'displayauthors'},\n\t['DisplayEditors'] = {'display-editors', 'displayeditors'},\n\
      \t['Docket'] = 'docket',\n\t['DoiBroken'] = {'doi-broken', 'doi-broken-date', 'doi-inactive-date', 'doi_brokendate', 'doi_inactivedate'},\n\t['Edition'] = 'edition',\n\t['Editors'] = 'editors',\n\t['EditorFormat'] = {'editor-format', 'editorformat'},\t\
      \t\t\t\t\t-- deprecated in favor of NameListFormat;\n\t['EditorSeparator'] = 'editor-separator',\t\t\t\t\t\t\t\t\t-- deprecated\n\t['EditorNameSeparator'] = 'editor-name-separator',\t\t\t\t\t\t\t-- deprecated\n\t['Embargo'] = 'embargo',\n\t['Encyclopedia']\
      \ = {'encyclopedia', 'encyclopaedia'},\t\t\t\t\t\t-- this one only used by citation\n\t['Ended'] = 'ended',\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite episode and cite series\n\t['Episode'] = 'episode',\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite serial only TODO: make available\
      \ to cite episode?\n\t['Format'] = 'format',\n\t['ID'] = {'id', 'ID'},\n\t['IgnoreISBN'] = {'ignore-isbn-error', 'ignoreisbnerror'},\n\t['Inset'] = 'inset',\n\t['Issue'] = {'issue', 'number'},\n\t['Language'] = {'language', 'in'},\n\t['LastAuthorAmp']\
      \ = {'last-author-amp', 'lastauthoramp'},\n\t['LayDate'] = {'lay-date', 'laydate'},\n\t['LayFormat'] = 'lay-format',\n\t['LaySource'] = {'lay-source', 'laysource'},\n\t['LayURL'] = {'lay-url', 'lay-summary', 'layurl', 'laysummary'},\n\t['MailingList']\
      \ = {'mailinglist', 'mailing-list'},\t\t\t\t\t\t\t-- cite mailing list only\n\t['Map'] = 'map',\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['MapFormat'] = 'map-format',\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['MapURL'] = {'mapurl', 'map-url'},\t\
      \t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['MessageID'] = 'message-id',\n\t['Minutes'] = 'minutes',\n\t['Mode'] = 'mode',\n\t['Month'] = 'month',\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated; remove after 1 January 2015?\n\t['NameListFormat'] = {'name-list-format',\
      \ 'author-format', 'authorformat', 'editor-format', 'editorformat'},\n\t['NameSeparator'] = 'name-separator',\t\t\t\t\t\t\t\t\t\t-- deprecated\n\t['Network'] = 'network',\n\t['NoPP'] = {'no-pp', 'nopp'},\n\t['NoTracking'] = {'template-doc-demo', 'template\
      \ doc demo', 'no-cat', 'nocat', \n\t\t'no-tracking', 'notracking'},\n\t['OrigYear'] = {'orig-year', 'origyear'},\n\t['Others'] = {'others', 'interviewer', 'interviewers'},\n\t['Page'] = {'p', 'page'},\n\t['Pages'] = {'pp', 'pages'},\n\t['Periodical'] =\
      \ {'journal', 'newspaper', 'magazine', 'work',\n\t\t'website',  'periodical', 'encyclopedia', 'encyclopaedia', 'dictionary'},\n\t['Place'] = {'place', 'location'},\n\t['PPrefix'] = {'p-prefix', 'PPrefix'},\n\t['PPPrefix'] = 'pp-prefix',\n\t['Program']\
      \ = 'program',\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite interview\n\t['PostScript'] = 'postscript',\n\t['PublicationDate'] = {'publicationdate', 'publication-date'},\n\t['PublicationPlace'] = {'publication-place', 'publicationplace'},\n\t['PublisherName'] = {'publisher',\
      \ 'distributor', 'institution', 'newsgroup'},\n\t['Quote'] = {'quote', 'quotation'},\n\t['Ref'] = {'ref', 'Ref'},\n\t['RegistrationRequired'] = 'registration',\n\t['Scale'] = 'scale',\n\t['ScriptTitle'] = 'script-title',\n\t['Section'] = 'section',\n\t\
      ['Season'] = 'season',\n\t['Sections'] = 'sections',\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['Separator'] = 'separator',\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated in favor of Mode\n\t['Series'] = {'series', 'version'},\n\t['SeriesSeparator'] = 'series-separator',\n\
      \t['SeriesLink'] = {'series-link', 'serieslink'},\n\t['SeriesNumber'] = {'series-number', 'series-no', 'seriesnumber', 'seriesno'},\n\t['Sheet'] = 'sheet',\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['Sheets'] = 'sheets',\t\t\t\t\t\t\t\t\t\t\t\t\t\t\
      -- cite map only\n\t['Station'] = 'station',\n\t['SubscriptionRequired'] = 'subscription',\n\t['Time'] = 'time',\n\t['TimeCaption'] = {'time-caption', 'timecaption'},\n\t['Title'] = 'title',\n\t['TitleLink'] = {'title-link', 'episode-link', 'titlelink',\
      \ 'episodelink'},\n\t['TitleNote'] = 'department',\n\t['TitleType'] = {'type', 'medium'},\n\t['TransChapter'] = {'trans-chapter', 'trans_chapter'},\n\t['TransMap'] = 'trans-map',\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['Transcript'] = 'transcript',\n\
      \t['TranscriptFormat'] = 'transcript-format',\n\t['TranscriptURL'] = {'transcript-url', 'transcripturl'},\n\t['TransTitle'] = {'trans-title', 'trans_title'},\n\t['URL'] = {'url', 'URL'},\n\t['Via'] = 'via',\n\t['Volume'] = 'volume',\n\t['Year'] = 'year',\n\
      \n\t['AuthorList-First'] = {&quot;author#-first&quot;, &quot;author-first#&quot;, &quot;first#&quot;, &quot;given#&quot;},\n\t['AuthorList-Last'] = {&quot;author#-last&quot;, &quot;author-last#&quot;, &quot;last#&quot;, &quot;surname#&quot;, &quot;Author#&quot;,\
      \ &quot;author#&quot;, &quot;subject#&quot;},\n\t['AuthorList-Link'] = {&quot;author#-link&quot;, &quot;author-link#&quot;, &quot;author#link&quot;, &quot;authorlink#&quot;, &quot;subject-link#&quot;, &quot;subject#link&quot;, &quot;subject#-link&quot;,\
      \ &quot;subjectlink#&quot;},\n\t['AuthorList-Mask'] = {&quot;author#-mask&quot;, &quot;author-mask#&quot;, &quot;author#mask&quot;, &quot;authormask#&quot;},\n\t\n\t['EditorList-First'] = {&quot;editor#-first&quot;, &quot;editor-first#&quot;, &quot;editor#-given&quot;,\
      \ &quot;editor-given#&quot;, &quot;EditorGiven#&quot;},\n\t['EditorList-Last'] = {&quot;editor#-last&quot;, &quot;editor-last#&quot;, &quot;editor#-surname&quot;, &quot;editor-surname#&quot;, &quot;EditorSurname#&quot;, &quot;Editor#&quot;, &quot;editor#&quot;,\
      \ &quot;editors#&quot;},\n\t['EditorList-Link'] = {&quot;editor#-link&quot;, &quot;editor-link#&quot;, &quot;editor#link&quot;, &quot;editorlink#&quot;},\n\t['EditorList-Mask'] = {&quot;editor#-mask&quot;, &quot;editor-mask#&quot;, &quot;editor#mask&quot;,\
      \ &quot;editormask#&quot;},\n}\n\n--[[--------------------------&lt; D E F A U L T S &gt;--------------------------------------------------------------\n\n-- Default parameter values\n\n]]\n\nlocal defaults = {\n\t['DeadURL'] = 'yes',\n\t['PPrefix'] =\
      \ &quot;p.&amp;nbsp;&quot;,\n\t['PPPrefix'] = &quot;pp.&amp;nbsp;&quot;,\t\n}\n\n--[[--------------------------&lt; M A I N T E N A N C E _ C A T E G O R I E S &gt;----------------------------------\n\nHere we name maintenance categories to be used in\
      \ maintenance messages.\n\n]]\n\nlocal maint_cats = {\n\t['ASIN'] = 'CS1 maint: ASIN uses ISBN',\n\t['date_year'] = 'CS1 maint: Date and year',\n\t['disp_auth_ed'] = 'CS1 maint: display-$1',\t\t\t\t\t\t\t\t\t-- $1 is authors or editors\n\t['embargo'] =\
      \ 'CS1 maint: PMC embargo expired',\n\t['english'] = 'CS1 maint: English language specified',\n\t['etal'] = 'CS1 maint: Explicit use of et al.',\n\t['unknown_lang'] = 'CS1 maint: Unrecognized language',\n\t['untitled'] = 'CS1 maint: Untitled periodical',\n\
      \t}\n\n--[[--------------------------&lt; P R O P E R T I E S _ C A T E G O R I E S &gt;------------------------------------\n\nHere we name properties categories\n\n]]\n\nlocal prop_cats = {\n\t['foreign_lang_source'] = 'CS1 $1-language sources ($2)',\t\
      \t\t\t\t-- |language= categories; $1 is language name, $2 is ISO639-1 code\n\t['script'] = 'CS1 uses foreign language script',\t\t\t\t\t\t\t-- when language specified by |script-title=xx: doesn't have its own category\n\t['script_with_name'] = 'CS1 uses\
      \ $1-language script ($2)',\t\t\t\t\t-- |script-title=xx: has matching category; $1 is language name, $2 is ISO639-1 code\n\t}\n\n\n\n--[[--------------------------&lt; T I T L E _ T Y P E S &gt;--------------------------------------------------------\n\
      \nHere we map a template's CitationClass to TitleType\n\n]]\n\nlocal title_types = {\n\t['AV-media-notes'] = 'Media notes',\n\t['DVD-notes'] = 'Media notes',\n\t['mailinglist'] = 'Mailing list',\n\t['map'] = 'Map',\n\t['podcast'] = 'Podcast',\n\t['pressrelease']\
      \ = 'Press release',\n\t['report'] = 'Report',\n\t['techreport'] = 'Technical report',\n\t['thesis'] = 'Thesis',\n\t}\n\n--[[--------------------------&lt; E R R O R _ C O N D I T I O N S &gt;----------------------------------------------\n\nError condition\
      \ table\n\nThe following contains a list of IDs for various error conditions defined in the \ncode.  For each ID, we specify a text message to display, an error category to\ninclude, and whether the error message should be wrapped as a hidden comment.\n\
      \nAnchor changes require identical changes to matching anchor in Help:CS1 errors\n\n]]\n\nlocal error_conditions = {\n\taccessdate_missing_url = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;accessdate=&lt;/code&gt; requires\
      \ &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;url=&lt;/code&gt;',\n\t\tanchor = 'accessdate_missing_url',\n\t\tcategory = 'Pages using citations with accessdate and no URL',\n\t\thidden = true },\n\tarchive_missing_date = {\n\t\tmessage =\
      \ '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;archiveurl=&lt;/code&gt; requires &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;archivedate=&lt;/code&gt;',\n\t\tanchor = 'archive_missing_date',\n\t\tcategory = 'Pages with archiveurl\
      \ citation errors',\n\t\thidden = false },\n\tarchive_missing_url = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;archiveurl=&lt;/code&gt; requires &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;url=&lt;/code&gt;',\n\
      \t\tanchor = 'archive_missing_url',\n\t\tcategory = 'Pages with archiveurl citation errors',\n\t\thidden = false },\n\tarxiv_missing = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;arxiv=&lt;/code&gt; required',\n\t\tanchor\
      \ = 'arxiv_missing',\n\t\tcategory = 'CS1 errors: arXiv',\t\t\t\t\t\t\t\t\t\t\t-- same as bad arxiv\n\t\thidden = false },\n\tarxiv_params_not_supported = {\n\t\tmessage = 'Unsupported parameter(s) in cite arXiv',\n\t\tanchor = 'arxiv_params_not_supported',\n\
      \t\tcategory = 'CS1 errors: arXiv',\t\t\t\t\t\t\t\t\t\t\t-- same as bad arxiv\n\t\thidden = false },\n\tbad_arxiv = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;arxiv=&lt;/code&gt; value',\n\t\tanchor = 'bad_arxiv',\n\
      \t\tcategory = 'CS1 errors: arXiv',\n\t\thidden = false },\n\tbad_asin = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;asin=&lt;/code&gt; value',\n\t\tanchor = 'bad_asin',\n\t\tcategory ='CS1 errors: ASIN',\n\t\thidden\
      \ = false },\n\tbad_authorlink = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;authorlink=&lt;/code&gt; value',\n\t\tanchor = 'bad_authorlink',\n\t\tcategory = 'CS1 errors: authorlink',\n\t\thidden = false },\n\tbad_date\
      \ = {\n\t\tmessage = 'Check date values in: &lt;code style=&quot;'..code_style..'&quot;&gt;$1&lt;/code&gt;',\n\t\tanchor = 'bad_date',\n\t\tcategory = 'CS1 errors: dates',\n\t\thidden = false },\n\tbad_doi = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;doi=&lt;/code&gt;\
      \ value',\n\t\tanchor = 'bad_doi',\n\t\tcategory = 'CS1 errors: DOI',\n\t\thidden = false },\n\tbad_isbn = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;isbn=&lt;/code&gt; value',\n\t\tanchor = 'bad_isbn',\n\t\tcategory\
      \ = 'Pages with ISBN errors',\n\t\thidden = false },\n\tbad_issn = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;issn=&lt;/code&gt; value',\n\t\tanchor = 'bad_issn',\n\t\tcategory = 'CS1 errors: ISSN',\n\t\thidden = false\
      \ },\n\tbad_lccn = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;lccn=&lt;/code&gt; value',\n\t\tanchor = 'bad_lccn',\n\t\tcategory = 'CS1 errors: LCCN',\n\t\thidden = false },\n\tbad_message_id = {\n\t\tmessage = 'Check\
      \ &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;message-id=&lt;/code&gt; value',\n\t\tanchor = 'bad_message_id',\n\t\tcategory = 'CS1 errors: message-id',\n\t\thidden = false },\n\tbad_ol = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;ol=&lt;/code&gt;\
      \ value',\n\t\tanchor = 'bad_ol',\n\t\tcategory = 'CS1 errors: OL',\n\t\thidden = false },\n\tbad_pmc = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;pmc=&lt;/code&gt; value',\n\t\tanchor = 'bad_pmc',\n\t\tcategory =\
      \ 'CS1 errors: PMC',\n\t\thidden = false },\n\tbad_pmid = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;pmid=&lt;/code&gt; value',\n\t\tanchor = 'bad_pmid',\n\t\tcategory = 'CS1 errors: PMID',\n\t\thidden = false },\n\
      \tbad_url = {\n\t\tmessage = 'Check &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;url=&lt;/code&gt; scheme',\n\t\tanchor = 'bad_url',\n\t\tcategory = 'Pages with URL errors',\n\t\thidden = false },\n\tbare_url_missing_title = {\n\t\tmessage\
      \ = '$1 missing title',\n\t\tanchor = 'bare_url_missing_title',\n\t\tcategory = 'Pages with citations having bare URLs',\n\t\thidden = false },\n\tchapter_ignored = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;chapter=&lt;/code&gt;\
      \ ignored',\n\t\tanchor = 'chapter_ignored',\n\t\tcategory = 'CS1 errors: chapter ignored',\n\t\thidden = false },\n\tcitation_missing_title = {\n\t\tmessage = 'Missing or empty &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;title=&lt;/code&gt;',\n\
      \t\tanchor = 'citation_missing_title',\n\t\tcategory = 'Pages with citations lacking titles',\n\t\thidden = false },\n\tcite_web_url = {\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- this error applies to cite web and to cite podcast\n\t\tmessage = 'Missing or empty\
      \ &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;url=&lt;/code&gt;',\n\t\tanchor = 'cite_web_url',\n\t\tcategory = 'Pages using web citations with no URL',\n\t\thidden = true },\n\tcoauthors_missing_author = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;coauthors=&lt;/code&gt;\
      \ requires &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;author=&lt;/code&gt;',\n\t\tanchor = 'coauthors_missing_author',\n\t\tcategory = 'CS1 errors: coauthors without author',\n\t\thidden = false },\n\tdeprecated_params = {\n\t\tmessage =\
      \ 'Cite uses deprecated parameter &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=&lt;/code&gt;',\n\t\tanchor = 'deprecated_params',\n\t\tcategory = 'Pages containing cite templates with deprecated parameters',\n\t\thidden = true },\n\tempty_citation\
      \ = {\n\t\tmessage = 'Empty citation',\n\t\tanchor = 'empty_citation',\n\t\tcategory = 'Pages with empty citations',\n\t\thidden = false },\n\textra_pages = {\n\t\tmessage = 'Extra &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;pages=&lt;/code&gt;\
      \ or &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;at=&lt;/code&gt;',\n\t\tanchor = 'extra_pages',\n\t\tcategory = 'Pages with citations using conflicting page specifications',\n\t\thidden = false },\n\tfirst_missing_last = {\n\t\tmessage =\
      \ '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;first$2=&lt;/code&gt; missing &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;last$2=&lt;/code&gt; in $1',\n\t\tanchor = 'first_missing_last',\n\t\tcategory = 'CS1 errors: missing author\
      \ or editor',\n\t\thidden = false },\n\tformat_missing_url = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=&lt;/code&gt; requires &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$2=&lt;/code&gt;',\n\t\tanchor =\
      \ 'format_missing_url',\n\t\tcategory = 'Pages using citations with format and no URL',\n\t\thidden = true },\n\timplict_etal_editor = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;displayeditors=&lt;/code&gt; suggested',\n\
      \t\tanchor = 'displayeditors',\n\t\tcategory = 'Pages using citations with old-style implicit et al. in editors',\n\t\thidden = true },\n\tinvalid_param_val = {\n\t\tmessage = 'Invalid &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=$2&lt;/code&gt;',\n\
      \t\tanchor = 'invalid_param_val',\n\t\tcategory = 'CS1 errors: invalid parameter value',\n\t\thidden = false },\n\tmissing_name = {\n\t\tmessage = 'Missing &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;last$2=&lt;/code&gt; in $1',\n\t\tanchor\
      \ = 'missing_name',\n\t\tcategory = 'CS1 errors: missing author or editor',\n\t\thidden = false },\n\tparameter_ignored = {\n\t\tmessage = 'Unknown parameter &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=&lt;/code&gt; ignored',\n\t\tanchor\
      \ = 'parameter_ignored',\n\t\tcategory = 'Pages with citations using unsupported parameters',\n\t\thidden = false },\n\tparameter_ignored_suggest = {\n\t\tmessage = 'Unknown parameter &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$1=&lt;/code&gt;\
      \ ignored (&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;$2=&lt;/code&gt; suggested)',\n\t\tanchor = 'parameter_ignored_suggest',\n\t\tcategory = 'Pages with citations using unsupported parameters',\n\t\thidden = false },\n\tredundant_parameters\
      \ = {\n\t\tmessage = 'More than one of $1 specified',\n\t\tanchor = 'redundant_parameters',\n\t\tcategory = 'Pages with citations having redundant parameters',\n\t\thidden = false },\n\ttext_ignored = {\n\t\tmessage = 'Text &quot;$1&quot; ignored',\n\t\
      \tanchor = 'text_ignored',\n\t\tcategory = 'Pages with citations using unnamed parameters',\n\t\thidden = false },\n\ttrans_missing_chapter = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;trans-chapter=&lt;/code&gt; requires\
      \ &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;chapter=&lt;/code&gt;',\n\t\tanchor = 'trans_missing_chapter',\n\t\tcategory = 'Pages with citations using translated terms without the original',\n\t\thidden = false },\n\ttrans_missing_title\
      \ = {\n\t\tmessage = '&lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;trans-title=&lt;/code&gt; requires &lt;code style=&quot;'..code_style..'&quot;&gt;&amp;#124;title=&lt;/code&gt;',\n\t\tanchor = 'trans_missing_title',\n\t\tcategory = 'Pages\
      \ with citations using translated terms without the original',\n\t\thidden = false },\n\tvancouver = {\n\t\tmessage = 'Vancouver style error',\n\t\tanchor = 'vancouver',\n\t\tcategory = 'CS1 errors: Vancouver style',\n\t\thidden = false },\n\twikilink_in_url\
      \ = {\n\t\tmessage = 'Wikilink embedded in URL title',\n\t\tanchor = 'wikilink_in_url',\n\t\tcategory = 'Pages with citations having wikilinks embedded in URL titles',\n\t\thidden = false },\n}\n\n--[[--------------------------&lt; I D _ H A N D L E R\
      \ S &gt;--------------------------------------------------------\n\nThe following contains a list of values for various defined identifiers.  For each identifier we specify a\nvariety of information necessary to properly render the identifier in the citation.\n\
      \n\tparameters: a list of parameter aliases for this identifier\n\tlink: Wikipedia article name\n\tlabel: the alternate name to apply to link\n\tmode: \t'manual' when there is a specific function in the code to handle the identifier;\n\t\t\t'external'\
      \ for identifiers that link outside of Wikipedia;\n\tprefix: the first part of a url that will be concatenated with a second part which usually contains the identifier\n\tencode: true if uri should be percent encoded; otherwise false\n\tCOinS: into rft.id\n\
      \tseparator: character or text between label and the identifier in the rendered citation\n]]\n\nlocal id_handlers = {\n\t['ARXIV'] = {\n\t\tparameters = {'arxiv', 'ARXIV', 'eprint'}, \n\t\tlink = 'arXiv',\n\t\tlabel = 'arXiv',\n\t\tmode = 'manual',\n\t\
      \tprefix = '//arxiv.org/abs/', \t\t\t\t\t\t-- protocol relative tested 2013-09-04\n\t\tencode = false,\n\t\tCOinS = 'info:arxiv',\n\t\tseparator = ':',\n\t},\n\t['ASIN'] = {\n\t\tparameters = { 'asin', 'ASIN' },\t   \n\t\tlink = 'Amazon Standard Identification\
      \ Number',\n\t\tlabel = 'ASIN',\n\t\tmode = 'manual',\n\t\tCOinS = 'info:asin',\n\t\tseparator = '&amp;nbsp;',\n\t\tencode = false;\n\t},\n\t['BIBCODE'] = {\n\t\tparameters = {'bibcode', 'BIBCODE'}, \n\t\tlink = 'Bibcode',\n\t\tlabel = 'Bibcode',\n\t\t\
      mode = 'external',\n\t\tprefix = 'http://adsabs.harvard.edu/abs/',\n\t\tencode = false,\n\t\tCOinS = 'info:bibcode',\n\t\tseparator = ':',\n\t},\n\t['DOI'] = {\n\t\tparameters = { 'doi', 'DOI' },\n\t\tlink = 'Digital object identifier',\n\t\tlabel = 'doi',\n\
      \t\tmode = 'manual',\n\t\tprefix = '//dx.doi.org/',\n\t\tCOinS = 'info:doi',\n\t\tseparator = ':',\n\t\tencode = true,\n\t},\n\t['ISBN'] = {\n\t\tparameters = {'isbn', 'ISBN', 'isbn13', 'ISBN13'}, \n\t\tlink = 'International Standard Book Number',\n\t\t\
      label = 'ISBN',\n\t\tmode = 'manual',\n\t\tprefix = 'Special:BookSources/',\n\t\tCOinS = 'rft.isbn',\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['ISSN'] = {\n\t\tparameters = {'issn', 'ISSN'}, \n\t\tlink = 'International Standard Serial Number',\n\t\tlabel\
      \ = 'ISSN',\n\t\tmode = 'manual',\n\t\tprefix = '//www.worldcat.org/issn/',\n\t\tCOinS = 'rft.issn',\n\t\tencode = false,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['JFM'] = {\n\t\tparameters = {'jfm', 'JFM'}, \n\t\tlink = 'Jahrbuch über die Fortschritte\
      \ der Mathematik',\n\t\tlabel = 'JFM',\n\t\tmode = 'external',\n\t\tprefix = '//zbmath.org/?format=complete&amp;q=an:',\n\t\tCOinS = 'rft.jfm',\n\t\tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['JSTOR'] = {\n\t\tparameters = {'jstor', 'JSTOR'},\
      \ \n\t\tlink = 'JSTOR',\n\t\tlabel = 'JSTOR',\n\t\tmode = 'external',\n\t\tprefix = '//www.jstor.org/stable/', \t\t\t\t-- protocol relative tested 2013-09-04\n\t\tCOinS = 'rft.jstor',\n\t\tencode = false,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['LCCN']\
      \ = {\n\t\tparameters = {'LCCN', 'lccn'}, \n\t\tlink = 'Library of Congress Control Number',\n\t\tlabel = 'LCCN',\n\t\tmode = 'manual',\n\t\tprefix = 'http://lccn.loc.gov/',\n\t\tCOinS = 'rft.lccn',\n\t\tencode = false,\n\t\tseparator = '&amp;nbsp;',\n\
      \t},\n\t['MR'] = {\n\t\tparameters = {'MR', 'mr'}, \n\t\tlink = 'Mathematical Reviews',\n\t\tlabel = 'MR',\n\t\tmode = 'external',\n\t\tprefix = '//www.ams.org/mathscinet-getitem?mr=', \t-- protocol relative tested 2013-09-04\n\t\tCOinS = 'rft.mr',\n\t\
      \tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['OCLC'] = {\n\t\tparameters = {'OCLC', 'oclc'}, \n\t\tlink = 'OCLC',\n\t\tlabel = 'OCLC',\n\t\tmode = 'external',\n\t\tprefix = '//www.worldcat.org/oclc/',\n\t\tCOinS = 'info:oclcnum',\n\t\tencode\
      \ = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['OL'] = {\n\t\tparameters = { 'ol', 'OL' },\n\t\tlink = 'Open Library',\n\t\tlabel = 'OL',\n\t\tmode = 'manual',\n\t\tCOinS = 'info:olnum',\n\t\tseparator = '&amp;nbsp;',\n\t\tendode = true,\n\t},\n\t\
      ['OSTI'] = {\n\t\tparameters = {'OSTI', 'osti'}, \n\t\tlink = 'Office of Scientific and Technical Information',\n\t\tlabel = 'OSTI',\n\t\tmode = 'external',\n\t\tprefix = '//www.osti.gov/energycitations/product.biblio.jsp?osti_id=',\t-- protocol relative\
      \ tested 2013-09-04\n\t\tCOinS = 'info:osti',\n\t\tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['PMC'] = {\n\t\tparameters = {'PMC', 'pmc'}, \n\t\tlink = 'PubMed Central',\n\t\tlabel = 'PMC',\n\t\tmode = 'manual',\t\t\t\t\t\t\t\t\t-- changed\
      \ to support unlinking of PMC identifier when article is embargoed\n\t\tprefix = '//www.ncbi.nlm.nih.gov/pmc/articles/PMC', \n\t\tsuffix = &quot; &quot;,\n\t\tCOinS = 'info:pmc',\n\t\tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['PMID'] = {\n\
      \t\tparameters = {'PMID', 'pmid'}, \n\t\tlink = 'PubMed Identifier',\n\t\tlabel = 'PMID',\n\t\tmode = 'manual',\t\t\t\t\t\t\t\t\t-- changed from external manual to support PMID validation\n\t\tprefix = '//www.ncbi.nlm.nih.gov/pubmed/',\n\t\tCOinS = 'info:pmid',\n\
      \t\tencode = false,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['RFC'] = {\n\t\tparameters = {'RFC', 'rfc'}, \n\t\tlink = 'Request for Comments',\n\t\tlabel = 'RFC',\n\t\tmode = 'external',\n\t\tprefix = '//tools.ietf.org/html/rfc',\n\t\tCOinS = 'info:rfc',\n\
      \t\tencode = false,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['SSRN'] = {\n\t\tparameters = {'SSRN', 'ssrn'}, \n\t\tlink = 'Social Science Research Network',\n\t\tlabel = 'SSRN',\n\t\tmode = 'external',\n\t\tprefix = '//ssrn.com/abstract=', \t\t\t\t\t--\
      \ protocol relative tested 2013-09-04\n\t\tCOinS = 'info:ssrn',\n\t\tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['USENETID'] = {\n\t\tparameters = {'message-id'},\n\t\tlink = 'Usenet',\n\t\tlabel = 'Usenet:',\n\t\tmode = 'manual',\n\t\tprefix\
      \ = 'news:',\n\t\tencode = false,\n\t\tCOinS = 'info:usenet',\n\t\tseparator = '&amp;nbsp;',\n\t},\n\t['ZBL'] = {\n\t\tparameters = {'ZBL', 'zbl'}, \n\t\tlink = 'Zentralblatt MATH',\n\t\tlabel = 'Zbl',\n\t\tmode = 'external',\n\t\tprefix = '//zbmath.org/?format=complete&amp;q=an:',\n\
      \t\tCOinS = 'info:zbl',\n\t\tencode = true,\n\t\tseparator = '&amp;nbsp;',\n\t},\n}\n\nreturn \t{\n\taliases = aliases,\n\tdefaults = defaults,\n\terror_conditions = error_conditions,\n\tid_handlers = id_handlers,\n\tmaint_cats = maint_cats,\n\tmessages\
      \ = messages,\n\tpresentation = presentation,\n\tprop_cats = prop_cats,\n\ttitle_types = title_types,\n\tuncategorized_namespaces = uncategorized_namespaces,\n\tuncategorized_subpages = uncategorized_subpages,\n\t}</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:55.538Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACitation%2FCS1%2FWhitelist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:55 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550966570, 1778187090, 1029514367
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"39013723\" pageid=\"39013723\" ns=\"828\" title=\"Module:Citation/CS1/Whitelist\"><revisions><rev user=\"Trappist the monk\" timestamp=\"2015-04-18T09:53:28Z\" comment=\"Synch\
      \ from sandbox;\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\n--[[--------------------------&lt; P A R A M E T E R S   N O T   S U P P O R T E D &gt;------------------------------\n\nThis is a list of parameters that\
      \ once were but now are no longer supported:\n\n\t['albumlink'] = nil,\t\t\t-- unique alias of titlelink used by old cite AV media notes\n\t['albumtype'] = nil,\t\t\t-- controled inappropriate functionality in the old cite AV media notes\n\t['artist']\
      \ = nil,\t\t\t\t-- unique alias of others used by old cite AV media notes\n\t['authors#'] = nil,\t\t\t\t-- no need for multiple lists of author names\n\t['cointerviewers'] = nil,\t\t-- unique alias of others used by old cite interview\n\t['day'] = nil,\t\
      \t\t\t\t-- deprecated in {{citation/core}} and somehow undeprecated in Module:Citation/CS1 and now finally removed\n\t['director'] = nil,\t\t\t\t-- unique alias of author used by old cite DVD-notes\n\t['DoiBroken'] = nil,\t\t\t-- not used, non-standard\
      \ captialization\n\t['editors#'] = nil,\t\t\t\t-- no need for multiple lists of editor names\n\t['Embargo'] = nil,\t\t\t\t-- not used, non-standard capitalization\n\t['notestitle'] = nil,\t\t\t-- unique alias of chapter used by old cite AV media notes\n\
      \t['PPPrefix'] = nil,\t\t\t\t-- not used, non-standard capitalization\n\t['publisherid'] = nil,\t\t\t-- unique alias of id used by old cite AV media notes and old cite DVD-notes\n\t['titleyear'] = nil,\t\t\t-- unique alias of origyear used by old cite\
      \ DVD-notes\n\n]]\n\n--[[--------------------------&lt; S U P P O R T E D   P A R A M E T E R S &gt;--------------------------------------\n\nBecause a steady-state signal conveys no useful information, whitelist.basic_arguments[] list items can have three\
      \ values:\n\ttrue - these parameters are valid and supported parameters\n\tfalse - these parameters are deprecated but still supported\n\tnil - these parameters are no longer supported (when setting a parameter to nil, leave a comment stating the reasons\
      \ for invalidating the parameter)\n\t\n]]\n\nlocal whitelist = {}\n\nlocal basic_arguments = {\n\t['accessdate'] = true,\n\t['access-date'] = true,\n\t['agency'] = true,\n\t['airdate'] = true,\n\t['air-date'] = true,\n\t['archivedate'] = true,\n\t['archive-date']\
      \ = true,\n\t['archive-format'] = true,\n\t['archiveurl'] = true,\n\t['archive-url'] = true,\n\t['article'] = true,\n\t['arxiv'] = true,\n\t['ARXIV'] = true,\n\t['asin'] = true,\n\t['ASIN'] = true,\n\t['asin-tld'] = true,\n\t['ASIN-TLD'] = true,\n\t['at']\
      \ = true,\n\t['author'] = true,\n\t['Author'] = false,\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\t['author-first'] = true,\n\t['authorformat'] = false,\t\t\t\t-- deprecated; primarily used to support Vancouver format which functionality now\
      \ part of name-list-format\n\t['author-format'] = false,\t\t\t\t-- deprecated; primarily used to support Vancouver format which functionality now part of name-list-format\n\t['author-last'] = true,\n\t['authorlink'] = true,\n\t['author-link'] = true,\n\
      \t['authormask'] = true,\n\t['author-mask'] = true,\n\t['author-name-separator'] = false,\t\t-- deprecated; primarily used to support Vancouver format which functionality now part of name-list-format\n\t['authors'] = true,\n\t['author-separator'] = false,\t\
      \t\t-- deprecated; primarily used to support Vancouver format which functionality now part of name-list-format\n\t['began'] = false,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated because module handles date ranges; cite episode and cite series\n\t['bibcode']\
      \ = true,\n\t['BIBCODE'] = true,\n\t['booktitle'] = true,\n\t['book-title'] = true,\n\t['callsign']=true,\t\t\t\t-- cite interview\n\t['call-sign']=true,\t\t\t\t-- cite interview\n\t['cartography'] = true,\n\t['chapter'] = true,\n\t['chapter-format'] =\
      \ true,\n\t['chapterlink'] = false,\t\t-- deprecated\n\t['chapter-link'] = false,\t\t-- deprecated\n\t['chapterurl'] = true,\n\t['chapter-url'] = true,\n\t['city'] = true,\t\t\t\t-- cite interview, cite episode, cite serial\n\t['class'] = true,\t\t\t\t\
      -- cite arxiv and arxiv identifiers\n\t['coauthor'] = false,\t\t\t-- deprecated\n\t['coauthors'] = false,\t\t\t-- deprecated\n\t['conference'] = true,\n\t['conference-format'] = true,\n\t['conferenceurl'] = true,\n\t['conference-url'] = true,\n\t['contribution']\
      \ = true,\n\t['contribution-format'] = true,\n\t['contributionurl'] = true,\n\t['contribution-url'] = true,\n\t['credits'] = true,\t\t\t\t-- cite episode, cite serial\n\t['date'] = true,\n\t['deadurl'] = true,\n\t['dead-url'] = true,\n\t['degree'] = true,\n\
      \t['department'] = true,\n\t['dictionary'] = true,\n\t['displayauthors'] = true,\n\t['display-authors'] = true,\n\t['displayeditors'] = true,\n\t['display-editors'] = true,\n\t['docket'] = true,\n\t['doi'] = true,\n\t['DOI'] = true,\n\t['doi-broken'] =\
      \ true,\n\t['doi_brokendate'] = true,\n\t['doi-broken-date'] = true,\n\t['doi_inactivedate'] = true,\n\t['doi-inactive-date'] = true,\n\t['edition'] = true,\n\t['editor'] = true,\n\t['Editor'] = false,\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\
      \t['editor-first'] = true,\n\t['editorformat'] = false,\t\t\t\t-- deprecated; primarily used to support Vancouver format which functionality now part of name-list-format\n\t['editor-format'] = false,\t\t\t\t-- deprecated; primarily used to support Vancouver\
      \ format which functionality now part of name-list-format\n\t['EditorGiven'] = false,\t\t\t\t-- deprecated; non-standard capitalization\n\t['editor-given'] = true,\n\t['editor-last'] = true,\n\t['editorlink'] = true,\n\t['editor-link'] = true,\n\t['editormask']\
      \ = true,\n\t['editor-mask'] = true,\n\t['editor-name-separator'] = false,\t\t-- deprecated; primarily used to support Vancouver format which functionality now part of name-list-format\n\t['editors'] = true,\n\t['editor-separator'] = false,\t\t\t-- deprecated;\
      \ primarily used to support Vancouver format which functionality now part of name-list-format\n\t['EditorSurname'] = false,\t\t\t\t-- deprecated; non-standard capitalization\n\t['editor-surname'] = true,\n\t['embargo'] = true,\n\t['encyclopaedia'] = true,\n\
      \t['encyclopedia'] = true,\n\t['ended'] = false,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated because module handles date ranges; cite episode and cite series\n\t['entry'] = true,\n\t['episode'] = true,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite serial only TODO:\
      \ make available to cite episode?\n\t['episodelink'] = true,\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite episode and cite serial\n\t['episode-link'] = true,\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite episode and cite serial\n\t['eprint'] = true,\t\t\t\t\t\t\t\t\t\t\t\t\t\
      \t\t-- cite arxiv and arxiv identifiers\n\t['event'] = true,\n\t['event-format'] = true,\n\t['eventurl'] = true,\n\t['event-url'] = true,\n\t['first'] = true,\n\t['format'] = true,\n\t['given'] = true,\n\t['host'] = true,\n\t['id'] = true,\n\t['ID'] =\
      \ true,\n\t['ignoreisbnerror'] = true,\n\t['ignore-isbn-error'] = true,\n\t['in'] = true,\n\t['inset'] = true,\n\t['institution'] = true,\n\t['interviewer'] = true,\t\t\t\t--cite interview\n\t['interviewers'] = true,\t\t\t--cite interview\n\t['isbn'] =\
      \ true,\n\t['ISBN'] = true,\n\t['isbn13'] = true,\n\t['ISBN13'] = true,\n\t['issn'] = true,\n\t['ISSN'] = true,\n\t['issue'] = true,\n\t['jfm'] = true,\n\t['JFM'] = true,\n\t['journal'] = true,\n\t['jstor'] = true,\n\t['JSTOR'] = true,\n\t['language']\
      \ = true,\n\t['last'] = true,\n\t['lastauthoramp'] = true,\n\t['last-author-amp'] = true,\n\t['laydate'] = true,\n\t['lay-date'] = true,\n\t['laysource'] = true,\n\t['lay-source'] = true,\n\t['laysummary'] = true,\n\t['lay-summary'] = true,\n\t['lay-format']\
      \ = true,\n\t['layurl'] = true,\n\t['lay-url'] = true,\n\t['lccn'] = true,\n\t['LCCN'] = true,\n\t['location'] = true,\n\t['magazine'] = true,\n\t['mailinglist'] = true,\t\t\t\t-- cite mailing list only\n\t['mailing-list'] = true,\t\t\t-- cite mailing\
      \ list only\n\t['map'] = true,\t\t\t\t\t\t-- cite map only\n\t['map-format'] = true,\t\t\t\t-- cite map only\n\t['mapurl'] = true,\t\t\t\t\t-- cite map only\n\t['map-url'] = true,\t\t\t\t\t-- cite map only\n\t['medium'] = true,\n\t['message-id'] = true,\t\
      \t\t-- cite newsgroup\n\t['minutes'] = true,\n\t['mode'] = true,\n\t['month'] = false,\t\t\t\t-- deprecated\n\t['mr'] = true,\n\t['MR'] = true,\n\t['name-list-format'] = true,\n\t['name-separator'] = false,\t\t-- deprecated;  primarily used to support\
      \ Vancouver format which functionality now part of name-list-format\n\t['network'] = true,\n\t['newsgroup'] = true,\n\t['newspaper'] = true,\n\t['nocat'] = true,\n\t['no-cat'] = true,\n\t['nopp'] = true,\n\t['no-pp'] = true,\n\t['notracking'] = true,\n\
      \t['no-tracking'] = true,\n\t['number'] = true,\n\t['oclc'] = true,\n\t['OCLC'] = true,\n\t['ol'] = true,\n\t['OL'] = true,\n\t['origyear'] = true,\n\t['orig-year'] = true,\n\t['osti'] = true,\n\t['OSTI'] = true,\n\t['others'] = true,\n\t['p'] = true,\n\
      \t['page'] = true,\n\t['pages'] = true,\n\t['people'] = true,\n\t['periodical'] = true,\n\t['place'] = true,\n\t['pmc'] = true,\n\t['PMC'] = true,\n\t['pmid'] = true,\n\t['PMID'] = true,\n\t['postscript'] = true,\n\t['pp'] = true,\n\t['pp-prefix'] = true,\n\
      \t['PPrefix'] = true,\n\t['p-prefix'] = true,\n\t['program']=true,\t\t\t\t-- cite interview\n\t['publicationdate'] = true,\n\t['publication-date'] = true,\n\t['publicationplace'] = true,\n\t['publication-place'] = true,\n\t['publisher'] = true,\n\t['quotation']\
      \ = true,\n\t['quote'] = true,\n\t['ref'] = true,\n\t['Ref'] = true,\n\t['registration'] = true,\n\t['rfc'] = true,\n\t['RFC'] = true,\n\t['scale'] = true,\n\t['script-title'] = true,\n\t['season'] = true,\n\t['section'] = true,\n\t['section-format'] =\
      \ true,\n\t['sections'] = true,\t\t\t\t\t-- cite map only\n\t['sectionurl'] = true,\n\t['section-url'] = true,\n\t['separator'] = false,\t\t\t\t-- deprecated; this functionality now provided by |mode=\n\t['series'] = true,\n\t['serieslink'] = true,\n\t\
      ['series-link'] = true,\n\t['seriesno'] = true,\n\t['series-no'] = true,\n\t['seriesnumber'] = true,\n\t['series-number'] = true,\n\t['series-separator'] = true,\n\t['sheet'] = true,\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['sheets'] = true,\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t\t-- cite map only\n\t['ssrn'] = true,\n\t['SSRN'] = true,\n\t['station'] = true,\n\t['subject'] = true,\n\t['subjectlink'] = true,\n\t['subject-link'] = true,\n\t['subscription'] = true,\n\t['surname'] = true,\n\t['template doc\
      \ demo'] = true,\n\t['template-doc-demo'] = true,\n\t['time'] = true,\n\t['timecaption'] = true,\n\t['time-caption'] = true,\n\t['title'] = true,\n\t['titlelink'] = true,\n\t['title-link'] = true,\n\t['trans_chapter'] = true,\n\t['trans-chapter'] = true,\n\
      \t['trans-map'] = true;\n\t['transcript'] = true,\n\t['transcript-format'] = true,\n\t['transcripturl'] = true,\n\t['transcript-url'] = true,\n\t['trans_title'] = true,\n\t['trans-title'] = true,\n\t['type'] = true,\n\t['url'] = true,\n\t['URL'] = true,\n\
      \t['version'] = true,\n\t['via'] = true,\n\t['volume'] = true,\n\t['website'] = true,\n\t['work'] = true,\n\t['year'] = true,\n\t['zbl'] = true,\n\t['ZBL'] = true,\n}\n\nlocal numbered_arguments = {\n\t['author#'] = true,\n\t['Author#'] = false,\t\t\t\t\
      \t\t\t\t\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\t['author-first#'] = true,\n\t['author#-first'] = true,\n\t['author-last#'] = true,\n\t['author#-last'] = true,\n\t['author-link#'] = true,\n\t['author#link'] = true,\n\t['author#-link']\
      \ = true,\n\t['authorlink#'] = true,\n\t['author-mask#'] = true,\n\t['author#mask'] = true,\n\t['author#-mask'] = true,\n\t['authormask#'] = true,\n\t['editor#'] = true,\n\t['Editor#'] = false,\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\
      \t['editor-first#'] = true,\n\t['editor#-first'] = true,\n\t['EditorGiven#'] = false,\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\t['editor#-given'] = true,\n\t['editor-given#'] = true,\n\t['editor-last#'] = true,\n\t['editor#-last']\
      \ = true,\n\t['editor-link#'] = true,\n\t['editor#link'] = true,\n\t['editor#-link'] = true,\n\t['editorlink#'] = true,\n\t['editor-mask#'] = true,\n\t['editor#mask'] = true,\n\t['editor#-mask'] = true,\n\t['editormask#'] = true,\n\t['EditorSurname#']\
      \ = false,\t\t\t\t\t\t\t\t\t\t\t\t\t-- deprecated; non-standard capitalization\n\t['editor#-surname'] = true,\n\t['editor-surname#'] = true,\n\t['first#'] = true,\n\t['given#'] = true,\n\t['last#'] = true,\n\t['subject#'] = true,\n\t['subject-link#'] =\
      \ true,\n\t['subject#link'] = true,\n\t['subject#-link'] = true,\n\t['subjectlink#'] = true,\n\t['surname#'] = true,\n}\n--};\n\n--return whitelist;\nreturn {basic_arguments = basic_arguments, numbered_arguments = numbered_arguments};</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:55.791Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACitation%2FCS1%2FDate_validation&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:55 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3030 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550966839, 2610614526, 1029515320
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><normalized><n from=\"Module:Citation/CS1/Date_validation\" to=\"Module:Citation/CS1/Date validation\" /></normalized><pages><page _idx=\"42164542\" pageid=\"42164542\" ns=\"828\" title=\"Module:Citation/CS1/Date\
      \ validation\"><revisions><rev user=\"Trappist the monk\" timestamp=\"2015-04-18T09:53:26Z\" comment=\"Synch from sandbox;\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">\nlocal p = {}\n\n--[[--------------------------&lt;\
      \ I S _ V A L I D _ A C C E S S D A T E &gt;----------------------------------------\n\nreturns true if:\n\tWikipedia start date &lt;= accessdate &lt; today + 2 days\n\nWikipedia start date is 2001-01-15T00:00:00 UTC which is 979516800 seconds after 1970-01-01T00:00:00\
      \ UTC (the start of Unix time)\naccessdate is the date provided in |accessdate= at time 00:00:00 UTC\ntoday is the current date at time 00:00:00 UTC plus 48 hours\n\tif today is 2015-01-01T00:00:00 then\n\t\tadding 24 hours gives 2015-01-02T00:00:00 –\
      \ one second more than today\n\t\tadding 24 hours gives 2015-01-03T00:00:00 – one second more than tomorrow\n\n]]\n\nlocal function is_valid_accessdate (accessdate)\n\tlocal lang = mw.getContentLanguage();\n\tlocal good1, good2;\n\tlocal access_ts, tomorrow_ts;\t\
      \t\t\t\t\t\t\t\t\t\t\t-- to hold unix time stamps representing the dates\n\t\t\n\tgood1, access_ts = pcall( lang.formatDate, lang, 'U', accessdate );\t\t\t-- convert accessdate value to unix timesatmp \n\tgood2, tomorrow_ts = pcall( lang.formatDate, lang,\
      \ 'U', 'today + 2 days' );\t-- today midnight + 2 days is one second more than all day tomorrow\n\t\n\tif good1 and good2 then\n\t\taccess_ts = tonumber (access_ts);\t\t\t\t\t\t\t\t\t\t-- convert to numbers for the comparison\n\t\ttomorrow_ts = tonumber\
      \ (tomorrow_ts);\n\telse\n\t\treturn false;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- one or both failed to convert to unix time stamp\n\tend\n\t\n\tif 979516800 &lt;= access_ts and access_ts &lt; tomorrow_ts then\t\t\t\t\t-- Wikipedia start date &lt;= accessdate\
      \ &lt; tomorrow's date\n\t\treturn true;\n\telse\n\t\treturn false;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- accessdate out of range\n\tend\nend\n\n--[[--------------------------&lt; G E T _ M O N T H _ N U M B E R &gt;----------------------------------------------\n\
      \nreturns a number according to the month in a date: 1 for January, etc.  Capitalization and spelling must be correct. If not a valid month, returns 0\n\n]]\n\nlocal function get_month_number (month)\nlocal long_months = {['January']=1, ['February']=2,\
      \ ['March']=3, ['April']=4, ['May']=5, ['June']=6, ['July']=7, ['August']=8, ['September']=9, ['October']=10, ['November']=11, ['December']=12};\nlocal short_months = {['Jan']=1, ['Feb']=2, ['Mar']=3, ['Apr']=4, ['May']=5, ['Jun']=6, ['Jul']=7, ['Aug']=8,\
      \ ['Sep']=9, ['Oct']=10, ['Nov']=11, ['Dec']=12};\nlocal temp;\n\ttemp=long_months[month];\n\tif temp then return temp; end\t\t\t\t-- if month is the long-form name\n\ttemp=short_months[month];\n\tif temp then return temp; end\t\t\t\t-- if month is the\
      \ short-form name\n\treturn 0;\t\t\t\t\t\t\t\t\t-- misspelled, improper case, or not a month name\nend\n\n--[[--------------------------&lt; G E T _ S E A S O N _ N U M B E R &gt;--------------------------------------------\n\nreturns a number according\
      \ to the sequence of seasons in a year: 1 for Winter, etc.  Capitalization and spelling must be correct. If not a valid season, returns 0\n\n]]\n\nlocal function get_season_number (season)\nlocal season_list = {['Winter']=1, ['Spring']=2, ['Summer']=3,\
      \ ['Fall']=4, ['Autumn']=4}\nlocal temp;\n\ttemp=season_list[season];\n\tif temp then return temp; end\t\t\t\t-- if season is a valid name return its number\n\treturn 0;\t\t\t\t\t\t\t\t\t-- misspelled, improper case, or not a season name\nend\n\n--[[--------------------------&lt;\
      \ I S _ P R O P E R _ N A M E &gt;--------------------------------------------------\n\nreturns a non-zero number if date contains a recognized proper name.  Capitalization and spelling must be correct.\n\n]]\n\nlocal function is_proper_name (name)\nlocal\
      \ name_list = {['Christmas']=1}\nlocal temp;\n\ttemp=name_list[name];\n\tif temp then return temp; end\t\t\t\t-- if name is a valid name return its number\n\treturn 0;\t\t\t\t\t\t\t\t\t-- misspelled, improper case, or not a proper name\nend\n\n--[[--------------------------&lt;\
      \ I S _ V A L I D _ M O N T H _ O R _ S E A S O N &gt;------------------------------\n\n--returns true if month or season is valid (properly spelled, capitalized, abbreviated)\n\n]]\n\nlocal function is_valid_month_or_season (month_season)\n\tif 0 == get_month_number\
      \ (month_season) then\t\t-- if month text isn't one of the twelve months, might be a season\n\t\tif 0 == get_season_number (month_season) then\t-- not a month, is it a season?\n\t\t\treturn false;\t\t\t\t\t\t\t\t-- return false not a month or one of the\
      \ five seasons\n\t\tend\n\tend\n\treturn true;\nend\n\n\n--[[--------------------------&lt; I S _ V A L I D _ Y E A R &gt;----------------------------------------------------\n\nFunction gets current year from the server and compares it to year from a\
      \ citation parameter.  Years more than one year in the future are not acceptable.\n\n]]\n\nlocal function is_valid_year(year)\n\tif not is_set(year_limit) then\n\t\tyear_limit = tonumber(os.date(&quot;%Y&quot;))+1;\t\t\t-- global variable so we only have\
      \ to fetch it once\n\tend\n\treturn tonumber(year) &lt;= year_limit;\t\t\t\t-- false if year is in the future more than one year\nend\n\n--[[\nReturns true if day is less than or equal to the number of days in month and year is no farther into the future\
      \ than next year; else returns false.\n\nAssumes Julian calendar prior to year 1582 and Gregorian calendar thereafter. Accounts for Julian calendar leap years before 1582 and Gregorian leap years after 1582.\nWhere the two calendars overlap (1582 to approximately\
      \ 1923) dates are assumed to be Gregorian.\n]]\nlocal function is_valid_date (year, month, day)\nlocal days_in_month = {31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31};\nlocal month_length;\n\tif not is_valid_year(year) then\t-- no farther into the future\
      \ than next year\n\t\treturn false;\n\tend\n\t\n\tif (2==month) then\t\t\t\t\t\t\t-- if February\n\t\tmonth_length = 28;\t\t\t\t\t\t-- then 28 days unless\n\t\tif 1582 &gt; tonumber(year) then\t\t\t-- Julian calendar\n\t\t\tif 0==(year%4) then\n\t\t\t\t\
      month_length = 29;\n\t\t\tend\n\t\telse\t\t\t\t\t\t\t\t\t-- Gregorian calendar\n\t\t\tif (0==(year%4) and (0~=(year%100) or 0==(year%400))) then\t-- is a leap year?\n\t\t\t\tmonth_length = 29;\t\t\t\t-- if leap year then 29 days in February\n\t\t\tend\n\
      \t\tend\n\telse\n\t\tmonth_length=days_in_month[month];\n\tend\n\n\tif tonumber (day) &gt; month_length then\n\t\treturn false;\n\tend\n\treturn true;\nend\n\n--[[--------------------------&lt; I S _ V A L I D _ M O N T H _ R A N G E _ S T Y L E &gt;--------------------------\n\
      \nMonths in a range are expected to have the same style: Jan–Mar or October–December but not February–Mar or Jul–August. \nThere is a special test for May because it can be either short or long form.\n\nReturns true when style for both months is the same\n\
      \n]]\n\nlocal function is_valid_month_range_style (month1, month2)\nlocal len1 = month1:len();\nlocal len2 = month2:len();\n\tif len1 == len2 then\n\t\treturn true;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- both months are short form so return true\n\telseif 'May'\
      \ == month1 or 'May'== month2 then\n\t\treturn true;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- both months are long form so return true\n\telseif 3 == len1 or 3 == len2 then\n\t\treturn false;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- months are mixed form so return false\n\
      \telse\n\t\treturn true;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- both months are long form so return true\n\tend\nend\n\n\n--[[--------------------------&lt; I S _ V A L I D _ M O N T H _ S E A S O N _ R A N G E &gt;------------------------\n\nCheck a pair of\
      \ months or seasons to see if both are valid members of a month or season pair.\n\nMonth pairs are expected to be left to right, earliest to latest in time.\n\nSimilarly, seasons are also left to right, earliest to latest in time.  There is an oddity with\
      \ seasons: winter is assigned a value of 1, spring 2, ...,\nfall and autumn 4.  Because winter can follow fall/autumn at the end of a calender year, a special test is made to see if |date=Fall-Winter yyyy (4-1) is the date.\n\n]]\n\nlocal function is_valid_month_season_range(range_start,\
      \ range_end)\n\tlocal range_start_number = get_month_number (range_start);\n\t\n\tif 0 == range_start_number then\t\t\t\t\t\t\t\t-- is this a month range?\n\t\tlocal range_start_number = get_season_number (range_start);\t\t-- not a month; is it a season?\
      \ get start season number\n\t\tlocal range_end_number = get_season_number (range_end);\t\t\t-- get end season number\n\n\t\tif 0 ~= range_start_number then\t\t\t\t\t\t\t-- is start of range a season?\n\t\t\tif range_start_number &lt; range_end_number then\t\
      \t-- range_start is a season\n\t\t\t\treturn true;\t\t\t\t\t\t\t\t\t-- return true when range_end is also a season and follows start season; else false\n\t\t\tend\n\t\t\tif 4 == range_start_number and 1 == range_end_number then\t-- special case when range\
      \ is Fall-Winter or Autumn-Winter\n\t\t\t\treturn true;\n\t\t\tend\n\t\tend\n\t\treturn false;\t\t-- range_start is not a month or a season; or range_start is a season and range_end is not; or improper season sequence\n\tend\n\n\tlocal range_end_number\
      \ = get_month_number (range_end);\t\t-- get end month number\n\tif range_start_number &lt; range_end_number then\t\t\t\t-- range_start is a month; does range_start precede range_end?\n\t\tif is_valid_month_range_style (range_start, range_end) then\t\t\t\
      \t-- do months have the same style?\n\t\t\treturn true;\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- proper order and same style\n\t\tend\n\tend\n\treturn false;\t\t\t\t\t\t\t\t\t\t\t\t-- range_start month number is greater than or equal to range end number; or range\
      \ end isn't a month\nend\n\n--[[--------------------------&lt; C H E C K _ D A T E &gt;----------------------------------------------------------\n\nCheck date format to see that it is one of the formats approved by WP:DATESNO or WP:DATERANGE. Exception:\
      \ only allowed range separator is endash.\nAdditionally, check the date to see that it is a real date: no 31 in 30-day months; no 29 February when not a leap year.  Months, both long-form and three\ncharacter abbreviations, and seasons must be spelled\
      \ correctly. Future years beyond next year are not allowed.\n\nIf the date fails the format tests, this function returns false and does not return values for anchor_year and COinS_date.  When this happens, the date parameter is\nused in the COinS metadata\
      \ and the CITEREF identifier gets its year from the year parameter if present otherwise CITEREF does not get a date value.\n\nInputs:\n\tdate_string - date string from date-holding parameters (date, year, accessdate, embargo, archivedate, etc.)\n\nReturns:\n\
      \tfalse if date string is not a real date; else\n\ttrue, anchor_year, COinS_date\n\t\tanchor_year can be used in CITEREF anchors\n\t\tCOinS_date is date_string without anchor_year disambiguator if any\n]]\nlocal function check_date (date_string)\n\tlocal\
      \ year;\t\t\t-- assume that year2, months, and days are not used;\n\tlocal year2=0;\t\t-- second year in a year range\n\tlocal month=0;\n\tlocal month2=0;\t\t-- second month in a month range\n\tlocal day=0;\n\tlocal day2=0;\t\t-- second day in a day range\n\
      \tlocal anchor_year;\n\tlocal coins_date;\n\n\tif date_string:match(&quot;^%d%d%d%d%-%d%d%-%d%d$&quot;) then\t\t\t\t\t\t\t\t\t\t-- year-initial numerical year month day format\n\t\tyear, month, day=string.match(date_string, &quot;(%d%d%d%d)%-(%d%d)%-(%d%d)&quot;);\n\
      \t\tmonth=tonumber(month);\n\t\tif 12 &lt; month or 1 &gt; month or 1583 &gt; tonumber(year) then return false; end\t\t\t-- month number not valid or not Gregorian calendar\n\t\tanchor_year = year;\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d?, +[1-9]%d%d%d%a?$&quot;)\
      \ then\t\t\t\t\t\t-- month-initial: month day, year\n\t\tmonth, day, anchor_year, year=string.match(date_string, &quot;(%a+)%s*(%d%d?),%s*((%d%d%d%d)%a?)&quot;);\n\t\tmonth = get_month_number (month);\n\t\tif 0 == month then return false; end\t\t\t\t\t\
      \t\t\t\t\t\t\t-- return false if month text isn't one of the twelve months\n\t\t\t\t\n\telseif date_string:match(&quot;^%a+ +[1-9]%d?–[1-9]%d?, +[1-9]%d%d%d%a?$&quot;) then\t\t\t\t-- month-initial day range: month day–day, year; days are separated by endash\n\
      \t\tmonth, day, day2, anchor_year, year=string.match(date_string, &quot;(%a+) +(%d%d?)–(%d%d?), +((%d%d%d%d)%a?)&quot;);\n\t\tif tonumber(day) &gt;= tonumber(day2) then return false; end\t\t\t\t\t\t\t-- date range order is left to right: earlier to later;\
      \ dates may not be the same;\n\t\tmonth = get_month_number (month);\n\t\tif 0 == month then return false; end\t\t\t\t\t\t\t\t\t\t\t\t-- return false if month text isn't one of the twelve months\n\n\telseif date_string:match(&quot;^[1-9]%d? +%a+ +[1-9]%d%d%d%a?$&quot;)\
      \ then\t\t\t\t\t\t-- day-initial: day month year\n\t\tday, month, anchor_year, year=string.match(date_string, &quot;(%d%d*)%s*(%a+)%s*((%d%d%d%d)%a?)&quot;);\n\t\tmonth = get_month_number (month);\n\t\tif 0 == month then return false; end\t\t\t\t\t\t\t\
      \t\t\t\t\t-- return false if month text isn't one of the twelve months\n\n\telseif date_string:match(&quot;^[1-9]%d?–[1-9]%d? +%a+ +[1-9]%d%d%d%a?$&quot;) then\t\t\t\t-- day-range-initial: day–day month year; days are separated by endash\n\t\tday, day2,\
      \ month, anchor_year, year=string.match(date_string, &quot;(%d%d?)–(%d%d?) +(%a+) +((%d%d%d%d)%a?)&quot;);\n\t\tif tonumber(day) &gt;= tonumber(day2) then return false; end\t\t\t\t\t\t\t-- date range order is left to right: earlier to later; dates may\
      \ not be the same;\n\t\tmonth = get_month_number (month);\n\t\tif 0 == month then return false; end\t\t\t\t\t\t\t\t\t\t\t\t-- return false if month text isn't one of the twelve months\n\n\telseif date_string:match(&quot;^[1-9]%d? +%a+ – [1-9]%d? +%a+ +[1-9]%d%d%d%a?$&quot;)\
      \ then\t\t-- day initial month-day-range: day month - day month year; uses spaced endash\n\t\tday, month, day2, month2, anchor_year, year=date_string:match(&quot;(%d%d?) +(%a+) – (%d%d?) +(%a+) +((%d%d%d%d)%a?)&quot;);\n\t\tif (not is_valid_month_season_range(month,\
      \ month2)) or not is_valid_year(year) then return false; end\t-- date range order is left to right: earlier to later;\n\t\tmonth = get_month_number (month);\n\t\tmonth2 = get_month_number (month2);\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d? – %a+\
      \ +[1-9]%d?, +[1-9]%d%d%d?%a?$&quot;) then\t\t-- month initial month-day-range: month day – month day, year;  uses spaced endash\n\t\tmonth, day, month2, day2, anchor_year, year=date_string:match(&quot;(%a+) +(%d%d?) – (%a+) +(%d%d?), +((%d%d%d%d)%a?)&quot;);\n\
      \t\tif (not is_valid_month_season_range(month, month2)) or not is_valid_year(year) then return false; end\n\t\tmonth = get_month_number (month);\n\t\tmonth2 = get_month_number (month2);\n\n\telseif date_string:match(&quot;^[1-9]%d? +%a+ +[1-9]%d%d%d –\
      \ [1-9]%d? +%a+ +[1-9]%d%d%d%a?$&quot;) then\t\t-- day initial month-day-year-range: day month year - day month year; uses spaced endash\n\t\tday, month, year, day2, month2, anchor_year, year2=date_string:match(&quot;(%d%d?) +(%a+) +(%d%d%d%d?) – (%d%d?)\
      \ +(%a+) +((%d%d%d%d?)%a?)&quot;);\n\t\tif tonumber(year2) &lt;= tonumber(year) then return false; end\t\t\t\t\t\t\t-- must be sequential years, left to right, earlier to later\n\t\tif not is_valid_year(year2) or not is_valid_month_range_style(month, month2)\
      \ then return false; end\t\t-- year2 no more than one year in the future; months same style\n\t\tmonth = get_month_number (month);\n\t\tmonth2 = get_month_number (month2);\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d?, +[1-9]%d%d%d – %a+ +[1-9]%d?,\
      \ +[1-9]%d%d%d%a?$&quot;) then\t\t-- month initial month-day-year-range: month day, year – month day, year;  uses spaced endash\n\t\tmonth, day, year, month2, day2, anchor_year, year2=date_string:match(&quot;(%a+) +(%d%d?), +(%d%d%d%d) – (%a+) +(%d%d?),\
      \ +((%d%d%d%d)%a?)&quot;);\n\t\tif tonumber(year2) &lt;= tonumber(year) then return false; end\t\t\t\t\t\t\t-- must be sequential years, left to right, earlier to later\n\t\tif not is_valid_year(year2) or not is_valid_month_range_style(month, month2) then\
      \ return false; end\t\t-- year2 no more than one year in the future; months same style\n\t\tmonth = get_month_number (month);\n\t\tmonth2 = get_month_number (month2);\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d%d%d–%d%d%a?$&quot;) then\t\t\t\t\t\t\
      \t\t-- special case Winter/Summer year-year (YYYY-YY); year separated with unspaced endash\n\t\tif nil == date_string:match(&quot;^Winter&quot;) and nil == date_string:match(&quot;^Summer&quot;) then return false end;\t-- 'month' can only be Winter or\
      \ Summer\n\t\tlocal century;\n\t\tyear, century, anchor_year, year2=date_string:match(&quot;%a+ +((%d%d)%d%d)–((%d%d)%a?)&quot;);\n\t\tanchor_year=year..'–'..anchor_year;\t\t\t\t\t\t\t\t\t\t\t\t\t-- assemble anchor_year from both years\n\t\tyear2 = century..year2;\t\
      \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- add the century to year2 for comparisons\n\t\tif 1 ~= tonumber(year2) - tonumber(year) then return false; end\t\t\t\t\t\t-- must be sequential years, left to right, earlier to later\n\t\tif not is_valid_year(year2) then\
      \ return false; end\t\t\t\t\t\t\t\t\t-- no year farther in the future than next year\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d%d%d–[1-9]%d%d%d%a?$&quot;) then\t\t\t\t\t\t-- special case Winter/Summer year-year; year separated with unspaced endash\n\
      \t\tif nil == date_string:match(&quot;^Winter&quot;) and nil == date_string:match(&quot;^Summer&quot;) then return false end;\t-- 'month' can only be Winter or Summer\n\t\tyear, anchor_year, year2=date_string:match(&quot;%a+ +(%d%d%d%d)–((%d%d%d%d)%a?)&quot;);\n\
      \t\tanchor_year=year..'–'..anchor_year;\t\t\t\t\t\t\t\t\t\t\t\t\t-- assemble anchor_year from both years\n\t\tif 1 ~= tonumber(year2) - tonumber(year) then return false; end\t\t\t\t\t\t-- must be sequential years, left to right, earlier to later\n\t\t\
      if not is_valid_year(year2) then return false; end\t\t\t\t\t\t\t\t\t-- no year farther in the future than next year\n\n\telseif date_string:match(&quot;^%a+ +[1-9]%d%d%d% – %a+ +[1-9]%d%d%d%a?$&quot;) then\t\t\t\t-- month/season year - month/season year;\
      \ separated by spaced endash\n\t\tmonth, year, month2, anchor_year, year2=date_string:match(&quot;(%a+) +(%d%d%d%d) – (%a+) +((%d%d%d%d)%a?)&quot;);\n\t\tanchor_year=year..'–'..anchor_year;\t\t\t\t\t\t\t\t\t\t\t\t\t-- assemble anchor_year from both years\n\
      \t\tif tonumber(year) &gt;= tonumber(year2) then return false; end\t\t\t\t\t\t\t-- left to right, earlier to later, not the same\n\t\tif not is_valid_year(year2) then return false; end\t\t\t\t\t\t\t\t\t-- no year farther in the future than next year\n\t\
      \tif not((0 ~= get_month_number(month) and 0 ~= get_month_number(month2) and is_valid_month_range_style(month, month2)) or \t-- both must be month year, same month style\n\t\t\t(0 ~= get_season_number(month) and 0 ~= get_season_number(month2))) then return\
      \ false; end\t\t\t\t\t\t\t\t-- or season year, not mixed\n\n\telseif date_string:match (&quot;^%a+–%a+ +[1-9]%d%d%d%a?$&quot;) then\t\t\t\t\t\t\t\t-- month/season range year; months separated by endash \n\t\tmonth, month2, anchor_year, year=date_string:match\
      \ (&quot;(%a+)–(%a+)%s*((%d%d%d%d)%a?)&quot;);\n\t\tif (not is_valid_month_season_range(month, month2)) or (not is_valid_year(year)) then\n\t\t\treturn false;\n\t\tend\n\t\t\n\telseif date_string:match(&quot;^%a+ +%d%d%d%d%a?$&quot;) then\t\t\t\t\t\t\t\
      -- month/season year or proper-name year\n\t\tmonth, anchor_year, year=date_string:match(&quot;(%a+)%s*((%d%d%d%d)%a?)&quot;);\n\t\tif not is_valid_year(year) then return false; end\n\t\tif not is_valid_month_or_season (month) and 0 == is_proper_name (month)\
      \ then return false; end\n\n\telseif date_string:match(&quot;^[1-9]%d%d%d?–[1-9]%d%d%d?%a?$&quot;) then\t\t\t\t-- Year range: YYY-YYY or YYY-YYYY or YYYY–YYYY; separated by unspaced endash; 100-9999\n\t\tyear, anchor_year, year2=date_string:match(&quot;(%d%d%d%d?)–\
      ((%d%d%d%d?)%a?)&quot;);\n\t\tanchor_year=year..'–'..anchor_year;\t\t\t\t\t\t\t\t\t\t-- assemble anchor year from both years\n\t\tif tonumber(year) &gt;= tonumber(year2) then return false; end\t\t\t\t-- left to right, earlier to later, not the same\n\t\
      \tif not is_valid_year(year2) then return false; end\t\t\t\t\t\t-- no year farther in the future than next year\n\n\telseif date_string:match(&quot;^[1-9]%d%d%d–%d%d%a?$&quot;) then\t\t\t\t\t\t-- Year range: YYYY–YY; separated by unspaced endash\n\t\t\
      local century;\n\t\tyear, century, anchor_year, year2=date_string:match(&quot;((%d%d)%d%d)–((%d%d)%a?)&quot;);\n\t\tanchor_year=year..'–'..anchor_year;\t\t\t\t\t\t\t\t\t\t-- assemble anchor year from both years\n\t\tif 13 &gt; tonumber(year2) then return\
      \ false; end\t\t\t\t\t\t\t-- don't allow 2003-05 which might be May 2003\n\t\tyear2 = century..year2;\t\t\t\t\t\t\t\t\t\t\t\t\t-- add the century to year2 for comparisons\n\t\tif tonumber(year) &gt;= tonumber(year2) then return false; end\t\t\t\t-- left\
      \ to right, earlier to later, not the same\n\t\tif not is_valid_year(year2) then return false; end\t\t\t\t\t\t-- no year farther in the future than next year\n\n\telseif date_string:match(&quot;^[1-9]%d%d%d?%a?$&quot;) then\t\t\t\t\t\t\t-- year; here accept\
      \ either YYY or YYYY\n\t\tanchor_year, year=date_string:match(&quot;((%d%d%d%d?)%a?)&quot;);\n\t\tif false == is_valid_year(year) then\n\t\t\treturn false;\n\t\tend\n\n\telse\n\t\treturn false;\t\t\t\t\t\t\t\t\t\t\t-- date format not one of the MOS:DATE\
      \ approved formats\n\tend\n\n\tlocal result=true;\t\t\t\t\t\t\t\t\t\t\t-- check whole dates for validity; assume true because not all dates will go through this test\n\tif 0 ~= year and 0 ~= month and 0 ~= day and 0 == year2 and 0 == month2 and 0 == day2\
      \ then\t\t-- YMD (simple whole date)\n\t\tresult=is_valid_date(year,month,day);\n\n\telseif 0 ~= year and 0 ~= month and 0 ~= day and 0 == year2 and 0 == month2 and 0 ~= day2 then\t-- YMD-d (day range)\n\t\tresult=is_valid_date(year,month,day);\n\t\tresult=result\
      \ and is_valid_date(year,month,day2);\n\n\telseif 0 ~= year and 0 ~= month and 0 ~= day and 0 == year2 and 0 ~= month2 and 0 ~= day2 then\t-- YMD-md (day month range)\n\t\tresult=is_valid_date(year,month,day);\n\t\tresult=result and is_valid_date(year,month2,day2);\n\
      \n\telseif 0 ~= year and 0 ~= month and 0 ~= day and 0 ~= year2 and 0 ~= month2 and 0 ~= day2 then\t-- YMD-ymd (day month year range)\n\t\tresult=is_valid_date(year,month,day);\n\t\tresult=result and is_valid_date(year2,month2,day2);\n\tend\n\t\n\tif false\
      \ == result then return false; end\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if here, then date_string is valid; get coins_date from date_string (leave CITEREF disambiguator) ...\n\tcoins_date=date_string:match(&quot;^(.+%d)%a?$&quot;);\t\t\t\t-- last character\
      \ of valid disambiguatable date is always a digit\n\tcoins_date= mw.ustring.gsub(coins_date, &quot;–&quot;, &quot;-&quot; );\t\t\t-- ... and replace any ndash with a hyphen\n\t\n\treturn true, anchor_year, coins_date;\t\t\t\t\t\t-- format is good and date\
      \ string represents a real date\nend\t\n\n--[[--------------------------&lt; D A T E S &gt;--------------------------------------------------------------------\n\nCycle the date-holding parameters in passed table date_parameters_list through check_date()\
      \ to check compliance with MOS:DATE. For all valid dates, check_date() returns\ntrue. The |date= parameter test is unique, it is the only date holding parameter from which values for anchor_year (used in CITEREF identifiers) and COinS_date (used in\nthe\
      \ COinS metadata) are derived.  The |date= parameter is the only date-holding parameter that is allowed to contain the no-date keywords &quot;n.d.&quot; or &quot;nd&quot; (without quotes).\n\nUnlike most error messages created in this module, only one\
      \ error message is created by this function. Because all of the date holding parameters are processed serially,\na single error message is created as the dates are tested.\n\n]]\n\n--function p.dates(date_parameters_list)\nlocal function dates(date_parameters_list)\n\
      \tlocal anchor_year;\t\t-- will return as nil if the date being tested is not |date=\n\tlocal COinS_date;\t\t-- will return as nil if the date being tested is not |date=\n\tlocal error_message = &quot;&quot;;\n\tlocal mismatch = 0;\n\tlocal good_date =\
      \ false;\n\t\n\tfor k, v in pairs(date_parameters_list) do\t\t\t\t\t\t\t\t\t\t-- for each date-holding parameter in the list\n\t\tif is_set(v) then\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- if the parameter has a value\n\t\t\tif v:match(&quot;^c%. [1-9]%d%d%d?%a?$&quot;)\
      \ then\t\t\t\t\t\t\t\t-- special case for c. year or with or without CITEREF disambiguator - only |date= and |year=\n\t\t\t\tlocal year = v:match(&quot;c%. ([1-9]%d%d%d?)%a?&quot;);\t\t\t\t\t\t-- get the year portion so it can be tested\n\t\t\t\tif 'date'==k\
      \ then\n\t\t\t\t\tanchor_year, COinS_date = v:match(&quot;((c%. [1-9]%d%d%d?)%a?)&quot;);\t-- anchor year and COinS_date only from |date= parameter\n\t\t\t\t\tgood_date = is_valid_year(year);\n\t\t\t\telseif 'year'==k then\n\t\t\t\t\tgood_date = is_valid_year(year);\n\
      \t\t\t\tend\n\t\t\telseif 'date'==k then\t\t\t\t\t\t\t\t\t\t\t\t\t-- if the parameter is |date=\n\t\t\t\tif v:match(&quot;^n%.d%.%a?&quot;) then\t\t\t\t\t\t\t\t\t\t-- if |date=n.d. with or without a CITEREF disambiguator\n\t\t\t\t\tgood_date, anchor_year,\
      \ COinS_date = true, v:match(&quot;((n%.d%.)%a?)&quot;);\t--&quot;n.d.&quot;; no error when date parameter is set to no date\n\t\t\t\telseif v:match(&quot;^nd%a?$&quot;) then\t\t\t\t\t\t\t\t\t\t-- if |date=nd with or without a CITEREF disambiguator\n\t\
      \t\t\t\tgood_date, anchor_year, COinS_date = true, v:match(&quot;((nd)%a?)&quot;);\t--&quot;nd&quot;;\tno error when date parameter is set to no date\n\t\t\t\telse\n\t\t\t\t\tgood_date, anchor_year, COinS_date = check_date (v);\t\t\t-- go test the date\n\
      \t\t\t\tend\n\t\t\telseif 'accessdate'==k then\t\t\t\t\t\t\t\t\t\t\t\t-- if the parameter is |date=\n\t\t\t\tgood_date = check_date (v);\t\t\t\t\t\t\t\t\t\t\t-- go test the date\n\t\t\t\tif true == good_date then\t\t\t\t\t\t\t\t\t\t\t-- if the date is\
      \ a valid date\n\t\t\t\t\tgood_date = is_valid_accessdate (v);\t\t\t\t\t\t\t-- is Wikipedia start date &lt; accessdate &lt; tomorrow's date?\n\t\t\t\tend\n\t\t\telse\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- any other date-holding parameter\n\t\t\t\tgood_date\
      \ = check_date (v);\t\t\t\t\t\t\t\t\t\t\t-- go test the date\n\t\t\tend\n\t\t\tif false==good_date then\t\t\t\t\t\t\t\t\t\t\t\t-- assemble one error message so we don't add the tracking category multiple times\n\t\t\t\tif is_set(error_message) then\t\t\
      \t\t\t\t\t\t\t\t-- once we've added the first portion of the error message ...\n\t\t\t\t\terror_message=error_message .. &quot;, &quot;;\t\t\t\t\t\t\t-- ... add a comma space separator\n\t\t\t\tend\n\t\t\t\terror_message=error_message .. &quot;&amp;#124;&quot;\
      \ .. k .. &quot;=&quot;;\t\t\t\t-- add the failed parameter\n\t\t\tend\n\t\tend\n\tend\n\treturn anchor_year, COinS_date, error_message, mismatch;\t\t\t\t\t-- and done\nend\n\n--[[--------------------------&lt; Y E A R _ D A T E _ C H E C K &gt;------------------------------------------------\n\
      \nCompare the value provided in |year= with the year value(s) provided in |date=.  This function returns a numeric value:\n\t0 - year value does not match the year value in date\n\t1 - (default) year value matches the year value in date or one of the year\
      \ values when date contains two years\n\t2 - year value matches the year value in date when date is in the form YYYY-MM-DD and year is disambiguated (|year=YYYYx)\n\n]]\n\nlocal function year_date_check (year_string, date_string)\n\tlocal year;\n\tlocal\
      \ date1;\n\tlocal date2;\n\tlocal result = 1;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- result of the test; assume that the test passes\n\t\n\tyear = year_string:match ('(%d%d%d%d?)');\n\n\tif date_string:match ('%d%d%d%d%-%d%d%-%d%d') and year_string:match ('%d%d%d%d%a')\
      \ then\t--special case where date and year required YYYY-MM-DD and YYYYx\n\t\tdate1 = date_string:match ('(%d%d%d%d)');\n\t\tyear = year_string:match ('(%d%d%d%d)');\n\t\tif year ~= date1 then\n\t\t\tresult = 0;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- years don't\
      \ match\n\t\telse\n\t\t\tresult = 2;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t-- years match; but because disambiguated, don't add to maint cat\n\t\tend\n\t\t\n\telseif date_string:match (&quot;%d%d%d%d?.-%d%d%d%d?&quot;) then\t\t\t\t\t\t-- any of the standard formats\
      \ of date with two three- or four-digit years\n\t\tdate1, date2 = date_string:match (&quot;(%d%d%d%d?).-(%d%d%d%d?)&quot;);\n\t\tif year ~= date1 and year ~= date2 then\n\t\t\tresult = 0;\n\t\tend\n\n\telseif date_string:match (&quot;%d%d%d%d[%s%-–]+%d%d&quot;)\
      \ then\t\t\t\t\t\t-- YYYY-YY date ranges\n\t\tlocal century;\n\t\tdate1, century, date2 = date_string:match (&quot;((%d%d)%d%d)[%s%-–]+(%d%d)&quot;);\n\t\tdate2 = century..date2;\t\t\t\t\t\t\t\t\t\t\t\t\t-- convert YY to YYYY\n\t\tif year ~= date1 and\
      \ year ~= date2 then\n\t\t\tresult = 0;\n\t\tend\n\n\telseif date_string:match (&quot;%d%d%d%d?&quot;) then\t\t\t\t\t\t\t\t\t-- any of the standard formats of date with one year\n\t\tdate1 = date_string:match (&quot;(%d%d%d%d?)&quot;);\n\t\tif year ~=\
      \ date1 then\n\t\t\tresult = 0;\n\t\tend\n\tend\n\treturn result;\nend\n\nreturn {dates = dates, year_date_check = year_date_check}\t\t\t\t\t\t-- return exported functions</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:56.007Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acite+web&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:55 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1055 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1017473054, 123542347, 1029516497
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:cite web" to="Template:Cite web" /></normalized><pages><page _idx="4148498" pageid="4148498" ns="10" title="Template:Cite web"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:56:36Z" comment="Changed protection level of Template:Cite web: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:citation/CS1|citation
      |CitationClass=web
      }}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:56.405Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Awhich&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:56 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1055 miss (0), cp3007 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1017473430, 266580132, 1029518249
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:which" to="Template:Which" /></normalized><pages><page _idx="11572404" pageid="11572404" ns="10" title="Template:Which"><revisions><rev user="AnomieBOT II" timestamp="2013-11-17T18:10:10Z" comment="[[Module:Unsubst|Unsubstifying]] template, so {{subst:Which}} results in {{Which|date=...}}" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||$N=Which |date=__DATE__ |$B=
      &lt;!-- {{Which?}} begin --&gt;{{Fix
      | subst = &lt;includeonly&gt;{{subst:&lt;/includeonly&gt;&lt;includeonly&gt;substcheck}}&lt;/includeonly&gt;
      | link  = {{{link|Wikipedia:Avoid weasel words}}}
      | text  = which?
      | title = The material near this tag possibly uses too vague attribution or weasel words.
      | date  = {{{date|}}}
      | cat   = [[Category:All articles with specifically marked weasel-worded phrases]]
      | cat-date = Category:Articles with specifically marked weasel-worded phrases
      }}&lt;!-- {{Which?}} end --&gt;
      }}&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:56.597Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Asubstcheck&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:56 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421598109, 123542710, 1029519027
    body: <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:substcheck" to="Template:Substcheck" /></normalized><pages><page _idx="22465489" pageid="22465489" ns="10" title="Template:Substcheck"><revisions><rev user="Thumperward" timestamp="2010-09-07T17:05:47Z" comment="add docs" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">SUBST&lt;noinclude&gt;{{documentation}}&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:56.811Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AUnsubst&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:56 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791343145, 123542836, 1029519889
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"40945493\" pageid=\"40945493\" ns=\"828\" title=\"Module:Unsubst\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-08-22T15:48:46Z\" comment=\"add tracking category\
      \ per protected edit request by [[User:Jackmcbarn]]\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">local p = {}\n\nlocal specialParams = {\n\t['$N'] = 'template name', -- Deprecated, but keeping until it is removed from\
      \ transcluding templates\n\t['$B'] = 'template content',\n}\n\np[''] = function ( frame )\n\tif not frame:getParent() then\n\t\terror( '{{#invoke:Unsubst|}} makes no sense without a parent frame' )\n\tend\n\tif not frame.args['$B'] then\n\t\terror( '{{#invoke:Unsubst|}}\
      \ requires parameter $B (template content)' )\n\tend\n\t\n\tif mw.isSubsting() then\n\t\t---- substing\n\t\t-- Combine passed args with passed defaults\n\t\tlocal args = {}\n\t\tfor k, v in pairs( frame.args ) do\n\t\t\tif not specialParams[k] then\n\t\
      \t\t\tif v == '__DATE__' then\n\t\t\t\t\tv = mw.getContentLanguage():formatDate( 'F Y' )\n\t\t\t\tend\n\t\t\t\targs[k] = v\n\t\t\tend\n\t\tend\n\t\tfor k, v in pairs( frame:getParent().args ) do\n\t\t\targs[k] = v\n\t\tend\n\n\t\t-- Build an equivalent\
      \ template invocation\n\t\t-- First, find the title to use\n\t\tlocal titleobj = mw.title.new(frame:getParent():getTitle())\n\t\tlocal title\n\t\tif titleobj.namespace == 10 then -- NS_TEMPLATE\n\t\t\ttitle = titleobj.text\n\t\telseif titleobj.namespace\
      \ == 0 then -- NS_MAIN\n\t\t\ttitle = ':' .. titleobj.text\n\t\telse\n\t\t\ttitle = titleobj.prefixedText\n\t\tend\n\n\t\t-- Build the invocation body with numbered args first, then named\n\t\tlocal ret = '{{' .. title\n\t\tfor k, v in ipairs( args ) do\n\
      \t\t\tif string.find( v, '=', 1, true ) then\n\t\t\t\t-- likely something like 1=foo=bar, we need to do it as a named arg\n\t\t\t\tbreak\n\t\t\tend\n\t\t\tret = ret .. '|' .. v\n\t\t\targs[k] = nil\n\t\tend\n\t\tfor k, v in pairs( args ) do\n\t\t\tret\
      \ = ret .. '|' .. k .. '=' .. v\n\t\tend\n\t\t\n\t\treturn ret .. '}}'\n\telse\n\t\t---- Not substing\n\t\t-- Just return the &quot;body&quot;\n\t\treturn frame.args['$B'] .. (frame.args['$N'] and frame:getParent():getTitle() == mw.title.getCurrentTitle().prefixedText\
      \ and '[[Category:Calls to Module:Unsubst that use $N]]' or '')\n\tend\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:57.006Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFix&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:56 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3007 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550968374, 266580427, 1029520683
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"5632010\" pageid=\"5632010\" ns=\"10\" title=\"Template:Fix\"><revisions><rev user=\"Waldir\" timestamp=\"2014-05-11T01:03:11Z\" comment=\"if the noprint and inline-template\
      \ classes need to be preserved, according to the docs, then why not enforcing in the code rather than asking people to do it (and relying on them reading the docs attentively enough not to miss that)?\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\"\
      \ xml:space=\"preserve\">{{#switch:{{{subst|¬}}}\n |¬={{category handler\n  |template=[[Category:Templates needing substitution checking]]\n  |nocat={{{nocat|&lt;noinclude&gt;true&lt;/noinclude&gt;}}}\n }}\n |SUBST=[[Category:Pages with incorrectly substituted\
      \ templates]]\n}}{{Category handler\n |main={{Fix/category\n  |cat-date={{{cat-date|}}} \n  |cat={{{cat|}}} \n  |cat-date2={{{cat-date2|}}} \n  |cat2={{{cat2|}}} \n  |cat-date3={{{cat-date3|}}} \n  |cat3={{{cat3|}}} \n  |date={{{date|}}}\n }}\n |template={{#if:{{{name|}}}|{{#ifeq:{{{name}}}|{{ROOTPAGENAME}}||{{#if:{{{date|}}}||[[Category:Templates\
      \ including undated clean-up tags]]}}}}}} \n |subpage=no\n}}{{#if:{{{text|}}}\n |&lt;sup class=&quot;noprint Inline-Template {{{class|}}}&quot; style=&quot;white-space:nowrap;&quot;&gt;&amp;#91;&lt;i&gt;{{#if:{{{pre-text|}}}\n  |{{{pre-text}}}&amp;#32;\n\
      \ }}[[{{{link|Wikipedia:Cleanup}}}|&lt;span title=&quot;{{{title|{{{link|Wikipedia:Cleanup}}}}}}{{#if:{{{date|}}}|&lt;nowiki/&gt; ({{{date}}})}}&quot;&gt;{{{text|}}}&lt;/span&gt;]]{{#if:{{{post-text|}}}\n  |&amp;#32;{{{post-text}}}\n }}&lt;/i&gt;&amp;#93;&lt;/sup&gt;|{{{special|}}}\n\
      }}&lt;noinclude&gt;\n{{Documentation}}\n&lt;!-- Add cats and interwikis to the /doc subpage, not here! --&gt;\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:57.206Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFix%2Fcategory&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:57 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165596671, 1778187838, 1029521493
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="34017846" pageid="34017846" ns="10" title="Template:Fix/category"><revisions><rev user="TheDJ" timestamp="2012-01-17T21:00:05Z" comment="Adding {{pp-template}} ([[WP:TW|TW]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;noinclude&gt;{{pp-template|small=yes}}&lt;/noinclude&gt;{{{cat|[[Category:All pages needing cleanup]]}}}{{#if:{{{cat-date|}}}
        |[[{{{cat-date}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}{{#if:{{{cat2|}}}|{{{cat2}}}}}{{#if:{{{cat-date2|}}}
        |[[{{{cat-date2}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date2}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}{{#if:{{{cat3|}}}|{{{cat3}}}}}{{#if:{{{cat-date3|}}}
        |[[{{{cat-date3}}} {{#if:{{{date|}}}
         |from {{{date}}}
        }}]]{{#if:{{{date|}}}
         |{{#ifexist:{{{cat-date3}}} from {{{date}}}|
          |[[Category:Articles with invalid date parameter in template]]
         }}
        }}
       }}</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:57.392Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ACategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:57 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3006 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421599018, 417986437, 1029522333
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="25084818" pageid="25084818" ns="10" title="Template:Category handler"><revisions><rev user="Mr. Stradivarius" timestamp="2013-10-20T10:48:53Z" comment="Changed protection level of Template:Category handler: [[WP:High-risk templates|Highly visible template]]: allow template editors to edit ([Edit=Protected template] (indefinite) [Move=Protected template] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Category handler|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Add categories to the /doc subpage, and interwikis to Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:57.605Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:57 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464557868, 123543349, 1029523219
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"39772274\" pageid=\"39772274\" ns=\"828\" title=\"Module:Category handler\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-22T05:08:26Z\" comment=\"allow invocations\
      \ specifying the page parameter to use the mw.loadData optimisations, and don&#039;t call mw.title.new every time\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n\
      --                                                                            --\n--                              CATEGORY HANDLER                              --\n--                                                                            --\n--   \
      \   This module implements the {{category handler}} template in Lua,      --\n--      with a few improvements: all namespaces and all namespace aliases     --\n--      are supported, and namespace names are detected automatically for     --\n--      the\
      \ local wiki. This module requires [[Module:Namespace detect]]      --\n--      and [[Module:Yesno]] to be available on the local wiki. It can be     --\n--      configured for different wikis by altering the values in              --\n--      [[Module:Category\
      \ handler/config]], and pages can be blacklisted      --\n--      from categorisation by using [[Module:Category handler/blacklist]].   --\n--                                                                            --\n--------------------------------------------------------------------------------\n\
      \n-- Load required modules\nlocal yesno = require('Module:Yesno')\n\n-- Lazily load things we don't always need\nlocal mShared, mappings\n\nlocal p = {}\n\n--------------------------------------------------------------------------------\n-- Helper functions\n\
      --------------------------------------------------------------------------------\n\nlocal function trimWhitespace(s, removeBlanks)\n\tif type(s) ~= 'string' then\n\t\treturn s\n\tend\n\ts = s:match('^%s*(.-)%s*$')\n\tif removeBlanks then\n\t\tif s ~= ''\
      \ then\n\t\t\treturn s\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn s\n\tend\nend\n\n--------------------------------------------------------------------------------\n-- CategoryHandler class\n--------------------------------------------------------------------------------\n\
      \nlocal CategoryHandler = {}\nCategoryHandler.__index = CategoryHandler\n\nfunction CategoryHandler.new(data, args)\n\tlocal obj = setmetatable({ _data = data, _args = args }, CategoryHandler)\n\t\n\t-- Set the title object\n\tdo\n\t\tlocal pagename =\
      \ obj:parameter('demopage')\n\t\tlocal success, titleObj\n\t\tif pagename then\n\t\t\tsuccess, titleObj = pcall(mw.title.new, pagename)\n\t\tend\n\t\tif success and titleObj then\n\t\t\tobj.title = titleObj\n\t\t\tif titleObj == mw.title.getCurrentTitle()\
      \ then\n\t\t\t\tobj._usesCurrentTitle = true\n\t\t\tend\n\t\telse\n\t\t\tobj.title = mw.title.getCurrentTitle()\n\t\t\tobj._usesCurrentTitle = true\n\t\tend\n\tend\n\n\t-- Set suppression parameter values\n\tfor _, key in ipairs{'nocat', 'categories'}\
      \ do\n\t\tlocal value = obj:parameter(key)\n\t\tvalue = trimWhitespace(value, true)\n\t\tobj['_' .. key] = yesno(value)\n\tend\n\tdo\n\t\tlocal subpage = obj:parameter('subpage')\n\t\tlocal category2 = obj:parameter('category2')\n\t\tif type(subpage) ==\
      \ 'string' then\n\t\t\tsubpage = mw.ustring.lower(subpage)\n\t\tend\n\t\tif type(category2) == 'string' then\n\t\t\tsubpage = mw.ustring.lower(category2)\n\t\tend\n\t\tobj._subpage = trimWhitespace(subpage, true)\n\t\tobj._category2 = trimWhitespace(category2)\
      \ -- don't remove blank values\n\tend\n\treturn obj\nend\n\nfunction CategoryHandler:parameter(key)\n\tlocal parameterNames = self._data.parameters[key]\n\tlocal pntype = type(parameterNames)\n\tif pntype == 'string' or pntype == 'number' then\n\t\treturn\
      \ self._args[parameterNames]\n\telseif pntype == 'table' then\n\t\tfor _, name in ipairs(parameterNames) do\n\t\t\tlocal value = self._args[name]\n\t\t\tif value ~= nil then\n\t\t\t\treturn value\n\t\t\tend\n\t\tend\n\t\treturn nil\n\telse\n\t\terror(string.format(\n\
      \t\t\t'invalid config key &quot;%s&quot;',\n\t\t\ttostring(key)\n\t\t), 2)\n\tend\nend\n\nfunction CategoryHandler:isSuppressedByArguments()\n\treturn\n\t\t-- See if a category suppression argument has been set.\n\t\tself._nocat == true\n\t\tor self._categories\
      \ == false\n\t\tor (\n\t\t\tself._category2\n\t\t\tand self._category2 ~= self._data.category2Yes\n\t\t\tand self._category2 ~= self._data.category2Negative\n\t\t)\n\n\t\t-- Check whether we are on a subpage, and see if categories are\n\t\t-- suppressed\
      \ based on our subpage status.\n\t\tor self._subpage == self._data.subpageNo and self.title.isSubpage\n\t\tor self._subpage == self._data.subpageOnly and not self.title.isSubpage\nend\n\nfunction CategoryHandler:shouldSkipBlacklistCheck()\n\t-- Check whether\
      \ the category suppression arguments indicate we\n\t-- should skip the blacklist check.\n\treturn self._nocat == false\n\t\tor self._categories == true\n\t\tor self._category2 == self._data.category2Yes\nend\n\nfunction CategoryHandler:matchesBlacklist()\n\
      \tif self._usesCurrentTitle then\n\t\treturn self._data.currentTitleMatchesBlacklist\n\telse\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\treturn mShared.matchesBlacklist(\n\t\t\tself.title.prefixedText,\n\t\t\tmw.loadData('Module:Category\
      \ handler/blacklist')\n\t\t)\n\tend\nend\n\nfunction CategoryHandler:isSuppressed()\n\t-- Find if categories are suppressed by either the arguments or by\n\t-- matching the blacklist.\n\treturn self:isSuppressedByArguments()\n\t\tor not self:shouldSkipBlacklistCheck()\
      \ and self:matchesBlacklist()\nend\n\nfunction CategoryHandler:getNamespaceParameters()\n\tif self._usesCurrentTitle then\n\t\treturn self._data.currentTitleNamespaceParameters\n\telse\n\t\tif not mappings then\n\t\t\tmShared = mShared or require('Module:Category\
      \ handler/shared')\n\t\t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\t\tend\n\t\treturn mShared.getNamespaceParameters(\n\t\t\tself.title,\n\t\t\tmappings\n\t\t)\n\tend\nend\n\nfunction CategoryHandler:namespaceParametersExist()\n\
      \t-- Find whether any namespace parameters have been specified.\n\t-- We use the order &quot;all&quot; --&gt; namespace params --&gt; &quot;other&quot; as this is what\n\t-- the old template did.\n\tif self:parameter('all') then\n\t\treturn true\n\tend\n\
      \tif not mappings then\n\t\tmShared = mShared or require('Module:Category handler/shared')\n\t\tmappings = mShared.getParamMappings(true) -- gets mappings with mw.loadData\n\tend\n\tfor ns, params in pairs(mappings) do\n\t\tfor i, param in ipairs(params)\
      \ do\n\t\t\tif self._args[param] then\n\t\t\t\treturn true\n\t\t\tend\n\t\tend\n\tend\n\tif self:parameter('other') then\n\t\treturn true\n\tend\n\treturn false\nend\n\nfunction CategoryHandler:getCategories()\n\tlocal params = self:getNamespaceParameters()\n\
      \tlocal nsCategory\n\tfor i, param in ipairs(params) do\n\t\tlocal value = self._args[param]\n\t\tif value ~= nil then\n\t\t\tnsCategory = value\n\t\t\tbreak\n\t\tend\n\tend\n\tif nsCategory ~= nil or self:namespaceParametersExist() then\n\t\t-- Namespace\
      \ parameters exist - advanced usage.\n\t\tif nsCategory == nil then\n\t\t\tnsCategory = self:parameter('other')\n\t\tend\n\t\tlocal ret = {self:parameter('all')}\n\t\tlocal numParam = tonumber(nsCategory)\n\t\tif numParam and numParam &gt;= 1 and math.floor(numParam)\
      \ == numParam then\n\t\t\t-- nsCategory is an integer\n\t\t\tret[#ret + 1] = self._args[numParam]\n\t\telse\n\t\t\tret[#ret + 1] = nsCategory\n\t\tend\n\t\tif #ret &lt; 1 then\n\t\t\treturn nil\n\t\telse\n\t\t\treturn table.concat(ret)\n\t\tend\n\telseif\
      \ self._data.defaultNamespaces[self.title.namespace] then\n\t\t-- Namespace parameters don't exist, simple usage.\n\t\treturn self._args[1]\n\tend\n\treturn nil\nend\n\n--------------------------------------------------------------------------------\n\
      -- Exports\n--------------------------------------------------------------------------------\n\nlocal p = {}\n\nfunction p._exportClasses()\n\t-- Used for testing purposes.\n\treturn {\n\t\tCategoryHandler = CategoryHandler\n\t}\nend\n\nfunction p._main(args,\
      \ data)\n\tdata = data or mw.loadData('Module:Category handler/data')\n\tlocal handler = CategoryHandler.new(data, args)\n\tif handler:isSuppressed() then\n\t\treturn nil\n\tend\n\treturn handler:getCategories()\nend\n\nfunction p.main(frame, data)\n\t\
      data = data or mw.loadData('Module:Category handler/data')\n\tlocal args = require('Module:Arguments').getArgs(frame, {\n\t\twrappers = data.wrappers,\n\t\tvalueFunc = function (k, v)\n\t\t\tv = trimWhitespace(v)\n\t\t\tif type(k) == 'number' then\n\t\t\
      \t\tif v ~= '' then\n\t\t\t\t\treturn v\n\t\t\t\telse\n\t\t\t\t\treturn nil\n\t\t\t\tend\n\t\t\telse\n\t\t\t\treturn v\n\t\t\tend\n\t\tend\n\t})\n\treturn p._main(args, data)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:58.038Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AYesno&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:57 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3031 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165597803, 1371660141, 1029524092
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"38665046\" pageid=\"38665046\" ns=\"828\" title=\"Module:Yesno\"><revisions><rev user=\"MSGJ\" timestamp=\"2015-04-27T10:43:30Z\" comment=\"recognise &quot;t&quot; for true\
      \ and &quot;f&quot; for false, per request\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- Function allowing for consistent treatment of boolean-like wikitext input.\n-- It works similarly to the template {{yesno}}.\n\
      \nreturn function (val, default)\n\t-- If your wiki uses non-ascii characters for any of &quot;yes&quot;, &quot;no&quot;, etc., you\n\t-- should replace &quot;val:lower()&quot; with &quot;mw.ustring.lower(val)&quot; in the\n\t-- following line.\n\tval\
      \ = type(val) == 'string' and val:lower() or val\n\tif val == nil then\n\t\treturn nil\n\telseif val == true \n\t\tor val == 'yes'\n\t\tor val == 'y'\n\t\tor val == 'true'\n\t\tor val == 't'\n\t\tor tonumber(val) == 1\n\tthen\n\t\treturn true\n\telseif\
      \ val == false\n\t\tor val == 'no'\n\t\tor val == 'n'\n\t\tor val == 'false'\n\t\tor val == 'f'\n\t\tor tonumber(val) == 0\n\tthen\n\t\treturn false\n\telse\n\t\treturn default\n\tend\nend</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:58.211Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fdata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:58 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550969937, 4019096336, 1029525919
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"43233647\" pageid=\"43233647\" ns=\"828\" title=\"Module:Category handler/data\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:05:55Z\" comment=\"Protected\
      \ Module:Category handler/data: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\"\
      \ xml:space=\"preserve\">-- This module assembles data to be passed to [[Module:Category handler]] using\n-- mw.loadData. This includes the configuration data and whether the current\n-- page matches the title blacklist.\n\nlocal data = require('Module:Category\
      \ handler/config')\nlocal mShared = require('Module:Category handler/shared')\nlocal blacklist = require('Module:Category handler/blacklist')\nlocal title = mw.title.getCurrentTitle()\n\ndata.currentTitleMatchesBlacklist = mShared.matchesBlacklist(\n\t\
      title.prefixedText,\n\tblacklist\n)\n\ndata.currentTitleNamespaceParameters = mShared.getNamespaceParameters(\n\ttitle,\n\tmShared.getParamMappings()\n)\n\nreturn data</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:58.413Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fconfig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:58 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464558994, 1778188391, 1029526684
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"42291997\" pageid=\"42291997\" ns=\"828\" title=\"Module:Category handler/config\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:05:36Z\" comment=\"Protected\
      \ Module:Category handler/config: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\"\
      \ xml:space=\"preserve\">--------------------------------------------------------------------------------\n--            [[Module:Category handler]] configuration data                  --\n--       Language-specific parameter names and values can be set\
      \ here.        --\n--       For blacklist config, see [[Module:Category handler/blacklist]].     --\n--------------------------------------------------------------------------------\n\nlocal cfg = {} -- Don't edit this line.\n\n--------------------------------------------------------------------------------\n\
      --                       Start configuration data                             --\n--------------------------------------------------------------------------------\n\n--------------------------------------------------------------------------------\n-- \
      \                             Parameter names                               --\n-- These configuration items specify custom parameter names.                  --\n-- To add one extra name, you can use this format:                            --\n--     \
      \                                                                       --\n-- foo = 'parameter name',                                                    --\n--                                                                            --\n-- To add multiple\
      \ names, you can use this format:                            --\n--                                                                            --\n-- foo = {'parameter name 1', 'parameter name 2', 'parameter name 3'},        --\n--------------------------------------------------------------------------------\n\
      \ncfg.parameters = {\n\t\n\t-- The nocat and categories parameter suppress\n\t-- categorisation. They are used with Module:Yesno, and work as follows:\n\t--\n\t-- cfg.nocat:\n\t-- Result of yesno()                        Effect\n\t-- true             \
      \                        Categorisation is suppressed\n\t-- false                                    Categorisation is allowed, and\n\t--                                          the blacklist check is skipped\n\t-- nil                                \
      \      Categorisation is allowed\n\t--\n\t-- cfg.categories:\n\t-- Result of yesno()                        Effect\n\t-- true                                     Categorisation is allowed, and\n\t--                                          the blacklist\
      \ check is skipped\n\t-- false                                    Categorisation is suppressed\n\t-- nil                                      Categorisation is allowed\n\tnocat = 'nocat',\n\tcategories = 'categories',\n\t\n\t-- The parameter name for the\
      \ legacy &quot;category2&quot; parameter. This skips the\n\t-- blacklist if set to the cfg.category2Yes value, and suppresses\n\t-- categorisation if present but equal to anything other than\n\t-- cfg.category2Yes or cfg.category2Negative.\n\tcategory2\
      \ = 'category2',\n\t\n\t-- cfg.subpage is the parameter name to specify how to behave on subpages.\n\tsubpage = 'subpage',\n\t\n\t-- The parameter for data to return in all namespaces.\n\tall = 'all',\n\t\n\t-- The parameter name for data to return if\
      \ no data is specified for the\n\t-- namespace that is detected.\n\tother = 'other',\n\t\n\t-- The parameter name used to specify a page other than the current page;\n\t-- used for testing and demonstration.\n\tdemopage = 'page',\n}\n\n--------------------------------------------------------------------------------\n\
      --                              Parameter values                              --\n-- These are set values that can be used with certain parameters. Only one    --\n-- value can be specified, like this:                                         --\n--   \
      \                                                                         --\n-- cfg.foo = 'value name'                                                     --                                               --\n--------------------------------------------------------------------------------\n\
      \n-- The following settings are used with the cfg.category2 parameter. Setting\n-- cfg.category2 to cfg.category2Yes skips the blacklist, and if cfg.category2\n-- is present but equal to anything other than cfg.category2Yes or\n-- cfg.category2Negative\
      \ then it supresses cateogrisation.\ncfg.category2Yes = 'yes'\ncfg.category2Negative = '¬'\n\n-- The following settings are used with the cfg.subpage parameter.\n-- cfg.subpageNo is the value to specify to not categorise on subpages;\n-- cfg.subpageOnly\
      \ is the value to specify to only categorise on subpages.\ncfg.subpageNo = 'no'\ncfg.subpageOnly = 'only'\n\n--------------------------------------------------------------------------------\n--                           Default namespaces             \
      \                  --\n-- This is a table of namespaces to categorise by default. The keys are the   --\n-- namespace numbers.                                                         --\n--------------------------------------------------------------------------------\n\
      \ncfg.defaultNamespaces = {\n\t[  0] = true, -- main\n\t[  6] = true, -- file\n\t[ 12] = true, -- help\n\t[ 14] = true, -- category\n\t[100] = true, -- portal\n\t[108] = true, -- book\n}\n\n--------------------------------------------------------------------------------\n\
      --                                Wrappers                                    --\n-- This is a wrapper template or a list of wrapper templates to be passed to  --\n-- [[Module:Arguments]].                                                      --\n--------------------------------------------------------------------------------\n\
      \ncfg.wrappers = 'Template:Category handler'\n\n--------------------------------------------------------------------------------\n--                           End configuration data                           --\n--------------------------------------------------------------------------------\n\
      \nreturn cfg -- Don't edit this line.</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:58.705Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fshared&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:58 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1065 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1868456284, 4019096514, 1029527643
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"43232937\" pageid=\"43232937\" ns=\"828\" title=\"Module:Category handler/shared\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:06:15Z\" comment=\"Protected\
      \ Module:Category handler/shared: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\"\
      \ xml:space=\"preserve\">-- This module contains shared functions used by [[Module:Category handler]]\n-- and its submodules.\n\nlocal p = {}\n\nfunction p.matchesBlacklist(page, blacklist)\n\tfor i, pattern in ipairs(blacklist) do\n\t\tlocal match = mw.ustring.match(page,\
      \ pattern)\n\t\tif match then\n\t\t\treturn true\n\t\tend\n\tend\n\treturn false\nend\n\nfunction p.getParamMappings(useLoadData)\n\tlocal dataPage = 'Module:Namespace detect/data'\n\tif useLoadData then\n\t\treturn mw.loadData(dataPage).mappings\n\telse\n\
      \t\treturn require(dataPage).mappings\n\tend\nend\n\nfunction p.getNamespaceParameters(titleObj, mappings)\n\t-- We don't use title.nsText for the namespace name because it adds\n\t-- underscores.\n\tlocal mappingsKey\n\tif titleObj.isTalkPage then\n\t\
      \tmappingsKey = 'talk'\n\telse\n\t\tmappingsKey = mw.site.namespaces[titleObj.namespace].name\n\tend\n\tmappingsKey = mw.ustring.lower(mappingsKey)\n\treturn mappings[mappingsKey] or {}\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:58.900Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ACategory+handler%2Fblacklist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:58 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3007 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550970767, 266581366, 1029528900
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"43232926\" pageid=\"43232926\" ns=\"828\" title=\"Module:Category handler/blacklist\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-07-13T09:07:09Z\" comment=\"\
      Protected Module:Category handler/blacklist: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"\
      Scribunto\" xml:space=\"preserve\">-- This module contains the blacklist used by [[Module:Category handler]].\n-- Pages that match Lua patterns in this list will not be categorised unless\n-- categorisation is explicitly requested.\n\nreturn {\n    '^Main\
      \ Page$', -- don't categorise the main page.\n \n    -- Don't categorise the following pages or their subpages.\n    -- &quot;%f[/\\0]&quot; matches if the next character is &quot;/&quot; or the end of the string.\n    '^Wikipedia:Cascade%-protected items%f[/\\\
      0]',\n    '^User:UBX%f[/\\0]', -- The userbox &quot;template&quot; space.\n    '^User talk:UBX%f[/\\0]',\n \n    -- Don't categorise subpages of these pages, but allow\n    -- categorisation of the base page.\n    '^Wikipedia:Template messages/.*$',\n\
      \ \n    '/[aA]rchive' -- Don't categorise archives.\n}</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:59.099Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANamespace+detect%2Fdata&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:59 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3031 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421600894, 1371660738, 1029529828
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"42257476\" pageid=\"42257476\" ns=\"828\" title=\"Module:Namespace detect/data\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-04-05T17:02:16Z\" comment=\"bug fix\
      \ - use the demospace parameter as both key and value in the argKeys table\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--------------------------------------------------------------------------------\n--           \
      \               Namespace detect data                             --\n-- This module holds data for [[Module:Namespace detect]] to be loaded per    --\n-- page, rather than per #invoke, for performance reasons.                    --\n--------------------------------------------------------------------------------\n\
      \nlocal cfg = require('Module:Namespace detect/config')\n\nlocal function addKey(t, key, defaultKey)\n\tif key ~= defaultKey then\n\t\tt[#t + 1] = key\n\tend\nend\n\n-- Get a table of parameters to query for each default parameter name.\n-- This allows\
      \ wikis to customise parameter names in the cfg table while\n-- ensuring that default parameter names will always work. The cfg table\n-- values can be added as a string, or as an array of strings.\n\nlocal defaultKeys = {\n\t'main',\n\t'talk',\n\t'other',\n\
      \t'subjectns',\n\t'demospace',\n\t'demopage'\n}\n\nlocal argKeys = {}\nfor i, defaultKey in ipairs(defaultKeys) do\n\targKeys[defaultKey] = {defaultKey}\nend\n\nfor defaultKey, t in pairs(argKeys) do\n\tlocal cfgValue = cfg[defaultKey]\n\tlocal cfgValueType\
      \ = type(cfgValue)\n\tif cfgValueType == 'string' then\n\t\taddKey(t, cfgValue, defaultKey)\n\telseif cfgValueType == 'table' then\n\t\tfor i, key in ipairs(cfgValue) do\n\t\t\taddKey(t, key, defaultKey)\n\t\tend\n\tend\n\tcfg[defaultKey] = nil -- Free\
      \ the cfg value as we don't need it any more.\nend\n\nlocal function getParamMappings()\n\t--[[\n\t-- Returns a table of how parameter names map to namespace names. The keys\n\t-- are the actual namespace names, in lower case, and the values are the\n\t\
      -- possible parameter names for that namespace, also in lower case. The\n\t-- table entries are structured like this:\n\t-- {\n\t--   [''] = {'main'},\n\t--   ['wikipedia'] = {'wikipedia', 'project', 'wp'},\n\t--   ...\n\t-- }\n\t--]]\n\tlocal mappings\
      \ = {}\n\tlocal mainNsName = mw.site.subjectNamespaces[0].name\n\tmainNsName = mw.ustring.lower(mainNsName)\n\tmappings[mainNsName] = mw.clone(argKeys.main)\n\tmappings['talk'] = mw.clone(argKeys.talk)\n\tfor nsid, ns in pairs(mw.site.subjectNamespaces)\
      \ do\n\t\tif nsid ~= 0 then -- Exclude main namespace.\n\t\t\tlocal nsname = mw.ustring.lower(ns.name)\n\t\t\tlocal canonicalName = mw.ustring.lower(ns.canonicalName)\n\t\t\tmappings[nsname] = {nsname}\n\t\t\tif canonicalName ~= nsname then\n\t\t\t\ttable.insert(mappings[nsname],\
      \ canonicalName)\n\t\t\tend\n\t\t\tfor _, alias in ipairs(ns.aliases) do\n\t\t\t\ttable.insert(mappings[nsname], mw.ustring.lower(alias))\n\t\t\tend\n\t\tend\n\tend\n\treturn mappings\nend\n\nreturn {\n\targKeys = argKeys,\n\tcfg = cfg,\n\tmappings = getParamMappings()\n\
      }</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:59.301Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ANamespace+detect%2Fconfig&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:59 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165600071, 4019096802, 1029530701
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="42256703" pageid="42256703" ns="828" title="Module:Namespace detect/config"><revisions><rev user="Mr. Stradivarius" timestamp="2014-04-05T17:03:49Z" comment="use cfg.demopage rather than cfg.page now that the default parameter has been changed on the /data page" contentformat="text/plain" contentmodel="Scribunto" xml:space="preserve">--------------------------------------------------------------------------------
      --                    Namespace detect configuration data                     --
      --                                                                            --
      -- This module stores configuration data for Module:Namespace detect. Here    --
      -- you can localise the module to your wiki's language.                       --
      --                                                                            --
      -- To activate a configuration item, you need to uncomment it. This means     --
      -- that you need to remove the text &quot;-- &quot; at the start of the line.           --
      --------------------------------------------------------------------------------

      local cfg = {} -- Don't edit this line.

      --------------------------------------------------------------------------------
      --                              Parameter names                               --
      -- These configuration items specify custom parameter names. Values added     --
      -- here will work in addition to the default English parameter names.         --
      -- To add one extra name, you can use this format:                            --
      --                                                                            --
      -- cfg.foo = 'parameter name'                                                 --
      --                                                                            --
      -- To add multiple names, you can use this format:                            --
      --                                                                            --
      -- cfg.foo = {'parameter name 1', 'parameter name 2', 'parameter name 3'}     --
      --------------------------------------------------------------------------------

      ---- This parameter displays content for the main namespace:
      -- cfg.main = 'main'

      ---- This parameter displays in talk namespaces:
      -- cfg.talk = 'talk'

      ---- This parameter displays content for &quot;other&quot; namespaces (namespaces for which
      ---- parameters have not been specified):
      -- cfg.other = 'other'

      ---- This parameter makes talk pages behave as though they are the corresponding
      ---- subject namespace. Note that this parameter is used with [[Module:Yesno]].
      ---- Edit that module to change the default values of &quot;yes&quot;, &quot;no&quot;, etc.
      -- cfg.subjectns = 'subjectns'

      ---- This parameter sets a demonstration namespace:
      -- cfg.demospace = 'demospace'

      ---- This parameter sets a specific page to compare:
      cfg.demopage = 'page'

      --------------------------------------------------------------------------------
      --                           Table configuration                              --
      -- These configuration items allow customisation of the &quot;table&quot; function,     --
      -- used to generate a table of possible parameters in the module              --
      -- documentation.                                                             --
      --------------------------------------------------------------------------------

      ---- The header for the namespace column in the wikitable containing the list of
      ---- possible subject-space parameters.
      -- cfg.wikitableNamespaceHeader = 'Namespace'

      ---- The header for the wikitable containing the list of possible subject-space
      ---- parameters.
      -- cfg.wikitableAliasesHeader = 'Aliases'

      --------------------------------------------------------------------------------
      --                        End of configuration data                           --
      --------------------------------------------------------------------------------

      return cfg -- Don't edit this line.</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:59.511Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3AArguments&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:59 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1065 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1868457853, 4019096888, 1029531625
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"41298065\" pageid=\"41298065\" ns=\"828\" title=\"Module:Arguments\"><revisions><rev user=\"Jackmcbarn\" timestamp=\"2015-06-26T22:53:15Z\" comment=\"add argument translation\
      \ from sandbox - all tests pass\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">-- This module provides easy processing of arguments passed to Scribunto from\n-- #invoke. It is intended for use by other Lua modules, and\
      \ should not be\n-- called from #invoke directly.\n\nlocal libraryUtil = require('libraryUtil')\nlocal checkType = libraryUtil.checkType\n\nlocal arguments = {}\n\n-- Generate four different tidyVal functions, so that we don't have to check the\n-- options\
      \ every time we call it.\n\nlocal function tidyValDefault(key, val)\n\tif type(val) == 'string' then\n\t\tval = val:match('^%s*(.-)%s*$')\n\t\tif val == '' then\n\t\t\treturn nil\n\t\telse\n\t\t\treturn val\n\t\tend\n\telse\n\t\treturn val\n\tend\nend\n\
      \nlocal function tidyValTrimOnly(key, val)\n\tif type(val) == 'string' then\n\t\treturn val:match('^%s*(.-)%s*$')\n\telse\n\t\treturn val\n\tend\nend\n\nlocal function tidyValRemoveBlanksOnly(key, val)\n\tif type(val) == 'string' then\n\t\tif val:find('%S')\
      \ then\n\t\t\treturn val\n\t\telse\n\t\t\treturn nil\n\t\tend\n\telse\n\t\treturn val\n\tend\nend\n\nlocal function tidyValNoChange(key, val)\n\treturn val\nend\n\nlocal function matchesTitle(given, title)\n\tlocal tp = type( given )\n\treturn (tp == 'string'\
      \ or tp == 'number') and mw.title.new( given ).prefixedText == title\nend\n\nlocal translate_mt = { __index = function(t, k) return k end }\n\nfunction arguments.getArgs(frame, options)\n\tcheckType('getArgs', 1, frame, 'table', true)\n\tcheckType('getArgs',\
      \ 2, options, 'table', true)\n\tframe = frame or {}\n\toptions = options or {}\n\n\t--[[\n\t-- Set up argument translation.\n\t--]]\n\toptions.translate = options.translate or {}\n\tif getmetatable(options.translate) == nil then\n\t\tsetmetatable(options.translate,\
      \ translate_mt)\n\tend\n\tif options.backtranslate == nil then\n\t\toptions.backtranslate = {}\n\t\tfor k,v in pairs(options.translate) do\n\t\t\toptions.backtranslate[v] = k\n\t\tend\n\tend\n\tif options.backtranslate and getmetatable(options.backtranslate)\
      \ == nil then\n\t\tsetmetatable(options.backtranslate, {\n\t\t\t__index = function(t, k)\n\t\t\t\tif options.translate[k] ~= k then\n\t\t\t\t\treturn nil\n\t\t\t\telse\n\t\t\t\t\treturn k\n\t\t\t\tend\n\t\t\tend\n\t\t})\n\tend\n\n\t--[[\n\t-- Get the argument\
      \ tables. If we were passed a valid frame object, get the\n\t-- frame arguments (fargs) and the parent frame arguments (pargs), depending\n\t-- on the options set and on the parent frame's availability. If we weren't\n\t-- passed a valid frame object,\
      \ we are being called from another Lua module\n\t-- or from the debug console, so assume that we were passed a table of args\n\t-- directly, and assign it to a new variable (luaArgs).\n\t--]]\n\tlocal fargs, pargs, luaArgs\n\tif type(frame.args) == 'table'\
      \ and type(frame.getParent) == 'function' then\n\t\tif options.wrappers then\n\t\t\t--[[\n\t\t\t-- The wrappers option makes Module:Arguments look up arguments in\n\t\t\t-- either the frame argument table or the parent argument table, but\n\t\t\t-- not\
      \ both. This means that users can use either the #invoke syntax\n\t\t\t-- or a wrapper template without the loss of performance associated\n\t\t\t-- with looking arguments up in both the frame and the parent frame.\n\t\t\t-- Module:Arguments will look\
      \ up arguments in the parent frame\n\t\t\t-- if it finds the parent frame's title in options.wrapper;\n\t\t\t-- otherwise it will look up arguments in the frame object passed\n\t\t\t-- to getArgs.\n\t\t\t--]]\n\t\t\tlocal parent = frame:getParent()\n\t\
      \t\tif not parent then\n\t\t\t\tfargs = frame.args\n\t\t\telse\n\t\t\t\tlocal title = parent:getTitle():gsub('/sandbox$', '')\n\t\t\t\tlocal found = false\n\t\t\t\tif matchesTitle(options.wrappers, title) then\n\t\t\t\t\tfound = true\n\t\t\t\telseif type(options.wrappers)\
      \ == 'table' then\n\t\t\t\t\tfor _,v in pairs(options.wrappers) do\n\t\t\t\t\t\tif matchesTitle(v, title) then\n\t\t\t\t\t\t\tfound = true\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tend\n\t\t\t\t\tend\n\t\t\t\tend\n\n\t\t\t\t-- We test for false specifically here\
      \ so that nil (the default) acts like true.\n\t\t\t\tif found or options.frameOnly == false then\n\t\t\t\t\tpargs = parent.args\n\t\t\t\tend\n\t\t\t\tif not found or options.parentOnly == false then\n\t\t\t\t\tfargs = frame.args\n\t\t\t\tend\n\t\t\tend\n\
      \t\telse\n\t\t\t-- options.wrapper isn't set, so check the other options.\n\t\t\tif not options.parentOnly then\n\t\t\t\tfargs = frame.args\n\t\t\tend\n\t\t\tif not options.frameOnly then\n\t\t\t\tlocal parent = frame:getParent()\n\t\t\t\tpargs = parent\
      \ and parent.args or nil\n\t\t\tend\n\t\tend\n\t\tif options.parentFirst then\n\t\t\tfargs, pargs = pargs, fargs\n\t\tend\n\telse\n\t\tluaArgs = frame\n\tend\n\n\t-- Set the order of precedence of the argument tables. If the variables are\n\t-- nil, nothing\
      \ will be added to the table, which is how we avoid clashes\n\t-- between the frame/parent args and the Lua args.\n\tlocal argTables = {fargs}\n\targTables[#argTables + 1] = pargs\n\targTables[#argTables + 1] = luaArgs\n\n\t--[[\n\t-- Generate the tidyVal\
      \ function. If it has been specified by the user, we\n\t-- use that; if not, we choose one of four functions depending on the\n\t-- options chosen. This is so that we don't have to call the options table\n\t-- every time the function is called.\n\t--]]\n\
      \tlocal tidyVal = options.valueFunc\n\tif tidyVal then\n\t\tif type(tidyVal) ~= 'function' then\n\t\t\terror(\n\t\t\t\t&quot;bad value assigned to option 'valueFunc'&quot;\n\t\t\t\t\t.. '(function expected, got '\n\t\t\t\t\t.. type(tidyVal)\n\t\t\t\t\t\
      .. ')',\n\t\t\t\t2\n\t\t\t)\n\t\tend\n\telseif options.trim ~= false then\n\t\tif options.removeBlanks ~= false then\n\t\t\ttidyVal = tidyValDefault\n\t\telse\n\t\t\ttidyVal = tidyValTrimOnly\n\t\tend\n\telse\n\t\tif options.removeBlanks ~= false then\n\
      \t\t\ttidyVal = tidyValRemoveBlanksOnly\n\t\telse\n\t\t\ttidyVal = tidyValNoChange\n\t\tend\n\tend\n\n\t--[[\n\t-- Set up the args, metaArgs and nilArgs tables. args will be the one\n\t-- accessed from functions, and metaArgs will hold the actual arguments.\
      \ Nil\n\t-- arguments are memoized in nilArgs, and the metatable connects all of them\n\t-- together.\n\t--]]\n\tlocal args, metaArgs, nilArgs, metatable = {}, {}, {}, {}\n\tsetmetatable(args, metatable)\n\n\tlocal function mergeArgs(tables)\n\t\t--[[\n\
      \t\t-- Accepts multiple tables as input and merges their keys and values\n\t\t-- into one table. If a value is already present it is not overwritten;\n\t\t-- tables listed earlier have precedence. We are also memoizing nil\n\t\t-- values, which can be\
      \ overwritten if they are 's' (soft).\n\t\t--]]\n\t\tfor _, t in ipairs(tables) do\n\t\t\tfor key, val in pairs(t) do\n\t\t\t\tif metaArgs[key] == nil and nilArgs[key] ~= 'h' then\n\t\t\t\t\tlocal tidiedVal = tidyVal(key, val)\n\t\t\t\t\tif tidiedVal ==\
      \ nil then\n\t\t\t\t\t\tnilArgs[key] = 's'\n\t\t\t\t\telse\n\t\t\t\t\t\tmetaArgs[key] = tidiedVal\n\t\t\t\t\tend\n\t\t\t\tend\n\t\t\tend\n\t\tend\n\tend\n\n\t--[[\n\t-- Define metatable behaviour. Arguments are memoized in the metaArgs table,\n\t-- and\
      \ are only fetched from the argument tables once. Fetching arguments\n\t-- from the argument tables is the most resource-intensive step in this\n\t-- module, so we try and avoid it where possible. For this reason, nil\n\t-- arguments are also memoized,\
      \ in the nilArgs table. Also, we keep a record\n\t-- in the metatable of when pairs and ipairs have been called, so we do not\n\t-- run pairs and ipairs on the argument tables more than once. We also do\n\t-- not run ipairs on fargs and pargs if pairs\
      \ has already been run, as all\n\t-- the arguments will already have been copied over.\n\t--]]\n\n\tmetatable.__index = function (t, key)\n\t\t--[[\n\t\t-- Fetches an argument when the args table is indexed. First we check\n\t\t-- to see if the value is\
      \ memoized, and if not we try and fetch it from\n\t\t-- the argument tables. When we check memoization, we need to check\n\t\t-- metaArgs before nilArgs, as both can be non-nil at the same time.\n\t\t-- If the argument is not present in metaArgs, we also\
      \ check whether\n\t\t-- pairs has been run yet. If pairs has already been run, we return nil.\n\t\t-- This is because all the arguments will have already been copied into\n\t\t-- metaArgs by the mergeArgs function, meaning that any other arguments\n\t\t\
      -- must be nil.\n\t\t--]]\n\t\tif type(key) == 'string' then\n\t\t\tkey = options.translate[key]\n\t\tend\n\t\tlocal val = metaArgs[key]\n\t\tif val ~= nil then\n\t\t\treturn val\n\t\telseif metatable.donePairs or nilArgs[key] then\n\t\t\treturn nil\n\t\
      \tend\n\t\tfor _, argTable in ipairs(argTables) do\n\t\t\tlocal argTableVal = tidyVal(key, argTable[key])\n\t\t\tif argTableVal ~= nil then\n\t\t\t\tmetaArgs[key] = argTableVal\n\t\t\t\treturn argTableVal\n\t\t\tend\n\t\tend\n\t\tnilArgs[key] = 'h'\n\t\
      \treturn nil\n\tend\n\n\tmetatable.__newindex = function (t, key, val)\n\t\t-- This function is called when a module tries to add a new value to the\n\t\t-- args table, or tries to change an existing value.\n\t\tif type(key) == 'string' then\n\t\t\tkey\
      \ = options.translate[key]\n\t\tend\n\t\tif options.readOnly then\n\t\t\terror(\n\t\t\t\t'could not write to argument table key &quot;'\n\t\t\t\t\t.. tostring(key)\n\t\t\t\t\t.. '&quot;; the table is read-only',\n\t\t\t\t2\n\t\t\t)\n\t\telseif options.noOverwrite\
      \ and args[key] ~= nil then\n\t\t\terror(\n\t\t\t\t'could not write to argument table key &quot;'\n\t\t\t\t\t.. tostring(key)\n\t\t\t\t\t.. '&quot;; overwriting existing arguments is not permitted',\n\t\t\t\t2\n\t\t\t)\n\t\telseif val == nil then\n\t\t\
      \t--[[\n\t\t\t-- If the argument is to be overwritten with nil, we need to erase\n\t\t\t-- the value in metaArgs, so that __index, __pairs and __ipairs do\n\t\t\t-- not use a previous existing value, if present; and we also need\n\t\t\t-- to memoize the\
      \ nil in nilArgs, so that the value isn't looked\n\t\t\t-- up in the argument tables if it is accessed again.\n\t\t\t--]]\n\t\t\tmetaArgs[key] = nil\n\t\t\tnilArgs[key] = 'h'\n\t\telse\n\t\t\tmetaArgs[key] = val\n\t\tend\n\tend\n\n\tlocal function translatenext(invariant)\n\
      \t\tlocal k, v = next(invariant.t, invariant.k)\n\t\tinvariant.k = k\n\t\tif k == nil then\n\t\t\treturn nil\n\t\telseif type(k) ~= 'string' or not options.backtranslate then\n\t\t\treturn k, v\n\t\telse\n\t\t\tlocal backtranslate = options.backtranslate[k]\n\
      \t\t\tif backtranslate == nil then\n\t\t\t\t-- Skip this one. This is a tail call, so this won't cause stack overflow\n\t\t\t\treturn translatenext(invariant)\n\t\t\telse\n\t\t\t\treturn backtranslate, v\n\t\t\tend\n\t\tend\n\tend\n\n\tmetatable.__pairs\
      \ = function ()\n\t\t-- Called when pairs is run on the args table.\n\t\tif not metatable.donePairs then\n\t\t\tmergeArgs(argTables)\n\t\t\tmetatable.donePairs = true\n\t\tend\n\t\treturn translatenext, { t = metaArgs }\n\tend\n\n\tlocal function inext(t,\
      \ i)\n\t\t-- This uses our __index metamethod\n\t\tlocal v = t[i + 1]\n\t\tif v ~= nil then\n\t\t\treturn i + 1, v\n\t\tend\n\tend\n\n\tmetatable.__ipairs = function (t)\n\t\t-- Called when ipairs is run on the args table.\n\t\treturn inext, t, 0\n\tend\n\
      \n\treturn args\nend\n\nreturn arguments</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:40:59.763Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AQuote&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:59 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464560827, 1778188900, 1029532711
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="994397" pageid="994397" ns="10" title="Template:Quote"><revisions><rev user="Dinoguy1000" timestamp="2015-06-18T20:25:51Z" comment="that&#039;s one of the reasons I don&#039;t like nested parameters in the conditional part of #if statements" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;blockquote class=&quot;templatequote&quot; {{#if:{{{style|}}}|style=&quot;{{{style}}}&quot;}}&gt;{{{text|{{{quote|{{{1|&lt;noinclude&gt;{{lorem ipsum}}&lt;/noinclude&gt;&lt;includeonly&gt;{{error|Error: No text given for quotation (or equals sign used in the actual argument to an unnamed parameter)}}&lt;/includeonly&gt;}}}}}}}}}{{#if:{{{sign|&lt;noinclude&gt;1&lt;/noinclude&gt;}}}{{{cite|}}}{{{author|}}}{{{by|}}}{{{2|}}}{{{source|}}}{{{ts|}}}{{{3|}}}|&lt;div class=&quot;templatequotecite&quot;&gt;—{{Comma separated entries
       | {{{sign|{{{cite|{{{author|{{{by|{{{2|&lt;noinclude&gt;Author&lt;/noinclude&gt;}}}}}}}}}}}}}}}
       | {{#if:{{{source|&lt;noinclude&gt;1&lt;/noinclude&gt;}}}{{{ts|}}}{{{3|}}}|&lt;cite&gt;{{{source|{{{ts|{{{3|&lt;noinclude&gt;Source&lt;/noinclude&gt;}}}}}}}}}&lt;/cite&gt;}}
       }}&lt;/div&gt;
      }}
      &lt;/blockquote&gt;{{#if:{{{class|}}}{{{id|}}}{{{title|}}}{{{diff|}}}{{{4|}}}{{{5|}}}|[[Category:Pages incorrectly using the quote template]]}}&lt;noinclude&gt;
      {{documentation}}&lt;!-- Add categories to the /doc subpage, not here! --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:40:59.939Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acitation+needed&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:40:59 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791346289, 123544793, 1029533636
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:citation needed" to="Template:Citation needed" /></normalized><pages><page _idx="2048472" pageid="2048472" ns="10" title="Template:Citation needed"><revisions><rev user="MSGJ" timestamp="2015-04-02T12:03:07Z" comment="try again" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}#invoke:Unsubst||date=__DATE__ |$B=
      {{Fix
      |name={{{name|Citation needed}}}
      |link=Wikipedia:Citation needed
      |text=citation needed
      |class=Template-Fact
      |title={{{reason|This claim needs references to reliable sources.}}}
      |date={{{date|}}}
      |cat=[[Category:All articles with unsourced statements]]
      |cat-date=Category:Articles with unsourced statements
      }}{{#if:{{{1|}}}|[[Category:Pages containing citation needed template with deprecated parameters]]}}
      }}&lt;noinclude&gt;

      {{Documentation}}

      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:00.137Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acategory+handler&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:00 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3013 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421602032, 1492454519, 1029534478
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:category handler" to="Template:Category handler" /></normalized><pages><page _idx="25084818" pageid="25084818" ns="10" title="Template:Category handler"><revisions><rev user="Mr. Stradivarius" timestamp="2013-10-20T10:48:53Z" comment="Changed protection level of Template:Category handler: [[WP:High-risk templates|Highly visible template]]: allow template editors to edit ([Edit=Protected template] (indefinite) [Move=Protected template] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Category handler|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Add categories to the /doc subpage, and interwikis to Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:00.444Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AROOTPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:00 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3007 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791346790, 266582088, 1029535411
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="22351615" pageid="22351615" ns="10" title="Template:ROOTPAGENAME"><revisions><rev user="Amalthea" timestamp="2010-05-03T11:31:08Z" comment="Allow substitution using safesubst: ([[meta:Help:Safesubst]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{ {{{|safesubst:}}}PAGENAME:{{ {{{|safesubst:}}}FULLROOTPAGENAME|{{{1|}}}}}}}&lt;noinclude&gt;

      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:00.722Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AFULLROOTPAGENAME&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:00 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1067 miss (0), cp3040 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2850767884, 2605864030, 1029536477
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"34701984\" pageid=\"34701984\" ns=\"10\" title=\"Template:FULLROOTPAGENAME\"><revisions><rev user=\"PrimeHunter\" timestamp=\"2012-02-12T12:42:22Z\" comment=\"Protected Template:FULLROOTPAGENAME:\
      \ [[WP:High-risk templates|Highly visible template]] ([edit=sysop] (indefinite) [move=sysop] (indefinite))\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{ {{{|safesubst:}}}#if: {{ {{{|safesubst:}}}Ns has subpages | {{\
      \ {{{|safesubst:}}}#if:{{{1|}}}|{{ {{{|safesubst:}}}NAMESPACE:{{{1}}}}}|{{ {{{|safesubst:}}}NAMESPACE}}}} }} \n  | {{ {{{|safesubst:}}}#titleparts:{{ {{{|safesubst:}}}#if:{{{1|}}}|{{{1}}}|{{ {{{|safesubst:}}}FULLPAGENAME}}}}|1}}\n  | {{ {{{|safesubst:}}}#if:{{{1|}}}|{{{1}}}|{{\
      \ {{{|safesubst:}}}FULLPAGENAME}}}}\n}}&lt;noinclude&gt;\n\n{{documentation}}\n\n&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:00.948Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Ade+icon&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:00 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3004 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464562519, 3878586021, 1029537813
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:de icon" to="Template:De icon" /></normalized><pages><page _idx="20845104" pageid="20845104" ns="10" title="Template:De icon"><revisions><rev user="Plastikspork" timestamp="2013-10-19T16:50:22Z" comment="Fix" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Language icon|de|German}}&lt;noinclude&gt;
      {{Documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:01.218Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALanguage+icon&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:01 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1065 miss (0), cp3030 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 1868461277, 2610618149, 1029538756
    body: '<?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="40797933" pageid="40797933" ns="10" title="Template:Language icon"><revisions><rev user="Anthony Appleyard" timestamp="2013-10-15T08:22:12Z" comment="Anthony Appleyard moved page
      [[Template:Language icon]] to [[Template:Link language]]: Requested at [[WP:RM]] as uncontroversial ([[Special:Permalink/577248632|permalink]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">#REDIRECT [[Template:Link language]]</rev></revisions></page></pages></query></api>'
- recorded: 2015-06-28T17:41:01.423Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ALink+language&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:01 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3006 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791347787, 417988797, 1029539932
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="3483283" pageid="3483283" ns="10" title="Template:Link language"><revisions><rev user="Anthony Appleyard" timestamp="2013-10-15T08:22:10Z" comment="Anthony Appleyard moved page [[Template:Language icon]] to [[Template:Link language]]: Requested at [[WP:RM]] as uncontroversial ([[Special:Permalink/577248632|permalink]])" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#ifexist:Template:ISO 639 name {{{1&lt;noinclude&gt;|&lt;/noinclude&gt;}}}
       |&lt;span class=&quot;languageicon&quot; style=&quot;font-size:0.95em; font-weight:bold; color:#555;&quot;&gt;({{ISO 639 name {{{1}}}}})&lt;/span&gt;{{category handler
        |main={{#ifeq:{{{1|}}}|en||[[Category:Articles with {{ISO 639 name {{{1}}}}}-language external links]]}}
       }}
       |{{error|Invalid language code.}}
      }}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:01.614Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AISO+639+name+de&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:01 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165603725, 123545815, 1029540814
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="19086232" pageid="19086232" ns="10" title="Template:ISO 639 name de"><revisions><rev user="Closedmouth" timestamp="2011-06-18T06:16:17Z" comment="Protected Template:ISO 639 name de: [[WP:High-risk templates|Highly visible template]] ([edit=sysop] (indefinite) [move=sysop] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">German&lt;noinclude&gt;
      {{ISO 639 name conversion template doc|{{ISO 639 name de}}|de}}
      [[id:Templat:ISO 639 name de]]
      [[pt:Predefinição:ISO 639 nome de]]&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:01.816Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3APortal&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:01 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1067 miss (0), cp3014 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2850769243, 1778189804, 1029541687
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="1780010" pageid="1780010" ns="10" title="Template:Portal"><revisions><rev user="Mr. Stradivarius" timestamp="2013-11-24T05:37:16Z" comment="Changed protection level of Template:Portal: [[WP:High-risk templates|Highly visible template]]: allow template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;{{#invoke:Portal|portal}}&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:02.032Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:01 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3004 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421604067, 3878586820, 1029542550
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"38965350\" pageid=\"38965350\" ns=\"828\" title=\"Module:Portal\"><revisions><rev user=\"Jackmcbarn\" timestamp=\"2014-12-01T02:19:07Z\" comment=\"use mw.html and other fixes\
      \ from sandbox\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[==[ This module is a Lua implementation of the old {{Portal}} template. As of August 2013 it is used on nearly 5,000,000 articles.\n-- Please take care when\
      \ updating it! It outputs two functions: p.portal, which generates a table of portals, and p.image, which\n-- produces the image name for an individual portal.\n\n-- The portal image data is kept in submodules of [[Module:Portal/images]], listed below:\n\
      -- [[Module:Portal/images/a]]\t\t- for portal names beginning with &quot;A&quot;.\n-- [[Module:Portal/images/b]]\t\t- for portal names beginning with &quot;B&quot;.\n-- [[Module:Portal/images/c]]\t\t- for portal names beginning with &quot;C&quot;.\n--\
      \ [[Module:Portal/images/d]]\t\t- for portal names beginning with &quot;D&quot;.\n-- [[Module:Portal/images/e]]\t\t- for portal names beginning with &quot;E&quot;.\n-- [[Module:Portal/images/f]]\t\t- for portal names beginning with &quot;F&quot;.\n-- [[Module:Portal/images/g]]\t\
      \t- for portal names beginning with &quot;G&quot;.\n-- [[Module:Portal/images/h]]\t\t- for portal names beginning with &quot;H&quot;.\n-- [[Module:Portal/images/i]]\t\t- for portal names beginning with &quot;I&quot;.\n-- [[Module:Portal/images/j]]\t\t\
      - for portal names beginning with &quot;J&quot;.\n-- [[Module:Portal/images/k]]\t\t- for portal names beginning with &quot;K&quot;.\n-- [[Module:Portal/images/l]]\t\t- for portal names beginning with &quot;L&quot;.\n-- [[Module:Portal/images/m]]\t\t- for\
      \ portal names beginning with &quot;M&quot;.\n-- [[Module:Portal/images/n]]\t\t- for portal names beginning with &quot;N&quot;.\n-- [[Module:Portal/images/o]]\t\t- for portal names beginning with &quot;O&quot;.\n-- [[Module:Portal/images/p]]\t\t- for portal\
      \ names beginning with &quot;P&quot;.\n-- [[Module:Portal/images/q]]\t\t- for portal names beginning with &quot;Q&quot;.\n-- [[Module:Portal/images/r]]\t\t- for portal names beginning with &quot;R&quot;.\n-- [[Module:Portal/images/s]]\t\t- for portal names\
      \ beginning with &quot;S&quot;.\n-- [[Module:Portal/images/t]]\t\t- for portal names beginning with &quot;T&quot;.\n-- [[Module:Portal/images/u]]\t\t- for portal names beginning with &quot;U&quot;.\n-- [[Module:Portal/images/v]]\t\t- for portal names beginning\
      \ with &quot;V&quot;.\n-- [[Module:Portal/images/w]]\t\t- for portal names beginning with &quot;W&quot;.\n-- [[Module:Portal/images/x]]\t\t- for portal names beginning with &quot;X&quot;.\n-- [[Module:Portal/images/y]]\t\t- for portal names beginning with\
      \ &quot;Y&quot;.\n-- [[Module:Portal/images/z]]\t\t- for portal names beginning with &quot;Z&quot;.\n-- [[Module:Portal/images/other]]\t- for portal names beginning with any other letters. This includes numbers,\n-- \t\t\t\t\t\t\t\t\t  letters with diacritics,\
      \ and letters in non-Latin alphabets.\n-- [[Module:Portal/images/aliases]]\t- for adding aliases for existing portal names. Use this page for variations\n-- \t\t\t\t\t\t\t\t\t  in spelling and diacritics, etc., no matter what letter the portal begins with.\n\
      --\n-- The images data pages are separated by the first letter to reduce server load when images are added, changed, or removed.\n-- Previously all the images were on one data page at [[Module:Portal/images]], but this had the disadvantage that all\n--\
      \ 5,000,000 pages using this module needed to be refreshed every time an image was added or removed.\n]==]\n\nlocal p = {}\n\nlocal function matchImagePage(s)\n\t-- Finds the appropriate image subpage given a lower-case\n\t-- portal name plus the first\
      \ letter of that portal name.\n\tif type(s) ~= 'string' or #s &lt; 1 then return end\n\tlocal firstLetter = mw.ustring.sub(s, 1, 1)\n\tlocal imagePage\n\tif mw.ustring.find(firstLetter, '^[a-z]') then\n\t\timagePage = 'Module:Portal/images/' .. firstLetter\n\
      \telse\n\t\timagePage = 'Module:Portal/images/other'\n\tend\n\treturn mw.loadData(imagePage)[s]\nend\n\nlocal function getAlias(s)\n\t-- Gets an alias from the image alias data page.\n\tlocal aliasData = mw.loadData('Module:Portal/images/aliases')\n\t\
      for portal, aliases in pairs(aliasData) do\n\t\tfor _, alias in ipairs(aliases) do\n\t\t\tif alias == s then\n\t\t\t\treturn portal\n\t\t\tend\n\t\tend\n\tend\nend\n\nlocal function getImageName(s)\n\t-- Gets the image name for a given string.\n\tif type(s)\
      \ ~= 'string' or #s &lt; 1 then\n\t\treturn 'Portal-puzzle.svg'\n\tend\n\ts = mw.ustring.lower(s)\n\treturn matchImagePage(s) or matchImagePage(getAlias(s)) or 'Portal-puzzle.svg'\nend\n\nfunction p._portal(portals, args)\n\t-- This function builds the\
      \ portal box used by the {{portal}} template.\n\tlocal root = mw.html.create('div')\n\t\t:addClass('noprint portal')\n\t\t:addClass(args.left and 'tleft' or 'tright')\n\t\t:css('border', 'solid #aaa 1px')\n\t\t:css('margin', args.margin or (args.left ==\
      \ 'yes' and '0.5em 1em 0.5em 0') or '0.5em 0 0.5em 1em')\n\t\t:newline()\n\n\t-- Start the table. This corresponds to the start of the wikitext table in the old [[Template:Portal]].\n\tlocal tableroot = root:tag('table')\n\t\t:css('background', '#f9f9f9')\n\
      \t\t:css('font-size', '85%')\n\t\t:css('line-height', '110%')\n\t\t:css('max-width', '175px')\n\t\t:css('width', type(args.boxsize) == 'string' and (args.boxsize .. 'px') or nil)\n\n\t-- If no portals have been specified, display an error and add the page\
      \ to a tracking category.\n\tif not portals[1] then\n\t\ttableroot:wikitext('&lt;strong class=&quot;error&quot;&gt;No portals specified: please specify at least one portal&lt;/strong&gt;[[Category:Portal templates without a parameter]]')\n\tend\n\n\t--\
      \ Display the portals specified in the positional arguments.\n\tfor _, portal in ipairs(portals) do\n\t\tlocal image = getImageName(portal)\n\n\t\t-- Generate the html for the image and the portal name.\n\t\ttableroot\n\t\t\t:newline()\n\t\t\t:tag('tr')\n\
      \t\t\t\t:css('vertical-align', 'middle')\n\t\t\t\t:tag('td')\n\t\t\t\t\t:css('text-align', 'center')\n\t\t\t\t\t:wikitext(string.format('[[File:%s|32x28px|alt=Portal icon|class=noviewer]]', image))\n\t\t\t\t\t:done()\n\t\t\t\t:tag('td')\n\t\t\t\t\t:css('padding',\
      \ '0 0.2em')\n\t\t\t\t\t:css('vertical-align', 'middle')\n\t\t\t\t\t:css('font-style', 'italic')\n\t\t\t\t\t:css('font-weight', 'bold')\n\t\t\t\t\t:wikitext(string.format('[[Portal:%s|%s%sportal]]', portal, portal, args['break'] and '&lt;br /&gt;' or '\
      \ '))\n\tend\n\treturn tostring(root)\nend\n\nfunction p._image(portals)\n\n\t-- Wrapper function to allow getImageName() to be accessed through #invoke.\n\treturn getImageName(portals[1])\nend\n\nlocal function getAllImageTables()\n\t-- Returns an array\
      \ containing all image subpages (minus aliases) as loaded by mw.loadData.\n\tlocal images = {}\n\tfor i, subpage in ipairs{'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z',\
      \ 'other'} do\n\t\timages[i] = mw.loadData('Module:Portal/images/' .. subpage)\n\tend\n\treturn images\nend\n\nfunction p._displayAll(portals, args)\n\t-- This function displays all portals that have portal images. This function is for maintenance purposes\
      \ and should not be used in\n\t-- articles, for two reasons: 1) there are over 1500 portals with portal images, and 2) the module doesn't record how the portal\n\t-- names are capitalized, so the portal links may be broken.\n\tlocal lang = mw.language.getContentLanguage()\n\
      \tlocal count = 1\n\tfor _, imageTable in ipairs(getAllImageTables()) do\n\t\tfor portal in pairs(imageTable) do\n\t\t\tportals[count] = lang:ucfirst(portal)\n\t\t\tcount = count + 1\n\t\tend\n\tend\n\treturn p._portal(portals, args)\nend\n\nfunction p._imageDupes()\n\
      \t-- This function searches the image subpages to find duplicate images. If duplicate images exist, it is not necessarily a bad thing,\n\t-- as different portals might just happen to choose the same image. However, this function is helpful in identifying\
      \ images that\n\t-- should be moved to a portal alias for ease of maintenance.\n\tlocal exists, dupes = {}, {}\n\tfor _, imageTable in ipairs(getAllImageTables()) do\n\t\tfor portal, image in pairs(imageTable) do\n\t\t\tif not exists[image] then\n\t\t\t\
      \texists[image] = portal\n\t\t\telse\n\t\t\t\ttable.insert(dupes, string.format('The image &quot;[[:File:%s|%s]]&quot; is used for both portals &quot;%s&quot; and &quot;%s&quot;.', image, image, exists[image], portal))\n\t\t\tend\n\t\tend\n\tend\n\tif\
      \ #dupes &lt; 1 then\n\t\treturn 'No duplicate images found.'\n\telse\n\t\treturn 'The following duplicate images were found:\\n* ' .. table.concat(dupes, '\\n* ')\n\tend\nend\n\nlocal function processPortalArgs(args)\n\t-- This function processes a table\
      \ of arguments and returns two tables: an array of portal names for processing by ipairs, and a table of\n\t-- the named arguments that specify style options, etc. We need to use ipairs because we want to list all the portals in the order\n\t-- they were\
      \ passed to the template, but we also want to be able to deal with positional arguments passed explicitly, for example\n\t-- {{portal|2=Politics}}. The behaviour of ipairs is undefined if nil values are present, so we need to make sure they are all removed.\n\
      \targs = type(args) == 'table' and args or {}\n\tlocal portals = {}\n\tlocal namedArgs = {}\n\tfor k, v in pairs(args) do\n\t\tif type(k) == 'number' and type(v) == 'string' then -- Make sure we have no non-string portal names.\n\t\t\ttable.insert(portals,\
      \ k)\n\t\telseif type(k) ~= 'number' then\n\t\t\tnamedArgs[k] = v\n\t\tend\n\tend\n\ttable.sort(portals)\n\tfor i, v in ipairs(portals) do\n\t\tportals[i] = args[v]\n\tend\n\treturn portals, namedArgs\nend\n\nlocal function makeWrapper(funcName)\n\t--\
      \ Processes external arguments and sends them to the other functions.\n\treturn function (frame)\n\t\t-- If called via #invoke, use the args passed into the invoking\n\t\t-- template, or the args passed to #invoke if any exist. Otherwise\n\t\t-- assume\
      \ args are being passed directly in from the debug console\n\t\t-- or from another Lua module.\n\t\tlocal origArgs\n\t\tif type(frame.getParent) == 'function' then\n\t\t\torigArgs = frame:getParent().args\n\t\t\tfor k, v in pairs(frame.args) do\n\t\t\t\
      \torigArgs = frame.args\n\t\t\t\tbreak\n\t\t\tend\n\t\telse\n\t\t\torigArgs = frame\n\t\tend\n\t\t-- Trim whitespace and remove blank arguments.\n\t\tlocal args = {}\n\t\tfor k, v in pairs(origArgs) do\n\t\t\tif type(v) == 'string' then\n\t\t\t\tv = mw.text.trim(v)\n\
      \t\t\tend\n\t\t\tif v ~= '' then\n\t\t\t\targs[k] = v\n\t\t\tend\n\t\tend\n\t\treturn p[funcName](processPortalArgs(args)) -- passes two tables to func: an array of portal names, and a table of named arguments.\n\tend\nend\n\nfor _, funcName in ipairs{'portal',\
      \ 'image', 'imageDupes', 'displayAll'} do\n\tp[funcName] = makeWrapper('_' .. funcName)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:02.353Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3APortal%2Fimages%2Fc&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:02 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1067 miss (0), cp3005 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2850769816, 4208155839, 1029543402
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"40416122\" pageid=\"40416122\" ns=\"828\" title=\"Module:Portal/images/c\"><revisions><rev user=\"John of Reading\" timestamp=\"2015-06-03T05:51:41Z\" comment=\"Updated capitalism\
      \ to avoid a clash with numismatics\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\">--[==[ This is the &quot;C&quot; list of portal image names. It contains a list of portal images for use with [[Module:Portal]]\n-- for\
      \ portal names that start with the letter &quot;C&quot;. For aliases to existing portal names, and for portal names that\n-- start with other letters, please use the appropriate page from the following list:\n \n-- [[Module:Portal/images/a]]       - for\
      \ portal names beginning with &quot;A&quot;.\n-- [[Module:Portal/images/b]]       - for portal names beginning with &quot;B&quot;.\n-- [[Module:Portal/images/d]]       - for portal names beginning with &quot;D&quot;.\n-- [[Module:Portal/images/e]]    \
      \   - for portal names beginning with &quot;E&quot;.\n-- [[Module:Portal/images/f]]       - for portal names beginning with &quot;F&quot;.\n-- [[Module:Portal/images/g]]       - for portal names beginning with &quot;G&quot;.\n-- [[Module:Portal/images/h]]\
      \       - for portal names beginning with &quot;H&quot;.\n-- [[Module:Portal/images/i]]       - for portal names beginning with &quot;I&quot;.\n-- [[Module:Portal/images/j]]       - for portal names beginning with &quot;J&quot;.\n-- [[Module:Portal/images/k]]\
      \       - for portal names beginning with &quot;K&quot;.\n-- [[Module:Portal/images/l]]       - for portal names beginning with &quot;L&quot;.\n-- [[Module:Portal/images/m]]       - for portal names beginning with &quot;M&quot;.\n-- [[Module:Portal/images/n]]\
      \       - for portal names beginning with &quot;N&quot;.\n-- [[Module:Portal/images/o]]       - for portal names beginning with &quot;O&quot;.\n-- [[Module:Portal/images/p]]       - for portal names beginning with &quot;P&quot;.\n-- [[Module:Portal/images/q]]\
      \       - for portal names beginning with &quot;Q&quot;.\n-- [[Module:Portal/images/r]]       - for portal names beginning with &quot;R&quot;.\n-- [[Module:Portal/images/s]]       - for portal names beginning with &quot;S&quot;.\n-- [[Module:Portal/images/t]]\
      \       - for portal names beginning with &quot;T&quot;.\n-- [[Module:Portal/images/u]]       - for portal names beginning with &quot;U&quot;.\n-- [[Module:Portal/images/v]]       - for portal names beginning with &quot;V&quot;.\n-- [[Module:Portal/images/w]]\
      \       - for portal names beginning with &quot;W&quot;.\n-- [[Module:Portal/images/x]]       - for portal names beginning with &quot;X&quot;.\n-- [[Module:Portal/images/y]]       - for portal names beginning with &quot;Y&quot;.\n-- [[Module:Portal/images/z]]\
      \       - for portal names beginning with &quot;Z&quot;.\n-- [[Module:Portal/images/other]]   - for portal names beginning with any other letters. This includes numbers,\n--                                    letters with diacritics, and letters in non-Latin\
      \ alphabets.\n-- [[Module:Portal/images/aliases]] - for adding aliases for existing portal names. Use this page for variations\n--                                    in spelling and diacritics, etc., no matter what letter the portal begins with.\n \n--\
      \ When adding entries, please use alphabetical order. The format of the images table entries is as follows:\n--          [&quot;portal name&quot;] = &quot;image.svg&quot;,\n-- The portal name should be the name of your portal, in lower case. For example,\
      \ the portal name for \n-- &quot;Portal:United Kingdom&quot; would be &quot;united kingdom&quot;. The image name should be capitalised normally, and the &quot;File:&quot;\n-- namespace prefix should be\n-- omitted.\n]==]\n\nreturn {\n\t[&quot;calgary&quot;]\
      \ = &quot;Flag of Calgary, Alberta.svg&quot;,\n\t[&quot;california&quot;] = &quot;Flag of California.svg|border&quot;,\n\t[&quot;california central valley&quot;] = &quot;California Central Valley county map.svg&quot;,\n\t[&quot;california roads&quot;]\
      \ = &quot;California blank.svg&quot;,\n\t[&quot;calvinism&quot;] = &quot;Kreuz-hugenotten.svg&quot;,\n\t[&quot;cambodia&quot;] = &quot;Flag of Cambodia.svg|border&quot;,\n\t[&quot;cameroon&quot;] = &quot;Flag of Cameroon.svg|border&quot;,\n\t[&quot;canada&quot;]\
      \ = &quot;Flag of Canada.svg|border&quot;,\n\t[&quot;canada/kawartha lakes&quot;] = &quot;Kawartha Lakes flag.svg|border&quot;,\n\t[&quot;canada roads&quot;] = &quot;Trans-Canada Highway shield.svg&quot;,\n\t[&quot;canadian armed forces&quot;] = &quot;Canadian\
      \ Forces emblem.svg&quot;,\n\t[&quot;canadian communities&quot;] = &quot;Map Canada political-geo.png&quot;,\n\t[&quot;canadian football&quot;] = &quot;Canadian football.png&quot;,\n\t[&quot;canadian law&quot;] = &quot;Supreme Court of Canada.jpg&quot;,\n\
      \t[&quot;canadian politics&quot;] = &quot;Can-vote-stub.svg&quot;,\n\t[&quot;canadian territories&quot;] = &quot;Northern Canada.svg&quot;,\n\t[&quot;cannabis&quot;] = &quot;Cannabis leaf.svg&quot;,\n\t[&quot;cape cod and the islands&quot;] = &quot;Nobska\
      \ Lighthouse 1.jpg&quot;,\n\t[&quot;cape verde&quot;] = &quot;Flag of Cape Verde.svg|border&quot;,\n\t[&quot;capital district&quot;] = &quot;Empire State Plaza symbol 2.svg&quot;,\n\t[&quot;capitalism&quot;] = &quot;Capitalismlogo.svg&quot;,\n\t[&quot;caribbean&quot;]\
      \ = &quot;Caribbean map blank.png&quot;,\n\t[&quot;caribbean community&quot;] = &quot;Flag of CARICOM.svg&quot;,\n\t[&quot;cars&quot;] = &quot;Sportcar sergio luiz ara 01.svg&quot;,\n\t[&quot;cartoon&quot;] = &quot;Mad scientist.svg&quot;,\n\t[&quot;cartoon\
      \ network&quot;] = &quot;Cartoon Network.svg|border&quot;,\n\t[&quot;catalan-speaking countries&quot;] = &quot;Siñal d'Aragón.svg|border&quot;,\n\t[&quot;catholicism&quot;] = &quot;046CupolaSPietro.jpg|border&quot;,\n\t[&quot;cats&quot;] = &quot;Cat03.jpg&quot;,\n\
      \t[&quot;celine dion&quot;] = &quot;Celine Dion Concert Singing 'Taking Chances' 2008.jpg&quot;,\n\t[&quot;celtic studies&quot;] = &quot;Celtic-knot-insquare-39crossings.svg&quot;,\n\t[&quot;central african republic&quot;] = &quot;Flag of the Central African\
      \ Republic.svg|border&quot;,\n\t[&quot;central america&quot;] = &quot;Age of Consent - Central America.svg&quot;,\n\t[&quot;central asia&quot;] = &quot;Central Asian Games participating countries.PNG&quot;,\n\t[&quot;cetaceans&quot;] = &quot;Sperm whale\
      \ fluke.jpg&quot;,\n\t[&quot;chad&quot;] = &quot;Flag of Chad.svg|border&quot;,\n\t[&quot;chandigarh&quot;] = &quot;Ghandi_Bhawan_at_Punjab_University.jpg&quot;,\n\t[&quot;channel islands&quot;] = &quot;Flag of Sark.svg|border&quot;,\n\t[&quot;charles\
      \ dickens&quot;] = &quot;Charles_Dickens_3.jpg&quot;,\n\t[&quot;chechnya&quot;] = &quot;Flag of the Chechen Republic.svg|border&quot;,\n\t[&quot;cheesehead&quot;] = &quot;Cheesehead.png&quot;,\n\t[&quot;chemistry&quot;] = &quot;Nuvola apps edu science.svg&quot;,\n\
      \t[&quot;chennai&quot;] = &quot;Chennai High Court 1200x800.jpg&quot;,\n\t[&quot;cher&quot;] = &quot;Cher Assinatura.png&quot;,\n\t[&quot;cheshire&quot;] = &quot;Cheshire Flag.svg|border&quot;,\n\t[&quot;chess&quot;] = &quot;Nuvola apps package games strategy.png&quot;,\n\
      \t[&quot;chicago&quot;] = &quot;Chicago city seal.png&quot;,\n\t[&quot;children's literature&quot;] = &quot;Tom Sawyer 1876 frontispiece.jpg&quot;,\n\t[&quot;chile&quot;] = &quot;Flag of Chile.svg|border&quot;,\n\t[&quot;china&quot;] = &quot;China.svg&quot;,\n\
      \t[&quot;chittagong&quot;] = &quot;Beach View of the Saint Martin's Island.jpg&quot;,\n\t[&quot;christian democracy&quot;] = &quot;Orange flag waving.svg&quot;,\n\t[&quot;christianity&quot;] = &quot;P christianity.svg&quot;,\n\t[&quot;christianity in china&quot;]\
      \ = &quot;Blessing message.svg&quot;,\n\t[&quot;christianity in india&quot;] = &quot;India with cross.svg&quot;,\n\t[&quot;christian metal&quot;] = &quot;Guitar 1.svg&quot;,\n\t[&quot;christian music&quot;] = &quot;Musical note nicu bucule 01.svg&quot;,\n\
      \t[&quot;christina aguilera&quot;] = &quot;CA2010PREIMRE.jpg&quot;,\n\t[&quot;christmas&quot;] = &quot;Xmas tree.svg&quot;,\n\t[&quot;chronology&quot;] = &quot;History.gif&quot;,\n\t[&quot;cincinnati&quot;] = &quot;Cincinnati Dusk Light.JPG&quot;,\n\t\
      [&quot;city of port of spain&quot;] = &quot;POS Academy for the Performing Arts 03 2012 0960.JPG&quot;,\n\t[&quot;city of san fernando&quot;] = &quot;HilltopSandoview.jpg&quot;,\n\t[&quot;classical civilisation&quot;] = &quot;2006 01 21 Athènes Parthé\
      non.JPG&quot;,\n\t[&quot;classical music&quot;] = &quot;'A' (PSF).png&quot;,\n\t[&quot;cleveland&quot;] = &quot;Flag of Cleveland, Ohio.svg|border&quot;,\n\t[&quot;coffee&quot;] = &quot;Emblem-relax.svg&quot;,\n\t[&quot;cold war&quot;] = &quot;Cold War\
      \ Map 1959.svg&quot;,\n\t[&quot;college basketball&quot;] = &quot;Basketball.png&quot;,\n\t[&quot;college football&quot;] = &quot;NCAAFootball transparent.png&quot;,\n\t[&quot;colombia&quot;] = &quot;Flag of Colombia.svg|border&quot;,\n\t[&quot;colonialism&quot;]\
      \ = &quot;PithHelmetTruman.jpg&quot;,\n\t[&quot;color&quot;] = &quot;Colouring pencils.jpg&quot;,\n\t[&quot;colorado&quot;] = &quot;Flag of Colorado.svg|border|alt=Flag of Colorado&quot;,\n\t[&quot;comedy&quot;] = &quot;SMirC-laugh.svg&quot;,\n\t[&quot;comics&quot;]\
      \ = &quot;Speech balloon.svg&quot;,\n\t[&quot;commonwealth games&quot;] = &quot;The Hydro - May 2012.JPG&quot;,\n\t[&quot;commonwealth realms&quot;] = &quot;Commonwealth Realms map2.png&quot;,\n\t[&quot;communism&quot;] = &quot;Symbol-hammer-and-sickle.svg&quot;,\n\
      \t[&quot;community&quot;] = &quot;P globe blue.png&quot;,\n\t[&quot;community of christ&quot;] = &quot;USVA headstone emb-20.jpg&quot;,\n\t[&quot;companies&quot;] = &quot;Factory 1b.svg&quot;,\n\t[&quot;complementary and alternative medicine&quot;] = &quot;Rod\
      \ of Asclepius2.svg&quot;,\n\t[&quot;computer graphics&quot;] = &quot;5-cell.gif&quot;,\n\t[&quot;computer networking&quot;] = &quot;Bus icon.svg&quot;,\n\t[&quot;computer programming&quot;] = &quot;8bit-dynamiclist.gif&quot;,\n\t[&quot;computer science&quot;]\
      \ = &quot;Internet map 1024.jpg&quot;,\n\t[&quot;computer security&quot;] = &quot;Monitor padlock.svg&quot;,\n\t[&quot;connecticut&quot;] = &quot;Seal of Connecticut.svg&quot;,\n\t[&quot;conservatism&quot;] = &quot;DodgerBlue flag waving.svg&quot;,\n\t\
      [&quot;constructed languages&quot;] = &quot;Design conlang.png&quot;,\n\t[&quot;contents&quot;] = &quot;Wikipedia's W.svg&quot;,\n\t[&quot;contents/indexes&quot;] = &quot;Pointing-right.svg&quot;,\n\t[&quot;contents/outlines&quot;] = &quot;Pointing-left.svg&quot;,\n\
      \t[&quot;cooperatives&quot;] = &quot;Twinpines.svg&quot;,\n\t[&quot;córdoba&quot;] = &quot;Escudo ciudad de cordoba argentina.svg&quot;,\n\t[&quot;cornhusker&quot;] = &quot;Nebraska silhouette.png&quot;,\n\t[&quot;cornwall&quot;] = &quot;Flag of Cornwall.svg|border&quot;,\n\
      \t[&quot;cosmology&quot;] = &quot;Ilc 9yr moll4096.png&quot;,\n\t[&quot;costa rica&quot;] = &quot;Flag of Costa Rica.svg|border&quot;,\n\t[&quot;country music&quot;] = &quot;Steel guitar-KayEss.1.jpeg&quot;,\n\t[&quot;creationism&quot;] = &quot;Michelangelo,\
      \ Creation of Adam 04.jpg&quot;,\n\t[&quot;cricket&quot;] = &quot;Cricketball.png&quot;,\n\t[&quot;crimea&quot;] = &quot;Flag of Crimea.svg|border&quot;,\n\t[&quot;criminal justice&quot;] = &quot;Scale of justice 2.svg&quot;,\n\t[&quot;croatia&quot;] =\
      \ &quot;Flag of Croatia.svg|border&quot;,\n\t[&quot;crusades&quot;] = &quot;Blason ville fr Villejust (Essonne).svg&quot;,\n\t[&quot;crustaceans&quot;] = &quot;Charybdis japonica.jpg&quot;,\n\t[&quot;cryptography&quot;] = &quot;Crypto key.svg&quot;,\n\t\
      [&quot;cryptozoology&quot;] = &quot;Okapi2.jpg&quot;,\n\t[&quot;cuba&quot;] = &quot;Flag of Cuba.svg|border&quot;,\n\t[&quot;cultural heritage of serbia&quot;] = &quot;Spomenik Kulture.svg&quot;,\n\t[&quot;culture&quot;] = &quot;P culture.svg&quot;,\n\t\
      [&quot;cumbria&quot;] = &quot;Herdwick sheep crop.jpg&quot;,\n\t[&quot;current events&quot;] = &quot;Ambox globe.svg&quot;,\n\t[&quot;current events/turkey&quot;] = &quot;Wikinews-logo.png&quot;,\n\t[&quot;cycling&quot;] = &quot;Cycling pictogram.svg&quot;,\n\
      \t[&quot;cyprus&quot;] = &quot;Satellite image of Cyprus, cropped.jpg|border&quot;,\n\t[&quot;czech republic&quot;] = &quot;Flag of the Czech Republic.svg|border&quot;,\n}</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:02.546Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AClear&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:02 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1052 miss (0), cp3030 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3165605207, 2610619053, 1029544712
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="1239772" pageid="1239772" ns="10" title="Template:Clear"><revisions><rev user="Fuhghettaboutit" timestamp="2013-11-02T04:54:10Z" comment="Changed protection level of Template:Clear: Enable access by template editors ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;div style=&quot;clear:{{{1|both}}};&quot;&gt;&lt;/div&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:02.727Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3AReflist&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:02 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3008 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550975485, 3578342132, 1029545511
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"7585648\" pageid=\"7585648\" ns=\"10\" title=\"Template:Reflist\"><revisions><rev user=\"Edokter\" timestamp=\"2014-07-19T16:16:30Z\" comment=\"Undid revision 617584734 by [[Special:Contributions/Nikkimaria|Nikkimaria]]\
      \ ([[User talk:Nikkimaria|talk]]) Undo; we know the number (&gt;250,000)\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">&lt;div class=&quot;reflist &lt;!--\n --&gt;{{#if: {{{1|}}}\n    | columns {{#iferror: {{#ifexpr:\
      \ {{{1|1}}} &gt; 1 }}\n      | references-column-width \n      | references-column-count references-column-count-{{#if:1|{{{1}}}}} }}\n    | {{#if: {{{colwidth|}}}\n      | references-column-width }} }}&quot; style=&quot;&lt;!--\n --&gt;{{#if: {{{1|}}}\n\
      \    | {{#iferror: {{#ifexpr: {{{1|1}}} &gt; 1 }}\n      | {{column-width|{{#if:1|{{{1}}}}}}}\n      | {{column-count|{{#if:1|{{{1}}}}}}} }}\n    | {{#if: {{{colwidth|}}}\n      | {{column-width|{{{colwidth}}}}} }} }} list-style-type: &lt;!--\n --&gt;{{{liststyle|{{#switch:\
      \ {{{group|}}}\n    | upper-alpha\n    | upper-roman\n    | lower-alpha\n    | lower-greek\n    | lower-roman = {{{group}}}\n    | #default = decimal}}}}};&quot;&gt;\n{{#tag:references|{{{refs|}}}|group={{{group|}}}}}&lt;/div&gt;&lt;noinclude&gt;\n{{Documentation}}\n\
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:02.958Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Acolumn-count&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:02 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1068 miss (0), cp3010 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 3464565243, 123546632, 1029546334
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:column-count" to="Template:Column-count" /></normalized><pages><page _idx="29216387" pageid="29216387" ns="10" title="Template:Column-count"><revisions><rev user="Edokter" timestamp="2014-12-17T20:09:11Z" comment="redundant" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">&lt;includeonly&gt;-moz-column-count: {{{1|2}}}; -webkit-column-count: {{{1|2}}}; column-count: {{{1|2}}};&lt;/includeonly&gt;&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:03.138Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3Awiktionary&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:03 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3041 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550975995, 2115714442, 1029547295
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><normalized><n from="Template:wiktionary" to="Template:Wiktionary" /></normalized><pages><page _idx="960068" pageid="960068" ns="10" title="Template:Wiktionary"><revisions><rev user="Ianblair23" timestamp="2015-05-22T08:49:38Z" comment="sister → sister project" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{Sister project
      |position={{{position|}}}
      |project=wiktionary
      |text=Look up '''''[[wiktionary:{{{1|Special:Search/{{lc:{{SUBPAGENAME}}}}}}}|{{{1|{{lc:{{SUBPAGENAME}}}}}}}]]'''''{{#if:{{{2|}}}
        |{{#if:{{{3|}}}
         |,
         |&amp;nbsp;or
        }} '''''[[wiktionary:{{{2}}}|{{{2}}}]]'''''
       }}{{#if:{{{3|}}}
        |{{#if:{{{4|}}}
         |,
         |, or
        }} '''''[[wiktionary:{{{3}}}|{{{3}}}]]'''''
       }}{{#if:{{{4|}}}
        |{{#if:{{{5|}}}
         |,
         |, or
        }} '''''[[wiktionary:{{{4}}}|{{{4}}}]]'''''
       }}{{#if:{{{5|}}}
        |, or '''''[[wiktionary:{{{5}}}|{{{5}}}]]'''''
       }} in Wiktionary, the free dictionary.
      }}&lt;noinclude&gt;
      {{documentation}}
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:03.339Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASister+project&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:03 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3005 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550976230, 4208156518, 1029548096
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"20505184\" pageid=\"20505184\" ns=\"10\" title=\"Template:Sister project\"><revisions><rev user=\"Redrose64\" timestamp=\"2015-03-31T19:15:16Z\" comment=\"add sistersitebox\
      \ to |class= per [[Template talk:Sister project#Template-protected edit request on 31 March 2015]]\" contentformat=\"text/x-wiki\" contentmodel=\"wikitext\" xml:space=\"preserve\">{{Side box\n| metadata=no\n| position = {{{position|}}}\n| image    = \n\
      \  {{#switch: {{{image|}}}\n  | none =    &lt;!-- &quot;image=none&quot;, do nothing --&gt;\n  |      =    &lt;!-- No image fed, select an image --&gt;\n    [[Image:{{#switch: {{lc: {{{project|}}} }}\n    | commons                = Commons-logo.svg\n \
      \   | meta|metawiki|m        = Wikimedia Community Logo.svg\n    | wikibooks|wbk|wb|b     = Wikibooks-logo-en-noslogan.svg\n    | wikidata|data          = Wikidata-logo.svg\n    | wikiquote|quote|wqt|q  = Wikiquote-logo.svg\n    | wikipedia|wp|w      \
      \   = Wikipedia-logo-v2.svg\n    | wikisource|source|ws|s = Wikisource-logo.svg\n    | wiktionary|wkt|wdy|d   = Wiktionary-logo-en.svg\n    | wikinews|news|wnw|n    = Wikinews-logo.svg\n    | wikispecies|species    = Wikispecies-logo.svg\n    | wikiversity|wvy|v\
      \      = Wikiversity-logo.svg\n    | wikivoyage|voyage|voy  = Wikivoyage-Logo-v3-icon.svg\n    | mediawiki|mw           = Mediawiki.png\n    | outreachwiki|outreach  = Wikimedia Outreach.png\n    | incubator              = Incubator-notext.svg\n    | #default\
      \               = Wikimedia-logo.svg\n    }}|40x40px|link=|alt=\n    ]]\n  | #default = {{{image|}}}\n  }}\n| text       = {{{text}}}\n| below      = {{{below|}}}\n| imageright = {{{imageright|}}}\n| class      = plainlinks sistersitebox\n}}&lt;noinclude&gt;{{Documentation}}&lt;!--\
      \ Add categories and interwikis to the /doc subpage, not here! --&gt;&lt;/noinclude&gt;</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:03.517Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Template%3ASide+box&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:03 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3012 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791349985, 4019098700, 1029548950
    body: |-
      <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="20504849" pageid="20504849" ns="10" title="Template:Side box"><revisions><rev user="Mr. Stradivarius" timestamp="2014-06-03T04:58:23Z" comment="convert to [[Module:Side box]]" contentformat="text/x-wiki" contentmodel="wikitext" xml:space="preserve">{{#invoke:Side box|main}}&lt;noinclude&gt;
      {{documentation}}
      &lt;!-- Categories go on the /doc subpage, and interwikis go on Wikidata. --&gt;
      &lt;/noinclude&gt;</rev></revisions></page></pages></query></api>
- recorded: 2015-06-28T17:41:03.824Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=Module%3ASide+box&prop=revisions&rvprop=timestamp%7Cuser%7Ccomment%7Ccontent
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:03 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1066 miss (0), cp3030 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2421605949, 2610619861, 1029549763
    body: "<?xml version=\"1.0\"?><api batchcomplete=\"\"><query><pages><page _idx=\"42926982\" pageid=\"42926982\" ns=\"828\" title=\"Module:Side box\"><revisions><rev user=\"Mr. Stradivarius\" timestamp=\"2014-06-03T04:58:46Z\" comment=\"Protected Module:Side\
      \ box: [[WP:High-risk templates|High-risk Lua module]] ([Edit=Allow only template editors and admins] (indefinite) [Move=Allow only template editors and admins] (indefinite))\" contentformat=\"text/plain\" contentmodel=\"Scribunto\" xml:space=\"preserve\"\
      >-- This module implements {{side box}}.\n\nlocal yesno = require('Module:Yesno')\n\nlocal p = {}\n\nfunction p.main(frame)\n\tlocal origArgs = frame:getParent().args\n\tlocal args = {}\n\tfor k, v in pairs(origArgs) do\n\t\tv = v:match('%s*(.-)%s*$')\n\
      \t\tif v ~= '' then\n\t\t\targs[k] = v\n\t\tend\n\tend\n\treturn p._main(args)\nend\n\nfunction p._main(args)\n\tlocal data = p.makeData(args)\n\treturn p.renderSidebox(data)\nend\n\nfunction p.makeData(args)\n\tlocal data = {}\n\n\t-- Main table classes\n\
      \tdata.classes = {}\n\tif yesno(args.metadata) ~= false then\n\t\ttable.insert(data.classes, 'metadata')\n\tend\n\tif args.position and args.position:lower() == 'left' then\n\t\ttable.insert(data.classes, 'mbox-small-left')\n\telse\n\t\ttable.insert(data.classes,\
      \ 'mbox-small')\n\tend\n\ttable.insert(data.classes, args.class)\n\t\n\t-- Image\n\tif args.image and args.image ~= 'none' then\n\t\tdata.image = args.image\n\tend\n\n\t-- Copy over data that doesn't need adjusting\n\tlocal argsToCopy = {\n\t\t-- Styles\n\
      \t\t'style',\n\t\t'textstyle',\n\n\t\t-- Above row\n\t\t'above',\n\t\t'abovestyle',\n\n\t\t-- Body row\n\t\t'text',\n\t\t'imageright',\n\n\t\t-- Below row\n\t\t'below',\n\t}\n\tfor i, key in ipairs(argsToCopy) do\n\t\tdata[key] = args[key]\n\tend\n\n\t\
      return data\nend\n\nfunction p.renderSidebox(data)\n\t-- Renders the sidebox HTML.\n\n\t-- Table root\n\tlocal root = mw.html.create('table')\n\tfor i, class in ipairs(data.classes or {}) do\n\t\troot:addClass(class)\n\tend\n\troot:css{border = '1px solid\
      \ #aaa', ['background-color'] = '#f9f9f9'}\n\tif data.style then\n\t\troot:cssText(data.style)\n\tend\n\n\t-- The &quot;above&quot; row\n\tif data.above then\n\t\tlocal aboveCell = root:newline():tag('tr'):tag('td')\n\t\taboveCell\n\t\t\t:attr('colspan',\
      \ data.imageright and 3 or 2)\n\t\t\t:addClass('mbox-text')\n\t\tif data.textstyle then\n\t\t\taboveCell:cssText(data.textstyle)\n\t\tend\n\t\tif data.abovestyle then\n\t\t\taboveCell:cssText(data.abovestyle)\n\t\tend\n\t\taboveCell\n\t\t\t:newline()\n\
      \t\t\t:wikitext(data.above)\n\tend\n\n\t-- The body row\n\tlocal bodyRow = root:newline():tag('tr'):newline()\n\tif data.image then\n\t\tbodyRow:tag('td')\n\t\t\t:addClass('mbox-image')\n\t\t\t:wikitext(data.image)\n\telse\n\t\tbodyRow:tag('td'):css('width',\
      \ '1px')\n\tend\n\tlocal textCell = bodyRow:newline():tag('td')\n\ttextCell:addClass('mbox-text plainlist')\n\tif data.textstyle then\n\t\ttextCell:cssText(data.textstyle)\n\tend\n\ttextCell:wikitext(data.text)\n\tif data.imageright then\n\t\tbodyRow:newline():tag('td')\n\
      \t\t\t:addClass('mbox-imageright')\n\t\t\t:wikitext(data.imageright)\n\tend\n\n\t-- The below row\n\tif data.below then\n\t\tlocal belowCell = root:newline():tag('tr'):tag('td')\n\t\tbelowCell\n\t\t\t:attr('colspan', data.imageright and 3 or 2)\n\t\t\t\
      :addClass('mbox-text')\n\t\tif data.textstyle then\n\t\t\tbelowCell:cssText(data.textstyle)\n\t\tend\n\t\tbelowCell:wikitext(data.below)\n\tend\n\n\treturn tostring(root)\nend\n\nreturn p</rev></revisions></page></pages></query></api>"
- recorded: 2015-06-28T17:41:04.131Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3ASmokeycover.jpg&prop=imageinfo&iiprop=url&iiurlwidth=220
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:04 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1053 miss (0), cp3013 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2791350572, 1492457105, 1029551041
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="32234496" pageid="32234496" ns="6" title="File:Smokeycover.jpg" imagerepository="local"><imageinfo><ii thumburl="https://upload.wikimedia.org/wikipedia/en/thumb/7/73/Smokeycover.jpg/220px-Smokeycover.jpg" thumbwidth="220" thumbheight="307" url="https://upload.wikimedia.org/wikipedia/en/7/73/Smokeycover.jpg" descriptionurl="https://en.wikipedia.org/wiki/File:Smokeycover.jpg" /></imageinfo></page></pages></query></api>
- recorded: 2015-06-28T17:41:05.697Z
  request:
    method: GET
    uri: https://en.wikipedia.org/w/api.php?format=xml&action=query&continue=&titles=File%3A8bit-dynamiclist.gif&prop=imageinfo&iiprop=url&iiurlwidth=32
    headers:
      Connection: Keep-Alive
      Content-Length: '0'
      Cookie: GeoIP=PT:17:Maia:41.2357:-8.6199:v4; WMF-Last-Access=28-Jun-2015
      Cookie2: $Version=1
      Host: en.wikipedia.org
      User-Agent: JavaWikipediaAPI/3.1-SNAPSHOT https://bitbucket.org/axelclk/info.bliki.wiki/
  response:
    status: 200
    headers:
      Age: '0'
      Cache-control: private, must-revalidate, max-age=0
      Connection: keep-alive
      Content-Type: text/xml; charset=utf-8
      Date: Sun, 28 Jun 2015 17:41:05 GMT
      Server: nginx/1.9.2
      Strict-Transport-Security: max-age=15768000
      Transfer-Encoding: chunked
      Vary: Accept-Encoding,X-Forwarded-Proto,Cookie
      X-Analytics: https=1;WMF-Last-Access=28-Jun-2015
      X-Cache: cp1054 miss (0), cp3003 miss (0), cp3041 frontend miss (0)
      X-Content-Type-Options: nosniff
      X-Frame-Options: SAMEORIGIN
      X-Powered-By: HHVM/3.6.1
      X-Varnish: 2550979122, 3098055201, 1029558392
    body: <?xml version="1.0"?><api batchcomplete=""><query><pages><page _idx="-1" ns="6" title="File:8bit-dynamiclist.gif" missing="" imagerepository="shared"><imageinfo><ii thumburl="https://upload.wikimedia.org/wikipedia/commons/1/1d/8bit-dynamiclist.gif" thumbwidth="32" thumbheight="32" url="https://upload.wikimedia.org/wikipedia/commons/1/1d/8bit-dynamiclist.gif" descriptionurl="https://commons.wikimedia.org/wiki/File:8bit-dynamiclist.gif" /></imageinfo></page></pages></query></api>
